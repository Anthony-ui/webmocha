(window.webpackJsonp=window.webpackJsonp||[]).push([[1],{0:function(t,e,n){t.exports=n("zUnb")},"4ZJM":function(t,e,n){t.exports=function(){"use strict";var t,e,n;function i(i,r){if(t)if(e){var o="self.onerror = function() { console.error('An error occurred while parsing the WebWorker bundle. This is most likely due to improper transpilation by Babel; please see https://docs.mapbox.com/mapbox-gl-js/api/#transpiling-v2'); }; var sharedChunk = {}; ("+t+")(sharedChunk); ("+e+")(sharedChunk); self.onerror = null;",s={};t(s),n=r(s),"undefined"!=typeof window&&(n.workerUrl=window.URL.createObjectURL(new Blob([o],{type:"text/javascript"})))}else e=r;else t=r}return i(0,function(t){var e="2.3.0",n=i;function i(t,e,n,i){this.cx=3*t,this.bx=3*(n-t)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*e,this.by=3*(i-e)-this.cy,this.ay=1-this.cy-this.by,this.p1x=t,this.p1y=i,this.p2x=n,this.p2y=i}i.prototype.sampleCurveX=function(t){return((this.ax*t+this.bx)*t+this.cx)*t},i.prototype.sampleCurveY=function(t){return((this.ay*t+this.by)*t+this.cy)*t},i.prototype.sampleCurveDerivativeX=function(t){return(3*this.ax*t+2*this.bx)*t+this.cx},i.prototype.solveCurveX=function(t,e){var n,i,r,o,s;for(void 0===e&&(e=1e-6),r=t,s=0;s<8;s++){if(o=this.sampleCurveX(r)-t,Math.abs(o)<e)return r;var a=this.sampleCurveDerivativeX(r);if(Math.abs(a)<1e-6)break;r-=o/a}if((r=t)<(n=0))return n;if(r>(i=1))return i;for(;n<i;){if(o=this.sampleCurveX(r),Math.abs(o-t)<e)return r;t>o?n=r:i=r,r=.5*(i-n)+n}return r},i.prototype.solve=function(t,e){return this.sampleCurveY(this.solveCurveX(t,e))};var r=o;function o(t,e){this.x=t,this.y=e}o.prototype={clone:function(){return new o(this.x,this.y)},add:function(t){return this.clone()._add(t)},sub:function(t){return this.clone()._sub(t)},multByPoint:function(t){return this.clone()._multByPoint(t)},divByPoint:function(t){return this.clone()._divByPoint(t)},mult:function(t){return this.clone()._mult(t)},div:function(t){return this.clone()._div(t)},rotate:function(t){return this.clone()._rotate(t)},rotateAround:function(t,e){return this.clone()._rotateAround(t,e)},matMult:function(t){return this.clone()._matMult(t)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(t){return this.x===t.x&&this.y===t.y},dist:function(t){return Math.sqrt(this.distSqr(t))},distSqr:function(t){var e=t.x-this.x,n=t.y-this.y;return e*e+n*n},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(t){return Math.atan2(this.y-t.y,this.x-t.x)},angleWith:function(t){return this.angleWithSep(t.x,t.y)},angleWithSep:function(t,e){return Math.atan2(this.x*e-this.y*t,this.x*t+this.y*e)},_matMult:function(t){var e=t[2]*this.x+t[3]*this.y;return this.x=t[0]*this.x+t[1]*this.y,this.y=e,this},_add:function(t){return this.x+=t.x,this.y+=t.y,this},_sub:function(t){return this.x-=t.x,this.y-=t.y,this},_mult:function(t){return this.x*=t,this.y*=t,this},_div:function(t){return this.x/=t,this.y/=t,this},_multByPoint:function(t){return this.x*=t.x,this.y*=t.y,this},_divByPoint:function(t){return this.x/=t.x,this.y/=t.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var t=this.y;return this.y=this.x,this.x=-t,this},_rotate:function(t){var e=Math.cos(t),n=Math.sin(t),i=n*this.x+e*this.y;return this.x=e*this.x-n*this.y,this.y=i,this},_rotateAround:function(t,e){var n=Math.cos(t),i=Math.sin(t),r=e.y+i*(this.x-e.x)+n*(this.y-e.y);return this.x=e.x+n*(this.x-e.x)-i*(this.y-e.y),this.y=r,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},o.convert=function(t){return t instanceof o?t:Array.isArray(t)?new o(t[0],t[1]):t};var s="undefined"!=typeof self?self:{};const a=Math.pow(2,53)-1,l=Math.PI/180,c=180/Math.PI;function u(t){return t*l}const h=[[0,0],[1,0],[1,1],[0,1]];function d(t){if(t<=0)return 0;if(t>=1)return 1;const e=t*t,n=e*t;return 4*(t<.5?n:3*(t-e)+n-.75)}function p(t,e,i,r){const o=new n(t,e,i,r);return function(t){return o.solve(t)}}const f=p(.25,.1,.25,1);function m(t,e,n){return Math.min(n,Math.max(e,t))}function g(t,e,n){const i=n-e,r=((t-e)%i+i)%i+e;return r===e?n:r}function _(t,e,n){if(!t.length)return n(null,[]);let i=t.length;const r=new Array(t.length);let o=null;t.forEach((t,s)=>{e(t,(t,e)=>{t&&(o=t),r[s]=e,0==--i&&n(o,r)})})}function y(t){const e=[];for(const n in t)e.push(t[n]);return e}function v(t,...e){for(const n of e)for(const e in n)t[e]=n[e];return t}let x=1;function b(){return x++}function w(){return function t(e){return e?(e^16*Math.random()>>e/4).toString(16):([1e7]+-[1e3]+-4e3+-8e3+-1e11).replace(/[018]/g,t)}()}function C(t){return t<=1?1:Math.pow(2,Math.ceil(Math.log(t)/Math.LN2))}function T(t){return!!t&&/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(t)}function S(t,e){t.forEach(t=>{e[t]&&(e[t]=e[t].bind(e))})}function E(t,e){return-1!==t.indexOf(e,t.length-e.length)}function k(t,e,n){const i={};for(const r in t)i[r]=e.call(n||this,t[r],r,t);return i}function A(t,e,n){const i={};for(const r in t)e.call(n||this,t[r],r,t)&&(i[r]=t[r]);return i}function I(t){return Array.isArray(t)?t.map(I):"object"==typeof t&&t?k(t,I):t}const P={};function M(t){P[t]||("undefined"!=typeof console&&console.warn(t),P[t]=!0)}function O(t,e,n){return(n.y-t.y)*(e.x-t.x)>(e.y-t.y)*(n.x-t.x)}function z(t){let e=0;for(let n,i,r=0,o=t.length,s=o-1;r<o;s=r++)n=t[r],i=t[s],e+=(i.x-n.x)*(n.y+i.y);return e}function D(){return"undefined"!=typeof WorkerGlobalScope&&"undefined"!=typeof self&&self instanceof WorkerGlobalScope}function L(t){const e={};if(t.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(t,n,i,r)=>{const o=i||r;return e[n]=!o||o.toLowerCase(),""}),e["max-age"]){const t=parseInt(e["max-age"],10);isNaN(t)?delete e["max-age"]:e["max-age"]=t}return e}let R,F,B,V=null;function U(t){if(null==V){const e=t.navigator?t.navigator.userAgent:null;V=!!t.safari||!(!e||!(/\b(iPad|iPhone|iPod)\b/.test(e)||e.match("Safari")&&!e.match("Chrome")))}return V}function N(t){try{const e=s[t];return e.setItem("_mapbox_test_",1),e.removeItem("_mapbox_test_"),!0}catch(t){return!1}}const j={now:()=>void 0!==B?B:s.performance.now(),setNow(t){B=t},restoreNow(){B=void 0},frame(t){const e=s.requestAnimationFrame(t);return{cancel:()=>s.cancelAnimationFrame(e)}},getImageData(t,e=0){const n=s.document.createElement("canvas"),i=n.getContext("2d");if(!i)throw new Error("failed to create canvas 2d context");return n.width=t.width,n.height=t.height,i.drawImage(t,0,0,t.width,t.height),i.getImageData(-e,-e,t.width+2*e,t.height+2*e)},resolveURL:t=>(R||(R=s.document.createElement("a")),R.href=t,R.href),get devicePixelRatio(){return s.devicePixelRatio},get prefersReducedMotion(){return!!s.matchMedia&&(null==F&&(F=s.matchMedia("(prefers-reduced-motion: reduce)")),F.matches)}};let q;const $={API_URL:"https://api.mapbox.com",get API_URL_REGEX(){if(null==q){const t=/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i;try{q=null!=process.env.API_URL_REGEX?new RegExp(process.env.API_URL_REGEX):t}catch(e){q=t}}return q},get EVENTS_URL(){return this.API_URL?0===this.API_URL.indexOf("https://api.mapbox.cn")?"https://events.mapbox.cn/events/v2":0===this.API_URL.indexOf("https://api.mapbox.com")?"https://events.mapbox.com/events/v2":null:null},SESSION_PATH:"/map-sessions/v1",FEEDBACK_URL:"https://apps.mapbox.com/feedback",TILE_URL_VERSION:"v4",RASTER_URL_PREFIX:"raster/v1",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null,MAX_PARALLEL_IMAGE_REQUESTS:16},G={supported:!1,testSupport:function(t){!W&&H&&(X?K(t):Z=t)}};let Z,H,W=!1,X=!1;function K(t){const e=t.createTexture();t.bindTexture(t.TEXTURE_2D,e);try{if(t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,H),t.isContextLost())return;G.supported=!0}catch(t){}t.deleteTexture(e),W=!0}s.document&&(H=s.document.createElement("img"),H.onload=function(){Z&&K(Z),Z=null,X=!0},H.onerror=function(){W=!0,Z=null},H.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");const Y="01",J="NO_ACCESS_TOKEN";function Q(t){return 0===t.indexOf("mapbox:")}function tt(t){return $.API_URL_REGEX.test(t)}const et=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function nt(t){const e=t.match(et);if(!e)throw new Error("Unable to parse URL object");return{protocol:e[1],authority:e[2],path:e[3]||"/",params:e[4]?e[4].split("&"):[]}}function it(t){const e=t.params.length?"?"+t.params.join("&"):"";return`${t.protocol}://${t.authority}${t.path}${e}`}function rt(t){if(!t)return null;const e=t.split(".");if(!e||3!==e.length)return null;try{return JSON.parse(decodeURIComponent(s.atob(e[1]).split("").map(t=>"%"+("00"+t.charCodeAt(0).toString(16)).slice(-2)).join("")))}catch(t){return null}}class ot{constructor(t){this.type=t,this.anonId=null,this.eventData={},this.queue=[],this.pendingRequest=null}getStorageKey(t){const e=rt($.ACCESS_TOKEN);let n="";return n=e&&e.u?s.btoa(encodeURIComponent(e.u).replace(/%([0-9A-F]{2})/g,(t,e)=>String.fromCharCode(Number("0x"+e)))):$.ACCESS_TOKEN||"",t?`mapbox.eventData.${t}:${n}`:"mapbox.eventData:"+n}fetchEventData(){const t=N("localStorage"),e=this.getStorageKey(),n=this.getStorageKey("uuid");if(t)try{const t=s.localStorage.getItem(e);t&&(this.eventData=JSON.parse(t));const i=s.localStorage.getItem(n);i&&(this.anonId=i)}catch(t){M("Unable to read from LocalStorage")}}saveEventData(){const t=N("localStorage"),e=this.getStorageKey(),n=this.getStorageKey("uuid");if(t)try{s.localStorage.setItem(n,this.anonId),Object.keys(this.eventData).length>=1&&s.localStorage.setItem(e,JSON.stringify(this.eventData))}catch(t){M("Unable to write to LocalStorage")}}processRequests(t){}postEvent(t,n,i,r){if(!$.EVENTS_URL)return;const o=nt($.EVENTS_URL);o.params.push("access_token="+(r||$.ACCESS_TOKEN||""));const s={event:this.type,created:new Date(t).toISOString(),sdkIdentifier:"mapbox-gl-js",sdkVersion:e,skuId:Y,userId:this.anonId},a=n?v(s,n):s,l={url:it(o),headers:{"Content-Type":"text/plain"},body:JSON.stringify([a])};this.pendingRequest=Et(l,t=>{this.pendingRequest=null,i(t),this.saveEventData(),this.processRequests(r)})}queueRequest(t,e){this.queue.push(t),this.processRequests(e)}}const st=new class extends ot{constructor(t){super("appUserTurnstile"),this._customAccessToken=t}postTurnstileEvent(t,e){$.EVENTS_URL&&$.ACCESS_TOKEN&&Array.isArray(t)&&t.some(t=>Q(t)||tt(t))&&this.queueRequest(Date.now(),e)}processRequests(t){if(this.pendingRequest||0===this.queue.length)return;this.anonId&&this.eventData.lastSuccess&&this.eventData.tokenU||this.fetchEventData();const e=rt($.ACCESS_TOKEN),n=e?e.u:$.ACCESS_TOKEN;let i=n!==this.eventData.tokenU;T(this.anonId)||(this.anonId=w(),i=!0);const r=this.queue.shift();if(this.eventData.lastSuccess){const t=new Date(this.eventData.lastSuccess),e=new Date(r),n=(r-this.eventData.lastSuccess)/864e5;i=i||n>=1||n<-1||t.getDate()!==e.getDate()}else i=!0;if(!i)return this.processRequests();this.postEvent(r,{"enabled.telemetry":!1},t=>{t||(this.eventData.lastSuccess=r,this.eventData.tokenU=n)},t)}},at=st.postTurnstileEvent.bind(st),lt=new class extends ot{constructor(){super("map.load"),this.success={},this.skuToken=""}postMapLoadEvent(t,e,n,i){this.skuToken=e,this.errorCb=i,$.EVENTS_URL&&(n||$.ACCESS_TOKEN?this.queueRequest({id:t,timestamp:Date.now()},n):this.errorCb(new Error(J)))}processRequests(t){if(this.pendingRequest||0===this.queue.length)return;const{id:e,timestamp:n}=this.queue.shift();e&&this.success[e]||(this.anonId||this.fetchEventData(),T(this.anonId)||(this.anonId=w()),this.postEvent(n,{skuToken:this.skuToken},t=>{t?this.errorCb(t):e&&(this.success[e]=!0)},t))}},ct=lt.postMapLoadEvent.bind(lt),ut=new class extends ot{constructor(){super("map.auth"),this.success={},this.skuToken=""}getSession(t,e,n,i){if(!$.API_URL||!$.SESSION_PATH)return;const r=nt($.API_URL+$.SESSION_PATH);r.params.push("sku="+(e||"")),r.params.push("access_token="+(i||$.ACCESS_TOKEN||""));const o={url:it(r),headers:{"Content-Type":"text/plain"}};this.pendingRequest=kt(o,t=>{this.pendingRequest=null,n(t),this.saveEventData(),this.processRequests(i)})}getSessionAPI(t,e,n,i){this.skuToken=e,this.errorCb=i,$.SESSION_PATH&&$.API_URL&&(n||$.ACCESS_TOKEN?this.queueRequest({id:t,timestamp:Date.now()},n):this.errorCb(new Error(J)))}processRequests(t){if(this.pendingRequest||0===this.queue.length)return;const{id:e,timestamp:n}=this.queue.shift();e&&this.success[e]||this.getSession(n,this.skuToken,t=>{t?this.errorCb(t):e&&(this.success[e]=!0)},t)}},ht=ut.getSessionAPI.bind(ut),dt=new Set,pt="mapbox-tiles";let ft,mt,gt=500,_t=50;function yt(){s.caches&&!ft&&(ft=s.caches.open(pt))}function vt(t){const e=t.indexOf("?");return e<0?t:t.slice(0,e)}let xt=1/0;const bt={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Image:"Image"};"function"==typeof Object.freeze&&Object.freeze(bt);class wt extends Error{constructor(t,e,n){401===e&&tt(n)&&(t+=": you may have provided an invalid Mapbox access token. See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes"),super(t),this.status=e,this.url=n}toString(){return`${this.name}: ${this.message} (${this.status}): ${this.url}`}}const Ct=D()?()=>self.worker&&self.worker.referrer:()=>("blob:"===s.location.protocol?s.parent:s).location.href,Tt=function(t,e){if(!(/^file:/.test(n=t.url)||/^file:/.test(Ct())&&!/^\w+:/.test(n))){if(s.fetch&&s.Request&&s.AbortController&&s.Request.prototype.hasOwnProperty("signal"))return function(t,e){const n=new s.AbortController,i=new s.Request(t.url,{method:t.method||"GET",body:t.body,credentials:t.credentials,headers:t.headers,referrer:Ct(),signal:n.signal});let r=!1,o=!1;const a=(l=i.url).indexOf("sku=")>0&&tt(l);var l;"json"===t.type&&i.headers.set("Accept","application/json");const c=(n,r,l)=>{if(o)return;if(n&&"SecurityError"!==n.message&&M(n),r&&l)return u(r);const c=Date.now();s.fetch(i).then(n=>{if(n.ok){const t=a?n.clone():null;return u(n,t,c)}return e(new wt(n.statusText,n.status,t.url))}).catch(t=>{20!==t.code&&e(new Error(t.message))})},u=(n,a,l)=>{("arrayBuffer"===t.type?n.arrayBuffer():"json"===t.type?n.json():n.text()).then(t=>{o||(a&&l&&function(t,e,n){if(yt(),!ft)return;const i={status:e.status,statusText:e.statusText,headers:new s.Headers};e.headers.forEach((t,e)=>i.headers.set(e,t));const r=L(e.headers.get("Cache-Control")||"");r["no-store"]||(r["max-age"]&&i.headers.set("Expires",new Date(n+1e3*r["max-age"]).toUTCString()),new Date(i.headers.get("Expires")).getTime()-n<42e4||function(t,e){if(void 0===mt)try{new Response(new ReadableStream),mt=!0}catch(t){mt=!1}mt?e(t.body):t.blob().then(e)}(e,e=>{const n=new s.Response(e,i);yt(),ft&&ft.then(e=>e.put(vt(t.url),n)).catch(t=>M(t.message))}))}(i,a,l),r=!0,e(null,t,n.headers.get("Cache-Control"),n.headers.get("Expires")))}).catch(t=>{o||e(new Error(t.message))})};return a?function(t,e){if(yt(),!ft)return e(null);const n=vt(t.url);ft.then(t=>{t.match(n).then(i=>{const r=function(t){if(!t)return!1;const e=new Date(t.headers.get("Expires")||0),n=L(t.headers.get("Cache-Control")||"");return e>Date.now()&&!n["no-cache"]}(i);t.delete(n),r&&t.put(n,i.clone()),e(null,i,r)}).catch(e)}).catch(e)}(i,c):c(null,null),{cancel:()=>{o=!0,r||n.abort()}}}(t,e);if(D()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",t,e,void 0,!0)}var n;return function(t,e){const n=new s.XMLHttpRequest;n.open(t.method||"GET",t.url,!0),"arrayBuffer"===t.type&&(n.responseType="arraybuffer");for(const i in t.headers)n.setRequestHeader(i,t.headers[i]);return"json"===t.type&&(n.responseType="text",n.setRequestHeader("Accept","application/json")),n.withCredentials="include"===t.credentials,n.onerror=()=>{e(new Error(n.statusText))},n.onload=()=>{if((n.status>=200&&n.status<300||0===n.status)&&null!==n.response){let i=n.response;if("json"===t.type)try{i=JSON.parse(n.response)}catch(t){return e(t)}e(null,i,n.getResponseHeader("Cache-Control"),n.getResponseHeader("Expires"))}else e(new wt(n.statusText,n.status,t.url))},n.send(t.body),{cancel:()=>n.abort()}}(t,e)},St=function(t,e){return Tt(v(t,{type:"arrayBuffer"}),e)},Et=function(t,e){return Tt(v(t,{method:"POST"}),e)},kt=function(t,e){return Tt(v(t,{method:"GET"}),e)};function At(t){const e=s.document.createElement("a");return e.href=t,e.protocol===s.document.location.protocol&&e.host===s.document.location.host}const It="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";let Pt,Mt;Pt=[],Mt=0;const Ot=function(t,e){if(G.supported&&(t.headers||(t.headers={}),t.headers.accept="image/webp,*/*"),Mt>=$.MAX_PARALLEL_IMAGE_REQUESTS){const n={requestParameters:t,callback:e,cancelled:!1,cancel(){this.cancelled=!0}};return Pt.push(n),n}Mt++;let n=!1;const i=()=>{if(!n)for(n=!0,Mt--;Pt.length&&Mt<$.MAX_PARALLEL_IMAGE_REQUESTS;){const t=Pt.shift(),{requestParameters:e,callback:n,cancelled:i}=t;i||(t.cancel=Ot(e,n).cancel)}},r=St(t,(t,n,r,o)=>{i(),t?e(t):n&&(s.createImageBitmap?function(t,e){const n=new s.Blob([new Uint8Array(t)],{type:"image/png"});s.createImageBitmap(n).then(t=>{e(null,t)}).catch(t=>{e(new Error(`Could not load image because of ${t.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`))})}(n,(t,n)=>e(t,n,r,o)):function(t,e){const n=new s.Image,i=s.URL;n.onload=()=>{e(null,n),i.revokeObjectURL(n.src),n.onload=null,s.requestAnimationFrame(()=>{n.src=It})},n.onerror=()=>e(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const r=new s.Blob([new Uint8Array(t)],{type:"image/png"});n.src=t.byteLength?i.createObjectURL(r):It}(n,(t,n)=>e(t,n,r,o)))});return{cancel:()=>{r.cancel(),i()}}};function zt(t,e,n){n[t]&&-1!==n[t].indexOf(e)||(n[t]=n[t]||[],n[t].push(e))}function Dt(t,e,n){if(n&&n[t]){const i=n[t].indexOf(e);-1!==i&&n[t].splice(i,1)}}class Lt{constructor(t,e={}){v(this,e),this.type=t}}class Rt extends Lt{constructor(t,e={}){super("error",v({error:t},e))}}class Ft{on(t,e){return this._listeners=this._listeners||{},zt(t,e,this._listeners),this}off(t,e){return Dt(t,e,this._listeners),Dt(t,e,this._oneTimeListeners),this}once(t,e){return e?(this._oneTimeListeners=this._oneTimeListeners||{},zt(t,e,this._oneTimeListeners),this):new Promise(e=>this.once(t,e))}fire(t,e){"string"==typeof t&&(t=new Lt(t,e||{}));const n=t.type;if(this.listens(n)){t.target=this;const e=this._listeners&&this._listeners[n]?this._listeners[n].slice():[];for(const n of e)n.call(this,t);const i=this._oneTimeListeners&&this._oneTimeListeners[n]?this._oneTimeListeners[n].slice():[];for(const o of i)Dt(n,o,this._oneTimeListeners),o.call(this,t);const r=this._eventedParent;r&&(v(t,"function"==typeof this._eventedParentData?this._eventedParentData():this._eventedParentData),r.fire(t))}else t instanceof Rt&&console.error(t.error);return this}listens(t){return!!(this._listeners&&this._listeners[t]&&this._listeners[t].length>0||this._oneTimeListeners&&this._oneTimeListeners[t]&&this._oneTimeListeners[t].length>0||this._eventedParent&&this._eventedParent.listens(t))}setEventedParent(t,e){return this._eventedParent=t,this._eventedParentData=e,this}}var Bt={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},light:{type:"light"},terrain:{type:"terrain"},fog:{type:"fog"},sources:{required:!0,type:"sources"},sprite:{type:"string"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{}},default:"mapbox"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{},sky:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background","layout_sky"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_sky:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{},within:{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},fog:{range:{type:"array",default:[.5,10],minimum:-20,maximum:20,length:2,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-blend":{type:"number","property-type":"data-constant",default:.1,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},terrain:{source:{type:"string",required:!0},exaggeration:{type:"number","property-type":"data-constant",default:1,minimum:0,maximum:1e3,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background","paint_sky"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_sky:{"sky-type":{type:"enum",values:{gradient:{},atmosphere:{}},default:"atmosphere",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun":{type:"array",value:"number",length:2,units:"degrees",minimum:[0,0],maximum:[360,180],transition:!1,requires:[{"sky-type":"atmosphere"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun-intensity":{type:"number",requires:[{"sky-type":"atmosphere"}],default:10,minimum:0,maximum:100,transition:!1,"property-type":"data-constant"},"sky-gradient-center":{type:"array",requires:[{"sky-type":"gradient"}],value:"number",default:[0,0],length:2,units:"degrees",minimum:[0,0],maximum:[360,180],transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"sky-gradient-radius":{type:"number",requires:[{"sky-type":"gradient"}],default:90,minimum:0,maximum:180,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"sky-gradient":{type:"color",default:["interpolate",["linear"],["sky-radial-progress"],.8,"#87ceeb",1,"white"],transition:!1,requires:[{"sky-type":"gradient"}],expression:{interpolated:!0,parameters:["sky-radial-progress"]},"property-type":"color-ramp"},"sky-atmosphere-halo-color":{type:"color",default:"white",transition:!1,requires:[{"sky-type":"atmosphere"}],"property-type":"data-constant"},"sky-atmosphere-color":{type:"color",default:"white",transition:!1,requires:[{"sky-type":"atmosphere"}],"property-type":"data-constant"},"sky-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}};class Vt{constructor(t,e,n,i){this.message=(t?t+": ":"")+n,i&&(this.identifier=i),null!=e&&e.__line__&&(this.line=e.__line__)}}function Ut(t){const e=t.value;return e?[new Vt(t.key,e,"constants have been deprecated as of v8")]:[]}function Nt(t,...e){for(const n of e)for(const e in n)t[e]=n[e];return t}function jt(t){return t instanceof Number||t instanceof String||t instanceof Boolean?t.valueOf():t}function qt(t){if(Array.isArray(t))return t.map(qt);if(t instanceof Object&&!(t instanceof Number||t instanceof String||t instanceof Boolean)){const e={};for(const n in t)e[n]=qt(t[n]);return e}return jt(t)}class $t extends Error{constructor(t,e){super(e),this.message=e,this.key=t}}class Gt{constructor(t,e=[]){this.parent=t,this.bindings={};for(const[n,i]of e)this.bindings[n]=i}concat(t){return new Gt(this,t)}get(t){if(this.bindings[t])return this.bindings[t];if(this.parent)return this.parent.get(t);throw new Error(t+" not found in scope.")}has(t){return!!this.bindings[t]||!!this.parent&&this.parent.has(t)}}const Zt={kind:"null"},Ht={kind:"number"},Wt={kind:"string"},Xt={kind:"boolean"},Kt={kind:"color"},Yt={kind:"object"},Jt={kind:"value"},Qt={kind:"collator"},te={kind:"formatted"},ee={kind:"resolvedImage"};function ne(t,e){return{kind:"array",itemType:t,N:e}}function ie(t){if("array"===t.kind){const e=ie(t.itemType);return"number"==typeof t.N?`array<${e}, ${t.N}>`:"value"===t.itemType.kind?"array":`array<${e}>`}return t.kind}const re=[Zt,Ht,Wt,Xt,Kt,te,Yt,ne(Jt),ee];function oe(t,e){if("error"===e.kind)return null;if("array"===t.kind){if("array"===e.kind&&(0===e.N&&"value"===e.itemType.kind||!oe(t.itemType,e.itemType))&&("number"!=typeof t.N||t.N===e.N))return null}else{if(t.kind===e.kind)return null;if("value"===t.kind)for(const t of re)if(!oe(t,e))return null}return`Expected ${ie(t)} but found ${ie(e)} instead.`}function se(t,e){return e.some(e=>e.kind===t.kind)}function ae(t,e){return e.some(e=>"null"===e?null===t:"array"===e?Array.isArray(t):"object"===e?t&&!Array.isArray(t)&&"object"==typeof t:e===typeof t)}function le(t){var e={exports:{}};return t(e,e.exports),e.exports}var ce=le(function(t,e){var n={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function i(t){return(t=Math.round(t))<0?0:t>255?255:t}function r(t){return i("%"===t[t.length-1]?parseFloat(t)/100*255:parseInt(t))}function o(t){return(e="%"===t[t.length-1]?parseFloat(t)/100:parseFloat(t))<0?0:e>1?1:e;var e}function s(t,e,n){return n<0?n+=1:n>1&&(n-=1),6*n<1?t+(e-t)*n*6:2*n<1?e:3*n<2?t+(e-t)*(2/3-n)*6:t}try{e.parseCSSColor=function(t){var e,a=t.replace(/ /g,"").toLowerCase();if(a in n)return n[a].slice();if("#"===a[0])return 4===a.length?(e=parseInt(a.substr(1),16))>=0&&e<=4095?[(3840&e)>>4|(3840&e)>>8,240&e|(240&e)>>4,15&e|(15&e)<<4,1]:null:7===a.length&&(e=parseInt(a.substr(1),16))>=0&&e<=16777215?[(16711680&e)>>16,(65280&e)>>8,255&e,1]:null;var l=a.indexOf("("),c=a.indexOf(")");if(-1!==l&&c+1===a.length){var u=a.substr(0,l),h=a.substr(l+1,c-(l+1)).split(","),d=1;switch(u){case"rgba":if(4!==h.length)return null;d=o(h.pop());case"rgb":return 3!==h.length?null:[r(h[0]),r(h[1]),r(h[2]),d];case"hsla":if(4!==h.length)return null;d=o(h.pop());case"hsl":if(3!==h.length)return null;var p=(parseFloat(h[0])%360+360)%360/360,f=o(h[1]),m=o(h[2]),g=m<=.5?m*(f+1):m+f-m*f,_=2*m-g;return[i(255*s(_,g,p+1/3)),i(255*s(_,g,p)),i(255*s(_,g,p-1/3)),d];default:return null}}return null}}catch(t){}});class ue{constructor(t,e,n,i=1){this.r=t,this.g=e,this.b=n,this.a=i}static parse(t){if(!t)return;if(t instanceof ue)return t;if("string"!=typeof t)return;const e=ce.parseCSSColor(t);return e?new ue(e[0]/255*e[3],e[1]/255*e[3],e[2]/255*e[3],e[3]):void 0}toString(){const[t,e,n,i]=this.toArray();return`rgba(${Math.round(t)},${Math.round(e)},${Math.round(n)},${i})`}toArray(){const{r:t,g:e,b:n,a:i}=this;return 0===i?[0,0,0,0]:[255*t/i,255*e/i,255*n/i,i]}}ue.black=new ue(0,0,0,1),ue.white=new ue(1,1,1,1),ue.transparent=new ue(0,0,0,0),ue.red=new ue(1,0,0,1),ue.blue=new ue(0,0,1,1);class he{constructor(t,e,n){this.sensitivity=t?e?"variant":"case":e?"accent":"base",this.locale=n,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(t,e){return this.collator.compare(t,e)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class de{constructor(t,e,n,i,r){this.text=t,this.image=e,this.scale=n,this.fontStack=i,this.textColor=r}}class pe{constructor(t){this.sections=t}static fromString(t){return new pe([new de(t,null,null,null,null)])}isEmpty(){return 0===this.sections.length||!this.sections.some(t=>0!==t.text.length||t.image&&0!==t.image.name.length)}static factory(t){return t instanceof pe?t:pe.fromString(t)}toString(){return 0===this.sections.length?"":this.sections.map(t=>t.text).join("")}serialize(){const t=["format"];for(const e of this.sections){if(e.image){t.push(["image",e.image.name]);continue}t.push(e.text);const n={};e.fontStack&&(n["text-font"]=["literal",e.fontStack.split(",")]),e.scale&&(n["font-scale"]=e.scale),e.textColor&&(n["text-color"]=["rgba"].concat(e.textColor.toArray())),t.push(n)}return t}}class fe{constructor(t){this.name=t.name,this.available=t.available}toString(){return this.name}static fromString(t){return t?new fe({name:t,available:!1}):null}serialize(){return["image",this.name]}}function me(t,e,n,i){return"number"==typeof t&&t>=0&&t<=255&&"number"==typeof e&&e>=0&&e<=255&&"number"==typeof n&&n>=0&&n<=255?void 0===i||"number"==typeof i&&i>=0&&i<=1?null:`Invalid rgba value [${[t,e,n,i].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${("number"==typeof i?[t,e,n,i]:[t,e,n]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function ge(t){if(null===t)return!0;if("string"==typeof t)return!0;if("boolean"==typeof t)return!0;if("number"==typeof t)return!0;if(t instanceof ue)return!0;if(t instanceof he)return!0;if(t instanceof pe)return!0;if(t instanceof fe)return!0;if(Array.isArray(t)){for(const e of t)if(!ge(e))return!1;return!0}if("object"==typeof t){for(const e in t)if(!ge(t[e]))return!1;return!0}return!1}function _e(t){if(null===t)return Zt;if("string"==typeof t)return Wt;if("boolean"==typeof t)return Xt;if("number"==typeof t)return Ht;if(t instanceof ue)return Kt;if(t instanceof he)return Qt;if(t instanceof pe)return te;if(t instanceof fe)return ee;if(Array.isArray(t)){const e=t.length;let n;for(const i of t){const t=_e(i);if(n){if(n===t)continue;n=Jt;break}n=t}return ne(n||Jt,e)}return Yt}function ye(t){const e=typeof t;return null===t?"":"string"===e||"number"===e||"boolean"===e?String(t):t instanceof ue||t instanceof pe||t instanceof fe?t.toString():JSON.stringify(t)}class ve{constructor(t,e){this.type=t,this.value=e}static parse(t,e){if(2!==t.length)return e.error(`'literal' expression requires exactly one argument, but found ${t.length-1} instead.`);if(!ge(t[1]))return e.error("invalid value");const n=t[1];let i=_e(n);const r=e.expectedType;return"array"!==i.kind||0!==i.N||!r||"array"!==r.kind||"number"==typeof r.N&&0!==r.N||(i=r),new ve(i,n)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}serialize(){return"array"===this.type.kind||"object"===this.type.kind?["literal",this.value]:this.value instanceof ue?["rgba"].concat(this.value.toArray()):this.value instanceof pe?this.value.serialize():this.value}}class xe{constructor(t){this.name="ExpressionEvaluationError",this.message=t}toJSON(){return this.message}}const be={string:Wt,number:Ht,boolean:Xt,object:Yt};class we{constructor(t,e){this.type=t,this.args=e}static parse(t,e){if(t.length<2)return e.error("Expected at least one argument.");let n,i=1;const r=t[0];if("array"===r){let r,o;if(t.length>2){const n=t[1];if("string"!=typeof n||!(n in be)||"object"===n)return e.error('The item type argument of "array" must be one of string, number, boolean',1);r=be[n],i++}else r=Jt;if(t.length>3){if(null!==t[2]&&("number"!=typeof t[2]||t[2]<0||t[2]!==Math.floor(t[2])))return e.error('The length argument to "array" must be a positive integer literal',2);o=t[2],i++}n=ne(r,o)}else n=be[r];const o=[];for(;i<t.length;i++){const n=e.parse(t[i],i,Jt);if(!n)return null;o.push(n)}return new we(n,o)}evaluate(t){for(let e=0;e<this.args.length;e++){const n=this.args[e].evaluate(t);if(!oe(this.type,_e(n)))return n;if(e===this.args.length-1)throw new xe(`Expected value to be of type ${ie(this.type)}, but found ${ie(_e(n))} instead.`)}return null}eachChild(t){this.args.forEach(t)}outputDefined(){return this.args.every(t=>t.outputDefined())}serialize(){const t=this.type,e=[t.kind];if("array"===t.kind){const n=t.itemType;if("string"===n.kind||"number"===n.kind||"boolean"===n.kind){e.push(n.kind);const i=t.N;("number"==typeof i||this.args.length>1)&&e.push(i)}}return e.concat(this.args.map(t=>t.serialize()))}}class Ce{constructor(t){this.type=te,this.sections=t}static parse(t,e){if(t.length<2)return e.error("Expected at least one argument.");const n=t[1];if(!Array.isArray(n)&&"object"==typeof n)return e.error("First argument must be an image or text section.");const i=[];let r=!1;for(let o=1;o<=t.length-1;++o){const n=t[o];if(r&&"object"==typeof n&&!Array.isArray(n)){r=!1;let t=null;if(n["font-scale"]&&(t=e.parse(n["font-scale"],1,Ht),!t))return null;let o=null;if(n["text-font"]&&(o=e.parse(n["text-font"],1,ne(Wt)),!o))return null;let s=null;if(n["text-color"]&&(s=e.parse(n["text-color"],1,Kt),!s))return null;const a=i[i.length-1];a.scale=t,a.font=o,a.textColor=s}else{const n=e.parse(t[o],1,Jt);if(!n)return null;const s=n.type.kind;if("string"!==s&&"value"!==s&&"null"!==s&&"resolvedImage"!==s)return e.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");r=!0,i.push({content:n,scale:null,font:null,textColor:null})}}return new Ce(i)}evaluate(t){return new pe(this.sections.map(e=>{const n=e.content.evaluate(t);return _e(n)===ee?new de("",n,null,null,null):new de(ye(n),null,e.scale?e.scale.evaluate(t):null,e.font?e.font.evaluate(t).join(","):null,e.textColor?e.textColor.evaluate(t):null)}))}eachChild(t){for(const e of this.sections)t(e.content),e.scale&&t(e.scale),e.font&&t(e.font),e.textColor&&t(e.textColor)}outputDefined(){return!1}serialize(){const t=["format"];for(const e of this.sections){t.push(e.content.serialize());const n={};e.scale&&(n["font-scale"]=e.scale.serialize()),e.font&&(n["text-font"]=e.font.serialize()),e.textColor&&(n["text-color"]=e.textColor.serialize()),t.push(n)}return t}}class Te{constructor(t){this.type=ee,this.input=t}static parse(t,e){if(2!==t.length)return e.error("Expected two arguments.");const n=e.parse(t[1],1,Wt);return n?new Te(n):e.error("No image name provided.")}evaluate(t){const e=this.input.evaluate(t),n=fe.fromString(e);return n&&t.availableImages&&(n.available=t.availableImages.indexOf(e)>-1),n}eachChild(t){t(this.input)}outputDefined(){return!1}serialize(){return["image",this.input.serialize()]}}const Se={"to-boolean":Xt,"to-color":Kt,"to-number":Ht,"to-string":Wt};class Ee{constructor(t,e){this.type=t,this.args=e}static parse(t,e){if(t.length<2)return e.error("Expected at least one argument.");const n=t[0];if(("to-boolean"===n||"to-string"===n)&&2!==t.length)return e.error("Expected one argument.");const i=Se[n],r=[];for(let o=1;o<t.length;o++){const n=e.parse(t[o],o,Jt);if(!n)return null;r.push(n)}return new Ee(i,r)}evaluate(t){if("boolean"===this.type.kind)return Boolean(this.args[0].evaluate(t));if("color"===this.type.kind){let e,n;for(const i of this.args){if(e=i.evaluate(t),n=null,e instanceof ue)return e;if("string"==typeof e){const n=t.parseColor(e);if(n)return n}else if(Array.isArray(e)&&(n=e.length<3||e.length>4?`Invalid rbga value ${JSON.stringify(e)}: expected an array containing either three or four numeric values.`:me(e[0],e[1],e[2],e[3]),!n))return new ue(e[0]/255,e[1]/255,e[2]/255,e[3])}throw new xe(n||`Could not parse color from value '${"string"==typeof e?e:String(JSON.stringify(e))}'`)}if("number"===this.type.kind){let e=null;for(const n of this.args){if(e=n.evaluate(t),null===e)return 0;const i=Number(e);if(!isNaN(i))return i}throw new xe(`Could not convert ${JSON.stringify(e)} to number.`)}return"formatted"===this.type.kind?pe.fromString(ye(this.args[0].evaluate(t))):"resolvedImage"===this.type.kind?fe.fromString(ye(this.args[0].evaluate(t))):ye(this.args[0].evaluate(t))}eachChild(t){this.args.forEach(t)}outputDefined(){return this.args.every(t=>t.outputDefined())}serialize(){if("formatted"===this.type.kind)return new Ce([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if("resolvedImage"===this.type.kind)return new Te(this.args[0]).serialize();const t=["to-"+this.type.kind];return this.eachChild(e=>{t.push(e.serialize())}),t}}const ke=["Unknown","Point","LineString","Polygon"];class Ae{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null}id(){return this.feature&&"id"in this.feature?this.feature.id:null}geometryType(){return this.feature?"number"==typeof this.feature.type?ke[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}parseColor(t){let e=this._parseColorCache[t];return e||(e=this._parseColorCache[t]=ue.parse(t)),e}}class Ie{constructor(t,e,n,i){this.name=t,this.type=e,this._evaluate=n,this.args=i}evaluate(t){return this._evaluate(t,this.args)}eachChild(t){this.args.forEach(t)}outputDefined(){return!1}serialize(){return[this.name].concat(this.args.map(t=>t.serialize()))}static parse(t,e){const n=t[0],i=Ie.definitions[n];if(!i)return e.error(`Unknown expression "${n}". If you wanted a literal array, use ["literal", [...]].`,0);const r=Array.isArray(i)?i[0]:i.type,o=Array.isArray(i)?[[i[1],i[2]]]:i.overloads,s=o.filter(([e])=>!Array.isArray(e)||e.length===t.length-1);let a=null;for(const[l,c]of s){a=new Je(e.registry,e.path,null,e.scope);const i=[];let o=!1;for(let e=1;e<t.length;e++){const n=t[e],r=Array.isArray(l)?l[e-1]:l.type,s=a.parse(n,1+i.length,r);if(!s){o=!0;break}i.push(s)}if(!o)if(Array.isArray(l)&&l.length!==i.length)a.error(`Expected ${l.length} arguments, but found ${i.length} instead.`);else{for(let t=0;t<i.length;t++){const e=Array.isArray(l)?l[t]:l.type,n=i[t];a.concat(t+1).checkSubtype(e,n.type)}if(0===a.errors.length)return new Ie(n,r,c,i)}}if(1===s.length)e.errors.push(...a.errors);else{const n=(s.length?s:o).map(([t])=>{return e=t,Array.isArray(e)?`(${e.map(ie).join(", ")})`:`(${ie(e.type)}...)`;var e}).join(" | "),i=[];for(let r=1;r<t.length;r++){const n=e.parse(t[r],1+i.length);if(!n)return null;i.push(ie(n.type))}e.error(`Expected arguments of type ${n}, but found (${i.join(", ")}) instead.`)}return null}static register(t,e){Ie.definitions=e;for(const n in e)t[n]=Ie}}class Pe{constructor(t,e,n){this.type=Qt,this.locale=n,this.caseSensitive=t,this.diacriticSensitive=e}static parse(t,e){if(2!==t.length)return e.error("Expected one argument.");const n=t[1];if("object"!=typeof n||Array.isArray(n))return e.error("Collator options argument must be an object.");const i=e.parse(void 0!==n["case-sensitive"]&&n["case-sensitive"],1,Xt);if(!i)return null;const r=e.parse(void 0!==n["diacritic-sensitive"]&&n["diacritic-sensitive"],1,Xt);if(!r)return null;let o=null;return n.locale&&(o=e.parse(n.locale,1,Wt),!o)?null:new Pe(i,r,o)}evaluate(t){return new he(this.caseSensitive.evaluate(t),this.diacriticSensitive.evaluate(t),this.locale?this.locale.evaluate(t):null)}eachChild(t){t(this.caseSensitive),t(this.diacriticSensitive),this.locale&&t(this.locale)}outputDefined(){return!1}serialize(){const t={};return t["case-sensitive"]=this.caseSensitive.serialize(),t["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(t.locale=this.locale.serialize()),["collator",t]}}const Me=8192;function Oe(t,e){t[0]=Math.min(t[0],e[0]),t[1]=Math.min(t[1],e[1]),t[2]=Math.max(t[2],e[0]),t[3]=Math.max(t[3],e[1])}function ze(t,e){return!(t[0]<=e[0]||t[2]>=e[2]||t[1]<=e[1]||t[3]>=e[3])}function De(t,e){const n=(180+t[0])/360,i=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+t[1]*Math.PI/360)))/360,r=Math.pow(2,e.z);return[Math.round(n*r*Me),Math.round(i*r*Me)]}function Le(t,e,n){const i=t[0]-e[0],r=t[1]-e[1],o=t[0]-n[0],s=t[1]-n[1];return i*s-o*r==0&&i*o<=0&&r*s<=0}function Re(t,e){let n=!1;for(let s=0,a=e.length;s<a;s++){const a=e[s];for(let e=0,s=a.length;e<s-1;e++){if(Le(t,a[e],a[e+1]))return!1;(r=a[e])[1]>(i=t)[1]!=(o=a[e+1])[1]>i[1]&&i[0]<(o[0]-r[0])*(i[1]-r[1])/(o[1]-r[1])+r[0]&&(n=!n)}}var i,r,o;return n}function Fe(t,e){for(let n=0;n<e.length;n++)if(Re(t,e[n]))return!0;return!1}function Be(t,e,n,i){const r=i[0]-n[0],o=i[1]-n[1],s=(t[0]-n[0])*o-r*(t[1]-n[1]),a=(e[0]-n[0])*o-r*(e[1]-n[1]);return s>0&&a<0||s<0&&a>0}function Ve(t,e,n){for(const c of n)for(let n=0;n<c.length-1;++n)if(0!=(a=[(s=c[n+1])[0]-(o=c[n])[0],s[1]-o[1]])[0]*(l=[(r=e)[0]-(i=t)[0],r[1]-i[1]])[1]-a[1]*l[0]&&Be(i,r,o,s)&&Be(o,s,i,r))return!0;var i,r,o,s,a,l;return!1}function Ue(t,e){for(let n=0;n<t.length;++n)if(!Re(t[n],e))return!1;for(let n=0;n<t.length-1;++n)if(Ve(t[n],t[n+1],e))return!1;return!0}function Ne(t,e){for(let n=0;n<e.length;n++)if(Ue(t,e[n]))return!0;return!1}function je(t,e,n){const i=[];for(let r=0;r<t.length;r++){const o=[];for(let i=0;i<t[r].length;i++){const s=De(t[r][i],n);Oe(e,s),o.push(s)}i.push(o)}return i}function qe(t,e,n){const i=[];for(let r=0;r<t.length;r++){const o=je(t[r],e,n);i.push(o)}return i}function $e(t,e,n,i){if(t[0]<n[0]||t[0]>n[2]){const e=.5*i;let r=t[0]-n[0]>e?-i:n[0]-t[0]>e?i:0;0===r&&(r=t[0]-n[2]>e?-i:n[2]-t[0]>e?i:0),t[0]+=r}Oe(e,t)}function Ge(t,e,n,i){const r=Math.pow(2,i.z)*Me,o=[i.x*Me,i.y*Me],s=[];for(const a of t)for(const t of a){const i=[t.x+o[0],t.y+o[1]];$e(i,e,n,r),s.push(i)}return s}function Ze(t,e,n,i){const r=Math.pow(2,i.z)*Me,o=[i.x*Me,i.y*Me],s=[];for(const l of t){const t=[];for(const n of l){const i=[n.x+o[0],n.y+o[1]];Oe(e,i),t.push(i)}s.push(t)}if(e[2]-e[0]<=r/2){(a=e)[0]=a[1]=1/0,a[2]=a[3]=-1/0;for(const t of s)for(const i of t)$e(i,e,n,r)}var a;return s}class He{constructor(t,e){this.type=Xt,this.geojson=t,this.geometries=e}static parse(t,e){if(2!==t.length)return e.error(`'within' expression requires exactly one argument, but found ${t.length-1} instead.`);if(ge(t[1])){const e=t[1];if("FeatureCollection"===e.type)for(let t=0;t<e.features.length;++t){const n=e.features[t].geometry.type;if("Polygon"===n||"MultiPolygon"===n)return new He(e,e.features[t].geometry)}else if("Feature"===e.type){const t=e.geometry.type;if("Polygon"===t||"MultiPolygon"===t)return new He(e,e.geometry)}else if("Polygon"===e.type||"MultiPolygon"===e.type)return new He(e,e)}return e.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(t){if(null!=t.geometry()&&null!=t.canonicalID()){if("Point"===t.geometryType())return function(t,e){const n=[1/0,1/0,-1/0,-1/0],i=[1/0,1/0,-1/0,-1/0],r=t.canonicalID();if("Polygon"===e.type){const o=je(e.coordinates,i,r),s=Ge(t.geometry(),n,i,r);if(!ze(n,i))return!1;for(const t of s)if(!Re(t,o))return!1}if("MultiPolygon"===e.type){const o=qe(e.coordinates,i,r),s=Ge(t.geometry(),n,i,r);if(!ze(n,i))return!1;for(const t of s)if(!Fe(t,o))return!1}return!0}(t,this.geometries);if("LineString"===t.geometryType())return function(t,e){const n=[1/0,1/0,-1/0,-1/0],i=[1/0,1/0,-1/0,-1/0],r=t.canonicalID();if("Polygon"===e.type){const o=je(e.coordinates,i,r),s=Ze(t.geometry(),n,i,r);if(!ze(n,i))return!1;for(const t of s)if(!Ue(t,o))return!1}if("MultiPolygon"===e.type){const o=qe(e.coordinates,i,r),s=Ze(t.geometry(),n,i,r);if(!ze(n,i))return!1;for(const t of s)if(!Ne(t,o))return!1}return!0}(t,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}serialize(){return["within",this.geojson]}}function We(t){if(t instanceof Ie){if("get"===t.name&&1===t.args.length)return!1;if("feature-state"===t.name)return!1;if("has"===t.name&&1===t.args.length)return!1;if("properties"===t.name||"geometry-type"===t.name||"id"===t.name)return!1;if(/^filter-/.test(t.name))return!1}if(t instanceof He)return!1;let e=!0;return t.eachChild(t=>{e&&!We(t)&&(e=!1)}),e}function Xe(t){if(t instanceof Ie&&"feature-state"===t.name)return!1;let e=!0;return t.eachChild(t=>{e&&!Xe(t)&&(e=!1)}),e}function Ke(t,e){if(t instanceof Ie&&e.indexOf(t.name)>=0)return!1;let n=!0;return t.eachChild(t=>{n&&!Ke(t,e)&&(n=!1)}),n}class Ye{constructor(t,e){this.type=e.type,this.name=t,this.boundExpression=e}static parse(t,e){if(2!==t.length||"string"!=typeof t[1])return e.error("'var' expression requires exactly one string literal argument.");const n=t[1];return e.scope.has(n)?new Ye(n,e.scope.get(n)):e.error(`Unknown variable "${n}". Make sure "${n}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(t){return this.boundExpression.evaluate(t)}eachChild(){}outputDefined(){return!1}serialize(){return["var",this.name]}}class Je{constructor(t,e=[],n,i=new Gt,r=[]){this.registry=t,this.path=e,this.key=e.map(t=>`[${t}]`).join(""),this.scope=i,this.errors=r,this.expectedType=n}parse(t,e,n,i,r={}){return e?this.concat(e,n,i)._parse(t,r):this._parse(t,r)}_parse(t,e){function n(t,e,n){return"assert"===n?new we(e,[t]):"coerce"===n?new Ee(e,[t]):t}if(null!==t&&"string"!=typeof t&&"boolean"!=typeof t&&"number"!=typeof t||(t=["literal",t]),Array.isArray(t)){if(0===t.length)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const i=t[0];if("string"!=typeof i)return this.error(`Expression name must be a string, but found ${typeof i} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const r=this.registry[i];if(r){let i=r.parse(t,this);if(!i)return null;if(this.expectedType){const t=this.expectedType,r=i.type;if("string"!==t.kind&&"number"!==t.kind&&"boolean"!==t.kind&&"object"!==t.kind&&"array"!==t.kind||"value"!==r.kind)if("color"!==t.kind&&"formatted"!==t.kind&&"resolvedImage"!==t.kind||"value"!==r.kind&&"string"!==r.kind){if(this.checkSubtype(t,r))return null}else i=n(i,t,e.typeAnnotation||"coerce");else i=n(i,t,e.typeAnnotation||"assert")}if(!(i instanceof ve)&&"resolvedImage"!==i.type.kind&&Qe(i)){const e=new Ae;try{i=new ve(i.type,i.evaluate(e))}catch(t){return this.error(t.message),null}}return i}return this.error(`Unknown expression "${i}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(void 0===t?"'undefined' value invalid. Use null instead.":"object"==typeof t?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof t} instead.`)}concat(t,e,n){const i="number"==typeof t?this.path.concat(t):this.path,r=n?this.scope.concat(n):this.scope;return new Je(this.registry,i,e||null,r,this.errors)}error(t,...e){const n=`${this.key}${e.map(t=>`[${t}]`).join("")}`;this.errors.push(new $t(n,t))}checkSubtype(t,e){const n=oe(t,e);return n&&this.error(n),n}}function Qe(t){if(t instanceof Ye)return Qe(t.boundExpression);if(t instanceof Ie&&"error"===t.name)return!1;if(t instanceof Pe)return!1;if(t instanceof He)return!1;const e=t instanceof Ee||t instanceof we;let n=!0;return t.eachChild(t=>{n=e?n&&Qe(t):n&&t instanceof ve}),!!n&&We(t)&&Ke(t,["zoom","heatmap-density","line-progress","sky-radial-progress","accumulated","is-supported-script"])}function tn(t,e){const n=t.length-1;let i,r,o=0,s=n,a=0;for(;o<=s;)if(a=Math.floor((o+s)/2),i=t[a],r=t[a+1],i<=e){if(a===n||e<r)return a;o=a+1}else{if(!(i>e))throw new xe("Input is not a number.");s=a-1}return 0}class en{constructor(t,e,n){this.type=t,this.input=e,this.labels=[],this.outputs=[];for(const[i,r]of n)this.labels.push(i),this.outputs.push(r)}static parse(t,e){if(t.length-1<4)return e.error(`Expected at least 4 arguments, but found only ${t.length-1}.`);if((t.length-1)%2!=0)return e.error("Expected an even number of arguments.");const n=e.parse(t[1],1,Ht);if(!n)return null;const i=[];let r=null;e.expectedType&&"value"!==e.expectedType.kind&&(r=e.expectedType);for(let o=1;o<t.length;o+=2){const n=1===o?-1/0:t[o],s=t[o+1],a=o,l=o+1;if("number"!=typeof n)return e.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',a);if(i.length&&i[i.length-1][0]>=n)return e.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',a);const c=e.parse(s,l,r);if(!c)return null;r=r||c.type,i.push([n,c])}return new en(r,n,i)}evaluate(t){const e=this.labels,n=this.outputs;if(1===e.length)return n[0].evaluate(t);const i=this.input.evaluate(t);if(i<=e[0])return n[0].evaluate(t);const r=e.length;return i>=e[r-1]?n[r-1].evaluate(t):n[tn(e,i)].evaluate(t)}eachChild(t){t(this.input);for(const e of this.outputs)t(e)}outputDefined(){return this.outputs.every(t=>t.outputDefined())}serialize(){const t=["step",this.input.serialize()];for(let e=0;e<this.labels.length;e++)e>0&&t.push(this.labels[e]),t.push(this.outputs[e].serialize());return t}}function nn(t,e,n){return t*(1-n)+e*n}var rn=Object.freeze({__proto__:null,number:nn,color:function(t,e,n){return new ue(nn(t.r,e.r,n),nn(t.g,e.g,n),nn(t.b,e.b,n),nn(t.a,e.a,n))},array:function(t,e,n){return t.map((t,i)=>nn(t,e[i],n))}});const on=4/29,sn=6/29,an=3*sn*sn,ln=Math.PI/180,cn=180/Math.PI;function un(t){return t>.008856451679035631?Math.pow(t,1/3):t/an+on}function hn(t){return t>sn?t*t*t:an*(t-on)}function dn(t){return 255*(t<=.0031308?12.92*t:1.055*Math.pow(t,1/2.4)-.055)}function pn(t){return(t/=255)<=.04045?t/12.92:Math.pow((t+.055)/1.055,2.4)}function fn(t){const e=pn(t.r),n=pn(t.g),i=pn(t.b),r=un((.4124564*e+.3575761*n+.1804375*i)/.95047),o=un((.2126729*e+.7151522*n+.072175*i)/1);return{l:116*o-16,a:500*(r-o),b:200*(o-un((.0193339*e+.119192*n+.9503041*i)/1.08883)),alpha:t.a}}function mn(t){let e=(t.l+16)/116,n=isNaN(t.a)?e:e+t.a/500,i=isNaN(t.b)?e:e-t.b/200;return e=1*hn(e),n=.95047*hn(n),i=1.08883*hn(i),new ue(dn(3.2404542*n-1.5371385*e-.4985314*i),dn(-.969266*n+1.8760108*e+.041556*i),dn(.0556434*n-.2040259*e+1.0572252*i),t.alpha)}function gn(t,e,n){const i=e-t;return t+n*(i>180||i<-180?i-360*Math.round(i/360):i)}const _n={forward:fn,reverse:mn,interpolate:function(t,e,n){return{l:nn(t.l,e.l,n),a:nn(t.a,e.a,n),b:nn(t.b,e.b,n),alpha:nn(t.alpha,e.alpha,n)}}},yn={forward:function(t){const{l:e,a:n,b:i}=fn(t),r=Math.atan2(i,n)*cn;return{h:r<0?r+360:r,c:Math.sqrt(n*n+i*i),l:e,alpha:t.a}},reverse:function(t){const e=t.h*ln,n=t.c;return mn({l:t.l,a:Math.cos(e)*n,b:Math.sin(e)*n,alpha:t.alpha})},interpolate:function(t,e,n){return{h:gn(t.h,e.h,n),c:nn(t.c,e.c,n),l:nn(t.l,e.l,n),alpha:nn(t.alpha,e.alpha,n)}}};var vn=Object.freeze({__proto__:null,lab:_n,hcl:yn});class xn{constructor(t,e,n,i,r){this.type=t,this.operator=e,this.interpolation=n,this.input=i,this.labels=[],this.outputs=[];for(const[o,s]of r)this.labels.push(o),this.outputs.push(s)}static interpolationFactor(t,e,i,r){let o=0;if("exponential"===t.name)o=bn(e,t.base,i,r);else if("linear"===t.name)o=bn(e,1,i,r);else if("cubic-bezier"===t.name){const s=t.controlPoints;o=new n(s[0],s[1],s[2],s[3]).solve(bn(e,1,i,r))}return o}static parse(t,e){let[n,i,r,...o]=t;if(!Array.isArray(i)||0===i.length)return e.error("Expected an interpolation type expression.",1);if("linear"===i[0])i={name:"linear"};else if("exponential"===i[0]){const t=i[1];if("number"!=typeof t)return e.error("Exponential interpolation requires a numeric base.",1,1);i={name:"exponential",base:t}}else{if("cubic-bezier"!==i[0])return e.error("Unknown interpolation type "+String(i[0]),1,0);{const t=i.slice(1);if(4!==t.length||t.some(t=>"number"!=typeof t||t<0||t>1))return e.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);i={name:"cubic-bezier",controlPoints:t}}}if(t.length-1<4)return e.error(`Expected at least 4 arguments, but found only ${t.length-1}.`);if((t.length-1)%2!=0)return e.error("Expected an even number of arguments.");if(r=e.parse(r,2,Ht),!r)return null;const s=[];let a=null;"interpolate-hcl"===n||"interpolate-lab"===n?a=Kt:e.expectedType&&"value"!==e.expectedType.kind&&(a=e.expectedType);for(let l=0;l<o.length;l+=2){const t=o[l],n=o[l+1],i=l+3,r=l+4;if("number"!=typeof t)return e.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',i);if(s.length&&s[s.length-1][0]>=t)return e.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',i);const c=e.parse(n,r,a);if(!c)return null;a=a||c.type,s.push([t,c])}return"number"===a.kind||"color"===a.kind||"array"===a.kind&&"number"===a.itemType.kind&&"number"==typeof a.N?new xn(a,n,i,r,s):e.error(`Type ${ie(a)} is not interpolatable.`)}evaluate(t){const e=this.labels,n=this.outputs;if(1===e.length)return n[0].evaluate(t);const i=this.input.evaluate(t);if(i<=e[0])return n[0].evaluate(t);const r=e.length;if(i>=e[r-1])return n[r-1].evaluate(t);const o=tn(e,i),s=xn.interpolationFactor(this.interpolation,i,e[o],e[o+1]),a=n[o].evaluate(t),l=n[o+1].evaluate(t);return"interpolate"===this.operator?rn[this.type.kind.toLowerCase()](a,l,s):"interpolate-hcl"===this.operator?yn.reverse(yn.interpolate(yn.forward(a),yn.forward(l),s)):_n.reverse(_n.interpolate(_n.forward(a),_n.forward(l),s))}eachChild(t){t(this.input);for(const e of this.outputs)t(e)}outputDefined(){return this.outputs.every(t=>t.outputDefined())}serialize(){let t;t="linear"===this.interpolation.name?["linear"]:"exponential"===this.interpolation.name?1===this.interpolation.base?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier"].concat(this.interpolation.controlPoints);const e=[this.operator,t,this.input.serialize()];for(let n=0;n<this.labels.length;n++)e.push(this.labels[n],this.outputs[n].serialize());return e}}function bn(t,e,n,i){const r=i-n,o=t-n;return 0===r?0:1===e?o/r:(Math.pow(e,o)-1)/(Math.pow(e,r)-1)}class wn{constructor(t,e){this.type=t,this.args=e}static parse(t,e){if(t.length<2)return e.error("Expectected at least one argument.");let n=null;const i=e.expectedType;i&&"value"!==i.kind&&(n=i);const r=[];for(const s of t.slice(1)){const t=e.parse(s,1+r.length,n,void 0,{typeAnnotation:"omit"});if(!t)return null;n=n||t.type,r.push(t)}const o=i&&r.some(t=>oe(i,t.type));return new wn(o?Jt:n,r)}evaluate(t){let e,n=null,i=0;for(const r of this.args)if(i++,n=r.evaluate(t),n&&n instanceof fe&&!n.available&&(e||(e=n.name),n=null,i===this.args.length&&(n=e)),null!==n)break;return n}eachChild(t){this.args.forEach(t)}outputDefined(){return this.args.every(t=>t.outputDefined())}serialize(){const t=["coalesce"];return this.eachChild(e=>{t.push(e.serialize())}),t}}class Cn{constructor(t,e){this.type=e.type,this.bindings=[].concat(t),this.result=e}evaluate(t){return this.result.evaluate(t)}eachChild(t){for(const e of this.bindings)t(e[1]);t(this.result)}static parse(t,e){if(t.length<4)return e.error(`Expected at least 3 arguments, but found ${t.length-1} instead.`);const n=[];for(let r=1;r<t.length-1;r+=2){const i=t[r];if("string"!=typeof i)return e.error(`Expected string, but found ${typeof i} instead.`,r);if(/[^a-zA-Z0-9_]/.test(i))return e.error("Variable names must contain only alphanumeric characters or '_'.",r);const o=e.parse(t[r+1],r+1);if(!o)return null;n.push([i,o])}const i=e.parse(t[t.length-1],t.length-1,e.expectedType,n);return i?new Cn(n,i):null}outputDefined(){return this.result.outputDefined()}serialize(){const t=["let"];for(const[e,n]of this.bindings)t.push(e,n.serialize());return t.push(this.result.serialize()),t}}class Tn{constructor(t,e,n){this.type=t,this.index=e,this.input=n}static parse(t,e){if(3!==t.length)return e.error(`Expected 2 arguments, but found ${t.length-1} instead.`);const n=e.parse(t[1],1,Ht),i=e.parse(t[2],2,ne(e.expectedType||Jt));return n&&i?new Tn(i.type.itemType,n,i):null}evaluate(t){const e=this.index.evaluate(t),n=this.input.evaluate(t);if(e<0)throw new xe(`Array index out of bounds: ${e} < 0.`);if(e>=n.length)throw new xe(`Array index out of bounds: ${e} > ${n.length-1}.`);if(e!==Math.floor(e))throw new xe(`Array index must be an integer, but found ${e} instead.`);return n[e]}eachChild(t){t(this.index),t(this.input)}outputDefined(){return!1}serialize(){return["at",this.index.serialize(),this.input.serialize()]}}class Sn{constructor(t,e){this.type=Xt,this.needle=t,this.haystack=e}static parse(t,e){if(3!==t.length)return e.error(`Expected 2 arguments, but found ${t.length-1} instead.`);const n=e.parse(t[1],1,Jt),i=e.parse(t[2],2,Jt);return n&&i?se(n.type,[Xt,Wt,Ht,Zt,Jt])?new Sn(n,i):e.error(`Expected first argument to be of type boolean, string, number or null, but found ${ie(n.type)} instead`):null}evaluate(t){const e=this.needle.evaluate(t),n=this.haystack.evaluate(t);if(!n)return!1;if(!ae(e,["boolean","string","number","null"]))throw new xe(`Expected first argument to be of type boolean, string, number or null, but found ${ie(_e(e))} instead.`);if(!ae(n,["string","array"]))throw new xe(`Expected second argument to be of type array or string, but found ${ie(_e(n))} instead.`);return n.indexOf(e)>=0}eachChild(t){t(this.needle),t(this.haystack)}outputDefined(){return!0}serialize(){return["in",this.needle.serialize(),this.haystack.serialize()]}}class En{constructor(t,e,n){this.type=Ht,this.needle=t,this.haystack=e,this.fromIndex=n}static parse(t,e){if(t.length<=2||t.length>=5)return e.error(`Expected 3 or 4 arguments, but found ${t.length-1} instead.`);const n=e.parse(t[1],1,Jt),i=e.parse(t[2],2,Jt);if(!n||!i)return null;if(!se(n.type,[Xt,Wt,Ht,Zt,Jt]))return e.error(`Expected first argument to be of type boolean, string, number or null, but found ${ie(n.type)} instead`);if(4===t.length){const r=e.parse(t[3],3,Ht);return r?new En(n,i,r):null}return new En(n,i)}evaluate(t){const e=this.needle.evaluate(t),n=this.haystack.evaluate(t);if(!ae(e,["boolean","string","number","null"]))throw new xe(`Expected first argument to be of type boolean, string, number or null, but found ${ie(_e(e))} instead.`);if(!ae(n,["string","array"]))throw new xe(`Expected second argument to be of type array or string, but found ${ie(_e(n))} instead.`);if(this.fromIndex){const i=this.fromIndex.evaluate(t);return n.indexOf(e,i)}return n.indexOf(e)}eachChild(t){t(this.needle),t(this.haystack),this.fromIndex&&t(this.fromIndex)}outputDefined(){return!1}serialize(){if(null!=this.fromIndex&&void 0!==this.fromIndex){const t=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),t]}return["index-of",this.needle.serialize(),this.haystack.serialize()]}}class kn{constructor(t,e,n,i,r,o){this.inputType=t,this.type=e,this.input=n,this.cases=i,this.outputs=r,this.otherwise=o}static parse(t,e){if(t.length<5)return e.error(`Expected at least 4 arguments, but found only ${t.length-1}.`);if(t.length%2!=1)return e.error("Expected an even number of arguments.");let n,i;e.expectedType&&"value"!==e.expectedType.kind&&(i=e.expectedType);const r={},o=[];for(let l=2;l<t.length-1;l+=2){let s=t[l];const a=t[l+1];Array.isArray(s)||(s=[s]);const c=e.concat(l);if(0===s.length)return c.error("Expected at least one branch label.");for(const t of s){if("number"!=typeof t&&"string"!=typeof t)return c.error("Branch labels must be numbers or strings.");if("number"==typeof t&&Math.abs(t)>Number.MAX_SAFE_INTEGER)return c.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if("number"==typeof t&&Math.floor(t)!==t)return c.error("Numeric branch labels must be integer values.");if(n){if(c.checkSubtype(n,_e(t)))return null}else n=_e(t);if(void 0!==r[String(t)])return c.error("Branch labels must be unique.");r[String(t)]=o.length}const u=e.parse(a,l,i);if(!u)return null;i=i||u.type,o.push(u)}const s=e.parse(t[1],1,Jt);if(!s)return null;const a=e.parse(t[t.length-1],t.length-1,i);return a?"value"!==s.type.kind&&e.concat(1).checkSubtype(n,s.type)?null:new kn(n,i,s,r,o,a):null}evaluate(t){const e=this.input.evaluate(t);return(_e(e)===this.inputType&&this.outputs[this.cases[e]]||this.otherwise).evaluate(t)}eachChild(t){t(this.input),this.outputs.forEach(t),t(this.otherwise)}outputDefined(){return this.outputs.every(t=>t.outputDefined())&&this.otherwise.outputDefined()}serialize(){const t=["match",this.input.serialize()],e=Object.keys(this.cases).sort(),n=[],i={};for(const o of e){const t=i[this.cases[o]];void 0===t?(i[this.cases[o]]=n.length,n.push([this.cases[o],[o]])):n[t][1].push(o)}const r=t=>"number"===this.inputType.kind?Number(t):t;for(const[o,s]of n)t.push(1===s.length?r(s[0]):s.map(r)),t.push(this.outputs[o].serialize());return t.push(this.otherwise.serialize()),t}}class An{constructor(t,e,n){this.type=t,this.branches=e,this.otherwise=n}static parse(t,e){if(t.length<4)return e.error(`Expected at least 3 arguments, but found only ${t.length-1}.`);if(t.length%2!=0)return e.error("Expected an odd number of arguments.");let n;e.expectedType&&"value"!==e.expectedType.kind&&(n=e.expectedType);const i=[];for(let o=1;o<t.length-1;o+=2){const r=e.parse(t[o],o,Xt);if(!r)return null;const s=e.parse(t[o+1],o+1,n);if(!s)return null;i.push([r,s]),n=n||s.type}const r=e.parse(t[t.length-1],t.length-1,n);return r?new An(n,i,r):null}evaluate(t){for(const[e,n]of this.branches)if(e.evaluate(t))return n.evaluate(t);return this.otherwise.evaluate(t)}eachChild(t){for(const[e,n]of this.branches)t(e),t(n);t(this.otherwise)}outputDefined(){return this.branches.every(([t,e])=>e.outputDefined())&&this.otherwise.outputDefined()}serialize(){const t=["case"];return this.eachChild(e=>{t.push(e.serialize())}),t}}class In{constructor(t,e,n,i){this.type=t,this.input=e,this.beginIndex=n,this.endIndex=i}static parse(t,e){if(t.length<=2||t.length>=5)return e.error(`Expected 3 or 4 arguments, but found ${t.length-1} instead.`);const n=e.parse(t[1],1,Jt),i=e.parse(t[2],2,Ht);if(!n||!i)return null;if(!se(n.type,[ne(Jt),Wt,Jt]))return e.error(`Expected first argument to be of type array or string, but found ${ie(n.type)} instead`);if(4===t.length){const r=e.parse(t[3],3,Ht);return r?new In(n.type,n,i,r):null}return new In(n.type,n,i)}evaluate(t){const e=this.input.evaluate(t),n=this.beginIndex.evaluate(t);if(!ae(e,["string","array"]))throw new xe(`Expected first argument to be of type array or string, but found ${ie(_e(e))} instead.`);if(this.endIndex){const i=this.endIndex.evaluate(t);return e.slice(n,i)}return e.slice(n)}eachChild(t){t(this.input),t(this.beginIndex),this.endIndex&&t(this.endIndex)}outputDefined(){return!1}serialize(){if(null!=this.endIndex&&void 0!==this.endIndex){const t=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),t]}return["slice",this.input.serialize(),this.beginIndex.serialize()]}}function Pn(t,e){return"=="===t||"!="===t?"boolean"===e.kind||"string"===e.kind||"number"===e.kind||"null"===e.kind||"value"===e.kind:"string"===e.kind||"number"===e.kind||"value"===e.kind}function Mn(t,e,n,i){return 0===i.compare(e,n)}function On(t,e,n){const i="=="!==t&&"!="!==t;return class r{constructor(t,e,n){this.type=Xt,this.lhs=t,this.rhs=e,this.collator=n,this.hasUntypedArgument="value"===t.type.kind||"value"===e.type.kind}static parse(t,e){if(3!==t.length&&4!==t.length)return e.error("Expected two or three arguments.");const n=t[0];let o=e.parse(t[1],1,Jt);if(!o)return null;if(!Pn(n,o.type))return e.concat(1).error(`"${n}" comparisons are not supported for type '${ie(o.type)}'.`);let s=e.parse(t[2],2,Jt);if(!s)return null;if(!Pn(n,s.type))return e.concat(2).error(`"${n}" comparisons are not supported for type '${ie(s.type)}'.`);if(o.type.kind!==s.type.kind&&"value"!==o.type.kind&&"value"!==s.type.kind)return e.error(`Cannot compare types '${ie(o.type)}' and '${ie(s.type)}'.`);i&&("value"===o.type.kind&&"value"!==s.type.kind?o=new we(s.type,[o]):"value"!==o.type.kind&&"value"===s.type.kind&&(s=new we(o.type,[s])));let a=null;if(4===t.length){if("string"!==o.type.kind&&"string"!==s.type.kind&&"value"!==o.type.kind&&"value"!==s.type.kind)return e.error("Cannot use collator to compare non-string types.");if(a=e.parse(t[3],3,Qt),!a)return null}return new r(o,s,a)}evaluate(r){const o=this.lhs.evaluate(r),s=this.rhs.evaluate(r);if(i&&this.hasUntypedArgument){const e=_e(o),n=_e(s);if(e.kind!==n.kind||"string"!==e.kind&&"number"!==e.kind)throw new xe(`Expected arguments for "${t}" to be (string, string) or (number, number), but found (${e.kind}, ${n.kind}) instead.`)}if(this.collator&&!i&&this.hasUntypedArgument){const t=_e(o),n=_e(s);if("string"!==t.kind||"string"!==n.kind)return e(r,o,s)}return this.collator?n(r,o,s,this.collator.evaluate(r)):e(r,o,s)}eachChild(t){t(this.lhs),t(this.rhs),this.collator&&t(this.collator)}outputDefined(){return!0}serialize(){const e=[t];return this.eachChild(t=>{e.push(t.serialize())}),e}}}const zn=On("==",function(t,e,n){return e===n},Mn),Dn=On("!=",function(t,e,n){return e!==n},function(t,e,n,i){return!Mn(0,e,n,i)}),Ln=On("<",function(t,e,n){return e<n},function(t,e,n,i){return i.compare(e,n)<0}),Rn=On(">",function(t,e,n){return e>n},function(t,e,n,i){return i.compare(e,n)>0}),Fn=On("<=",function(t,e,n){return e<=n},function(t,e,n,i){return i.compare(e,n)<=0}),Bn=On(">=",function(t,e,n){return e>=n},function(t,e,n,i){return i.compare(e,n)>=0});class Vn{constructor(t,e,n,i,r){this.type=Wt,this.number=t,this.locale=e,this.currency=n,this.minFractionDigits=i,this.maxFractionDigits=r}static parse(t,e){if(3!==t.length)return e.error("Expected two arguments.");const n=e.parse(t[1],1,Ht);if(!n)return null;const i=t[2];if("object"!=typeof i||Array.isArray(i))return e.error("NumberFormat options argument must be an object.");let r=null;if(i.locale&&(r=e.parse(i.locale,1,Wt),!r))return null;let o=null;if(i.currency&&(o=e.parse(i.currency,1,Wt),!o))return null;let s=null;if(i["min-fraction-digits"]&&(s=e.parse(i["min-fraction-digits"],1,Ht),!s))return null;let a=null;return i["max-fraction-digits"]&&(a=e.parse(i["max-fraction-digits"],1,Ht),!a)?null:new Vn(n,r,o,s,a)}evaluate(t){return new Intl.NumberFormat(this.locale?this.locale.evaluate(t):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(t):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(t):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(t):void 0}).format(this.number.evaluate(t))}eachChild(t){t(this.number),this.locale&&t(this.locale),this.currency&&t(this.currency),this.minFractionDigits&&t(this.minFractionDigits),this.maxFractionDigits&&t(this.maxFractionDigits)}outputDefined(){return!1}serialize(){const t={};return this.locale&&(t.locale=this.locale.serialize()),this.currency&&(t.currency=this.currency.serialize()),this.minFractionDigits&&(t["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(t["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),t]}}class Un{constructor(t){this.type=Ht,this.input=t}static parse(t,e){if(2!==t.length)return e.error(`Expected 1 argument, but found ${t.length-1} instead.`);const n=e.parse(t[1],1);return n?"array"!==n.type.kind&&"string"!==n.type.kind&&"value"!==n.type.kind?e.error(`Expected argument of type string or array, but found ${ie(n.type)} instead.`):new Un(n):null}evaluate(t){const e=this.input.evaluate(t);if("string"==typeof e)return e.length;if(Array.isArray(e))return e.length;throw new xe(`Expected value to be of type string or array, but found ${ie(_e(e))} instead.`)}eachChild(t){t(this.input)}outputDefined(){return!1}serialize(){const t=["length"];return this.eachChild(e=>{t.push(e.serialize())}),t}}const Nn={"==":zn,"!=":Dn,">":Rn,"<":Ln,">=":Bn,"<=":Fn,array:we,at:Tn,boolean:we,case:An,coalesce:wn,collator:Pe,format:Ce,image:Te,in:Sn,"index-of":En,interpolate:xn,"interpolate-hcl":xn,"interpolate-lab":xn,length:Un,let:Cn,literal:ve,match:kn,number:we,"number-format":Vn,object:we,slice:In,step:en,string:we,"to-boolean":Ee,"to-color":Ee,"to-number":Ee,"to-string":Ee,var:Ye,within:He};function jn(t,[e,n,i,r]){e=e.evaluate(t),n=n.evaluate(t),i=i.evaluate(t);const o=r?r.evaluate(t):1,s=me(e,n,i,o);if(s)throw new xe(s);return new ue(e/255*o,n/255*o,i/255*o,o)}function qn(t,e){return t in e}function $n(t,e){const n=e[t];return void 0===n?null:n}function Gn(t){return{type:t}}function Zn(t){return{result:"success",value:t}}function Hn(t){return{result:"error",value:t}}function Wn(t){return"data-driven"===t["property-type"]||"cross-faded-data-driven"===t["property-type"]}function Xn(t){return!!t.expression&&t.expression.parameters.indexOf("zoom")>-1}function Kn(t){return!!t.expression&&t.expression.interpolated}function Yn(t){return t instanceof Number?"number":t instanceof String?"string":t instanceof Boolean?"boolean":Array.isArray(t)?"array":null===t?"null":typeof t}function Jn(t){return"object"==typeof t&&null!==t&&!Array.isArray(t)}function Qn(t){return t}function ti(t,e){const n="color"===e.type,i=t.stops&&"object"==typeof t.stops[0][0],r=i||!(i||void 0!==t.property),o=t.type||(Kn(e)?"exponential":"interval");if(n&&((t=Nt({},t)).stops&&(t.stops=t.stops.map(t=>[t[0],ue.parse(t[1])])),t.default=ue.parse(t.default?t.default:e.default)),t.colorSpace&&"rgb"!==t.colorSpace&&!vn[t.colorSpace])throw new Error("Unknown color space: "+t.colorSpace);let s,a,l;if("exponential"===o)s=ri;else if("interval"===o)s=ii;else if("categorical"===o){s=ni,a=Object.create(null);for(const e of t.stops)a[e[0]]=e[1];l=typeof t.stops[0][0]}else{if("identity"!==o)throw new Error(`Unknown function type "${o}"`);s=oi}if(i){const n={},i=[];for(let e=0;e<t.stops.length;e++){const r=t.stops[e],o=r[0].zoom;void 0===n[o]&&(n[o]={zoom:o,type:t.type,property:t.property,default:t.default,stops:[]},i.push(o)),n[o].stops.push([r[0].value,r[1]])}const r=[];for(const t of i)r.push([n[t].zoom,ti(n[t],e)]);const o={name:"linear"};return{kind:"composite",interpolationType:o,interpolationFactor:xn.interpolationFactor.bind(void 0,o),zoomStops:r.map(t=>t[0]),evaluate:({zoom:n},i)=>ri({stops:r,base:t.base},e,n).evaluate(n,i)}}if(r){const n="exponential"===o?{name:"exponential",base:void 0!==t.base?t.base:1}:null;return{kind:"camera",interpolationType:n,interpolationFactor:xn.interpolationFactor.bind(void 0,n),zoomStops:t.stops.map(t=>t[0]),evaluate:({zoom:n})=>s(t,e,n,a,l)}}return{kind:"source",evaluate(n,i){const r=i&&i.properties?i.properties[t.property]:void 0;return void 0===r?ei(t.default,e.default):s(t,e,r,a,l)}}}function ei(t,e,n){return void 0!==t?t:void 0!==e?e:void 0!==n?n:void 0}function ni(t,e,n,i,r){return ei(typeof n===r?i[n]:void 0,t.default,e.default)}function ii(t,e,n){if("number"!==Yn(n))return ei(t.default,e.default);const i=t.stops.length;if(1===i)return t.stops[0][1];if(n<=t.stops[0][0])return t.stops[0][1];if(n>=t.stops[i-1][0])return t.stops[i-1][1];const r=tn(t.stops.map(t=>t[0]),n);return t.stops[r][1]}function ri(t,e,n){const i=void 0!==t.base?t.base:1;if("number"!==Yn(n))return ei(t.default,e.default);const r=t.stops.length;if(1===r)return t.stops[0][1];if(n<=t.stops[0][0])return t.stops[0][1];if(n>=t.stops[r-1][0])return t.stops[r-1][1];const o=tn(t.stops.map(t=>t[0]),n),s=function(t,e,n,i){const r=i-n,o=t-n;return 0===r?0:1===e?o/r:(Math.pow(e,o)-1)/(Math.pow(e,r)-1)}(n,i,t.stops[o][0],t.stops[o+1][0]),a=t.stops[o][1],l=t.stops[o+1][1];let c=rn[e.type]||Qn;if(t.colorSpace&&"rgb"!==t.colorSpace){const e=vn[t.colorSpace];c=(t,n)=>e.reverse(e.interpolate(e.forward(t),e.forward(n),s))}return"function"==typeof a.evaluate?{evaluate(...t){const e=a.evaluate.apply(void 0,t),n=l.evaluate.apply(void 0,t);if(void 0!==e&&void 0!==n)return c(e,n,s)}}:c(a,l,s)}function oi(t,e,n){return"color"===e.type?n=ue.parse(n):"formatted"===e.type?n=pe.fromString(n.toString()):"resolvedImage"===e.type?n=fe.fromString(n.toString()):Yn(n)===e.type||"enum"===e.type&&e.values[n]||(n=void 0),ei(n,t.default,e.default)}Ie.register(Nn,{error:[{kind:"error"},[Wt],(t,[e])=>{throw new xe(e.evaluate(t))}],typeof:[Wt,[Jt],(t,[e])=>ie(_e(e.evaluate(t)))],"to-rgba":[ne(Ht,4),[Kt],(t,[e])=>e.evaluate(t).toArray()],rgb:[Kt,[Ht,Ht,Ht],jn],rgba:[Kt,[Ht,Ht,Ht,Ht],jn],has:{type:Xt,overloads:[[[Wt],(t,[e])=>qn(e.evaluate(t),t.properties())],[[Wt,Yt],(t,[e,n])=>qn(e.evaluate(t),n.evaluate(t))]]},get:{type:Jt,overloads:[[[Wt],(t,[e])=>$n(e.evaluate(t),t.properties())],[[Wt,Yt],(t,[e,n])=>$n(e.evaluate(t),n.evaluate(t))]]},"feature-state":[Jt,[Wt],(t,[e])=>$n(e.evaluate(t),t.featureState||{})],properties:[Yt,[],t=>t.properties()],"geometry-type":[Wt,[],t=>t.geometryType()],id:[Jt,[],t=>t.id()],zoom:[Ht,[],t=>t.globals.zoom],"heatmap-density":[Ht,[],t=>t.globals.heatmapDensity||0],"line-progress":[Ht,[],t=>t.globals.lineProgress||0],"sky-radial-progress":[Ht,[],t=>t.globals.skyRadialProgress||0],accumulated:[Jt,[],t=>void 0===t.globals.accumulated?null:t.globals.accumulated],"+":[Ht,Gn(Ht),(t,e)=>{let n=0;for(const i of e)n+=i.evaluate(t);return n}],"*":[Ht,Gn(Ht),(t,e)=>{let n=1;for(const i of e)n*=i.evaluate(t);return n}],"-":{type:Ht,overloads:[[[Ht,Ht],(t,[e,n])=>e.evaluate(t)-n.evaluate(t)],[[Ht],(t,[e])=>-e.evaluate(t)]]},"/":[Ht,[Ht,Ht],(t,[e,n])=>e.evaluate(t)/n.evaluate(t)],"%":[Ht,[Ht,Ht],(t,[e,n])=>e.evaluate(t)%n.evaluate(t)],ln2:[Ht,[],()=>Math.LN2],pi:[Ht,[],()=>Math.PI],e:[Ht,[],()=>Math.E],"^":[Ht,[Ht,Ht],(t,[e,n])=>Math.pow(e.evaluate(t),n.evaluate(t))],sqrt:[Ht,[Ht],(t,[e])=>Math.sqrt(e.evaluate(t))],log10:[Ht,[Ht],(t,[e])=>Math.log(e.evaluate(t))/Math.LN10],ln:[Ht,[Ht],(t,[e])=>Math.log(e.evaluate(t))],log2:[Ht,[Ht],(t,[e])=>Math.log(e.evaluate(t))/Math.LN2],sin:[Ht,[Ht],(t,[e])=>Math.sin(e.evaluate(t))],cos:[Ht,[Ht],(t,[e])=>Math.cos(e.evaluate(t))],tan:[Ht,[Ht],(t,[e])=>Math.tan(e.evaluate(t))],asin:[Ht,[Ht],(t,[e])=>Math.asin(e.evaluate(t))],acos:[Ht,[Ht],(t,[e])=>Math.acos(e.evaluate(t))],atan:[Ht,[Ht],(t,[e])=>Math.atan(e.evaluate(t))],min:[Ht,Gn(Ht),(t,e)=>Math.min(...e.map(e=>e.evaluate(t)))],max:[Ht,Gn(Ht),(t,e)=>Math.max(...e.map(e=>e.evaluate(t)))],abs:[Ht,[Ht],(t,[e])=>Math.abs(e.evaluate(t))],round:[Ht,[Ht],(t,[e])=>{const n=e.evaluate(t);return n<0?-Math.round(-n):Math.round(n)}],floor:[Ht,[Ht],(t,[e])=>Math.floor(e.evaluate(t))],ceil:[Ht,[Ht],(t,[e])=>Math.ceil(e.evaluate(t))],"filter-==":[Xt,[Wt,Jt],(t,[e,n])=>t.properties()[e.value]===n.value],"filter-id-==":[Xt,[Jt],(t,[e])=>t.id()===e.value],"filter-type-==":[Xt,[Wt],(t,[e])=>t.geometryType()===e.value],"filter-<":[Xt,[Wt,Jt],(t,[e,n])=>{const i=t.properties()[e.value],r=n.value;return typeof i==typeof r&&i<r}],"filter-id-<":[Xt,[Jt],(t,[e])=>{const n=t.id(),i=e.value;return typeof n==typeof i&&n<i}],"filter->":[Xt,[Wt,Jt],(t,[e,n])=>{const i=t.properties()[e.value],r=n.value;return typeof i==typeof r&&i>r}],"filter-id->":[Xt,[Jt],(t,[e])=>{const n=t.id(),i=e.value;return typeof n==typeof i&&n>i}],"filter-<=":[Xt,[Wt,Jt],(t,[e,n])=>{const i=t.properties()[e.value],r=n.value;return typeof i==typeof r&&i<=r}],"filter-id-<=":[Xt,[Jt],(t,[e])=>{const n=t.id(),i=e.value;return typeof n==typeof i&&n<=i}],"filter->=":[Xt,[Wt,Jt],(t,[e,n])=>{const i=t.properties()[e.value],r=n.value;return typeof i==typeof r&&i>=r}],"filter-id->=":[Xt,[Jt],(t,[e])=>{const n=t.id(),i=e.value;return typeof n==typeof i&&n>=i}],"filter-has":[Xt,[Jt],(t,[e])=>e.value in t.properties()],"filter-has-id":[Xt,[],t=>null!==t.id()&&void 0!==t.id()],"filter-type-in":[Xt,[ne(Wt)],(t,[e])=>e.value.indexOf(t.geometryType())>=0],"filter-id-in":[Xt,[ne(Jt)],(t,[e])=>e.value.indexOf(t.id())>=0],"filter-in-small":[Xt,[Wt,ne(Jt)],(t,[e,n])=>n.value.indexOf(t.properties()[e.value])>=0],"filter-in-large":[Xt,[Wt,ne(Jt)],(t,[e,n])=>function(t,e,n,i){for(;n<=i;){const r=n+i>>1;if(e[r]===t)return!0;e[r]>t?i=r-1:n=r+1}return!1}(t.properties()[e.value],n.value,0,n.value.length-1)],all:{type:Xt,overloads:[[[Xt,Xt],(t,[e,n])=>e.evaluate(t)&&n.evaluate(t)],[Gn(Xt),(t,e)=>{for(const n of e)if(!n.evaluate(t))return!1;return!0}]]},any:{type:Xt,overloads:[[[Xt,Xt],(t,[e,n])=>e.evaluate(t)||n.evaluate(t)],[Gn(Xt),(t,e)=>{for(const n of e)if(n.evaluate(t))return!0;return!1}]]},"!":[Xt,[Xt],(t,[e])=>!e.evaluate(t)],"is-supported-script":[Xt,[Wt],(t,[e])=>{const n=t.globals&&t.globals.isSupportedScript;return!n||n(e.evaluate(t))}],upcase:[Wt,[Wt],(t,[e])=>e.evaluate(t).toUpperCase()],downcase:[Wt,[Wt],(t,[e])=>e.evaluate(t).toLowerCase()],concat:[Wt,Gn(Jt),(t,e)=>e.map(e=>ye(e.evaluate(t))).join("")],"resolved-locale":[Wt,[Qt],(t,[e])=>e.evaluate(t).resolvedLocale()]});class si{constructor(t,e){this.expression=t,this._warningHistory={},this._evaluator=new Ae,this._defaultValue=e?function(t){return"color"===t.type&&Jn(t.default)?new ue(0,0,0,0):"color"===t.type?ue.parse(t.default)||null:void 0===t.default?null:t.default}(e):null,this._enumValues=e&&"enum"===e.type?e.values:null}evaluateWithoutErrorHandling(t,e,n,i,r,o){return this._evaluator.globals=t,this._evaluator.feature=e,this._evaluator.featureState=n,this._evaluator.canonical=i,this._evaluator.availableImages=r||null,this._evaluator.formattedSection=o,this.expression.evaluate(this._evaluator)}evaluate(t,e,n,i,r,o){this._evaluator.globals=t,this._evaluator.feature=e||null,this._evaluator.featureState=n||null,this._evaluator.canonical=i,this._evaluator.availableImages=r||null,this._evaluator.formattedSection=o||null;try{const t=this.expression.evaluate(this._evaluator);if(null==t||"number"==typeof t&&t!=t)return this._defaultValue;if(this._enumValues&&!(t in this._enumValues))throw new xe(`Expected value to be one of ${Object.keys(this._enumValues).map(t=>JSON.stringify(t)).join(", ")}, but found ${JSON.stringify(t)} instead.`);return t}catch(t){return this._warningHistory[t.message]||(this._warningHistory[t.message]=!0,"undefined"!=typeof console&&console.warn(t.message)),this._defaultValue}}}function ai(t){return Array.isArray(t)&&t.length>0&&"string"==typeof t[0]&&t[0]in Nn}function li(t,e){const n=new Je(Nn,[],e?function(t){const e={color:Kt,string:Wt,number:Ht,enum:Wt,boolean:Xt,formatted:te,resolvedImage:ee};return"array"===t.type?ne(e[t.value]||Jt,t.length):e[t.type]}(e):void 0),i=n.parse(t,void 0,void 0,void 0,e&&"string"===e.type?{typeAnnotation:"coerce"}:void 0);return i?Zn(new si(i,e)):Hn(n.errors)}class ci{constructor(t,e){this.kind=t,this._styleExpression=e,this.isStateDependent="constant"!==t&&!Xe(e.expression)}evaluateWithoutErrorHandling(t,e,n,i,r,o){return this._styleExpression.evaluateWithoutErrorHandling(t,e,n,i,r,o)}evaluate(t,e,n,i,r,o){return this._styleExpression.evaluate(t,e,n,i,r,o)}}class ui{constructor(t,e,n,i){this.kind=t,this.zoomStops=n,this._styleExpression=e,this.isStateDependent="camera"!==t&&!Xe(e.expression),this.interpolationType=i}evaluateWithoutErrorHandling(t,e,n,i,r,o){return this._styleExpression.evaluateWithoutErrorHandling(t,e,n,i,r,o)}evaluate(t,e,n,i,r,o){return this._styleExpression.evaluate(t,e,n,i,r,o)}interpolationFactor(t,e,n){return this.interpolationType?xn.interpolationFactor(this.interpolationType,t,e,n):0}}function hi(t,e){if("error"===(t=li(t,e)).result)return t;const n=t.value.expression,i=We(n);if(!i&&!Wn(e))return Hn([new $t("","data expressions not supported")]);const r=Ke(n,["zoom"]);if(!r&&!Xn(e))return Hn([new $t("","zoom expressions not supported")]);const o=pi(n);return o||r?o instanceof $t?Hn([o]):o instanceof xn&&!Kn(e)?Hn([new $t("",'"interpolate" expressions cannot be used with this property')]):Zn(o?new ui(i?"camera":"composite",t.value,o.labels,o instanceof xn?o.interpolation:void 0):new ci(i?"constant":"source",t.value)):Hn([new $t("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class di{constructor(t,e){this._parameters=t,this._specification=e,Nt(this,ti(this._parameters,this._specification))}static deserialize(t){return new di(t._parameters,t._specification)}static serialize(t){return{_parameters:t._parameters,_specification:t._specification}}}function pi(t){let e=null;if(t instanceof Cn)e=pi(t.result);else if(t instanceof wn){for(const n of t.args)if(e=pi(n),e)break}else(t instanceof en||t instanceof xn)&&t.input instanceof Ie&&"zoom"===t.input.name&&(e=t);return e instanceof $t||t.eachChild(t=>{const n=pi(t);n instanceof $t?e=n:!e&&n?e=new $t("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):e&&n&&e!==n&&(e=new $t("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),e}function fi(t){const e=t.key,n=t.value,i=t.valueSpec||{},r=t.objectElementValidators||{},o=t.style,s=t.styleSpec;let a=[];const l=Yn(n);if("object"!==l)return[new Vt(e,n,`object expected, ${l} found`)];for(const c in n){const t=c.split(".")[0],l=i[t]||i["*"];let u;if(r[t])u=r[t];else if(i[t])u=qi;else if(r["*"])u=r["*"];else{if(!i["*"]){a.push(new Vt(e,n[c],`unknown property "${c}"`));continue}u=qi}a=a.concat(u({key:(e?e+".":e)+c,value:n[c],valueSpec:l,style:o,styleSpec:s,object:n,objectKey:c},n))}for(const c in i)r[c]||i[c].required&&void 0===i[c].default&&void 0===n[c]&&a.push(new Vt(e,n,`missing required property "${c}"`));return a}function mi(t){const e=t.value,n=t.valueSpec,i=t.style,r=t.styleSpec,o=t.key,s=t.arrayElementValidator||qi;if("array"!==Yn(e))return[new Vt(o,e,`array expected, ${Yn(e)} found`)];if(n.length&&e.length!==n.length)return[new Vt(o,e,`array length ${n.length} expected, length ${e.length} found`)];if(n["min-length"]&&e.length<n["min-length"])return[new Vt(o,e,`array length at least ${n["min-length"]} expected, length ${e.length} found`)];let a={type:n.value,values:n.values,minimum:n.minimum,maximum:n.maximum};r.$version<7&&(a.function=n.function),"object"===Yn(n.value)&&(a=n.value);let l=[];for(let c=0;c<e.length;c++)l=l.concat(s({array:e,arrayIndex:c,value:e[c],valueSpec:a,style:i,styleSpec:r,key:`${o}[${c}]`}));return l}function gi(t){const e=t.key,n=t.value,i=t.valueSpec;let r=Yn(n);if("number"===r&&n!=n&&(r="NaN"),"number"!==r)return[new Vt(e,n,`number expected, ${r} found`)];if("minimum"in i){let r=i.minimum;if("array"===Yn(i.minimum)&&(r=i.minimum[t.arrayIndex]),n<r)return[new Vt(e,n,`${n} is less than the minimum value ${r}`)]}if("maximum"in i){let r=i.maximum;if("array"===Yn(i.maximum)&&(r=i.maximum[t.arrayIndex]),n>r)return[new Vt(e,n,`${n} is greater than the maximum value ${r}`)]}return[]}function _i(t){const e=t.valueSpec,n=jt(t.value.type);let i,r,o,s={};const a="categorical"!==n&&void 0===t.value.property,l=!a,c="array"===Yn(t.value.stops)&&"array"===Yn(t.value.stops[0])&&"object"===Yn(t.value.stops[0][0]),u=fi({key:t.key,value:t.value,valueSpec:t.styleSpec.function,style:t.style,styleSpec:t.styleSpec,objectElementValidators:{stops:function(t){if("identity"===n)return[new Vt(t.key,t.value,'identity function may not have a "stops" property')];let e=[];const i=t.value;return e=e.concat(mi({key:t.key,value:i,valueSpec:t.valueSpec,style:t.style,styleSpec:t.styleSpec,arrayElementValidator:h})),"array"===Yn(i)&&0===i.length&&e.push(new Vt(t.key,i,"array must have at least one stop")),e},default:function(t){return qi({key:t.key,value:t.value,valueSpec:e,style:t.style,styleSpec:t.styleSpec})}}});return"identity"===n&&a&&u.push(new Vt(t.key,t.value,'missing required property "property"')),"identity"===n||t.value.stops||u.push(new Vt(t.key,t.value,'missing required property "stops"')),"exponential"===n&&t.valueSpec.expression&&!Kn(t.valueSpec)&&u.push(new Vt(t.key,t.value,"exponential functions not supported")),t.styleSpec.$version>=8&&(l&&!Wn(t.valueSpec)?u.push(new Vt(t.key,t.value,"property functions not supported")):a&&!Xn(t.valueSpec)&&u.push(new Vt(t.key,t.value,"zoom functions not supported"))),"categorical"!==n&&!c||void 0!==t.value.property||u.push(new Vt(t.key,t.value,'"property" property is required')),u;function h(t){let n=[];const i=t.value,a=t.key;if("array"!==Yn(i))return[new Vt(a,i,`array expected, ${Yn(i)} found`)];if(2!==i.length)return[new Vt(a,i,`array length 2 expected, length ${i.length} found`)];if(c){if("object"!==Yn(i[0]))return[new Vt(a,i,`object expected, ${Yn(i[0])} found`)];if(void 0===i[0].zoom)return[new Vt(a,i,"object stop key must have zoom")];if(void 0===i[0].value)return[new Vt(a,i,"object stop key must have value")];if(o&&o>jt(i[0].zoom))return[new Vt(a,i[0].zoom,"stop zoom values must appear in ascending order")];jt(i[0].zoom)!==o&&(o=jt(i[0].zoom),r=void 0,s={}),n=n.concat(fi({key:a+"[0]",value:i[0],valueSpec:{zoom:{}},style:t.style,styleSpec:t.styleSpec,objectElementValidators:{zoom:gi,value:d}}))}else n=n.concat(d({key:a+"[0]",value:i[0],valueSpec:{},style:t.style,styleSpec:t.styleSpec},i));return ai(qt(i[1]))?n.concat([new Vt(a+"[1]",i[1],"expressions are not allowed in function stops.")]):n.concat(qi({key:a+"[1]",value:i[1],valueSpec:e,style:t.style,styleSpec:t.styleSpec}))}function d(t,o){const a=Yn(t.value),l=jt(t.value),c=null!==t.value?t.value:o;if(i){if(a!==i)return[new Vt(t.key,c,`${a} stop domain type must match previous stop domain type ${i}`)]}else i=a;if("number"!==a&&"string"!==a&&"boolean"!==a)return[new Vt(t.key,c,"stop domain value must be a number, string, or boolean")];if("number"!==a&&"categorical"!==n){let i=`number expected, ${a} found`;return Wn(e)&&void 0===n&&(i+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new Vt(t.key,c,i)]}return"categorical"!==n||"number"!==a||isFinite(l)&&Math.floor(l)===l?"categorical"!==n&&"number"===a&&void 0!==r&&l<r?[new Vt(t.key,c,"stop domain values must appear in ascending order")]:(r=l,"categorical"===n&&l in s?[new Vt(t.key,c,"stop domain values must be unique")]:(s[l]=!0,[])):[new Vt(t.key,c,"integer expected, found "+l)]}}function yi(t){const e=("property"===t.expressionContext?hi:li)(qt(t.value),t.valueSpec);if("error"===e.result)return e.value.map(e=>new Vt(`${t.key}${e.key}`,t.value,e.message));const n=e.value.expression||e.value._styleExpression.expression;if("property"===t.expressionContext&&"text-font"===t.propertyKey&&!n.outputDefined())return[new Vt(t.key,t.value,`Invalid data expression for "${t.propertyKey}". Output values must be contained as literals within the expression.`)];if("property"===t.expressionContext&&"layout"===t.propertyType&&!Xe(n))return[new Vt(t.key,t.value,'"feature-state" data expressions are not supported with layout properties.')];if("filter"===t.expressionContext&&!Xe(n))return[new Vt(t.key,t.value,'"feature-state" data expressions are not supported with filters.')];if(t.expressionContext&&0===t.expressionContext.indexOf("cluster")){if(!Ke(n,["zoom","feature-state"]))return[new Vt(t.key,t.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if("cluster-initial"===t.expressionContext&&!We(n))return[new Vt(t.key,t.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function vi(t){const e=t.key,n=t.value,i=t.valueSpec,r=[];return Array.isArray(i.values)?-1===i.values.indexOf(jt(n))&&r.push(new Vt(e,n,`expected one of [${i.values.join(", ")}], ${JSON.stringify(n)} found`)):-1===Object.keys(i.values).indexOf(jt(n))&&r.push(new Vt(e,n,`expected one of [${Object.keys(i.values).join(", ")}], ${JSON.stringify(n)} found`)),r}function xi(t){if(!0===t||!1===t)return!0;if(!Array.isArray(t)||0===t.length)return!1;switch(t[0]){case"has":return t.length>=2&&"$id"!==t[1]&&"$type"!==t[1];case"in":return t.length>=3&&("string"!=typeof t[1]||Array.isArray(t[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return 3!==t.length||Array.isArray(t[1])||Array.isArray(t[2]);case"any":case"all":for(const e of t.slice(1))if(!xi(e)&&"boolean"!=typeof e)return!1;return!0;default:return!0}}const bi={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function wi(t){if(null==t)return{filter:()=>!0,needGeometry:!1};xi(t)||(t=Si(t));const e=li(t,bi);if("error"===e.result)throw new Error(e.value.map(t=>`${t.key}: ${t.message}`).join(", "));return{filter:(t,n,i)=>e.value.evaluate(t,n,{},i),needGeometry:Ti(t)}}function Ci(t,e){return t<e?-1:t>e?1:0}function Ti(t){if(!Array.isArray(t))return!1;if("within"===t[0])return!0;for(let e=1;e<t.length;e++)if(Ti(t[e]))return!0;return!1}function Si(t){if(!t)return!0;const e=t[0];return t.length<=1?"any"!==e:"=="===e?Ei(t[1],t[2],"=="):"!="===e?Ii(Ei(t[1],t[2],"==")):"<"===e||">"===e||"<="===e||">="===e?Ei(t[1],t[2],e):"any"===e?(n=t.slice(1),["any"].concat(n.map(Si))):"all"===e?["all"].concat(t.slice(1).map(Si)):"none"===e?["all"].concat(t.slice(1).map(Si).map(Ii)):"in"===e?ki(t[1],t.slice(2)):"!in"===e?Ii(ki(t[1],t.slice(2))):"has"===e?Ai(t[1]):"!has"===e?Ii(Ai(t[1])):"within"!==e||t;var n}function Ei(t,e,n){switch(t){case"$type":return["filter-type-"+n,e];case"$id":return["filter-id-"+n,e];default:return["filter-"+n,t,e]}}function ki(t,e){if(0===e.length)return!1;switch(t){case"$type":return["filter-type-in",["literal",e]];case"$id":return["filter-id-in",["literal",e]];default:return e.length>200&&!e.some(t=>typeof t!=typeof e[0])?["filter-in-large",t,["literal",e.sort(Ci)]]:["filter-in-small",t,["literal",e]]}}function Ai(t){switch(t){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",t]}}function Ii(t){return["!",t]}function Pi(t){return xi(qt(t.value))?yi(Nt({},t,{expressionContext:"filter",valueSpec:{value:"boolean"}})):Mi(t)}function Mi(t){const e=t.value,n=t.key;if("array"!==Yn(e))return[new Vt(n,e,`array expected, ${Yn(e)} found`)];const i=t.styleSpec;let r,o=[];if(e.length<1)return[new Vt(n,e,"filter array must have at least 1 element")];switch(o=o.concat(vi({key:n+"[0]",value:e[0],valueSpec:i.filter_operator,style:t.style,styleSpec:t.styleSpec})),jt(e[0])){case"<":case"<=":case">":case">=":e.length>=2&&"$type"===jt(e[1])&&o.push(new Vt(n,e,`"$type" cannot be use with operator "${e[0]}"`));case"==":case"!=":3!==e.length&&o.push(new Vt(n,e,`filter array for operator "${e[0]}" must have 3 elements`));case"in":case"!in":e.length>=2&&(r=Yn(e[1]),"string"!==r&&o.push(new Vt(n+"[1]",e[1],`string expected, ${r} found`)));for(let s=2;s<e.length;s++)r=Yn(e[s]),"$type"===jt(e[1])?o=o.concat(vi({key:`${n}[${s}]`,value:e[s],valueSpec:i.geometry_type,style:t.style,styleSpec:t.styleSpec})):"string"!==r&&"number"!==r&&"boolean"!==r&&o.push(new Vt(`${n}[${s}]`,e[s],`string, number, or boolean expected, ${r} found`));break;case"any":case"all":case"none":for(let i=1;i<e.length;i++)o=o.concat(Mi({key:`${n}[${i}]`,value:e[i],style:t.style,styleSpec:t.styleSpec}));break;case"has":case"!has":r=Yn(e[1]),2!==e.length?o.push(new Vt(n,e,`filter array for "${e[0]}" operator must have 2 elements`)):"string"!==r&&o.push(new Vt(n+"[1]",e[1],`string expected, ${r} found`));break;case"within":r=Yn(e[1]),2!==e.length?o.push(new Vt(n,e,`filter array for "${e[0]}" operator must have 2 elements`)):"object"!==r&&o.push(new Vt(n+"[1]",e[1],`object expected, ${r} found`))}return o}function Oi(t,e){const n=t.key,i=t.style,r=t.styleSpec,o=t.value,s=t.objectKey,a=r[`${e}_${t.layerType}`];if(!a)return[];const l=s.match(/^(.*)-transition$/);if("paint"===e&&l&&a[l[1]]&&a[l[1]].transition)return qi({key:n,value:o,valueSpec:r.transition,style:i,styleSpec:r});const c=t.valueSpec||a[s];if(!c)return[new Vt(n,o,`unknown property "${s}"`)];let u;if("string"===Yn(o)&&Wn(c)&&!c.tokens&&(u=/^{([^}]+)}$/.exec(o)))return[new Vt(n,o,`"${s}" does not support interpolation syntax\nUse an identity property function instead: \`{ "type": "identity", "property": ${JSON.stringify(u[1])} }\`.`)];const h=[];return"symbol"===t.layerType&&("text-field"===s&&i&&!i.glyphs&&h.push(new Vt(n,o,'use of "text-field" requires a style "glyphs" property')),"text-font"===s&&Jn(qt(o))&&"identity"===jt(o.type)&&h.push(new Vt(n,o,'"text-font" does not support identity functions'))),h.concat(qi({key:t.key,value:o,valueSpec:c,style:i,styleSpec:r,expressionContext:"property",propertyType:e,propertyKey:s}))}function zi(t){return Oi(t,"paint")}function Di(t){return Oi(t,"layout")}function Li(t){let e=[];const n=t.value,i=t.key,r=t.style,o=t.styleSpec;n.type||n.ref||e.push(new Vt(i,n,'either "type" or "ref" is required'));let s=jt(n.type);const a=jt(n.ref);if(n.id){const o=jt(n.id);for(let s=0;s<t.arrayIndex;s++){const t=r.layers[s];jt(t.id)===o&&e.push(new Vt(i,n.id,`duplicate layer id "${n.id}", previously used at line ${t.id.__line__}`))}}if("ref"in n){let t;["type","source","source-layer","filter","layout"].forEach(t=>{t in n&&e.push(new Vt(i,n[t],`"${t}" is prohibited for ref layers`))}),r.layers.forEach(e=>{jt(e.id)===a&&(t=e)}),t?t.ref?e.push(new Vt(i,n.ref,"ref cannot reference another ref layer")):s=jt(t.type):e.push(new Vt(i,n.ref,`ref layer "${a}" not found`))}else if("background"!==s&&"sky"!==s)if(n.source){const t=r.sources&&r.sources[n.source],o=t&&jt(t.type);t?"vector"===o&&"raster"===s?e.push(new Vt(i,n.source,`layer "${n.id}" requires a raster source`)):"raster"===o&&"raster"!==s?e.push(new Vt(i,n.source,`layer "${n.id}" requires a vector source`)):"vector"!==o||n["source-layer"]?"raster-dem"===o&&"hillshade"!==s?e.push(new Vt(i,n.source,"raster-dem source can only be used with layer type 'hillshade'.")):"line"!==s||!n.paint||!n.paint["line-gradient"]||"geojson"===o&&t.lineMetrics||e.push(new Vt(i,n,`layer "${n.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):e.push(new Vt(i,n,`layer "${n.id}" must specify a "source-layer"`)):e.push(new Vt(i,n.source,`source "${n.source}" not found`))}else e.push(new Vt(i,n,'missing required property "source"'));return e=e.concat(fi({key:i,value:n,valueSpec:o.layer,style:t.style,styleSpec:t.styleSpec,objectElementValidators:{"*":()=>[],type:()=>qi({key:i+".type",value:n.type,valueSpec:o.layer.type,style:t.style,styleSpec:t.styleSpec,object:n,objectKey:"type"}),filter:Pi,layout:t=>fi({layer:n,key:t.key,value:t.value,style:t.style,styleSpec:t.styleSpec,objectElementValidators:{"*":t=>Di(Nt({layerType:s},t))}}),paint:t=>fi({layer:n,key:t.key,value:t.value,style:t.style,styleSpec:t.styleSpec,objectElementValidators:{"*":t=>zi(Nt({layerType:s},t))}})}})),e}function Ri(t){const e=t.value,n=t.key,i=Yn(e);return"string"!==i?[new Vt(n,e,`string expected, ${i} found`)]:[]}const Fi={promoteId:function({key:t,value:e}){if("string"===Yn(e))return Ri({key:t,value:e});{const n=[];for(const i in e)n.push(...Ri({key:`${t}.${i}`,value:e[i]}));return n}}};function Bi(t){const e=t.value,n=t.key,i=t.styleSpec,r=t.style;if(!e.type)return[new Vt(n,e,'"type" is required')];const o=jt(e.type);let s;switch(o){case"vector":case"raster":case"raster-dem":return s=fi({key:n,value:e,valueSpec:i["source_"+o.replace("-","_")],style:t.style,styleSpec:i,objectElementValidators:Fi}),s;case"geojson":if(s=fi({key:n,value:e,valueSpec:i.source_geojson,style:r,styleSpec:i,objectElementValidators:Fi}),e.cluster)for(const t in e.clusterProperties){const[i,r]=e.clusterProperties[t],o="string"==typeof i?[i,["accumulated"],["get",t]]:i;s.push(...yi({key:`${n}.${t}.map`,value:r,expressionContext:"cluster-map"})),s.push(...yi({key:`${n}.${t}.reduce`,value:o,expressionContext:"cluster-reduce"}))}return s;case"video":return fi({key:n,value:e,valueSpec:i.source_video,style:r,styleSpec:i});case"image":return fi({key:n,value:e,valueSpec:i.source_image,style:r,styleSpec:i});case"canvas":return[new Vt(n,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return vi({key:n+".type",value:e.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]},style:r,styleSpec:i})}}function Vi(t){const e=t.value,n=t.styleSpec,i=n.light,r=t.style;let o=[];const s=Yn(e);if(void 0===e)return o;if("object"!==s)return o=o.concat([new Vt("light",e,`object expected, ${s} found`)]),o;for(const a in e){const t=a.match(/^(.*)-transition$/);o=o.concat(t&&i[t[1]]&&i[t[1]].transition?qi({key:a,value:e[a],valueSpec:n.transition,style:r,styleSpec:n}):i[a]?qi({key:a,value:e[a],valueSpec:i[a],style:r,styleSpec:n}):[new Vt(a,e[a],`unknown property "${a}"`)])}return o}function Ui(t){const e=t.value,n=t.key,i=t.style,r=t.styleSpec,o=r.terrain;let s=[];const a=Yn(e);if(void 0===e)return s;if("object"!==a)return s=s.concat([new Vt("terrain",e,`object expected, ${a} found`)]),s;for(const l in e){const t=l.match(/^(.*)-transition$/);s=s.concat(t&&o[t[1]]&&o[t[1]].transition?qi({key:l,value:e[l],valueSpec:r.transition,style:i,styleSpec:r}):o[l]?qi({key:l,value:e[l],valueSpec:o[l],style:i,styleSpec:r}):[new Vt(l,e[l],`unknown property "${l}"`)])}if(e.source){const t=i.sources&&i.sources[e.source],r=t&&jt(t.type);t?"raster-dem"!==r&&s.push(new Vt(n,e.source,`terrain cannot be used with a source of type ${r}, it only be used with a "raster-dem" source type`)):s.push(new Vt(n,e.source,`source "${e.source}" not found`))}else s.push(new Vt(n,e,'terrain is missing required property "source"'));return s}function Ni(t){const e=t.value,n=t.style,i=t.styleSpec,r=i.fog;let o=[];const s=Yn(e);if(void 0===e)return o;if("object"!==s)return o=o.concat([new Vt("fog",e,`object expected, ${s} found`)]),o;e.range&&!ai(qt(e.range))&&e.range[0]>=e.range[1]&&(o=o.concat([new Vt("fog",e,"fog.range[0] can't be greater than or equal to fog.range[1]")]));for(const a in e){const t=a.match(/^(.*)-transition$/);o=o.concat(t&&r[t[1]]&&r[t[1]].transition?qi({key:a,value:e[a],valueSpec:i.transition,style:n,styleSpec:i}):r[a]?qi({key:a,value:e[a],valueSpec:r[a],style:n,styleSpec:i}):[new Vt(a,e[a],`unknown property "${a}"`)])}return o}const ji={"*":()=>[],array:mi,boolean:function(t){const e=t.value,n=t.key,i=Yn(e);return"boolean"!==i?[new Vt(n,e,`boolean expected, ${i} found`)]:[]},number:gi,color:function(t){const e=t.key,n=t.value,i=Yn(n);return"string"!==i?[new Vt(e,n,`color expected, ${i} found`)]:null===ce.parseCSSColor(n)?[new Vt(e,n,`color expected, "${n}" found`)]:[]},constants:Ut,enum:vi,filter:Pi,function:_i,layer:Li,object:fi,source:Bi,light:Vi,terrain:Ui,fog:Ni,string:Ri,formatted:function(t){return 0===Ri(t).length?[]:yi(t)},resolvedImage:function(t){return 0===Ri(t).length?[]:yi(t)}};function qi(t){const e=t.value,n=t.valueSpec,i=t.styleSpec;return n.expression&&Jn(jt(e))?_i(t):n.expression&&ai(qt(e))?yi(t):n.type&&ji[n.type]?ji[n.type](t):fi(Nt({},t,{valueSpec:n.type?i[n.type]:n}))}function $i(t){const e=t.value,n=t.key,i=Ri(t);return i.length||(-1===e.indexOf("{fontstack}")&&i.push(new Vt(n,e,'"glyphs" url must include a "{fontstack}" token')),-1===e.indexOf("{range}")&&i.push(new Vt(n,e,'"glyphs" url must include a "{range}" token'))),i}function Gi(t,e=Bt){let n=[];return n=n.concat(qi({key:"",value:t,valueSpec:e.$root,styleSpec:e,style:t,objectElementValidators:{glyphs:$i,"*":()=>[]}})),t.constants&&(n=n.concat(Ut({key:"constants",value:t.constants,style:t,styleSpec:e}))),Zi(n)}function Zi(t){return[].concat(t).sort((t,e)=>t.line-e.line)}function Hi(t){return function(...e){return Zi(t.apply(this,e))}}Gi.source=Hi(Bi),Gi.light=Hi(Vi),Gi.terrain=Hi(Ui),Gi.fog=Hi(Ni),Gi.layer=Hi(Li),Gi.filter=Hi(Pi),Gi.paintProperty=Hi(zi),Gi.layoutProperty=Hi(Di);const Wi=Gi,Xi=Wi.light,Ki=Wi.fog,Yi=Wi.paintProperty,Ji=Wi.layoutProperty;function Qi(t,e){let n=!1;if(e&&e.length)for(const i of e)t.fire(new Rt(new Error(i.message))),n=!0;return n}var tr=er;function er(t,e,n){var i=this.cells=[];if(t instanceof ArrayBuffer){this.arrayBuffer=t;var r=new Int32Array(this.arrayBuffer);t=r[0],this.d=(e=r[1])+2*(n=r[2]);for(var o=0;o<this.d*this.d;o++){var s=r[3+o],a=r[3+o+1];i.push(s===a?null:r.subarray(s,a))}var l=r[3+i.length+1];this.keys=r.subarray(r[3+i.length],l),this.bboxes=r.subarray(l),this.insert=this._insertReadonly}else{this.d=e+2*n;for(var c=0;c<this.d*this.d;c++)i.push([]);this.keys=[],this.bboxes=[]}this.n=e,this.extent=t,this.padding=n,this.scale=e/t,this.uid=0;var u=n/e*t;this.min=-u,this.max=t+u}er.prototype.insert=function(t,e,n,i,r){this._forEachCell(e,n,i,r,this._insertCell,this.uid++),this.keys.push(t),this.bboxes.push(e),this.bboxes.push(n),this.bboxes.push(i),this.bboxes.push(r)},er.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},er.prototype._insertCell=function(t,e,n,i,r,o){this.cells[r].push(o)},er.prototype.query=function(t,e,n,i,r){var o=this.min,s=this.max;if(t<=o&&e<=o&&s<=n&&s<=i&&!r)return Array.prototype.slice.call(this.keys);var a=[];return this._forEachCell(t,e,n,i,this._queryCell,a,{},r),a},er.prototype._queryCell=function(t,e,n,i,r,o,s,a){var l=this.cells[r];if(null!==l)for(var c=this.keys,u=this.bboxes,h=0;h<l.length;h++){var d=l[h];if(void 0===s[d]){var p=4*d;(a?a(u[p+0],u[p+1],u[p+2],u[p+3]):t<=u[p+2]&&e<=u[p+3]&&n>=u[p+0]&&i>=u[p+1])?(s[d]=!0,o.push(c[d])):s[d]=!1}}},er.prototype._forEachCell=function(t,e,n,i,r,o,s,a){for(var l=this._convertToCellCoord(t),c=this._convertToCellCoord(e),u=this._convertToCellCoord(n),h=this._convertToCellCoord(i),d=l;d<=u;d++)for(var p=c;p<=h;p++){var f=this.d*p+d;if((!a||a(this._convertFromCellCoord(d),this._convertFromCellCoord(p),this._convertFromCellCoord(d+1),this._convertFromCellCoord(p+1)))&&r.call(this,t,e,n,i,f,o,s,a))return}},er.prototype._convertFromCellCoord=function(t){return(t-this.padding)/this.scale},er.prototype._convertToCellCoord=function(t){return Math.max(0,Math.min(this.d-1,Math.floor(t*this.scale)+this.padding))},er.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var t=this.cells,e=3+this.cells.length+1+1,n=0,i=0;i<this.cells.length;i++)n+=this.cells[i].length;var r=new Int32Array(e+n+this.keys.length+this.bboxes.length);r[0]=this.extent,r[1]=this.n,r[2]=this.padding;for(var o=e,s=0;s<t.length;s++){var a=t[s];r[3+s]=o,r.set(a,o),o+=a.length}return r[3+t.length]=o,r.set(this.keys,o),r[3+t.length+1]=o+=this.keys.length,r.set(this.bboxes,o),o+=this.bboxes.length,r.buffer};const{ImageData:nr,ImageBitmap:ir}=s,rr={};function or(t,e,n={}){Object.defineProperty(e,"_classRegistryKey",{value:t,writeable:!1}),rr[t]={klass:e,omit:n.omit||[],shallow:n.shallow||[]}}or("Object",Object),tr.serialize=function(t,e){const n=t.toArrayBuffer();return e&&e.push(n),{buffer:n}},tr.deserialize=function(t){return new tr(t.buffer)},or("Grid",tr),or("Color",ue),or("Error",Error),or("ResolvedImage",fe),or("StylePropertyFunction",di),or("StyleExpression",si,{omit:["_evaluator"]}),or("ZoomDependentExpression",ui),or("ZoomConstantExpression",ci),or("CompoundExpression",Ie,{omit:["_evaluate"]});for(const wd in Nn)Nn[wd]._classRegistryKey||or("Expression_"+wd,Nn[wd]);function sr(t){return t&&"undefined"!=typeof ArrayBuffer&&(t instanceof ArrayBuffer||t.constructor&&"ArrayBuffer"===t.constructor.name)}function ar(t){return ir&&t instanceof ir}function lr(t,e){if(null==t||"boolean"==typeof t||"number"==typeof t||"string"==typeof t||t instanceof Boolean||t instanceof Number||t instanceof String||t instanceof Date||t instanceof RegExp)return t;if(sr(t)||ar(t))return e&&e.push(t),t;if(ArrayBuffer.isView(t)){const n=t;return e&&e.push(n.buffer),n}if(t instanceof nr)return e&&e.push(t.data.buffer),t;if(Array.isArray(t)){const n=[];for(const i of t)n.push(lr(i,e));return n}if("object"==typeof t){const n=t.constructor,i=n._classRegistryKey;if(!i)throw new Error("can't serialize object of unregistered class");const r=n.serialize?n.serialize(t,e):{};if(!n.serialize){for(const n in t){if(!t.hasOwnProperty(n))continue;if(rr[i].omit.indexOf(n)>=0)continue;const o=t[n];r[n]=rr[i].shallow.indexOf(n)>=0?o:lr(o,e)}t instanceof Error&&(r.message=t.message)}if(r.$name)throw new Error("$name property is reserved for worker serialization logic.");return"Object"!==i&&(r.$name=i),r}throw new Error("can't serialize object of type "+typeof t)}function cr(t){if(null==t||"boolean"==typeof t||"number"==typeof t||"string"==typeof t||t instanceof Boolean||t instanceof Number||t instanceof String||t instanceof Date||t instanceof RegExp||sr(t)||ar(t)||ArrayBuffer.isView(t)||t instanceof nr)return t;if(Array.isArray(t))return t.map(cr);if("object"==typeof t){const e=t.$name||"Object",{klass:n}=rr[e];if(!n)throw new Error("can't deserialize unregistered class "+e);if(n.deserialize)return n.deserialize(t);const i=Object.create(n.prototype);for(const r of Object.keys(t)){if("$name"===r)continue;const n=t[r];i[r]=rr[e].shallow.indexOf(r)>=0?n:cr(n)}return i}throw new Error("can't deserialize object of type "+typeof t)}class ur{constructor(){this.first=!0}update(t,e){const n=Math.floor(t);return this.first?(this.first=!1,this.lastIntegerZoom=n,this.lastIntegerZoomTime=0,this.lastZoom=t,this.lastFloorZoom=n,!0):(this.lastFloorZoom>n?(this.lastIntegerZoom=n+1,this.lastIntegerZoomTime=e):this.lastFloorZoom<n&&(this.lastIntegerZoom=n,this.lastIntegerZoomTime=e),t!==this.lastZoom&&(this.lastZoom=t,this.lastFloorZoom=n,!0))}}const hr=t=>t>=1536&&t<=1791,dr=t=>t>=1872&&t<=1919,pr=t=>t>=2208&&t<=2303,fr=t=>t>=11904&&t<=12031,mr=t=>t>=12032&&t<=12255,gr=t=>t>=12272&&t<=12287,_r=t=>t>=12288&&t<=12351,yr=t=>t>=12352&&t<=12447,vr=t=>t>=12448&&t<=12543,xr=t=>t>=12544&&t<=12591,br=t=>t>=12704&&t<=12735,wr=t=>t>=12736&&t<=12783,Cr=t=>t>=12784&&t<=12799,Tr=t=>t>=12800&&t<=13055,Sr=t=>t>=13056&&t<=13311,Er=t=>t>=13312&&t<=19903,kr=t=>t>=19968&&t<=40959,Ar=t=>t>=40960&&t<=42127,Ir=t=>t>=42128&&t<=42191,Pr=t=>t>=44032&&t<=55215,Mr=t=>t>=63744&&t<=64255,Or=t=>t>=64336&&t<=65023,zr=t=>t>=65040&&t<=65055,Dr=t=>t>=65072&&t<=65103,Lr=t=>t>=65104&&t<=65135,Rr=t=>t>=65136&&t<=65279,Fr=t=>t>=65280&&t<=65519;function Br(t){for(const e of t)if(Nr(e.charCodeAt(0)))return!0;return!1}function Vr(t){for(const e of t)if(!Ur(e.charCodeAt(0)))return!1;return!0}function Ur(t){return!(hr(t)||dr(t)||pr(t)||Or(t)||Rr(t))}function Nr(t){return!(746!==t&&747!==t&&(t<4352||!(br(t)||xr(t)||Dr(t)&&!(t>=65097&&t<=65103)||Mr(t)||Sr(t)||fr(t)||wr(t)||!(!_r(t)||t>=12296&&t<=12305||t>=12308&&t<=12319||12336===t)||Er(t)||kr(t)||Tr(t)||(t=>t>=12592&&t<=12687)(t)||(t=>t>=43360&&t<=43391)(t)||(t=>t>=55216&&t<=55295)(t)||(t=>t>=4352&&t<=4607)(t)||Pr(t)||yr(t)||gr(t)||(t=>t>=12688&&t<=12703)(t)||mr(t)||Cr(t)||vr(t)&&12540!==t||!(!Fr(t)||65288===t||65289===t||65293===t||t>=65306&&t<=65310||65339===t||65341===t||65343===t||t>=65371&&t<=65503||65507===t||t>=65512&&t<=65519)||!(!Lr(t)||t>=65112&&t<=65118||t>=65123&&t<=65126)||(t=>t>=5120&&t<=5759)(t)||(t=>t>=6320&&t<=6399)(t)||zr(t)||(t=>t>=19904&&t<=19967)(t)||Ar(t)||Ir(t))))}function jr(t){return!(Nr(t)||function(t){return!!((t=>t>=128&&t<=255)(t)&&(167===t||169===t||174===t||177===t||188===t||189===t||190===t||215===t||247===t)||(t=>t>=8192&&t<=8303)(t)&&(8214===t||8224===t||8225===t||8240===t||8241===t||8251===t||8252===t||8258===t||8263===t||8264===t||8265===t||8273===t)||(t=>t>=8448&&t<=8527)(t)||(t=>t>=8528&&t<=8591)(t)||(t=>t>=8960&&t<=9215)(t)&&(t>=8960&&t<=8967||t>=8972&&t<=8991||t>=8996&&t<=9e3||9003===t||t>=9085&&t<=9114||t>=9150&&t<=9165||9167===t||t>=9169&&t<=9179||t>=9186&&t<=9215)||(t=>t>=9216&&t<=9279)(t)&&9251!==t||(t=>t>=9280&&t<=9311)(t)||(t=>t>=9312&&t<=9471)(t)||(t=>t>=9632&&t<=9727)(t)||(t=>t>=9728&&t<=9983)(t)&&!(t>=9754&&t<=9759)||(t=>t>=11008&&t<=11263)(t)&&(t>=11026&&t<=11055||t>=11088&&t<=11097||t>=11192&&t<=11243)||_r(t)||vr(t)||(t=>t>=57344&&t<=63743)(t)||Dr(t)||Lr(t)||Fr(t)||8734===t||8756===t||8757===t||t>=9984&&t<=10087||t>=10102&&t<=10131||65532===t||65533===t)}(t))}function qr(t){return t>=1424&&t<=2303||Or(t)||Rr(t)}function $r(t,e){return!(!e&&qr(t)||t>=2304&&t<=3583||t>=3840&&t<=4255||(t=>t>=6016&&t<=6143)(t))}function Gr(t){for(const e of t)if(qr(e.charCodeAt(0)))return!0;return!1}const Zr="deferred",Hr="loading",Wr="loaded";let Xr=null,Kr="unavailable",Yr=null;const Jr=function(t){t&&"string"==typeof t&&t.indexOf("NetworkError")>-1&&(Kr="error"),Xr&&Xr(t)};function Qr(){to.fire(new Lt("pluginStateChange",{pluginStatus:Kr,pluginURL:Yr}))}const to=new Ft,eo=function(){return Kr},no=function(){if(Kr!==Zr||!Yr)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");Kr=Hr,Qr(),Yr&&St({url:Yr},t=>{t?Jr(t):(Kr=Wr,Qr())})},io={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:()=>Kr===Wr||null!=io.applyArabicShaping,isLoading:()=>Kr===Hr,setState(t){Kr=t.pluginStatus,Yr=t.pluginURL},isParsed:()=>null!=io.applyArabicShaping&&null!=io.processBidirectionalText&&null!=io.processStyledBidirectionalText,getPluginURL:()=>Yr};class ro{constructor(t,e){this.zoom=t,e?(this.now=e.now,this.fadeDuration=e.fadeDuration,this.zoomHistory=e.zoomHistory,this.transition=e.transition):(this.now=0,this.fadeDuration=0,this.zoomHistory=new ur,this.transition={})}isSupportedScript(t){return function(t,e){for(const n of t)if(!$r(n.charCodeAt(0),e))return!1;return!0}(t,io.isLoaded())}crossFadingFactor(){return 0===this.fadeDuration?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)}getCrossfadeParameters(){const t=this.zoom,e=t-Math.floor(t),n=this.crossFadingFactor();return t>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:e+(1-e)*n}:{fromScale:.5,toScale:1,t:1-(1-n)*e}}}class oo{constructor(t,e){this.property=t,this.value=e,this.expression=function(t,e){if(Jn(t))return new di(t,e);if(ai(t)){const n=hi(t,e);if("error"===n.result)throw new Error(n.value.map(t=>`${t.key}: ${t.message}`).join(", "));return n.value}{let n=t;return"string"==typeof t&&"color"===e.type&&(n=ue.parse(t)),{kind:"constant",evaluate:()=>n}}}(void 0===e?t.specification.default:e,t.specification)}isDataDriven(){return"source"===this.expression.kind||"composite"===this.expression.kind}possiblyEvaluate(t,e,n){return this.property.possiblyEvaluate(this,t,e,n)}}class so{constructor(t){this.property=t,this.value=new oo(t,void 0)}transitioned(t,e){return new lo(this.property,this.value,e,v({},t.transition,this.transition),t.now)}untransitioned(){return new lo(this.property,this.value,null,{},0)}}class ao{constructor(t){this._properties=t,this._values=Object.create(t.defaultTransitionablePropertyValues)}getValue(t){return I(this._values[t].value.value)}setValue(t,e){this._values.hasOwnProperty(t)||(this._values[t]=new so(this._values[t].property)),this._values[t].value=new oo(this._values[t].property,null===e?void 0:I(e))}getTransition(t){return I(this._values[t].transition)}setTransition(t,e){this._values.hasOwnProperty(t)||(this._values[t]=new so(this._values[t].property)),this._values[t].transition=I(e)||void 0}serialize(){const t={};for(const e of Object.keys(this._values)){const n=this.getValue(e);void 0!==n&&(t[e]=n);const i=this.getTransition(e);void 0!==i&&(t[e+"-transition"]=i)}return t}transitioned(t,e){const n=new co(this._properties);for(const i of Object.keys(this._values))n._values[i]=this._values[i].transitioned(t,e._values[i]);return n}untransitioned(){const t=new co(this._properties);for(const e of Object.keys(this._values))t._values[e]=this._values[e].untransitioned();return t}}class lo{constructor(t,e,n,i,r){const o=i.delay||0,s=i.duration||0;r=r||0,this.property=t,this.value=e,this.begin=r+o,this.end=this.begin+s,t.specification.transition&&(i.delay||i.duration)&&(this.prior=n)}possiblyEvaluate(t,e,n){const i=t.now||0,r=this.value.possiblyEvaluate(t,e,n),o=this.prior;if(o){if(i>this.end)return this.prior=null,r;if(this.value.isDataDriven())return this.prior=null,r;if(i<this.begin)return o.possiblyEvaluate(t,e,n);{const s=(i-this.begin)/(this.end-this.begin);return this.property.interpolate(o.possiblyEvaluate(t,e,n),r,d(s))}}return r}}class co{constructor(t){this._properties=t,this._values=Object.create(t.defaultTransitioningPropertyValues)}possiblyEvaluate(t,e,n){const i=new po(this._properties);for(const r of Object.keys(this._values))i._values[r]=this._values[r].possiblyEvaluate(t,e,n);return i}hasTransition(){for(const t of Object.keys(this._values))if(this._values[t].prior)return!0;return!1}}class uo{constructor(t){this._properties=t,this._values=Object.create(t.defaultPropertyValues)}getValue(t){return I(this._values[t].value)}setValue(t,e){this._values[t]=new oo(this._values[t].property,null===e?void 0:I(e))}serialize(){const t={};for(const e of Object.keys(this._values)){const n=this.getValue(e);void 0!==n&&(t[e]=n)}return t}possiblyEvaluate(t,e,n){const i=new po(this._properties);for(const r of Object.keys(this._values))i._values[r]=this._values[r].possiblyEvaluate(t,e,n);return i}}class ho{constructor(t,e,n){this.property=t,this.value=e,this.parameters=n}isConstant(){return"constant"===this.value.kind}constantOr(t){return"constant"===this.value.kind?this.value.value:t}evaluate(t,e,n,i){return this.property.evaluate(this.value,this.parameters,t,e,n,i)}}class po{constructor(t){this._properties=t,this._values=Object.create(t.defaultPossiblyEvaluatedValues)}get(t){return this._values[t]}}class fo{constructor(t){this.specification=t}possiblyEvaluate(t,e){return t.expression.evaluate(e)}interpolate(t,e,n){const i=rn[this.specification.type];return i?i(t,e,n):t}}class mo{constructor(t,e){this.specification=t,this.overrides=e}possiblyEvaluate(t,e,n,i){return new ho(this,"constant"===t.expression.kind||"camera"===t.expression.kind?{kind:"constant",value:t.expression.evaluate(e,null,{},n,i)}:t.expression,e)}interpolate(t,e,n){if("constant"!==t.value.kind||"constant"!==e.value.kind)return t;if(void 0===t.value.value||void 0===e.value.value)return new ho(this,{kind:"constant",value:void 0},t.parameters);const i=rn[this.specification.type];return i?new ho(this,{kind:"constant",value:i(t.value.value,e.value.value,n)},t.parameters):t}evaluate(t,e,n,i,r,o){return"constant"===t.kind?t.value:t.evaluate(e,n,i,r,o)}}class go extends mo{possiblyEvaluate(t,e,n,i){if(void 0===t.value)return new ho(this,{kind:"constant",value:void 0},e);if("constant"===t.expression.kind){const r=t.expression.evaluate(e,null,{},n,i),o="resolvedImage"===t.property.specification.type&&"string"!=typeof r?r.name:r,s=this._calculate(o,o,o,e);return new ho(this,{kind:"constant",value:s},e)}if("camera"===t.expression.kind){const n=this._calculate(t.expression.evaluate({zoom:e.zoom-1}),t.expression.evaluate({zoom:e.zoom}),t.expression.evaluate({zoom:e.zoom+1}),e);return new ho(this,{kind:"constant",value:n},e)}return new ho(this,t.expression,e)}evaluate(t,e,n,i,r,o){if("source"===t.kind){const s=t.evaluate(e,n,i,r,o);return this._calculate(s,s,s,e)}return"composite"===t.kind?this._calculate(t.evaluate({zoom:Math.floor(e.zoom)-1},n,i),t.evaluate({zoom:Math.floor(e.zoom)},n,i),t.evaluate({zoom:Math.floor(e.zoom)+1},n,i),e):t.value}_calculate(t,e,n,i){return i.zoom>i.zoomHistory.lastIntegerZoom?{from:t,to:e,other:n}:{from:n,to:e,other:t}}interpolate(t){return t}}class _o{constructor(t){this.specification=t}possiblyEvaluate(t,e,n,i){if(void 0!==t.value){if("constant"===t.expression.kind){const r=t.expression.evaluate(e,null,{},n,i);return this._calculate(r,r,r,e)}return this._calculate(t.expression.evaluate(new ro(Math.floor(e.zoom-1),e)),t.expression.evaluate(new ro(Math.floor(e.zoom),e)),t.expression.evaluate(new ro(Math.floor(e.zoom+1),e)),e)}}_calculate(t,e,n,i){return i.zoom>i.zoomHistory.lastIntegerZoom?{from:t,to:e}:{from:n,to:e}}interpolate(t){return t}}class yo{constructor(t){this.specification=t}possiblyEvaluate(t,e,n,i){return!!t.expression.evaluate(e,null,{},n,i)}interpolate(){return!1}}class vo{constructor(t){this.properties=t,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];for(const e in t){const n=t[e];n.specification.overridable&&this.overridableProperties.push(e);const i=this.defaultPropertyValues[e]=new oo(n,void 0),r=this.defaultTransitionablePropertyValues[e]=new so(n);this.defaultTransitioningPropertyValues[e]=r.untransitioned(),this.defaultPossiblyEvaluatedValues[e]=i.possiblyEvaluate({})}}}function xo(t,e){return 256*(t=m(Math.floor(t),0,255))+m(Math.floor(e),0,255)}or("DataDrivenProperty",mo),or("DataConstantProperty",fo),or("CrossFadedDataDrivenProperty",go),or("CrossFadedProperty",_o),or("ColorRampProperty",yo);const bo={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class wo{constructor(t,e){this._structArray=t,this._pos1=e*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class Co{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(t,e){return t._trim(),e&&(t.isTransferred=!0,e.push(t.arrayBuffer)),{length:t.length,arrayBuffer:t.arrayBuffer}}static deserialize(t){const e=Object.create(this.prototype);return e.arrayBuffer=t.arrayBuffer,e.length=t.length,e.capacity=t.arrayBuffer.byteLength/e.bytesPerElement,e._refreshViews(),e}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(t){this.reserve(t),this.length=t}reserve(t){if(t>this.capacity){this.capacity=Math.max(t,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const e=this.uint8;this._refreshViews(),e&&this.uint8.set(e)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}}function To(t,e=1){let n=0,i=0;return{members:t.map(t=>{const r=bo[t.type].BYTES_PER_ELEMENT,o=n=So(n,Math.max(e,r)),s=t.components||1;return i=Math.max(i,r),n+=r*s,{name:t.name,type:t.type,components:s,offset:o}}),size:So(n,Math.max(i,e)),alignment:e}}function So(t,e){return Math.ceil(t/e)*e}class Eo extends Co{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,e){const n=this.length;return this.resize(n+1),this.emplace(n,t,e)}emplace(t,e,n){const i=2*t;return this.int16[i+0]=e,this.int16[i+1]=n,t}}Eo.prototype.bytesPerElement=4,or("StructArrayLayout2i4",Eo);class ko extends Co{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,e,n,i){const r=this.length;return this.resize(r+1),this.emplace(r,t,e,n,i)}emplace(t,e,n,i,r){const o=4*t;return this.int16[o+0]=e,this.int16[o+1]=n,this.int16[o+2]=i,this.int16[o+3]=r,t}}ko.prototype.bytesPerElement=8,or("StructArrayLayout4i8",ko);class Ao extends Co{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,e,n,i,r,o,s){const a=this.length;return this.resize(a+1),this.emplace(a,t,e,n,i,r,o,s)}emplace(t,e,n,i,r,o,s,a){const l=6*t,c=12*t,u=3*t;return this.int16[l+0]=e,this.int16[l+1]=n,this.uint8[c+4]=i,this.uint8[c+5]=r,this.uint8[c+6]=o,this.uint8[c+7]=s,this.float32[u+2]=a,t}}Ao.prototype.bytesPerElement=12,or("StructArrayLayout2i4ub1f12",Ao);class Io extends Co{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,e){const n=this.length;return this.resize(n+1),this.emplace(n,t,e)}emplace(t,e,n){const i=2*t;return this.float32[i+0]=e,this.float32[i+1]=n,t}}Io.prototype.bytesPerElement=8,or("StructArrayLayout2f8",Io);class Po extends Co{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,e,n,i,r,o,s,a,l,c){const u=this.length;return this.resize(u+1),this.emplace(u,t,e,n,i,r,o,s,a,l,c)}emplace(t,e,n,i,r,o,s,a,l,c,u){const h=10*t;return this.uint16[h+0]=e,this.uint16[h+1]=n,this.uint16[h+2]=i,this.uint16[h+3]=r,this.uint16[h+4]=o,this.uint16[h+5]=s,this.uint16[h+6]=a,this.uint16[h+7]=l,this.uint16[h+8]=c,this.uint16[h+9]=u,t}}Po.prototype.bytesPerElement=20,or("StructArrayLayout10ui20",Po);class Mo extends Co{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,e,n,i,r,o,s,a){const l=this.length;return this.resize(l+1),this.emplace(l,t,e,n,i,r,o,s,a)}emplace(t,e,n,i,r,o,s,a,l){const c=8*t;return this.uint16[c+0]=e,this.uint16[c+1]=n,this.uint16[c+2]=i,this.uint16[c+3]=r,this.uint16[c+4]=o,this.uint16[c+5]=s,this.uint16[c+6]=a,this.uint16[c+7]=l,t}}Mo.prototype.bytesPerElement=16,or("StructArrayLayout8ui16",Mo);class Oo extends Co{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,e,n,i,r,o,s,a,l,c,u,h){const d=this.length;return this.resize(d+1),this.emplace(d,t,e,n,i,r,o,s,a,l,c,u,h)}emplace(t,e,n,i,r,o,s,a,l,c,u,h,d){const p=12*t;return this.int16[p+0]=e,this.int16[p+1]=n,this.int16[p+2]=i,this.int16[p+3]=r,this.uint16[p+4]=o,this.uint16[p+5]=s,this.uint16[p+6]=a,this.uint16[p+7]=l,this.int16[p+8]=c,this.int16[p+9]=u,this.int16[p+10]=h,this.int16[p+11]=d,t}}Oo.prototype.bytesPerElement=24,or("StructArrayLayout4i4ui4i24",Oo);class zo extends Co{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,e,n){const i=this.length;return this.resize(i+1),this.emplace(i,t,e,n)}emplace(t,e,n,i){const r=3*t;return this.float32[r+0]=e,this.float32[r+1]=n,this.float32[r+2]=i,t}}zo.prototype.bytesPerElement=12,or("StructArrayLayout3f12",zo);class Do extends Co{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(t){const e=this.length;return this.resize(e+1),this.emplace(e,t)}emplace(t,e){return this.uint32[1*t+0]=e,t}}Do.prototype.bytesPerElement=4,or("StructArrayLayout1ul4",Do);class Lo extends Co{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,e,n,i,r,o,s,a,l,c){const u=this.length;return this.resize(u+1),this.emplace(u,t,e,n,i,r,o,s,a,l,c)}emplace(t,e,n,i,r,o,s,a,l,c,u){const h=16*t,d=8*t;return this.int16[h+0]=e,this.int16[h+1]=n,this.float32[d+1]=i,this.float32[d+2]=r,this.float32[d+3]=o,this.float32[d+4]=s,this.int16[h+10]=a,this.uint32[d+6]=l,this.uint16[h+14]=c,this.uint16[h+15]=u,t}}Lo.prototype.bytesPerElement=32,or("StructArrayLayout2i4f1i1ul2ui32",Lo);class Ro extends Co{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,e,n,i,r,o){const s=this.length;return this.resize(s+1),this.emplace(s,t,e,n,i,r,o)}emplace(t,e,n,i,r,o,s){const a=6*t;return this.int16[a+0]=e,this.int16[a+1]=n,this.int16[a+2]=i,this.int16[a+3]=r,this.int16[a+4]=o,this.int16[a+5]=s,t}}Ro.prototype.bytesPerElement=12,or("StructArrayLayout2i2i2i12",Ro);class Fo extends Co{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,e,n,i,r){const o=this.length;return this.resize(o+1),this.emplace(o,t,e,n,i,r)}emplace(t,e,n,i,r,o){const s=4*t,a=8*t;return this.float32[s+0]=e,this.float32[s+1]=n,this.float32[s+2]=i,this.int16[a+6]=r,this.int16[a+7]=o,t}}Fo.prototype.bytesPerElement=16,or("StructArrayLayout2f1f2i16",Fo);class Bo extends Co{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,e,n,i){const r=this.length;return this.resize(r+1),this.emplace(r,t,e,n,i)}emplace(t,e,n,i,r){const o=12*t,s=3*t;return this.uint8[o+0]=e,this.uint8[o+1]=n,this.float32[s+1]=i,this.float32[s+2]=r,t}}Bo.prototype.bytesPerElement=12,or("StructArrayLayout2ub2f12",Bo);class Vo extends Co{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,e,n){const i=this.length;return this.resize(i+1),this.emplace(i,t,e,n)}emplace(t,e,n,i){const r=3*t;return this.uint16[r+0]=e,this.uint16[r+1]=n,this.uint16[r+2]=i,t}}Vo.prototype.bytesPerElement=6,or("StructArrayLayout3ui6",Vo);class Uo extends Co{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,e,n,i,r,o,s,a,l,c,u,h,d,p,f,m,g){const _=this.length;return this.resize(_+1),this.emplace(_,t,e,n,i,r,o,s,a,l,c,u,h,d,p,f,m,g)}emplace(t,e,n,i,r,o,s,a,l,c,u,h,d,p,f,m,g,_){const y=24*t,v=12*t,x=48*t;return this.int16[y+0]=e,this.int16[y+1]=n,this.uint16[y+2]=i,this.uint16[y+3]=r,this.uint32[v+2]=o,this.uint32[v+3]=s,this.uint32[v+4]=a,this.uint16[y+10]=l,this.uint16[y+11]=c,this.uint16[y+12]=u,this.float32[v+7]=h,this.float32[v+8]=d,this.uint8[x+36]=p,this.uint8[x+37]=f,this.uint8[x+38]=m,this.uint32[v+10]=g,this.int16[y+22]=_,t}}Uo.prototype.bytesPerElement=48,or("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",Uo);class No extends Co{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,e,n,i,r,o,s,a,l,c,u,h,d,p,f,m,g,_,y,v,x,b,w,C,T,S,E,k){const A=this.length;return this.resize(A+1),this.emplace(A,t,e,n,i,r,o,s,a,l,c,u,h,d,p,f,m,g,_,y,v,x,b,w,C,T,S,E,k)}emplace(t,e,n,i,r,o,s,a,l,c,u,h,d,p,f,m,g,_,y,v,x,b,w,C,T,S,E,k,A){const I=34*t,P=17*t;return this.int16[I+0]=e,this.int16[I+1]=n,this.int16[I+2]=i,this.int16[I+3]=r,this.int16[I+4]=o,this.int16[I+5]=s,this.int16[I+6]=a,this.int16[I+7]=l,this.uint16[I+8]=c,this.uint16[I+9]=u,this.uint16[I+10]=h,this.uint16[I+11]=d,this.uint16[I+12]=p,this.uint16[I+13]=f,this.uint16[I+14]=m,this.uint16[I+15]=g,this.uint16[I+16]=_,this.uint16[I+17]=y,this.uint16[I+18]=v,this.uint16[I+19]=x,this.uint16[I+20]=b,this.uint16[I+21]=w,this.uint16[I+22]=C,this.uint32[P+12]=T,this.float32[P+13]=S,this.float32[P+14]=E,this.float32[P+15]=k,this.float32[P+16]=A,t}}No.prototype.bytesPerElement=68,or("StructArrayLayout8i15ui1ul4f68",No);class jo extends Co{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t){const e=this.length;return this.resize(e+1),this.emplace(e,t)}emplace(t,e){return this.float32[1*t+0]=e,t}}jo.prototype.bytesPerElement=4,or("StructArrayLayout1f4",jo);class qo extends Co{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,e,n){const i=this.length;return this.resize(i+1),this.emplace(i,t,e,n)}emplace(t,e,n,i){const r=3*t;return this.int16[r+0]=e,this.int16[r+1]=n,this.int16[r+2]=i,t}}qo.prototype.bytesPerElement=6,or("StructArrayLayout3i6",qo);class $o extends Co{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,e,n,i){const r=this.length;return this.resize(r+1),this.emplace(r,t,e,n,i)}emplace(t,e,n,i,r){const o=6*t;return this.uint32[3*t+0]=e,this.uint16[o+2]=n,this.uint16[o+3]=i,this.uint16[o+4]=r,t}}$o.prototype.bytesPerElement=12,or("StructArrayLayout1ul3ui12",$o);class Go extends Co{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,e){const n=this.length;return this.resize(n+1),this.emplace(n,t,e)}emplace(t,e,n){const i=2*t;return this.uint16[i+0]=e,this.uint16[i+1]=n,t}}Go.prototype.bytesPerElement=4,or("StructArrayLayout2ui4",Go);class Zo extends Co{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t){const e=this.length;return this.resize(e+1),this.emplace(e,t)}emplace(t,e){return this.uint16[1*t+0]=e,t}}Zo.prototype.bytesPerElement=2,or("StructArrayLayout1ui2",Zo);class Ho extends Co{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,e,n,i){const r=this.length;return this.resize(r+1),this.emplace(r,t,e,n,i)}emplace(t,e,n,i,r){const o=4*t;return this.float32[o+0]=e,this.float32[o+1]=n,this.float32[o+2]=i,this.float32[o+3]=r,t}}Ho.prototype.bytesPerElement=16,or("StructArrayLayout4f16",Ho);class Wo extends wo{get anchorPointX(){return this._structArray.int16[this._pos2+0]}get anchorPointY(){return this._structArray.int16[this._pos2+1]}get x1(){return this._structArray.float32[this._pos4+1]}get y1(){return this._structArray.float32[this._pos4+2]}get x2(){return this._structArray.float32[this._pos4+3]}get y2(){return this._structArray.float32[this._pos4+4]}get padding(){return this._structArray.int16[this._pos2+10]}get featureIndex(){return this._structArray.uint32[this._pos4+6]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+14]}get bucketIndex(){return this._structArray.uint16[this._pos2+15]}get anchorPoint(){return new r(this.anchorPointX,this.anchorPointY)}}Wo.prototype.size=32;class Xo extends Lo{get(t){return new Wo(this,t)}}or("CollisionBoxArray",Xo);class Ko extends wo{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+2]}get numGlyphs(){return this._structArray.uint16[this._pos2+3]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+2]}get lineStartIndex(){return this._structArray.uint32[this._pos4+3]}get lineLength(){return this._structArray.uint32[this._pos4+4]}get segment(){return this._structArray.uint16[this._pos2+10]}get lowerSize(){return this._structArray.uint16[this._pos2+11]}get upperSize(){return this._structArray.uint16[this._pos2+12]}get lineOffsetX(){return this._structArray.float32[this._pos4+7]}get lineOffsetY(){return this._structArray.float32[this._pos4+8]}get writingMode(){return this._structArray.uint8[this._pos1+36]}get placedOrientation(){return this._structArray.uint8[this._pos1+37]}set placedOrientation(t){this._structArray.uint8[this._pos1+37]=t}get hidden(){return this._structArray.uint8[this._pos1+38]}set hidden(t){this._structArray.uint8[this._pos1+38]=t}get crossTileID(){return this._structArray.uint32[this._pos4+10]}set crossTileID(t){this._structArray.uint32[this._pos4+10]=t}get associatedIconIndex(){return this._structArray.int16[this._pos2+22]}}Ko.prototype.size=48;class Yo extends Uo{get(t){return new Ko(this,t)}}or("PlacedSymbolArray",Yo);class Jo extends wo{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+2]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+3]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+4]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+5]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+6]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+7]}get key(){return this._structArray.uint16[this._pos2+8]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+9]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+10]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+11]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+12]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+13]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+14]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get featureIndex(){return this._structArray.uint16[this._pos2+17]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+18]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+19]}get numIconVertices(){return this._structArray.uint16[this._pos2+20]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+21]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+22]}get crossTileID(){return this._structArray.uint32[this._pos4+12]}set crossTileID(t){this._structArray.uint32[this._pos4+12]=t}get textBoxScale(){return this._structArray.float32[this._pos4+13]}get textOffset0(){return this._structArray.float32[this._pos4+14]}get textOffset1(){return this._structArray.float32[this._pos4+15]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+16]}}Jo.prototype.size=68;class Qo extends No{get(t){return new Jo(this,t)}}or("SymbolInstanceArray",Qo);class ts extends jo{getoffsetX(t){return this.float32[1*t+0]}}or("GlyphOffsetArray",ts);class es extends qo{getx(t){return this.int16[3*t+0]}gety(t){return this.int16[3*t+1]}gettileUnitDistanceFromAnchor(t){return this.int16[3*t+2]}}or("SymbolLineVertexArray",es);class ns extends wo{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}get layoutVertexArrayOffset(){return this._structArray.uint16[this._pos2+4]}}ns.prototype.size=12;class is extends $o{get(t){return new ns(this,t)}}or("FeatureIndexArray",is);class rs extends wo{get a_centroid_pos0(){return this._structArray.uint16[this._pos2+0]}get a_centroid_pos1(){return this._structArray.uint16[this._pos2+1]}}rs.prototype.size=4;class os extends Go{get(t){return new rs(this,t)}}or("FillExtrusionCentroidArray",os);const ss=To([{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"}]),as=To([{name:"a_dash_to",components:4,type:"Uint16"},{name:"a_dash_from",components:4,type:"Uint16"}]);var ls=le(function(t){t.exports=function(t,e){var n,i,r,o,s,a,l,c;for(i=t.length-(n=3&t.length),r=e,s=3432918353,a=461845907,c=0;c<i;)l=255&t.charCodeAt(c)|(255&t.charCodeAt(++c))<<8|(255&t.charCodeAt(++c))<<16|(255&t.charCodeAt(++c))<<24,++c,r=27492+(65535&(o=5*(65535&(r=(r^=l=(65535&(l=(l=(65535&l)*s+(((l>>>16)*s&65535)<<16)&4294967295)<<15|l>>>17))*a+(((l>>>16)*a&65535)<<16)&4294967295)<<13|r>>>19))+((5*(r>>>16)&65535)<<16)&4294967295))+((58964+(o>>>16)&65535)<<16);switch(l=0,n){case 3:l^=(255&t.charCodeAt(c+2))<<16;case 2:l^=(255&t.charCodeAt(c+1))<<8;case 1:r^=l=(65535&(l=(l=(65535&(l^=255&t.charCodeAt(c)))*s+(((l>>>16)*s&65535)<<16)&4294967295)<<15|l>>>17))*a+(((l>>>16)*a&65535)<<16)&4294967295}return r^=t.length,r=2246822507*(65535&(r^=r>>>16))+((2246822507*(r>>>16)&65535)<<16)&4294967295,r=3266489909*(65535&(r^=r>>>13))+((3266489909*(r>>>16)&65535)<<16)&4294967295,(r^=r>>>16)>>>0}}),cs=le(function(t){t.exports=function(t,e){for(var n,i=t.length,r=e^i,o=0;i>=4;)n=1540483477*(65535&(n=255&t.charCodeAt(o)|(255&t.charCodeAt(++o))<<8|(255&t.charCodeAt(++o))<<16|(255&t.charCodeAt(++o))<<24))+((1540483477*(n>>>16)&65535)<<16),r=1540483477*(65535&r)+((1540483477*(r>>>16)&65535)<<16)^(n=1540483477*(65535&(n^=n>>>24))+((1540483477*(n>>>16)&65535)<<16)),i-=4,++o;switch(i){case 3:r^=(255&t.charCodeAt(o+2))<<16;case 2:r^=(255&t.charCodeAt(o+1))<<8;case 1:r=1540483477*(65535&(r^=255&t.charCodeAt(o)))+((1540483477*(r>>>16)&65535)<<16)}return r=1540483477*(65535&(r^=r>>>13))+((1540483477*(r>>>16)&65535)<<16),(r^=r>>>15)>>>0}}),us=ls,hs=cs;us.murmur3=ls,us.murmur2=hs;class ds{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(t,e,n,i){this.ids.push(ps(t)),this.positions.push(e,n,i)}getPositions(t){const e=ps(t);let n=0,i=this.ids.length-1;for(;n<i;){const t=n+i>>1;this.ids[t]>=e?i=t:n=t+1}const r=[];for(;this.ids[n]===e;)r.push({index:this.positions[3*n],start:this.positions[3*n+1],end:this.positions[3*n+2]}),n++;return r}static serialize(t,e){const n=new Float64Array(t.ids),i=new Uint32Array(t.positions);return fs(n,i,0,n.length-1),e&&e.push(n.buffer,i.buffer),{ids:n,positions:i}}static deserialize(t){const e=new ds;return e.ids=t.ids,e.positions=t.positions,e.indexed=!0,e}}function ps(t){const e=+t;return!isNaN(e)&&e<=a?e:us(String(t))}function fs(t,e,n,i){for(;n<i;){const r=t[n+i>>1];let o=n-1,s=i+1;for(;;){do{o++}while(t[o]<r);do{s--}while(t[s]>r);if(o>=s)break;ms(t,o,s),ms(e,3*o,3*s),ms(e,3*o+1,3*s+1),ms(e,3*o+2,3*s+2)}s-n<i-s?(fs(t,e,n,s),n=s+1):(fs(t,e,s+1,i),i=s)}}function ms(t,e,n){const i=t[e];t[e]=t[n],t[n]=i}or("FeaturePositionMap",ds);class gs{constructor(t,e){this.gl=t.gl,this.location=e}}class _s extends gs{constructor(t,e){super(t,e),this.current=0}set(t){this.current!==t&&(this.current=t,this.gl.uniform1f(this.location,t))}}class ys extends gs{constructor(t,e){super(t,e),this.current=[0,0,0,0]}set(t){t[0]===this.current[0]&&t[1]===this.current[1]&&t[2]===this.current[2]&&t[3]===this.current[3]||(this.current=t,this.gl.uniform4f(this.location,t[0],t[1],t[2],t[3]))}}class vs extends gs{constructor(t,e){super(t,e),this.current=ue.transparent}set(t){t.r===this.current.r&&t.g===this.current.g&&t.b===this.current.b&&t.a===this.current.a||(this.current=t,this.gl.uniform4f(this.location,t.r,t.g,t.b,t.a))}}const xs=new Float32Array(16),bs=new Float32Array(9);function ws(t){return[xo(255*t.r,255*t.g),xo(255*t.b,255*t.a)]}class Cs{constructor(t,e,n){this.value=t,this.uniformNames=e.map(t=>"u_"+t),this.type=n}setUniform(t,e,n){t.set(n.constantOr(this.value))}getBinding(t,e,n){return"color"===this.type?new vs(t,e):new _s(t,e)}}class Ts{constructor(t,e){this.uniformNames=e.map(t=>"u_"+t),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1}setConstantPatternPositions(t,e){this.pixelRatioFrom=e.pixelRatio,this.pixelRatioTo=t.pixelRatio,this.patternFrom=e.tl.concat(e.br),this.patternTo=t.tl.concat(t.br)}setUniform(t,e,n,i){const r="u_pattern_to"===i||"u_dash_to"===i?this.patternTo:"u_pattern_from"===i||"u_dash_from"===i?this.patternFrom:"u_pixel_ratio_to"===i?this.pixelRatioTo:"u_pixel_ratio_from"===i?this.pixelRatioFrom:null;r&&t.set(r)}getBinding(t,e,n){return"u_pattern_from"===n||"u_pattern_to"===n||"u_dash_from"===n||"u_dash_to"===n?new ys(t,e):new _s(t,e)}}class Ss{constructor(t,e,n,i){this.expression=t,this.type=n,this.maxValue=0,this.paintVertexAttributes=e.map(t=>({name:"a_"+t,type:"Float32",components:"color"===n?2:1,offset:0})),this.paintVertexArray=new i}populatePaintArray(t,e,n,i,r){const o=this.paintVertexArray.length,s=this.expression.evaluate(new ro(0),e,{},i,[],r);this.paintVertexArray.resize(t),this._setPaintValue(o,t,s)}updatePaintArray(t,e,n,i){const r=this.expression.evaluate({zoom:0},n,i);this._setPaintValue(t,e,r)}_setPaintValue(t,e,n){if("color"===this.type){const i=ws(n);for(let n=t;n<e;n++)this.paintVertexArray.emplace(n,i[0],i[1])}else{for(let i=t;i<e;i++)this.paintVertexArray.emplace(i,n);this.maxValue=Math.max(this.maxValue,Math.abs(n))}}upload(t){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=t.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class Es{constructor(t,e,n,i,r,o){this.expression=t,this.uniformNames=e.map(t=>`u_${t}_t`),this.type=n,this.useIntegerZoom=i,this.zoom=r,this.maxValue=0,this.paintVertexAttributes=e.map(t=>({name:"a_"+t,type:"Float32",components:"color"===n?4:2,offset:0})),this.paintVertexArray=new o}populatePaintArray(t,e,n,i,r){const o=this.expression.evaluate(new ro(this.zoom),e,{},i,[],r),s=this.expression.evaluate(new ro(this.zoom+1),e,{},i,[],r),a=this.paintVertexArray.length;this.paintVertexArray.resize(t),this._setPaintValue(a,t,o,s)}updatePaintArray(t,e,n,i){const r=this.expression.evaluate({zoom:this.zoom},n,i),o=this.expression.evaluate({zoom:this.zoom+1},n,i);this._setPaintValue(t,e,r,o)}_setPaintValue(t,e,n,i){if("color"===this.type){const r=ws(n),o=ws(i);for(let n=t;n<e;n++)this.paintVertexArray.emplace(n,r[0],r[1],o[0],o[1])}else{for(let r=t;r<e;r++)this.paintVertexArray.emplace(r,n,i);this.maxValue=Math.max(this.maxValue,Math.abs(n),Math.abs(i))}}upload(t){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=t.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(t,e){const n=this.useIntegerZoom?Math.floor(e.zoom):e.zoom,i=m(this.expression.interpolationFactor(n,this.zoom,this.zoom+1),0,1);t.set(i)}getBinding(t,e,n){return new _s(t,e)}}class ks{constructor(t,e,n,i,r,o,s){this.expression=t,this.type=n,this.useIntegerZoom=i,this.zoom=r,this.layerId=s,this.paintVertexAttributes=("array"===n?as:ss).members;for(let a=0;a<e.length;++a);this.zoomInPaintVertexArray=new o,this.zoomOutPaintVertexArray=new o}populatePaintArray(t,e,n){const i=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(t),this.zoomOutPaintVertexArray.resize(t),this._setPaintValues(i,t,e.patterns&&e.patterns[this.layerId],n)}updatePaintArray(t,e,n,i,r){this._setPaintValues(t,e,n.patterns&&n.patterns[this.layerId],r)}_setPaintValues(t,e,n,i){if(!i||!n)return;const{min:r,mid:o,max:s}=n,a=i[r],l=i[o],c=i[s];if(a&&l&&c)for(let u=t;u<e;u++)this._setPaintValue(this.zoomInPaintVertexArray,u,l,a),this._setPaintValue(this.zoomOutPaintVertexArray,u,l,c)}_setPaintValue(t,e,n,i){t.emplace(e,n.tl[0],n.tl[1],n.br[0],n.br[1],i.tl[0],i.tl[1],i.br[0],i.br[1],n.pixelRatio,i.pixelRatio)}upload(t){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=t.createVertexBuffer(this.zoomInPaintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=t.createVertexBuffer(this.zoomOutPaintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()}}class As{constructor(t,e,n=(()=>!0)){this.binders={},this._buffers=[];const i=[];for(const r in t.paint._values){if(!n(r))continue;const o=t.paint.get(r);if(!(o instanceof ho&&Wn(o.property.specification)))continue;const s=Ms(r,t.type),a=o.value,l=o.property.specification.type,c=o.property.useIntegerZoom,u=o.property.specification["property-type"],h="cross-faded"===u||"cross-faded-data-driven"===u,d="line-dasharray"===String(r)&&"constant"!==t.layout.get("line-cap").value.kind;if("constant"!==a.kind||d)if("source"===a.kind||d||h){const n=Ds(r,l,"source");this.binders[r]=h?new ks(a,s,l,c,e,n,t.id):new Ss(a,s,l,n),i.push("/a_"+r)}else{const t=Ds(r,l,"composite");this.binders[r]=new Es(a,s,l,c,e,t),i.push("/z_"+r)}else this.binders[r]=h?new Ts(a.value,s):new Cs(a.value,s,l),i.push("/u_"+r)}this.cacheKey=i.sort().join("")}getMaxValue(t){const e=this.binders[t];return e instanceof Ss||e instanceof Es?e.maxValue:0}populatePaintArrays(t,e,n,i,r){for(const o in this.binders){const s=this.binders[o];(s instanceof Ss||s instanceof Es||s instanceof ks)&&s.populatePaintArray(t,e,n,i,r)}}setConstantPatternPositions(t,e){for(const n in this.binders){const i=this.binders[n];i instanceof Ts&&i.setConstantPatternPositions(t,e)}}updatePaintArrays(t,e,n,i,r){let o=!1;for(const s in t){const a=e.getPositions(s);for(const e of a){const a=n.feature(e.index);for(const n in this.binders){const l=this.binders[n];if((l instanceof Ss||l instanceof Es||l instanceof ks)&&!0===l.expression.isStateDependent){const c=i.paint.get(n);l.expression=c.value,l.updatePaintArray(e.start,e.end,a,t[s],r),o=!0}}}}return o}defines(){const t=[];for(const e in this.binders){const n=this.binders[e];(n instanceof Cs||n instanceof Ts)&&t.push(...n.uniformNames.map(t=>"#define HAS_UNIFORM_"+t))}return t}getBinderAttributes(){const t=[];for(const e in this.binders){const n=this.binders[e];if(n instanceof Ss||n instanceof Es||n instanceof ks)for(let e=0;e<n.paintVertexAttributes.length;e++)t.push(n.paintVertexAttributes[e].name)}return t}getBinderUniforms(){const t=[];for(const e in this.binders){const n=this.binders[e];if(n instanceof Cs||n instanceof Ts||n instanceof Es)for(const e of n.uniformNames)t.push(e)}return t}getPaintVertexBuffers(){return this._buffers}getUniforms(t,e){const n=[];for(const i in this.binders){const r=this.binders[i];if(r instanceof Cs||r instanceof Ts||r instanceof Es)for(const o of r.uniformNames)if(e[o]){const s=r.getBinding(t,e[o],o);n.push({name:o,property:i,binding:s})}}return n}setUniforms(t,e,n,i){for(const{name:r,property:o,binding:s}of e)this.binders[o].setUniform(s,i,n.get(o),r)}updatePaintBuffers(t){this._buffers=[];for(const e in this.binders){const n=this.binders[e];if(t&&n instanceof ks){const e=2===t.fromScale?n.zoomInPaintVertexBuffer:n.zoomOutPaintVertexBuffer;e&&this._buffers.push(e)}else(n instanceof Ss||n instanceof Es)&&n.paintVertexBuffer&&this._buffers.push(n.paintVertexBuffer)}}upload(t){for(const e in this.binders){const n=this.binders[e];(n instanceof Ss||n instanceof Es||n instanceof ks)&&n.upload(t)}this.updatePaintBuffers()}destroy(){for(const t in this.binders){const e=this.binders[t];(e instanceof Ss||e instanceof Es||e instanceof ks)&&e.destroy()}}}class Is{constructor(t,e,n=(()=>!0)){this.programConfigurations={};for(const i of t)this.programConfigurations[i.id]=new As(i,e,n);this.needsUpload=!1,this._featureMap=new ds,this._bufferOffset=0}populatePaintArrays(t,e,n,i,r,o){for(const s in this.programConfigurations)this.programConfigurations[s].populatePaintArrays(t,e,i,r,o);void 0!==e.id&&this._featureMap.add(e.id,n,this._bufferOffset,t),this._bufferOffset=t,this.needsUpload=!0}updatePaintArrays(t,e,n,i){for(const r of n)this.needsUpload=this.programConfigurations[r.id].updatePaintArrays(t,this._featureMap,e,r,i)||this.needsUpload}get(t){return this.programConfigurations[t]}upload(t){if(this.needsUpload){for(const e in this.programConfigurations)this.programConfigurations[e].upload(t);this.needsUpload=!1}}destroy(){for(const t in this.programConfigurations)this.programConfigurations[t].destroy()}}const Ps={"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"line-dasharray":["dash_to","dash_from"]};function Ms(t,e){return Ps[t]||[t.replace(e+"-","").replace(/-/g,"_")]}const Os={"line-pattern":{source:Po,composite:Po},"fill-pattern":{source:Po,composite:Po},"fill-extrusion-pattern":{source:Po,composite:Po},"line-dasharray":{source:Mo,composite:Mo}},zs={color:{source:Io,composite:Ho},number:{source:jo,composite:Io}};function Ds(t,e,n){const i=Os[t];return i&&i[n]||zs[e][n]}or("ConstantBinder",Cs),or("CrossFadedConstantBinder",Ts),or("SourceExpressionBinder",Ss),or("CrossFadedCompositeBinder",ks),or("CompositeExpressionBinder",Es),or("ProgramConfiguration",As,{omit:["_buffers"]}),or("ProgramConfigurationSet",Is);const Ls="-transition";class Rs extends Ft{constructor(t,e){if(super(),this.id=t.id,this.type=t.type,this._featureFilter={filter:()=>!0,needGeometry:!1},"custom"!==t.type&&(this.metadata=(t=t).metadata,this.minzoom=t.minzoom,this.maxzoom=t.maxzoom,"background"!==t.type&&"sky"!==t.type&&(this.source=t.source,this.sourceLayer=t["source-layer"],this.filter=t.filter),e.layout&&(this._unevaluatedLayout=new uo(e.layout)),e.paint)){this._transitionablePaint=new ao(e.paint);for(const e in t.paint)this.setPaintProperty(e,t.paint[e],{validate:!1});for(const e in t.layout)this.setLayoutProperty(e,t.layout[e],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new po(e.paint)}}getCrossfadeParameters(){return this._crossfadeParameters}getLayoutProperty(t){return"visibility"===t?this.visibility:this._unevaluatedLayout.getValue(t)}setLayoutProperty(t,e,n={}){null!=e&&this._validate(Ji,`layers.${this.id}.layout.${t}`,t,e,n)||("visibility"!==t?this._unevaluatedLayout.setValue(t,e):this.visibility=e)}getPaintProperty(t){return E(t,Ls)?this._transitionablePaint.getTransition(t.slice(0,-Ls.length)):this._transitionablePaint.getValue(t)}setPaintProperty(t,e,n={}){if(null!=e&&this._validate(Yi,`layers.${this.id}.paint.${t}`,t,e,n))return!1;if(E(t,Ls))return this._transitionablePaint.setTransition(t.slice(0,-Ls.length),e||void 0),!1;{const n=this._transitionablePaint._values[t],i="cross-faded-data-driven"===n.property.specification["property-type"],r=n.value.isDataDriven(),o=n.value;this._transitionablePaint.setValue(t,e),this._handleSpecialPaintPropertyUpdate(t);const s=this._transitionablePaint._values[t].value;return s.isDataDriven()||r||i||this._handleOverridablePaintPropertyUpdate(t,o,s)}}_handleSpecialPaintPropertyUpdate(t){}getProgramIds(){return null}getProgramConfiguration(t){return null}_handleOverridablePaintPropertyUpdate(t,e,n){return!1}isHidden(t){return!!(this.minzoom&&t<this.minzoom)||!!(this.maxzoom&&t>=this.maxzoom)||"none"===this.visibility}updateTransitions(t){this._transitioningPaint=this._transitionablePaint.transitioned(t,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(t,e){t.getCrossfadeParameters&&(this._crossfadeParameters=t.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(t,void 0,e)),this.paint=this._transitioningPaint.possiblyEvaluate(t,void 0,e)}serialize(){const t={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(t.layout=t.layout||{},t.layout.visibility=this.visibility),A(t,(t,e)=>!(void 0===t||"layout"===e&&!Object.keys(t).length||"paint"===e&&!Object.keys(t).length))}_validate(t,e,n,i,r={}){return(!r||!1!==r.validate)&&Qi(this,t.call(Wi,{key:e,layerType:this.type,objectKey:n,value:i,styleSpec:Bt,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isSky(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const t in this.paint._values){const e=this.paint.get(t);if(e instanceof ho&&Wn(e.property.specification)&&("source"===e.value.kind||"composite"===e.value.kind)&&e.value.isStateDependent)return!0}return!1}}const Fs=To([{name:"a_pos",components:2,type:"Int16"}],4),{members:Bs}=Fs;class Vs{constructor(t=[]){this.segments=t}prepareSegment(t,e,n,i){let r=this.segments[this.segments.length-1];return t>Vs.MAX_VERTEX_ARRAY_LENGTH&&M(`Max vertices per segment is ${Vs.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${t}`),(!r||r.vertexLength+t>Vs.MAX_VERTEX_ARRAY_LENGTH||r.sortKey!==i)&&(r={vertexOffset:e.length,primitiveOffset:n.length,vertexLength:0,primitiveLength:0},void 0!==i&&(r.sortKey=i),this.segments.push(r)),r}get(){return this.segments}destroy(){for(const t of this.segments)for(const e in t.vaos)t.vaos[e].destroy()}static simpleSegment(t,e,n,i){return new Vs([{vertexOffset:t,primitiveOffset:e,vertexLength:n,primitiveLength:i,vaos:{},sortKey:0}])}}Vs.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,or("SegmentVector",Vs);var Us=8192;const Ns=Math.pow(2,14)-1,js=-Ns-1;function qs(t){const e=Us/t.extent,n=t.loadGeometry();for(let i=0;i<n.length;i++){const t=n[i];for(let n=0;n<t.length;n++){const i=t[n],r=Math.round(i.x*e),o=Math.round(i.y*e);i.x=m(r,js,Ns),i.y=m(o,js,Ns),(r<i.x||r>i.x+1||o<i.y||o>i.y+1)&&M("Geometry exceeds allowed extent, reduce your vector tile buffer size")}}return n}function $s(t,e){return{type:t.type,id:t.id,properties:t.properties,geometry:e?qs(t):[]}}function Gs(t,e,n,i,r){t.emplaceBack(2*e+(i+1)/2,2*n+(r+1)/2)}class Zs{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(t=>t.id),this.index=t.index,this.hasPattern=!1,this.layoutVertexArray=new Eo,this.indexArray=new Vo,this.segments=new Vs,this.programConfigurations=new Is(t.layers,t.zoom),this.stateDependentLayerIds=this.layers.filter(t=>t.isStateDependent()).map(t=>t.id)}populate(t,e,n){const i=this.layers[0],r=[];let o=null;"circle"===i.type&&(o=i.layout.get("circle-sort-key"));for(const{feature:s,id:a,index:l,sourceLayerIndex:c}of t){const t=this.layers[0]._featureFilter.needGeometry,e=$s(s,t);if(!this.layers[0]._featureFilter.filter(new ro(this.zoom),e,n))continue;const i=o?o.evaluate(e,{},n):void 0,u={id:a,properties:s.properties,type:s.type,sourceLayerIndex:c,index:l,geometry:t?e.geometry:qs(s),patterns:{},sortKey:i};r.push(u)}o&&r.sort((t,e)=>t.sortKey-e.sortKey);for(const s of r){const{geometry:i,index:r,sourceLayerIndex:o}=s,a=t[r].feature;this.addFeature(s,i,r,n),e.featureIndex.insert(a,i,r,o,this.index)}}update(t,e,n){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,e,this.stateDependentLayers,n)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,Bs),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(t,e,n,i){for(const r of e)for(const e of r){const n=e.x,i=e.y;if(n<0||n>=Us||i<0||i>=Us)continue;const r=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,t.sortKey),o=r.vertexLength;Gs(this.layoutVertexArray,n,i,-1,-1),Gs(this.layoutVertexArray,n,i,1,-1),Gs(this.layoutVertexArray,n,i,1,1),Gs(this.layoutVertexArray,n,i,-1,1),this.indexArray.emplaceBack(o,o+1,o+2),this.indexArray.emplaceBack(o,o+3,o+2),r.vertexLength+=4,r.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,n,{},i)}}function Hs(t,e){for(let n=0;n<t.length;n++)if(na(e,t[n]))return!0;for(let n=0;n<e.length;n++)if(na(t,e[n]))return!0;return!!Ys(t,e)}function Ws(t,e,n){return!!na(t,e)||!!Qs(e,t,n)}function Xs(t,e){if(1===t.length)return ea(e,t[0]);for(let n=0;n<e.length;n++){const i=e[n];for(let e=0;e<i.length;e++)if(na(t,i[e]))return!0}for(let n=0;n<t.length;n++)if(ea(e,t[n]))return!0;for(let n=0;n<e.length;n++)if(Ys(t,e[n]))return!0;return!1}function Ks(t,e,n){if(t.length>1){if(Ys(t,e))return!0;for(let i=0;i<e.length;i++)if(Qs(e[i],t,n))return!0}for(let i=0;i<t.length;i++)if(Qs(t[i],e,n))return!0;return!1}function Ys(t,e){if(0===t.length||0===e.length)return!1;for(let n=0;n<t.length-1;n++){const i=t[n],r=t[n+1];for(let t=0;t<e.length-1;t++)if(Js(i,r,e[t],e[t+1]))return!0}return!1}function Js(t,e,n,i){return O(t,n,i)!==O(e,n,i)&&O(t,e,n)!==O(t,e,i)}function Qs(t,e,n){const i=n*n;if(1===e.length)return t.distSqr(e[0])<i;for(let r=1;r<e.length;r++)if(ta(t,e[r-1],e[r])<i)return!0;return!1}function ta(t,e,n){const i=e.distSqr(n);if(0===i)return t.distSqr(e);const r=((t.x-e.x)*(n.x-e.x)+(t.y-e.y)*(n.y-e.y))/i;return t.distSqr(r<0?e:r>1?n:n.sub(e)._mult(r)._add(e))}function ea(t,e){let n,i,r,o=!1;for(let s=0;s<t.length;s++){n=t[s];for(let t=0,s=n.length-1;t<n.length;s=t++)i=n[t],r=n[s],i.y>e.y!=r.y>e.y&&e.x<(r.x-i.x)*(e.y-i.y)/(r.y-i.y)+i.x&&(o=!o)}return o}function na(t,e){let n=!1;for(let i=0,r=t.length-1;i<t.length;r=i++){const o=t[i],s=t[r];o.y>e.y!=s.y>e.y&&e.x<(s.x-o.x)*(e.y-o.y)/(s.y-o.y)+o.x&&(n=!n)}return n}function ia(t,e,n,i,o){for(const r of t)if(e<=r.x&&n<=r.y&&i>=r.x&&o>=r.y)return!0;const s=[new r(e,n),new r(e,o),new r(i,o),new r(i,n)];if(t.length>2)for(const r of s)if(na(t,r))return!0;for(let r=0;r<t.length-1;r++)if(ra(t[r],t[r+1],s))return!0;return!1}function ra(t,e,n){const i=n[0],r=n[2];if(t.x<i.x&&e.x<i.x||t.x>r.x&&e.x>r.x||t.y<i.y&&e.y<i.y||t.y>r.y&&e.y>r.y)return!1;const o=O(t,e,n[0]);return o!==O(t,e,n[1])||o!==O(t,e,n[2])||o!==O(t,e,n[3])}function oa(t,e,n){const i=e.paint.get(t).value;return"constant"===i.kind?i.value:n.programConfigurations.get(e.id).getMaxValue(t)}function sa(t){return Math.sqrt(t[0]*t[0]+t[1]*t[1])}function aa(t,e,n,i,o){if(!e[0]&&!e[1])return t;const s=r.convert(e)._mult(o);"viewport"===n&&s._rotate(-i);const a=[];for(let r=0;r<t.length;r++)a.push(t[r].sub(s));return a}function la(t,e,n,i){const o=r.convert(t)._mult(i);return"viewport"===e&&o._rotate(-n),o}or("CircleBucket",Zs,{omit:["layers"]});const ca=new vo({"circle-sort-key":new mo(Bt.layout_circle["circle-sort-key"])});var ua={paint:new vo({"circle-radius":new mo(Bt.paint_circle["circle-radius"]),"circle-color":new mo(Bt.paint_circle["circle-color"]),"circle-blur":new mo(Bt.paint_circle["circle-blur"]),"circle-opacity":new mo(Bt.paint_circle["circle-opacity"]),"circle-translate":new fo(Bt.paint_circle["circle-translate"]),"circle-translate-anchor":new fo(Bt.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new fo(Bt.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new fo(Bt.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new mo(Bt.paint_circle["circle-stroke-width"]),"circle-stroke-color":new mo(Bt.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new mo(Bt.paint_circle["circle-stroke-opacity"])}),layout:ca},ha="undefined"!=typeof Float32Array?Float32Array:Array;function da(){var t=new ha(9);return ha!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[5]=0,t[6]=0,t[7]=0),t[0]=1,t[4]=1,t[8]=1,t}function pa(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function fa(t,e,n){var i=e[0],r=e[1],o=e[2],s=e[3],a=e[4],l=e[5],c=e[6],u=e[7],h=e[8],d=e[9],p=e[10],f=e[11],m=e[12],g=e[13],_=e[14],y=e[15],v=n[0],x=n[1],b=n[2],w=n[3];return t[0]=v*i+x*a+b*h+w*m,t[1]=v*r+x*l+b*d+w*g,t[2]=v*o+x*c+b*p+w*_,t[3]=v*s+x*u+b*f+w*y,t[4]=(v=n[4])*i+(x=n[5])*a+(b=n[6])*h+(w=n[7])*m,t[5]=v*r+x*l+b*d+w*g,t[6]=v*o+x*c+b*p+w*_,t[7]=v*s+x*u+b*f+w*y,t[8]=(v=n[8])*i+(x=n[9])*a+(b=n[10])*h+(w=n[11])*m,t[9]=v*r+x*l+b*d+w*g,t[10]=v*o+x*c+b*p+w*_,t[11]=v*s+x*u+b*f+w*y,t[12]=(v=n[12])*i+(x=n[13])*a+(b=n[14])*h+(w=n[15])*m,t[13]=v*r+x*l+b*d+w*g,t[14]=v*o+x*c+b*p+w*_,t[15]=v*s+x*u+b*f+w*y,t}Math.hypot||(Math.hypot=function(){for(var t=0,e=arguments.length;e--;)t+=arguments[e]*arguments[e];return Math.sqrt(t)});var ma=fa;function ga(){var t=new ha(3);return ha!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t}function _a(t){return Math.hypot(t[0],t[1],t[2])}function ya(t,e,n){var i=new ha(3);return i[0]=t,i[1]=e,i[2]=n,i}function va(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t}function xa(t,e,n){return t[0]=e[0]*n[0],t[1]=e[1]*n[1],t[2]=e[2]*n[2],t}function ba(t,e,n,i){return t[0]=e[0]+n[0]*i,t[1]=e[1]+n[1]*i,t[2]=e[2]+n[2]*i,t}function wa(t,e){var n=e[0],i=e[1],r=e[2],o=n*n+i*i+r*r;return o>0&&(o=1/Math.sqrt(o)),t[0]=e[0]*o,t[1]=e[1]*o,t[2]=e[2]*o,t}function Ca(t,e,n){var i=n[0],r=n[1],o=n[2],s=e[0],a=e[1],l=e[2],c=r*l-o*a,u=o*s-i*l,h=i*a-r*s,d=r*h-o*u,p=o*c-i*h,f=i*u-r*c,m=2*n[3];return u*=m,h*=m,p*=2,f*=2,t[0]=s+(c*=m)+(d*=2),t[1]=a+u+p,t[2]=l+h+f,t}var Ta,Sa=va,Ea=xa,ka=_a;function Aa(t,e,n){var i=e[0],r=e[1],o=e[2],s=e[3];return t[0]=n[0]*i+n[4]*r+n[8]*o+n[12]*s,t[1]=n[1]*i+n[5]*r+n[9]*o+n[13]*s,t[2]=n[2]*i+n[6]*r+n[10]*o+n[14]*s,t[3]=n[3]*i+n[7]*r+n[11]*o+n[15]*s,t}function Ia(){var t=new ha(4);return ha!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t[3]=1,t}function Pa(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t}function Ma(t,e,n){n*=.5;var i=e[0],r=e[1],o=e[2],s=e[3],a=Math.sin(n),l=Math.cos(n);return t[0]=i*l+s*a,t[1]=r*l+o*a,t[2]=o*l-r*a,t[3]=s*l-i*a,t}function Oa(t,e,n){const i=Aa([],[t.x,t.y,e,1],n);return new r(i[0]/i[3],i[1]/i[3])}ga(),Ta=new ha(4),ha!=Float32Array&&(Ta[0]=0,Ta[1]=0,Ta[2]=0,Ta[3]=0),ga(),ya(1,0,0),ya(0,1,0),Ia(),Ia(),da();const za=ya(0,0,0),Da=ya(0,0,1);function La(t,e){const n=ga();return za[2]=e,t.intersectsPlane(za,Da,n),new r(n[0],n[1])}class Ra extends Zs{}function Fa(t,{width:e,height:n},i,r){if(r){if(r instanceof Uint8ClampedArray)r=new Uint8Array(r.buffer);else if(r.length!==e*n*i)throw new RangeError("mismatched image size")}else r=new Uint8Array(e*n*i);return t.width=e,t.height=n,t.data=r,t}function Ba(t,{width:e,height:n},i){if(e===t.width&&n===t.height)return;const r=Fa({},{width:e,height:n},i);Va(t,r,{x:0,y:0},{x:0,y:0},{width:Math.min(t.width,e),height:Math.min(t.height,n)},i),t.width=e,t.height=n,t.data=r.data}function Va(t,e,n,i,r,o){if(0===r.width||0===r.height)return e;if(r.width>t.width||r.height>t.height||n.x>t.width-r.width||n.y>t.height-r.height)throw new RangeError("out of range source coordinates for image copy");if(r.width>e.width||r.height>e.height||i.x>e.width-r.width||i.y>e.height-r.height)throw new RangeError("out of range destination coordinates for image copy");const s=t.data,a=e.data;for(let l=0;l<r.height;l++){const c=((n.y+l)*t.width+n.x)*o,u=((i.y+l)*e.width+i.x)*o;for(let t=0;t<r.width*o;t++)a[u+t]=s[c+t]}return e}or("HeatmapBucket",Ra,{omit:["layers"]});class Ua{constructor(t,e){Fa(this,t,1,e)}resize(t){Ba(this,t,1)}clone(){return new Ua({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(t,e,n,i,r){Va(t,e,n,i,r,1)}}class Na{constructor(t,e){Fa(this,t,4,e)}resize(t){Ba(this,t,4)}replace(t,e){e?this.data.set(t):this.data=t instanceof Uint8ClampedArray?new Uint8Array(t.buffer):t}clone(){return new Na({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(t,e,n,i,r){Va(t,e,n,i,r,4)}}or("AlphaImage",Ua),or("RGBAImage",Na);var ja={paint:new vo({"heatmap-radius":new mo(Bt.paint_heatmap["heatmap-radius"]),"heatmap-weight":new mo(Bt.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new fo(Bt.paint_heatmap["heatmap-intensity"]),"heatmap-color":new yo(Bt.paint_heatmap["heatmap-color"]),"heatmap-opacity":new fo(Bt.paint_heatmap["heatmap-opacity"])})};function qa(t){const e={},n=t.resolution||256,i=t.clips?t.clips.length:1,r=t.image||new Na({width:n,height:i}),o=(n,i,o)=>{e[t.evaluationKey]=o;const s=t.expression.evaluate(e);r.data[n+i+0]=Math.floor(255*s.r/s.a),r.data[n+i+1]=Math.floor(255*s.g/s.a),r.data[n+i+2]=Math.floor(255*s.b/s.a),r.data[n+i+3]=Math.floor(255*s.a)};if(t.clips)for(let s=0,a=0;s<i;++s,a+=4*n)for(let e=0,i=0;e<n;e++,i+=4){const r=e/(n-1),{start:l,end:c}=t.clips[s];o(a,i,l*(1-r)+c*r)}else for(let s=0,a=0;s<n;s++,a+=4)o(0,a,s/(n-1));return r}var $a={paint:new vo({"hillshade-illumination-direction":new fo(Bt.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new fo(Bt.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new fo(Bt.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new fo(Bt.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new fo(Bt.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new fo(Bt.paint_hillshade["hillshade-accent-color"])})};const Ga=To([{name:"a_pos",components:2,type:"Int16"}],4),{members:Za}=Ga;var Ha=Xa,Wa=Xa;function Xa(t,e,n){n=n||2;var i,r,o,s,a,l,c,u=e&&e.length,h=u?e[0]*n:t.length,d=Ka(t,0,h,n,!0),p=[];if(!d||d.next===d.prev)return p;if(u&&(d=function(t,e,n,i){var r,o,s,a=[];for(r=0,o=e.length;r<o;r++)(s=Ka(t,e[r]*i,r<o-1?e[r+1]*i:t.length,i,!1))===s.next&&(s.steiner=!0),a.push(al(s));for(a.sort(il),r=0;r<a.length;r++)rl(a[r],n),n=Ya(n,n.next);return n}(t,e,d,n)),t.length>80*n){i=o=t[0],r=s=t[1];for(var f=n;f<h;f+=n)(a=t[f])<i&&(i=a),(l=t[f+1])<r&&(r=l),a>o&&(o=a),l>s&&(s=l);c=0!==(c=Math.max(o-i,s-r))?1/c:0}return Ja(d,p,n,i,r,c),p}function Ka(t,e,n,i,r){var o,s;if(r===xl(t,e,n,i)>0)for(o=e;o<n;o+=i)s=_l(o,t[o],t[o+1],s);else for(o=n-i;o>=e;o-=i)s=_l(o,t[o],t[o+1],s);return s&&hl(s,s.next)&&(yl(s),s=s.next),s}function Ya(t,e){if(!t)return t;e||(e=t);var n,i=t;do{if(n=!1,i.steiner||!hl(i,i.next)&&0!==ul(i.prev,i,i.next))i=i.next;else{if(yl(i),(i=e=i.prev)===i.next)break;n=!0}}while(n||i!==e);return e}function Ja(t,e,n,i,r,o,s){if(t){!s&&o&&function(t,e,n,i){var r=t;do{null===r.z&&(r.z=sl(r.x,r.y,e,n,i)),r.prevZ=r.prev,r.nextZ=r.next,r=r.next}while(r!==t);r.prevZ.nextZ=null,r.prevZ=null,function(t){var e,n,i,r,o,s,a,l,c=1;do{for(n=t,t=null,o=null,s=0;n;){for(s++,i=n,a=0,e=0;e<c&&(a++,i=i.nextZ);e++);for(l=c;a>0||l>0&&i;)0!==a&&(0===l||!i||n.z<=i.z)?(r=n,n=n.nextZ,a--):(r=i,i=i.nextZ,l--),o?o.nextZ=r:t=r,r.prevZ=o,o=r;n=i}o.nextZ=null,c*=2}while(s>1)}(r)}(t,i,r,o);for(var a,l,c=t;t.prev!==t.next;)if(a=t.prev,l=t.next,o?tl(t,i,r,o):Qa(t))e.push(a.i/n),e.push(t.i/n),e.push(l.i/n),yl(t),t=l.next,c=l.next;else if((t=l)===c){s?1===s?Ja(t=el(Ya(t),e,n),e,n,i,r,o,2):2===s&&nl(t,e,n,i,r,o):Ja(Ya(t),e,n,i,r,o,1);break}}}function Qa(t){var e=t.prev,n=t,i=t.next;if(ul(e,n,i)>=0)return!1;for(var r=t.next.next;r!==t.prev;){if(ll(e.x,e.y,n.x,n.y,i.x,i.y,r.x,r.y)&&ul(r.prev,r,r.next)>=0)return!1;r=r.next}return!0}function tl(t,e,n,i){var r=t.prev,o=t,s=t.next;if(ul(r,o,s)>=0)return!1;for(var a=r.x>o.x?r.x>s.x?r.x:s.x:o.x>s.x?o.x:s.x,l=r.y>o.y?r.y>s.y?r.y:s.y:o.y>s.y?o.y:s.y,c=sl(r.x<o.x?r.x<s.x?r.x:s.x:o.x<s.x?o.x:s.x,r.y<o.y?r.y<s.y?r.y:s.y:o.y<s.y?o.y:s.y,e,n,i),u=sl(a,l,e,n,i),h=t.prevZ,d=t.nextZ;h&&h.z>=c&&d&&d.z<=u;){if(h!==t.prev&&h!==t.next&&ll(r.x,r.y,o.x,o.y,s.x,s.y,h.x,h.y)&&ul(h.prev,h,h.next)>=0)return!1;if(h=h.prevZ,d!==t.prev&&d!==t.next&&ll(r.x,r.y,o.x,o.y,s.x,s.y,d.x,d.y)&&ul(d.prev,d,d.next)>=0)return!1;d=d.nextZ}for(;h&&h.z>=c;){if(h!==t.prev&&h!==t.next&&ll(r.x,r.y,o.x,o.y,s.x,s.y,h.x,h.y)&&ul(h.prev,h,h.next)>=0)return!1;h=h.prevZ}for(;d&&d.z<=u;){if(d!==t.prev&&d!==t.next&&ll(r.x,r.y,o.x,o.y,s.x,s.y,d.x,d.y)&&ul(d.prev,d,d.next)>=0)return!1;d=d.nextZ}return!0}function el(t,e,n){var i=t;do{var r=i.prev,o=i.next.next;!hl(r,o)&&dl(r,i,i.next,o)&&ml(r,o)&&ml(o,r)&&(e.push(r.i/n),e.push(i.i/n),e.push(o.i/n),yl(i),yl(i.next),i=t=o),i=i.next}while(i!==t);return Ya(i)}function nl(t,e,n,i,r,o){var s=t;do{for(var a=s.next.next;a!==s.prev;){if(s.i!==a.i&&cl(s,a)){var l=gl(s,a);return s=Ya(s,s.next),l=Ya(l,l.next),Ja(s,e,n,i,r,o),void Ja(l,e,n,i,r,o)}a=a.next}s=s.next}while(s!==t)}function il(t,e){return t.x-e.x}function rl(t,e){if(e=function(t,e){var n,i=e,r=t.x,o=t.y,s=-1/0;do{if(o<=i.y&&o>=i.next.y&&i.next.y!==i.y){var a=i.x+(o-i.y)*(i.next.x-i.x)/(i.next.y-i.y);if(a<=r&&a>s){if(s=a,a===r){if(o===i.y)return i;if(o===i.next.y)return i.next}n=i.x<i.next.x?i:i.next}}i=i.next}while(i!==e);if(!n)return null;if(r===s)return n;var l,c=n,u=n.x,h=n.y,d=1/0;i=n;do{r>=i.x&&i.x>=u&&r!==i.x&&ll(o<h?r:s,o,u,h,o<h?s:r,o,i.x,i.y)&&(l=Math.abs(o-i.y)/(r-i.x),ml(i,t)&&(l<d||l===d&&(i.x>n.x||i.x===n.x&&ol(n,i)))&&(n=i,d=l)),i=i.next}while(i!==c);return n}(t,e)){var n=gl(e,t);Ya(e,e.next),Ya(n,n.next)}}function ol(t,e){return ul(t.prev,t,e.prev)<0&&ul(e.next,t,t.next)<0}function sl(t,e,n,i,r){return(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-n)*r)|t<<8))|t<<4))|t<<2))|t<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-i)*r)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function al(t){var e=t,n=t;do{(e.x<n.x||e.x===n.x&&e.y<n.y)&&(n=e),e=e.next}while(e!==t);return n}function ll(t,e,n,i,r,o,s,a){return(r-s)*(e-a)-(t-s)*(o-a)>=0&&(t-s)*(i-a)-(n-s)*(e-a)>=0&&(n-s)*(o-a)-(r-s)*(i-a)>=0}function cl(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!function(t,e){var n=t;do{if(n.i!==t.i&&n.next.i!==t.i&&n.i!==e.i&&n.next.i!==e.i&&dl(n,n.next,t,e))return!0;n=n.next}while(n!==t);return!1}(t,e)&&(ml(t,e)&&ml(e,t)&&function(t,e){var n=t,i=!1,r=(t.x+e.x)/2,o=(t.y+e.y)/2;do{n.y>o!=n.next.y>o&&n.next.y!==n.y&&r<(n.next.x-n.x)*(o-n.y)/(n.next.y-n.y)+n.x&&(i=!i),n=n.next}while(n!==t);return i}(t,e)&&(ul(t.prev,t,e.prev)||ul(t,e.prev,e))||hl(t,e)&&ul(t.prev,t,t.next)>0&&ul(e.prev,e,e.next)>0)}function ul(t,e,n){return(e.y-t.y)*(n.x-e.x)-(e.x-t.x)*(n.y-e.y)}function hl(t,e){return t.x===e.x&&t.y===e.y}function dl(t,e,n,i){var r=fl(ul(t,e,n)),o=fl(ul(t,e,i)),s=fl(ul(n,i,t)),a=fl(ul(n,i,e));return r!==o&&s!==a||!(0!==r||!pl(t,n,e))||!(0!==o||!pl(t,i,e))||!(0!==s||!pl(n,t,i))||!(0!==a||!pl(n,e,i))}function pl(t,e,n){return e.x<=Math.max(t.x,n.x)&&e.x>=Math.min(t.x,n.x)&&e.y<=Math.max(t.y,n.y)&&e.y>=Math.min(t.y,n.y)}function fl(t){return t>0?1:t<0?-1:0}function ml(t,e){return ul(t.prev,t,t.next)<0?ul(t,e,t.next)>=0&&ul(t,t.prev,e)>=0:ul(t,e,t.prev)<0||ul(t,t.next,e)<0}function gl(t,e){var n=new vl(t.i,t.x,t.y),i=new vl(e.i,e.x,e.y),r=t.next,o=e.prev;return t.next=e,e.prev=t,n.next=r,r.prev=n,i.next=n,n.prev=i,o.next=i,i.prev=o,i}function _l(t,e,n,i){var r=new vl(t,e,n);return i?(r.next=i.next,r.prev=i,i.next.prev=r,i.next=r):(r.prev=r,r.next=r),r}function yl(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function vl(t,e,n){this.i=t,this.x=e,this.y=n,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function xl(t,e,n,i){for(var r=0,o=e,s=n-i;o<n;o+=i)r+=(t[s]-t[o])*(t[o+1]+t[s+1]),s=o;return r}function bl(t,e,n,i,r){wl(t,e,n||0,i||t.length-1,r||Tl)}function wl(t,e,n,i,r){for(;i>n;){if(i-n>600){var o=i-n+1,s=e-n+1,a=Math.log(o),l=.5*Math.exp(2*a/3),c=.5*Math.sqrt(a*l*(o-l)/o)*(s-o/2<0?-1:1);wl(t,e,Math.max(n,Math.floor(e-s*l/o+c)),Math.min(i,Math.floor(e+(o-s)*l/o+c)),r)}var u=t[e],h=n,d=i;for(Cl(t,n,e),r(t[i],u)>0&&Cl(t,n,i);h<d;){for(Cl(t,h,d),h++,d--;r(t[h],u)<0;)h++;for(;r(t[d],u)>0;)d--}0===r(t[n],u)?Cl(t,n,d):Cl(t,++d,i),d<=e&&(n=d+1),e<=d&&(i=d-1)}}function Cl(t,e,n){var i=t[e];t[e]=t[n],t[n]=i}function Tl(t,e){return t<e?-1:t>e?1:0}function Sl(t,e){const n=t.length;if(n<=1)return[t];const i=[];let r,o;for(let s=0;s<n;s++){const e=z(t[s]);0!==e&&(t[s].area=Math.abs(e),void 0===o&&(o=e<0),o===e<0?(r&&i.push(r),r=[t[s]]):r.push(t[s]))}if(r&&i.push(r),e>1)for(let s=0;s<i.length;s++)i[s].length<=e||(bl(i[s],e,1,i[s].length-1,El),i[s]=i[s].slice(0,e));return i}function El(t,e){return e.area-t.area}function kl(t,e,n){const i=n.patternDependencies;let r=!1;for(const o of e){const e=o.paint.get(t+"-pattern");e.isConstant()||(r=!0);const n=e.constantOr(null);n&&(r=!0,i[n.to]=!0,i[n.from]=!0)}return r}function Al(t,e,n,i,r){const o=r.patternDependencies;for(const s of e){const e=s.paint.get(t+"-pattern").value;if("constant"!==e.kind){let t=e.evaluate({zoom:i-1},n,{},r.availableImages),a=e.evaluate({zoom:i},n,{},r.availableImages),l=e.evaluate({zoom:i+1},n,{},r.availableImages);t=t&&t.name?t.name:t,a=a&&a.name?a.name:a,l=l&&l.name?l.name:l,o[t]=!0,o[a]=!0,o[l]=!0,n.patterns[s.id]={min:t,mid:a,max:l}}}return n}Xa.deviation=function(t,e,n,i){var r=e&&e.length,o=Math.abs(xl(t,0,r?e[0]*n:t.length,n));if(r)for(var s=0,a=e.length;s<a;s++)o-=Math.abs(xl(t,e[s]*n,s<a-1?e[s+1]*n:t.length,n));var l=0;for(s=0;s<i.length;s+=3){var c=i[s]*n,u=i[s+1]*n,h=i[s+2]*n;l+=Math.abs((t[c]-t[h])*(t[u+1]-t[c+1])-(t[c]-t[u])*(t[h+1]-t[c+1]))}return 0===o&&0===l?0:Math.abs((l-o)/o)},Xa.flatten=function(t){for(var e=t[0][0].length,n={vertices:[],holes:[],dimensions:e},i=0,r=0;r<t.length;r++){for(var o=0;o<t[r].length;o++)for(var s=0;s<e;s++)n.vertices.push(t[r][o][s]);r>0&&n.holes.push(i+=t[r-1].length)}return n},Ha.default=Wa;class Il{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(t=>t.id),this.index=t.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new Eo,this.indexArray=new Vo,this.indexArray2=new Go,this.programConfigurations=new Is(t.layers,t.zoom),this.segments=new Vs,this.segments2=new Vs,this.stateDependentLayerIds=this.layers.filter(t=>t.isStateDependent()).map(t=>t.id)}populate(t,e,n){this.hasPattern=kl("fill",this.layers,e);const i=this.layers[0].layout.get("fill-sort-key"),r=[];for(const{feature:o,id:s,index:a,sourceLayerIndex:l}of t){const t=this.layers[0]._featureFilter.needGeometry,c=$s(o,t);if(!this.layers[0]._featureFilter.filter(new ro(this.zoom),c,n))continue;const u=i?i.evaluate(c,{},n,e.availableImages):void 0,h={id:s,properties:o.properties,type:o.type,sourceLayerIndex:l,index:a,geometry:t?c.geometry:qs(o),patterns:{},sortKey:u};r.push(h)}i&&r.sort((t,e)=>t.sortKey-e.sortKey);for(const o of r){const{geometry:i,index:r,sourceLayerIndex:s}=o;if(this.hasPattern){const t=Al("fill",this.layers,o,this.zoom,e);this.patternFeatures.push(t)}else this.addFeature(o,i,r,n,{});e.featureIndex.insert(t[r].feature,i,r,s,this.index)}}update(t,e,n){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,e,this.stateDependentLayers,n)}addFeatures(t,e,n){for(const i of this.patternFeatures)this.addFeature(i,i.geometry,i.index,e,n)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,Za),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.indexBuffer2=t.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(t,e,n,i,r){for(const o of Sl(e,500)){let t=0;for(const a of o)t+=a.length;const e=this.segments.prepareSegment(t,this.layoutVertexArray,this.indexArray),n=e.vertexLength,i=[],r=[];for(const a of o){if(0===a.length)continue;a!==o[0]&&r.push(i.length/2);const t=this.segments2.prepareSegment(a.length,this.layoutVertexArray,this.indexArray2),e=t.vertexLength;this.layoutVertexArray.emplaceBack(a[0].x,a[0].y),this.indexArray2.emplaceBack(e+a.length-1,e),i.push(a[0].x),i.push(a[0].y);for(let n=1;n<a.length;n++)this.layoutVertexArray.emplaceBack(a[n].x,a[n].y),this.indexArray2.emplaceBack(e+n-1,e+n),i.push(a[n].x),i.push(a[n].y);t.vertexLength+=a.length,t.primitiveLength+=a.length}const s=Ha(i,r);for(let o=0;o<s.length;o+=3)this.indexArray.emplaceBack(n+s[o],n+s[o+1],n+s[o+2]);e.vertexLength+=t,e.primitiveLength+=s.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,n,r,i)}}or("FillBucket",Il,{omit:["layers","patternFeatures"]});const Pl=new vo({"fill-sort-key":new mo(Bt.layout_fill["fill-sort-key"])});var Ml={paint:new vo({"fill-antialias":new fo(Bt.paint_fill["fill-antialias"]),"fill-opacity":new mo(Bt.paint_fill["fill-opacity"]),"fill-color":new mo(Bt.paint_fill["fill-color"]),"fill-outline-color":new mo(Bt.paint_fill["fill-outline-color"]),"fill-translate":new fo(Bt.paint_fill["fill-translate"]),"fill-translate-anchor":new fo(Bt.paint_fill["fill-translate-anchor"]),"fill-pattern":new go(Bt.paint_fill["fill-pattern"])}),layout:Pl};const Ol=To([{name:"a_pos_normal_ed",components:4,type:"Int16"}]),zl=To([{name:"a_centroid_pos",components:2,type:"Uint16"}]),{members:Dl}=Ol;var Ll=Rl;function Rl(t,e,n,i,r){this.properties={},this.extent=n,this.type=0,this._pbf=t,this._geometry=-1,this._keys=i,this._values=r,t.readFields(Fl,this,e)}function Fl(t,e,n){1==t?e.id=n.readVarint():2==t?function(t,e){for(var n=t.readVarint()+t.pos;t.pos<n;){var i=e._keys[t.readVarint()],r=e._values[t.readVarint()];e.properties[i]=r}}(n,e):3==t?e.type=n.readVarint():4==t&&(e._geometry=n.pos)}function Bl(t){for(var e,n,i=0,r=0,o=t.length,s=o-1;r<o;s=r++)i+=((n=t[s]).x-(e=t[r]).x)*(e.y+n.y);return i}Rl.types=["Unknown","Point","LineString","Polygon"],Rl.prototype.loadGeometry=function(){var t=this._pbf;t.pos=this._geometry;for(var e,n=t.readVarint()+t.pos,i=1,o=0,s=0,a=0,l=[];t.pos<n;){if(o<=0){var c=t.readVarint();i=7&c,o=c>>3}if(o--,1===i||2===i)s+=t.readSVarint(),a+=t.readSVarint(),1===i&&(e&&l.push(e),e=[]),e.push(new r(s,a));else{if(7!==i)throw new Error("unknown command "+i);e&&e.push(e[0].clone())}}return e&&l.push(e),l},Rl.prototype.bbox=function(){var t=this._pbf;t.pos=this._geometry;for(var e=t.readVarint()+t.pos,n=1,i=0,r=0,o=0,s=1/0,a=-1/0,l=1/0,c=-1/0;t.pos<e;){if(i<=0){var u=t.readVarint();n=7&u,i=u>>3}if(i--,1===n||2===n)(r+=t.readSVarint())<s&&(s=r),r>a&&(a=r),(o+=t.readSVarint())<l&&(l=o),o>c&&(c=o);else if(7!==n)throw new Error("unknown command "+n)}return[s,l,a,c]},Rl.prototype.toGeoJSON=function(t,e,n){var i,r,o=this.extent*Math.pow(2,n),s=this.extent*t,a=this.extent*e,l=this.loadGeometry(),c=Rl.types[this.type];function u(t){for(var e=0;e<t.length;e++){var n=t[e];t[e]=[360*(n.x+s)/o-180,360/Math.PI*Math.atan(Math.exp((180-360*(n.y+a)/o)*Math.PI/180))-90]}}switch(this.type){case 1:var h=[];for(i=0;i<l.length;i++)h[i]=l[i][0];u(l=h);break;case 2:for(i=0;i<l.length;i++)u(l[i]);break;case 3:for(l=function(t){var e=t.length;if(e<=1)return[t];for(var n,i,r=[],o=0;o<e;o++){var s=Bl(t[o]);0!==s&&(void 0===i&&(i=s<0),i===s<0?(n&&r.push(n),n=[t[o]]):n.push(t[o]))}return n&&r.push(n),r}(l),i=0;i<l.length;i++)for(r=0;r<l[i].length;r++)u(l[i][r])}1===l.length?l=l[0]:c="Multi"+c;var d={type:"Feature",geometry:{type:c,coordinates:l},properties:this.properties};return"id"in this&&(d.id=this.id),d};var Vl=Ul;function Ul(t,e){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=t,this._keys=[],this._values=[],this._features=[],t.readFields(Nl,this,e),this.length=this._features.length}function Nl(t,e,n){15===t?e.version=n.readVarint():1===t?e.name=n.readString():5===t?e.extent=n.readVarint():2===t?e._features.push(n.pos):3===t?e._keys.push(n.readString()):4===t&&e._values.push(function(t){for(var e=null,n=t.readVarint()+t.pos;t.pos<n;){var i=t.readVarint()>>3;e=1===i?t.readString():2===i?t.readFloat():3===i?t.readDouble():4===i?t.readVarint64():5===i?t.readVarint():6===i?t.readSVarint():7===i?t.readBoolean():null}return e}(n))}function jl(t,e,n){if(3===t){var i=new Vl(n,n.readVarint()+n.pos);i.length&&(e[i.name]=i)}}Ul.prototype.feature=function(t){if(t<0||t>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[t];var e=this._pbf.readVarint()+this._pbf.pos;return new Ll(this._pbf,e,this.extent,this._keys,this._values)};var ql={VectorTile:function(t,e){this.layers=t.readFields(jl,{},e)},VectorTileFeature:Ll,VectorTileLayer:Vl};const $l=ql.VectorTileFeature.types,Gl=Math.pow(2,13);function Zl(t,e,n,i,r,o,s,a){t.emplaceBack((e<<1)+s,(n<<1)+o,(Math.floor(i*Gl)<<1)+r,Math.round(a))}class Hl{constructor(){this.acc=new r(0,0),this.polyCount=[]}startRing(t){this.currentPolyCount={edges:0,top:0},this.polyCount.push(this.currentPolyCount),this.min||(this.min=new r(t.x,t.y),this.max=new r(t.x,t.y))}append(t,e){this.currentPolyCount.edges++,this.acc._add(t);let n=!!this.borders;const i=this.min,r=this.max;t.x<i.x?(i.x=t.x,n=!0):t.x>r.x&&(r.x=t.x,n=!0),t.y<i.y?(i.y=t.y,n=!0):t.y>r.y&&(r.y=t.y,n=!0),((0===t.x||t.x===Us)&&t.x===e.x)!=((0===t.y||t.y===Us)&&t.y===e.y)&&this.processBorderOverlap(t,e),n&&this.checkBorderIntersection(t,e)}checkBorderIntersection(t,e){e.x<0!=t.x<0&&this.addBorderIntersection(0,nn(e.y,t.y,(0-e.x)/(t.x-e.x))),e.x>Us!=t.x>Us&&this.addBorderIntersection(1,nn(e.y,t.y,(Us-e.x)/(t.x-e.x))),e.y<0!=t.y<0&&this.addBorderIntersection(2,nn(e.x,t.x,(0-e.y)/(t.y-e.y))),e.y>Us!=t.y>Us&&this.addBorderIntersection(3,nn(e.x,t.x,(Us-e.y)/(t.y-e.y)))}addBorderIntersection(t,e){this.borders||(this.borders=[[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE]]);const n=this.borders[t];e<n[0]&&(n[0]=e),e>n[1]&&(n[1]=e)}processBorderOverlap(t,e){if(t.x===e.x){if(t.y===e.y)return;const n=0===t.x?0:1;this.addBorderIntersection(n,e.y),this.addBorderIntersection(n,t.y)}else{const n=0===t.y?2:3;this.addBorderIntersection(n,e.x),this.addBorderIntersection(n,t.x)}}centroid(){const t=this.polyCount.reduce((t,e)=>t+e.edges,0);return 0!==t?this.acc.div(t)._round():new r(0,0)}span(){return new r(this.max.x-this.min.x,this.max.y-this.min.y)}intersectsCount(){return this.borders.reduce((t,e)=>t+ +(e[0]!==Number.MAX_VALUE),0)}}class Wl{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(t=>t.id),this.index=t.index,this.hasPattern=!1,this.layoutVertexArray=new ko,this.centroidVertexArray=new os,this.indexArray=new Vo,this.programConfigurations=new Is(t.layers,t.zoom),this.segments=new Vs,this.stateDependentLayerIds=this.layers.filter(t=>t.isStateDependent()).map(t=>t.id),this.enableTerrain=t.enableTerrain}populate(t,e,n){this.features=[],this.hasPattern=kl("fill-extrusion",this.layers,e),this.featuresOnBorder=[],this.borders=[[],[],[],[]],this.borderDone=[!1,!1,!1,!1],this.tileToMeter=function(t){const e=Math.exp(Math.PI*(1-t.y/(1<<t.z)*2));return 80150034*e/(e*e+1)/Us/(1<<t.z)}(n);for(const{feature:i,id:r,index:o,sourceLayerIndex:s}of t){const t=this.layers[0]._featureFilter.needGeometry,a=$s(i,t);if(!this.layers[0]._featureFilter.filter(new ro(this.zoom),a,n))continue;const l={id:r,sourceLayerIndex:s,index:o,geometry:t?a.geometry:qs(i),properties:i.properties,type:i.type,patterns:{}},c=this.layoutVertexArray.length;this.hasPattern?this.features.push(Al("fill-extrusion",this.layers,l,this.zoom,e)):this.addFeature(l,l.geometry,o,n,{}),e.featureIndex.insert(i,l.geometry,o,s,this.index,c)}this.sortBorders()}addFeatures(t,e,n){for(const i of this.features){const{geometry:t}=i;this.addFeature(i,t,i.index,e,n)}this.sortBorders()}update(t,e,n){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,e,this.stateDependentLayers,n)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,Dl),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0}uploadCentroid(t){0!==this.centroidVertexArray.length&&(this.centroidVertexBuffer?this.needsCentroidUpdate&&this.centroidVertexBuffer.updateData(this.centroidVertexArray):this.centroidVertexBuffer=t.createVertexBuffer(this.centroidVertexArray,zl.members,!0),this.needsCentroidUpdate=!1)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.centroidVertexBuffer&&this.centroidVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(t,e,n,i,r){const o=this.enableTerrain&&t.properties&&"Polygon"===$l[t.type]?new Hl:null;for(const a of Sl(e,500)){let e=0,n=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray);if(0===a.length||(s=a[0]).every(t=>t.x<=0)||s.every(t=>t.x>=Us)||s.every(t=>t.y<=0)||s.every(t=>t.y>=Us))continue;for(let t=0;t<a.length;t++){const i=a[t];if(0===i.length)continue;e+=i.length;let r=0;o&&o.startRing(i[0]);for(let t=0;t<i.length;t++){const e=i[t];if(t>=1){const s=i[t-1];if(!Xl(e,s)){o&&o.append(e,s),n.vertexLength+4>Vs.MAX_VERTEX_ARRAY_LENGTH&&(n=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));const t=e.sub(s)._perp(),i=t.x/(Math.abs(t.x)+Math.abs(t.y)),a=t.y>0?1:0,l=s.dist(e);r+l>32768&&(r=0),Zl(this.layoutVertexArray,e.x,e.y,i,a,0,0,r),Zl(this.layoutVertexArray,e.x,e.y,i,a,0,1,r),r+=l,Zl(this.layoutVertexArray,s.x,s.y,i,a,0,0,r),Zl(this.layoutVertexArray,s.x,s.y,i,a,0,1,r);const c=n.vertexLength;this.indexArray.emplaceBack(c,c+2,c+1),this.indexArray.emplaceBack(c+1,c+2,c+3),n.vertexLength+=4,n.primitiveLength+=2}}}}if(n.vertexLength+e>Vs.MAX_VERTEX_ARRAY_LENGTH&&(n=this.segments.prepareSegment(e,this.layoutVertexArray,this.indexArray)),"Polygon"!==$l[t.type])continue;const i=[],r=[],l=n.vertexLength;for(let t=0;t<a.length;t++){const e=a[t];if(0!==e.length){e!==a[0]&&r.push(i.length/2);for(let t=0;t<e.length;t++){const n=e[t];Zl(this.layoutVertexArray,n.x,n.y,0,0,1,1,0),i.push(n.x),i.push(n.y),o&&o.currentPolyCount.top++}}}const c=Ha(i,r);for(let t=0;t<c.length;t+=3)this.indexArray.emplaceBack(l+c[t],l+c[t+2],l+c[t+1]);n.primitiveLength+=c.length/3,n.vertexLength+=e}var s;if(o&&o.polyCount.length>0){if(o.borders){o.vertexArrayOffset=this.centroidVertexArray.length;const t=o.borders,e=this.featuresOnBorder.push(o)-1;for(let n=0;n<4;n++)t[n][0]!==Number.MAX_VALUE&&this.borders[n].push(e)}this.encodeCentroid(o.borders?void 0:o.centroid(),o)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,n,r,i)}sortBorders(){for(let t=0;t<4;t++)this.borders[t].sort((e,n)=>this.featuresOnBorder[e].borders[t][0]-this.featuresOnBorder[n].borders[t][0])}encodeCentroid(t,e,n=!0){let i,r;if(t)if(0!==t.y){const n=e.span()._mult(this.tileToMeter);i=(Math.max(t.x,1)<<3)+Math.min(7,Math.round(n.x/10)),r=(Math.max(t.y,1)<<3)+Math.min(7,Math.round(n.y/10))}else i=Math.ceil(7*(t.x+450)),r=0;else i=0,r=+n;let o=n?this.centroidVertexArray.length:e.vertexArrayOffset;for(const s of e.polyCount){n&&this.centroidVertexArray.resize(this.centroidVertexArray.length+4*s.edges+s.top);for(let t=0;t<2*s.edges;t++)this.centroidVertexArray.emplace(o++,0,r),this.centroidVertexArray.emplace(o++,i,r);for(let t=0;t<s.top;t++)this.centroidVertexArray.emplace(o++,i,r)}}}function Xl(t,e){return t.x===e.x&&(t.x<0||t.x>Us)||t.y===e.y&&(t.y<0||t.y>Us)}or("FillExtrusionBucket",Wl,{omit:["layers","features"]}),or("PartMetadata",Hl);var Kl={paint:new vo({"fill-extrusion-opacity":new fo(Bt["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new mo(Bt["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new fo(Bt["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new fo(Bt["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new go(Bt["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new mo(Bt["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new mo(Bt["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new fo(Bt["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})};function Yl(t,e){return t.x*e.x+t.y*e.y}function Jl(t,e){if(1===t.length){let n=0;const i=e[n++];let r;for(;!r||i.equals(r);)if(r=e[n++],!r)return 1/0;for(;n<e.length;n++){const o=e[n],s=t[0],a=r.sub(i),l=o.sub(i),c=s.sub(i),u=Yl(a,a),h=Yl(a,l),d=Yl(l,l),p=Yl(c,a),f=Yl(c,l),m=u*d-h*h,g=(d*p-h*f)/m,_=(u*f-h*p)/m,y=i.z*(1-g-_)+r.z*g+o.z*_;if(isFinite(y))return y}return 1/0}{let t=1/0;for(const n of e)t=Math.min(t,n.z);return t}}function Ql(t){const e=new r(t[0],t[1]);return e.z=t[2],e}function tc(t,e,n,i,r,o,s,a){const l=s*r.getElevationAt(t,e,!0,!0),c=0!==o[0],u=c?0===o[1]?s*(o[0]/7-450):s*function(t,e,n){const i=Math.floor(e[0]/8),r=Math.floor(e[1]/8),o=10*(e[0]-8*i),s=10*(e[1]-8*r),a=t.getElevationAt(i,r,!0,!0),l=t.getMeterToDEM(n),c=Math.floor(.5*(o*l-1)),u=Math.floor(.5*(s*l-1)),h=t.tileCoordToPixel(i,r),d=2*c+1,p=2*u+1,f=function(t,e,n,i,r){return[t.getElevationAtPixel(e,n,!0),t.getElevationAtPixel(e+r,n,!0),t.getElevationAtPixel(e,n+r,!0),t.getElevationAtPixel(e+i,n+r,!0)]}(t,h.x-c,h.y-u,d,p),m=Math.abs(f[0]-f[1]),g=Math.abs(f[2]-f[3]),_=Math.abs(f[0]-f[2])+Math.abs(f[1]-f[3]),y=Math.min(.25,.5*l*(m+g)/d),v=Math.min(.25,.5*l*_/p);return a+Math.max(y*o,v*s)}(r,o,a):l;return{base:l+(0===n)?-1:n,top:c?Math.max(u+i,l+n+2):l+i}}const ec=To([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"},{name:"a_linesofar",components:1,type:"Float32"}],4),{members:nc}=ec,ic=To([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]),{members:rc}=ic,oc=ql.VectorTileFeature.types,sc=Math.cos(Math.PI/180*37.5);class ac{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(t=>t.id),this.index=t.index,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(t=>{this.gradients[t.id]={}}),this.layoutVertexArray=new Ao,this.layoutVertexArray2=new Io,this.indexArray=new Vo,this.programConfigurations=new Is(t.layers,t.zoom),this.segments=new Vs,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(t=>t.isStateDependent()).map(t=>t.id)}populate(t,e,n){this.hasPattern=kl("line",this.layers,e);const i=this.layers[0].layout.get("line-sort-key"),r=[];for(const{feature:l,id:c,index:u,sourceLayerIndex:h}of t){const t=this.layers[0]._featureFilter.needGeometry,e=$s(l,t);if(!this.layers[0]._featureFilter.filter(new ro(this.zoom),e,n))continue;const o=i?i.evaluate(e,{},n):void 0,s={id:c,properties:l.properties,type:l.type,sourceLayerIndex:h,index:u,geometry:t?e.geometry:qs(l),patterns:{},sortKey:o};r.push(s)}i&&r.sort((t,e)=>t.sortKey-e.sortKey);const{lineAtlas:o,featureIndex:s}=e,a=this.addConstantDashes(o);for(const l of r){const{geometry:i,index:r,sourceLayerIndex:c}=l;if(a&&this.addFeatureDashes(l,o),this.hasPattern){const t=Al("line",this.layers,l,this.zoom,e);this.patternFeatures.push(t)}else this.addFeature(l,i,r,n,o.positions);s.insert(t[r].feature,i,r,c,this.index)}}addConstantDashes(t){let e=!1;for(const n of this.layers){const i=n.paint.get("line-dasharray").value,r=n.layout.get("line-cap").value;if("constant"!==i.kind||"constant"!==r.kind)e=!0;else{const e=r.value,n=i.value;if(!n)continue;t.addDash(n.from,e),t.addDash(n.to,e),n.other&&t.addDash(n.other,e)}}return e}addFeatureDashes(t,e){const n=this.zoom;for(const i of this.layers){const r=i.paint.get("line-dasharray").value,o=i.layout.get("line-cap").value;if("constant"===r.kind&&"constant"===o.kind)continue;let s,a,l,c,u,h;if("constant"===r.kind){const t=r.value;if(!t)continue;s=t.other||t.to,a=t.to,l=t.from}else s=r.evaluate({zoom:n-1},t),a=r.evaluate({zoom:n},t),l=r.evaluate({zoom:n+1},t);"constant"===o.kind?c=u=h=o.value:(c=o.evaluate({zoom:n-1},t),u=o.evaluate({zoom:n},t),h=o.evaluate({zoom:n+1},t)),e.addDash(s,c),e.addDash(a,u),e.addDash(l,h);const d=e.getKey(s,c),p=e.getKey(a,u),f=e.getKey(l,h);t.patterns[i.id]={min:d,mid:p,max:f}}}update(t,e,n){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,e,this.stateDependentLayers,n)}addFeatures(t,e,n){for(const i of this.patternFeatures)this.addFeature(i,i.geometry,i.index,e,n)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(0!==this.layoutVertexArray2.length&&(this.layoutVertexBuffer2=t.createVertexBuffer(this.layoutVertexArray2,rc)),this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,nc),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(t){if(t.properties&&t.properties.hasOwnProperty("mapbox_clip_start")&&t.properties.hasOwnProperty("mapbox_clip_end"))return{start:+t.properties.mapbox_clip_start,end:+t.properties.mapbox_clip_end}}addFeature(t,e,n,i,r){const o=this.layers[0].layout,s=o.get("line-join").evaluate(t,{}),a=o.get("line-cap").evaluate(t,{}),l=o.get("line-miter-limit"),c=o.get("line-round-limit");this.lineClips=this.lineFeatureClips(t);for(const u of e)this.addLine(u,t,s,a,l,c);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,n,r,i)}addLine(t,e,n,i,r,o){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineSoFar=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(let e=0;e<t.length-1;e++)this.totalDistance+=t[e].dist(t[e+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const s="Polygon"===oc[e.type];let a=t.length;for(;a>=2&&t[a-1].equals(t[a-2]);)a--;let l=0;for(;l<a-1&&t[l].equals(t[l+1]);)l++;if(a<(s?3:2))return;"bevel"===n&&(r=1.05);const c=this.overscaling<=16?122880/(512*this.overscaling):0,u=this.segments.prepareSegment(10*a,this.layoutVertexArray,this.indexArray);let h,d,p,f,m;this.e1=this.e2=-1,s&&(h=t[a-2],m=t[l].sub(h)._unit()._perp());for(let g=l;g<a;g++){if(p=g===a-1?s?t[l+1]:void 0:t[g+1],p&&t[g].equals(p))continue;m&&(f=m),h&&(d=h),h=t[g],m=p?p.sub(h)._unit()._perp():f,f=f||m;let e=f.add(m);0===e.x&&0===e.y||e._unit();const _=f.x*m.x+f.y*m.y,y=e.x*m.x+e.y*m.y,v=0!==y?1/y:1/0,x=2*Math.sqrt(2-2*y),b=y<sc&&d&&p,w=f.x*m.y-f.y*m.x>0;if(b&&g>l){const t=h.dist(d);if(t>2*c){const e=h.sub(h.sub(d)._mult(c/t)._round());this.updateDistance(d,e),this.addCurrentVertex(e,f,0,0,u),d=e}}const C=d&&p;let T=C?n:s?"butt":i;if(C&&"round"===T&&(v<o?T="miter":v<=2&&(T="fakeround")),"miter"===T&&v>r&&(T="bevel"),"bevel"===T&&(v>2&&(T="flipbevel"),v<r&&(T="miter")),d&&this.updateDistance(d,h),"miter"===T)e._mult(v),this.addCurrentVertex(h,e,0,0,u);else if("flipbevel"===T){if(v>100)e=m.mult(-1);else{const t=v*f.add(m).mag()/f.sub(m).mag();e._perp()._mult(t*(w?-1:1))}this.addCurrentVertex(h,e,0,0,u),this.addCurrentVertex(h,e.mult(-1),0,0,u)}else if("bevel"===T||"fakeround"===T){const t=-Math.sqrt(v*v-1),e=w?t:0,n=w?0:t;if(d&&this.addCurrentVertex(h,f,e,n,u),"fakeround"===T){const t=Math.round(180*x/Math.PI/20);for(let e=1;e<t;e++){let n=e/t;if(.5!==n){const t=n-.5;n+=n*t*(n-1)*((1.0904+_*(_*(3.55645-1.43519*_)-3.2452))*t*t+(.848013+_*(.215638*_-1.06021)))}const i=m.sub(f)._mult(n)._add(f)._unit()._mult(w?-1:1);this.addHalfVertex(h,i.x,i.y,!1,w,0,u)}}p&&this.addCurrentVertex(h,m,-e,-n,u)}else if("butt"===T)this.addCurrentVertex(h,e,0,0,u);else if("square"===T){const t=d?1:-1;d||this.addCurrentVertex(h,e,t,t,u),this.addCurrentVertex(h,e,0,0,u),d&&this.addCurrentVertex(h,e,t,t,u)}else"round"===T&&(d&&(this.addCurrentVertex(h,f,0,0,u),this.addCurrentVertex(h,f,1,1,u,!0)),p&&(this.addCurrentVertex(h,m,-1,-1,u,!0),this.addCurrentVertex(h,m,0,0,u)));if(b&&g<a-1){const t=h.dist(p);if(t>2*c){const e=h.add(p.sub(h)._mult(c/t)._round());this.updateDistance(h,e),this.addCurrentVertex(e,m,0,0,u),h=e}}}}addCurrentVertex(t,e,n,i,r,o=!1){const s=e.y*i-e.x,a=-e.y-e.x*i;this.addHalfVertex(t,e.x+e.y*n,e.y-e.x*n,o,!1,n,r),this.addHalfVertex(t,s,a,o,!0,-i,r)}addHalfVertex({x:t,y:e},n,i,r,o,s,a){this.layoutVertexArray.emplaceBack((t<<1)+(r?1:0),(e<<1)+(o?1:0),Math.round(63*n)+128,Math.round(63*i)+128,1+(0===s?0:s<0?-1:1),0,this.lineSoFar),this.lineClips&&this.layoutVertexArray2.emplaceBack(this.scaledDistance,this.lineClipsArray.length);const l=a.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,l),a.primitiveLength++),o?this.e2=l:this.e1=l}updateScaledDistance(){if(this.lineClips){const t=this.totalDistance/(this.lineClips.end-this.lineClips.start);this.scaledDistance=this.distance/this.totalDistance,this.lineSoFar=t*this.lineClips.start+this.distance}else this.lineSoFar=this.distance}updateDistance(t,e){this.distance+=t.dist(e),this.updateScaledDistance()}}or("LineBucket",ac,{omit:["layers","patternFeatures"]});const lc=new vo({"line-cap":new mo(Bt.layout_line["line-cap"]),"line-join":new mo(Bt.layout_line["line-join"]),"line-miter-limit":new fo(Bt.layout_line["line-miter-limit"]),"line-round-limit":new fo(Bt.layout_line["line-round-limit"]),"line-sort-key":new mo(Bt.layout_line["line-sort-key"])});var cc={paint:new vo({"line-opacity":new mo(Bt.paint_line["line-opacity"]),"line-color":new mo(Bt.paint_line["line-color"]),"line-translate":new fo(Bt.paint_line["line-translate"]),"line-translate-anchor":new fo(Bt.paint_line["line-translate-anchor"]),"line-width":new mo(Bt.paint_line["line-width"]),"line-gap-width":new mo(Bt.paint_line["line-gap-width"]),"line-offset":new mo(Bt.paint_line["line-offset"]),"line-blur":new mo(Bt.paint_line["line-blur"]),"line-dasharray":new go(Bt.paint_line["line-dasharray"]),"line-pattern":new go(Bt.paint_line["line-pattern"]),"line-gradient":new yo(Bt.paint_line["line-gradient"])}),layout:lc};const uc=new class extends mo{possiblyEvaluate(t,e){return e=new ro(Math.floor(e.zoom),{now:e.now,fadeDuration:e.fadeDuration,zoomHistory:e.zoomHistory,transition:e.transition}),super.possiblyEvaluate(t,e)}evaluate(t,e,n,i){return e=v({},e,{zoom:Math.floor(e.zoom)}),super.evaluate(t,e,n,i)}}(cc.paint.properties["line-width"].specification);function hc(t,e){return e>0?e+2*t:t}uc.useIntegerZoom=!0;const dc=To([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),pc=To([{name:"a_projected_pos",components:3,type:"Float32"}],4);To([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const fc=To([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}]),mc=To([{name:"a_size_scale",components:1,type:"Float32"},{name:"a_padding",components:2,type:"Float32"}]);To([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Float32",name:"x1"},{type:"Float32",name:"y1"},{type:"Float32",name:"x2"},{type:"Float32",name:"y2"},{type:"Int16",name:"padding"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const gc=To([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),_c=To([{name:"a_pos_2f",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);To([{name:"triangle",components:3,type:"Uint16"}]),To([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),To([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"}]),To([{type:"Float32",name:"offsetX"}]),To([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]);const yc=128;function vc(t,e){const{expression:n}=e;if("constant"===n.kind)return{kind:"constant",layoutSize:n.evaluate(new ro(t+1))};if("source"===n.kind)return{kind:"source"};{const{zoomStops:e,interpolationType:i}=n;let r=0;for(;r<e.length&&e[r]<=t;)r++;r=Math.max(0,r-1);let o=r;for(;o<e.length&&e[o]<t+1;)o++;o=Math.min(e.length-1,o);const s=e[r],a=e[o];return"composite"===n.kind?{kind:"composite",minZoom:s,maxZoom:a,interpolationType:i}:{kind:"camera",minZoom:s,maxZoom:a,minSize:n.evaluate(new ro(s)),maxSize:n.evaluate(new ro(a)),interpolationType:i}}}function xc(t,{uSize:e,uSizeT:n},{lowerSize:i,upperSize:r}){return"source"===t.kind?i/yc:"composite"===t.kind?nn(i/yc,r/yc,n):e}function bc(t,e){let n=0,i=0;if("constant"===t.kind)i=t.layoutSize;else if("source"!==t.kind){const{interpolationType:r,minZoom:o,maxZoom:s}=t,a=r?m(xn.interpolationFactor(r,e,o,s),0,1):0;"camera"===t.kind?i=nn(t.minSize,t.maxSize,a):n=a}return{uSizeT:n,uSize:i}}var wc=Object.freeze({__proto__:null,getSizeData:vc,evaluateSizeForFeature:xc,evaluateSizeForZoom:bc,SIZE_PACK_FACTOR:yc});function Cc(t,e,n){return t.sections.forEach(t=>{t.text=function(t,e,n){const i=e.layout.get("text-transform").evaluate(n,{});return"uppercase"===i?t=t.toLocaleUpperCase():"lowercase"===i&&(t=t.toLocaleLowerCase()),io.applyArabicShaping&&(t=io.applyArabicShaping(t)),t}(t.text,e,n)}),t}const Tc={"!":"\ufe15","#":"\uff03",$:"\uff04","%":"\uff05","&":"\uff06","(":"\ufe35",")":"\ufe36","*":"\uff0a","+":"\uff0b",",":"\ufe10","-":"\ufe32",".":"\u30fb","/":"\uff0f",":":"\ufe13",";":"\ufe14","<":"\ufe3f","=":"\uff1d",">":"\ufe40","?":"\ufe16","@":"\uff20","[":"\ufe47","\\":"\uff3c","]":"\ufe48","^":"\uff3e",_:"\ufe33","`":"\uff40","{":"\ufe37","|":"\u2015","}":"\ufe38","~":"\uff5e","\xa2":"\uffe0","\xa3":"\uffe1","\xa5":"\uffe5","\xa6":"\uffe4","\xac":"\uffe2","\xaf":"\uffe3","\u2013":"\ufe32","\u2014":"\ufe31","\u2018":"\ufe43","\u2019":"\ufe44","\u201c":"\ufe41","\u201d":"\ufe42","\u2026":"\ufe19","\u2027":"\u30fb","\u20a9":"\uffe6","\u3001":"\ufe11","\u3002":"\ufe12","\u3008":"\ufe3f","\u3009":"\ufe40","\u300a":"\ufe3d","\u300b":"\ufe3e","\u300c":"\ufe41","\u300d":"\ufe42","\u300e":"\ufe43","\u300f":"\ufe44","\u3010":"\ufe3b","\u3011":"\ufe3c","\u3014":"\ufe39","\u3015":"\ufe3a","\u3016":"\ufe17","\u3017":"\ufe18","\uff01":"\ufe15","\uff08":"\ufe35","\uff09":"\ufe36","\uff0c":"\ufe10","\uff0d":"\ufe32","\uff0e":"\u30fb","\uff1a":"\ufe13","\uff1b":"\ufe14","\uff1c":"\ufe3f","\uff1e":"\ufe40","\uff1f":"\ufe16","\uff3b":"\ufe47","\uff3d":"\ufe48","\uff3f":"\ufe33","\uff5b":"\ufe37","\uff5c":"\u2015","\uff5d":"\ufe38","\uff5f":"\ufe35","\uff60":"\ufe36","\uff61":"\ufe12","\uff62":"\ufe41","\uff63":"\ufe42"};var Sc=function(t,e,n,i,r){var o,s,a=8*r-i-1,l=(1<<a)-1,c=l>>1,u=-7,h=n?r-1:0,d=n?-1:1,p=t[e+h];for(h+=d,o=p&(1<<-u)-1,p>>=-u,u+=a;u>0;o=256*o+t[e+h],h+=d,u-=8);for(s=o&(1<<-u)-1,o>>=-u,u+=i;u>0;s=256*s+t[e+h],h+=d,u-=8);if(0===o)o=1-c;else{if(o===l)return s?NaN:1/0*(p?-1:1);s+=Math.pow(2,i),o-=c}return(p?-1:1)*s*Math.pow(2,o-i)},Ec=function(t,e,n,i,r,o){var s,a,l,c=8*o-r-1,u=(1<<c)-1,h=u>>1,d=23===r?Math.pow(2,-24)-Math.pow(2,-77):0,p=i?0:o-1,f=i?1:-1,m=e<0||0===e&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(a=isNaN(e)?1:0,s=u):(s=Math.floor(Math.log(e)/Math.LN2),e*(l=Math.pow(2,-s))<1&&(s--,l*=2),(e+=s+h>=1?d/l:d*Math.pow(2,1-h))*l>=2&&(s++,l/=2),s+h>=u?(a=0,s=u):s+h>=1?(a=(e*l-1)*Math.pow(2,r),s+=h):(a=e*Math.pow(2,h-1)*Math.pow(2,r),s=0));r>=8;t[n+p]=255&a,p+=f,a/=256,r-=8);for(s=s<<r|a,c+=r;c>0;t[n+p]=255&s,p+=f,s/=256,c-=8);t[n+p-f]|=128*m},kc=Ac;function Ac(t){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(t)?t:new Uint8Array(t||0),this.pos=0,this.type=0,this.length=this.buf.length}Ac.Varint=0,Ac.Fixed64=1,Ac.Bytes=2,Ac.Fixed32=5;var Ic=4294967296,Pc=1/Ic,Mc="undefined"==typeof TextDecoder?null:new TextDecoder("utf8");function Oc(t){return t.type===Ac.Bytes?t.readVarint()+t.pos:t.pos+1}function zc(t,e,n){return n?4294967296*e+(t>>>0):4294967296*(e>>>0)+(t>>>0)}function Dc(t,e,n){var i=e<=16383?1:e<=2097151?2:e<=268435455?3:Math.floor(Math.log(e)/(7*Math.LN2));n.realloc(i);for(var r=n.pos-1;r>=t;r--)n.buf[r+i]=n.buf[r]}function Lc(t,e){for(var n=0;n<t.length;n++)e.writeVarint(t[n])}function Rc(t,e){for(var n=0;n<t.length;n++)e.writeSVarint(t[n])}function Fc(t,e){for(var n=0;n<t.length;n++)e.writeFloat(t[n])}function Bc(t,e){for(var n=0;n<t.length;n++)e.writeDouble(t[n])}function Vc(t,e){for(var n=0;n<t.length;n++)e.writeBoolean(t[n])}function Uc(t,e){for(var n=0;n<t.length;n++)e.writeFixed32(t[n])}function Nc(t,e){for(var n=0;n<t.length;n++)e.writeSFixed32(t[n])}function jc(t,e){for(var n=0;n<t.length;n++)e.writeFixed64(t[n])}function qc(t,e){for(var n=0;n<t.length;n++)e.writeSFixed64(t[n])}function $c(t,e){return(t[e]|t[e+1]<<8|t[e+2]<<16)+16777216*t[e+3]}function Gc(t,e,n){t[n]=e,t[n+1]=e>>>8,t[n+2]=e>>>16,t[n+3]=e>>>24}function Zc(t,e){return(t[e]|t[e+1]<<8|t[e+2]<<16)+(t[e+3]<<24)}function Hc(t,e,n){1===t&&n.readMessage(Wc,e)}function Wc(t,e,n){if(3===t){const{id:t,bitmap:i,width:r,height:o,left:s,top:a,advance:l}=n.readMessage(Xc,{});e.push({id:t,bitmap:new Ua({width:r+6,height:o+6},i),metrics:{width:r,height:o,left:s,top:a,advance:l}})}}function Xc(t,e,n){1===t?e.id=n.readVarint():2===t?e.bitmap=n.readBytes():3===t?e.width=n.readVarint():4===t?e.height=n.readVarint():5===t?e.left=n.readSVarint():6===t?e.top=n.readSVarint():7===t&&(e.advance=n.readVarint())}function Kc(t){let e=0,n=0;for(const s of t)e+=s.w*s.h,n=Math.max(n,s.w);t.sort((t,e)=>e.h-t.h);const i=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(e/.95)),n),h:1/0}];let r=0,o=0;for(const s of t)for(let t=i.length-1;t>=0;t--){const e=i[t];if(!(s.w>e.w||s.h>e.h)){if(s.x=e.x,s.y=e.y,o=Math.max(o,s.y+s.h),r=Math.max(r,s.x+s.w),s.w===e.w&&s.h===e.h){const e=i.pop();t<i.length&&(i[t]=e)}else s.h===e.h?(e.x+=s.w,e.w-=s.w):s.w===e.w?(e.y+=s.h,e.h-=s.h):(i.push({x:e.x+s.w,y:e.y,w:e.w-s.w,h:s.h}),e.y+=s.h,e.h-=s.h);break}}return{w:r,h:o,fill:e/(r*o)||0}}Ac.prototype={destroy:function(){this.buf=null},readFields:function(t,e,n){for(n=n||this.length;this.pos<n;){var i=this.readVarint(),r=i>>3,o=this.pos;this.type=7&i,t(r,e,this),this.pos===o&&this.skip(i)}return e},readMessage:function(t,e){return this.readFields(t,e,this.readVarint()+this.pos)},readFixed32:function(){var t=$c(this.buf,this.pos);return this.pos+=4,t},readSFixed32:function(){var t=Zc(this.buf,this.pos);return this.pos+=4,t},readFixed64:function(){var t=$c(this.buf,this.pos)+$c(this.buf,this.pos+4)*Ic;return this.pos+=8,t},readSFixed64:function(){var t=$c(this.buf,this.pos)+Zc(this.buf,this.pos+4)*Ic;return this.pos+=8,t},readFloat:function(){var t=Sc(this.buf,this.pos,!0,23,4);return this.pos+=4,t},readDouble:function(){var t=Sc(this.buf,this.pos,!0,52,8);return this.pos+=8,t},readVarint:function(t){var e,n,i=this.buf;return e=127&(n=i[this.pos++]),n<128?e:(e|=(127&(n=i[this.pos++]))<<7,n<128?e:(e|=(127&(n=i[this.pos++]))<<14,n<128?e:(e|=(127&(n=i[this.pos++]))<<21,n<128?e:function(t,e,n){var i,r,o=n.buf;if(i=(112&(r=o[n.pos++]))>>4,r<128)return zc(t,i,e);if(i|=(127&(r=o[n.pos++]))<<3,r<128)return zc(t,i,e);if(i|=(127&(r=o[n.pos++]))<<10,r<128)return zc(t,i,e);if(i|=(127&(r=o[n.pos++]))<<17,r<128)return zc(t,i,e);if(i|=(127&(r=o[n.pos++]))<<24,r<128)return zc(t,i,e);if(i|=(1&(r=o[n.pos++]))<<31,r<128)return zc(t,i,e);throw new Error("Expected varint not more than 10 bytes")}(e|=(15&(n=i[this.pos]))<<28,t,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var t=this.readVarint();return t%2==1?(t+1)/-2:t/2},readBoolean:function(){return Boolean(this.readVarint())},readString:function(){var t=this.readVarint()+this.pos,e=this.pos;return this.pos=t,t-e>=12&&Mc?function(t,e,n){return Mc.decode(t.subarray(e,n))}(this.buf,e,t):function(t,e,n){for(var i="",r=e;r<n;){var o,s,a,l=t[r],c=null,u=l>239?4:l>223?3:l>191?2:1;if(r+u>n)break;1===u?l<128&&(c=l):2===u?128==(192&(o=t[r+1]))&&(c=(31&l)<<6|63&o)<=127&&(c=null):3===u?(s=t[r+2],128==(192&(o=t[r+1]))&&128==(192&s)&&((c=(15&l)<<12|(63&o)<<6|63&s)<=2047||c>=55296&&c<=57343)&&(c=null)):4===u&&(s=t[r+2],a=t[r+3],128==(192&(o=t[r+1]))&&128==(192&s)&&128==(192&a)&&((c=(15&l)<<18|(63&o)<<12|(63&s)<<6|63&a)<=65535||c>=1114112)&&(c=null)),null===c?(c=65533,u=1):c>65535&&(c-=65536,i+=String.fromCharCode(c>>>10&1023|55296),c=56320|1023&c),i+=String.fromCharCode(c),r+=u}return i}(this.buf,e,t)},readBytes:function(){var t=this.readVarint()+this.pos,e=this.buf.subarray(this.pos,t);return this.pos=t,e},readPackedVarint:function(t,e){if(this.type!==Ac.Bytes)return t.push(this.readVarint(e));var n=Oc(this);for(t=t||[];this.pos<n;)t.push(this.readVarint(e));return t},readPackedSVarint:function(t){if(this.type!==Ac.Bytes)return t.push(this.readSVarint());var e=Oc(this);for(t=t||[];this.pos<e;)t.push(this.readSVarint());return t},readPackedBoolean:function(t){if(this.type!==Ac.Bytes)return t.push(this.readBoolean());var e=Oc(this);for(t=t||[];this.pos<e;)t.push(this.readBoolean());return t},readPackedFloat:function(t){if(this.type!==Ac.Bytes)return t.push(this.readFloat());var e=Oc(this);for(t=t||[];this.pos<e;)t.push(this.readFloat());return t},readPackedDouble:function(t){if(this.type!==Ac.Bytes)return t.push(this.readDouble());var e=Oc(this);for(t=t||[];this.pos<e;)t.push(this.readDouble());return t},readPackedFixed32:function(t){if(this.type!==Ac.Bytes)return t.push(this.readFixed32());var e=Oc(this);for(t=t||[];this.pos<e;)t.push(this.readFixed32());return t},readPackedSFixed32:function(t){if(this.type!==Ac.Bytes)return t.push(this.readSFixed32());var e=Oc(this);for(t=t||[];this.pos<e;)t.push(this.readSFixed32());return t},readPackedFixed64:function(t){if(this.type!==Ac.Bytes)return t.push(this.readFixed64());var e=Oc(this);for(t=t||[];this.pos<e;)t.push(this.readFixed64());return t},readPackedSFixed64:function(t){if(this.type!==Ac.Bytes)return t.push(this.readSFixed64());var e=Oc(this);for(t=t||[];this.pos<e;)t.push(this.readSFixed64());return t},skip:function(t){var e=7&t;if(e===Ac.Varint)for(;this.buf[this.pos++]>127;);else if(e===Ac.Bytes)this.pos=this.readVarint()+this.pos;else if(e===Ac.Fixed32)this.pos+=4;else{if(e!==Ac.Fixed64)throw new Error("Unimplemented type: "+e);this.pos+=8}},writeTag:function(t,e){this.writeVarint(t<<3|e)},realloc:function(t){for(var e=this.length||16;e<this.pos+t;)e*=2;if(e!==this.length){var n=new Uint8Array(e);n.set(this.buf),this.buf=n,this.length=e}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(t){this.realloc(4),Gc(this.buf,t,this.pos),this.pos+=4},writeSFixed32:function(t){this.realloc(4),Gc(this.buf,t,this.pos),this.pos+=4},writeFixed64:function(t){this.realloc(8),Gc(this.buf,-1&t,this.pos),Gc(this.buf,Math.floor(t*Pc),this.pos+4),this.pos+=8},writeSFixed64:function(t){this.realloc(8),Gc(this.buf,-1&t,this.pos),Gc(this.buf,Math.floor(t*Pc),this.pos+4),this.pos+=8},writeVarint:function(t){(t=+t||0)>268435455||t<0?function(t,e){var n,i;if(t>=0?(n=t%4294967296|0,i=t/4294967296|0):(i=~(-t/4294967296),4294967295^(n=~(-t%4294967296))?n=n+1|0:(n=0,i=i+1|0)),t>=0x10000000000000000||t<-0x10000000000000000)throw new Error("Given varint doesn't fit into 10 bytes");e.realloc(10),function(t,e,n){n.buf[n.pos++]=127&t|128,t>>>=7,n.buf[n.pos++]=127&t|128,t>>>=7,n.buf[n.pos++]=127&t|128,t>>>=7,n.buf[n.pos++]=127&t|128,n.buf[n.pos]=127&(t>>>=7)}(n,0,e),function(t,e){var n=(7&t)<<4;e.buf[e.pos++]|=n|((t>>>=3)?128:0),t&&(e.buf[e.pos++]=127&t|((t>>>=7)?128:0),t&&(e.buf[e.pos++]=127&t|((t>>>=7)?128:0),t&&(e.buf[e.pos++]=127&t|((t>>>=7)?128:0),t&&(e.buf[e.pos++]=127&t|((t>>>=7)?128:0),t&&(e.buf[e.pos++]=127&t)))))}(i,e)}(t,this):(this.realloc(4),this.buf[this.pos++]=127&t|(t>127?128:0),t<=127||(this.buf[this.pos++]=127&(t>>>=7)|(t>127?128:0),t<=127||(this.buf[this.pos++]=127&(t>>>=7)|(t>127?128:0),t<=127||(this.buf[this.pos++]=t>>>7&127))))},writeSVarint:function(t){this.writeVarint(t<0?2*-t-1:2*t)},writeBoolean:function(t){this.writeVarint(Boolean(t))},writeString:function(t){t=String(t),this.realloc(4*t.length),this.pos++;var e=this.pos;this.pos=function(t,e,n){for(var i,r,o=0;o<e.length;o++){if((i=e.charCodeAt(o))>55295&&i<57344){if(!r){i>56319||o+1===e.length?(t[n++]=239,t[n++]=191,t[n++]=189):r=i;continue}if(i<56320){t[n++]=239,t[n++]=191,t[n++]=189,r=i;continue}i=r-55296<<10|i-56320|65536,r=null}else r&&(t[n++]=239,t[n++]=191,t[n++]=189,r=null);i<128?t[n++]=i:(i<2048?t[n++]=i>>6|192:(i<65536?t[n++]=i>>12|224:(t[n++]=i>>18|240,t[n++]=i>>12&63|128),t[n++]=i>>6&63|128),t[n++]=63&i|128)}return n}(this.buf,t,this.pos);var n=this.pos-e;n>=128&&Dc(e,n,this),this.pos=e-1,this.writeVarint(n),this.pos+=n},writeFloat:function(t){this.realloc(4),Ec(this.buf,t,this.pos,!0,23,4),this.pos+=4},writeDouble:function(t){this.realloc(8),Ec(this.buf,t,this.pos,!0,52,8),this.pos+=8},writeBytes:function(t){var e=t.length;this.writeVarint(e),this.realloc(e);for(var n=0;n<e;n++)this.buf[this.pos++]=t[n]},writeRawMessage:function(t,e){this.pos++;var n=this.pos;t(e,this);var i=this.pos-n;i>=128&&Dc(n,i,this),this.pos=n-1,this.writeVarint(i),this.pos+=i},writeMessage:function(t,e,n){this.writeTag(t,Ac.Bytes),this.writeRawMessage(e,n)},writePackedVarint:function(t,e){e.length&&this.writeMessage(t,Lc,e)},writePackedSVarint:function(t,e){e.length&&this.writeMessage(t,Rc,e)},writePackedBoolean:function(t,e){e.length&&this.writeMessage(t,Vc,e)},writePackedFloat:function(t,e){e.length&&this.writeMessage(t,Fc,e)},writePackedDouble:function(t,e){e.length&&this.writeMessage(t,Bc,e)},writePackedFixed32:function(t,e){e.length&&this.writeMessage(t,Uc,e)},writePackedSFixed32:function(t,e){e.length&&this.writeMessage(t,Nc,e)},writePackedFixed64:function(t,e){e.length&&this.writeMessage(t,jc,e)},writePackedSFixed64:function(t,e){e.length&&this.writeMessage(t,qc,e)},writeBytesField:function(t,e){this.writeTag(t,Ac.Bytes),this.writeBytes(e)},writeFixed32Field:function(t,e){this.writeTag(t,Ac.Fixed32),this.writeFixed32(e)},writeSFixed32Field:function(t,e){this.writeTag(t,Ac.Fixed32),this.writeSFixed32(e)},writeFixed64Field:function(t,e){this.writeTag(t,Ac.Fixed64),this.writeFixed64(e)},writeSFixed64Field:function(t,e){this.writeTag(t,Ac.Fixed64),this.writeSFixed64(e)},writeVarintField:function(t,e){this.writeTag(t,Ac.Varint),this.writeVarint(e)},writeSVarintField:function(t,e){this.writeTag(t,Ac.Varint),this.writeSVarint(e)},writeStringField:function(t,e){this.writeTag(t,Ac.Bytes),this.writeString(e)},writeFloatField:function(t,e){this.writeTag(t,Ac.Fixed32),this.writeFloat(e)},writeDoubleField:function(t,e){this.writeTag(t,Ac.Fixed64),this.writeDouble(e)},writeBooleanField:function(t,e){this.writeVarintField(t,Boolean(e))}};class Yc{constructor(t,{pixelRatio:e,version:n,stretchX:i,stretchY:r,content:o}){this.paddedRect=t,this.pixelRatio=e,this.stretchX=i,this.stretchY=r,this.content=o,this.version=n}get tl(){return[this.paddedRect.x+1,this.paddedRect.y+1]}get br(){return[this.paddedRect.x+this.paddedRect.w-1,this.paddedRect.y+this.paddedRect.h-1]}get displaySize(){return[(this.paddedRect.w-2)/this.pixelRatio,(this.paddedRect.h-2)/this.pixelRatio]}}class Jc{constructor(t,e){const n={},i={};this.haveRenderCallbacks=[];const r=[];this.addImages(t,n,r),this.addImages(e,i,r);const{w:o,h:s}=Kc(r),a=new Na({width:o||1,height:s||1});for(const l in t){const e=t[l],i=n[l].paddedRect;Na.copy(e.data,a,{x:0,y:0},{x:i.x+1,y:i.y+1},e.data)}for(const l in e){const t=e[l],n=i[l].paddedRect,r=n.x+1,o=n.y+1,s=t.data.width,c=t.data.height;Na.copy(t.data,a,{x:0,y:0},{x:r,y:o},t.data),Na.copy(t.data,a,{x:0,y:c-1},{x:r,y:o-1},{width:s,height:1}),Na.copy(t.data,a,{x:0,y:0},{x:r,y:o+c},{width:s,height:1}),Na.copy(t.data,a,{x:s-1,y:0},{x:r-1,y:o},{width:1,height:c}),Na.copy(t.data,a,{x:0,y:0},{x:r+s,y:o},{width:1,height:c})}this.image=a,this.iconPositions=n,this.patternPositions=i}addImages(t,e,n){for(const i in t){const r=t[i],o={x:0,y:0,w:r.data.width+2,h:r.data.height+2};n.push(o),e[i]=new Yc(o,r),r.hasRenderCallback&&this.haveRenderCallbacks.push(i)}}patchUpdatedImages(t,e){t.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const n in t.updatedImages)this.patchUpdatedImage(this.iconPositions[n],t.getImage(n),e),this.patchUpdatedImage(this.patternPositions[n],t.getImage(n),e)}patchUpdatedImage(t,e,n){if(!t||!e)return;if(t.version===e.version)return;t.version=e.version;const[i,r]=t.tl;n.update(e.data,void 0,{x:i,y:r})}}or("ImagePosition",Yc),or("ImageAtlas",Jc);const Qc={horizontal:1,vertical:2,horizontalOnly:3};class tu{constructor(){this.scale=1,this.fontStack="",this.imageName=null}static forText(t,e){const n=new tu;return n.scale=t||1,n.fontStack=e,n}static forImage(t){const e=new tu;return e.imageName=t,e}}class eu{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(t,e){const n=new eu;for(let i=0;i<t.sections.length;i++){const r=t.sections[i];r.image?n.addImageSection(r):n.addTextSection(r,e)}return n}length(){return this.text.length}getSection(t){return this.sections[this.sectionIndex[t]]}getSectionIndex(t){return this.sectionIndex[t]}getCharCode(t){return this.text.charCodeAt(t)}verticalizePunctuation(){this.text=function(t){let e="";for(let n=0;n<t.length;n++){const i=t.charCodeAt(n+1)||null,r=t.charCodeAt(n-1)||null;e+=i&&jr(i)&&!Tc[t[n+1]]||r&&jr(r)&&!Tc[t[n-1]]||!Tc[t[n]]?t[n]:Tc[t[n]]}return e}(this.text)}trim(){let t=0;for(let n=0;n<this.text.length&&iu[this.text.charCodeAt(n)];n++)t++;let e=this.text.length;for(let n=this.text.length-1;n>=0&&n>=t&&iu[this.text.charCodeAt(n)];n--)e--;this.text=this.text.substring(t,e),this.sectionIndex=this.sectionIndex.slice(t,e)}substring(t,e){const n=new eu;return n.text=this.text.substring(t,e),n.sectionIndex=this.sectionIndex.slice(t,e),n.sections=this.sections,n}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((t,e)=>Math.max(t,this.sections[e].scale),0)}addTextSection(t,e){this.text+=t.text,this.sections.push(tu.forText(t.scale,t.fontStack||e));const n=this.sections.length-1;for(let i=0;i<t.text.length;++i)this.sectionIndex.push(n)}addImageSection(t){const e=t.image?t.image.name:"";if(0===e.length)return void M("Can't add FormattedSection with an empty image.");const n=this.getNextImageSectionCharCode();n?(this.text+=String.fromCharCode(n),this.sections.push(tu.forImage(e)),this.sectionIndex.push(this.sections.length-1)):M("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function nu(t,e,n,i,r,o,s,a,l,c,u,h,d,p,f,m){const g=eu.fromFeature(t,r);let _;h===Qc.vertical&&g.verticalizePunctuation();const{processBidirectionalText:y,processStyledBidirectionalText:v}=io;if(y&&1===g.sections.length){_=[];const t=y(g.toString(),uu(g,c,o,e,i,p,f));for(const e of t){const t=new eu;t.text=e,t.sections=g.sections;for(let n=0;n<e.length;n++)t.sectionIndex.push(0);_.push(t)}}else if(v){_=[];const t=v(g.text,g.sectionIndex,uu(g,c,o,e,i,p,f));for(const e of t){const t=new eu;t.text=e[0],t.sectionIndex=e[1],t.sections=g.sections,_.push(t)}}else _=function(t,e){const n=[],i=t.text;let r=0;for(const o of e)n.push(t.substring(r,o)),r=o;return r<i.length&&n.push(t.substring(r,i.length)),n}(g,uu(g,c,o,e,i,p,f));const x=[],b={positionedLines:x,text:g.toString(),top:u[1],bottom:u[1],left:u[0],right:u[0],writingMode:h,iconsInText:!1,verticalizable:!1};return function(t,e,n,i,r,o,s,a,l,c,u,h){let d=0,p=-17,f=0,m=0;const g="right"===a?1:"left"===a?0:.5;let _=0;for(const w of r){w.trim();const r=w.getMaxScale(),s=24*(r-1),a={positionedGlyphs:[],lineOffset:0};t.positionedLines[_]=a;const v=a.positionedGlyphs;let x=0;if(!w.length()){p+=o,++_;continue}for(let o=0;o<w.length();o++){const a=w.getSection(o),f=w.getSectionIndex(o),m=w.getCharCode(o);let g=0,_=null,b=null,C=null,T=24;const S=!(l===Qc.horizontal||!u&&!Nr(m)||u&&(iu[m]||(y=m,hr(y)||dr(y)||pr(y)||Or(y)||Rr(y))));if(a.imageName){const e=i[a.imageName];if(!e)continue;C=a.imageName,t.iconsInText=t.iconsInText||!0,b=e.paddedRect;const n=e.displaySize;a.scale=24*a.scale/h,_={width:n[0],height:n[1],left:1,top:-3,advance:S?n[1]:n[0],localGlyph:!1},g=s+(24-n[1]*a.scale),T=_.advance;const o=S?n[0]*a.scale-24*r:n[1]*a.scale-24*r;o>0&&o>x&&(x=o)}else{const t=n[a.fontStack],i=t&&t[m];if(i&&i.rect)b=i.rect,_=i.metrics;else{const t=e[a.fontStack],n=t&&t[m];if(!n)continue;_=n.metrics}g=24*(r-a.scale)}S?(t.verticalizable=!0,v.push({glyph:m,imageName:C,x:d,y:p+g,vertical:S,scale:a.scale,localGlyph:_.localGlyph,fontStack:a.fontStack,sectionIndex:f,metrics:_,rect:b}),d+=T*a.scale+c):(v.push({glyph:m,imageName:C,x:d,y:p+g,vertical:S,scale:a.scale,localGlyph:_.localGlyph,fontStack:a.fontStack,sectionIndex:f,metrics:_,rect:b}),d+=_.advance*a.scale+c)}0!==v.length&&(f=Math.max(d-c,f),du(v,0,v.length-1,g,x)),d=0;const b=o*r+x;a.lineOffset=Math.max(x,s),p+=b,m=Math.max(b,m),++_}var y;const v=p- -17,{horizontalAlign:x,verticalAlign:b}=hu(s);(function(t,e,n,i,r,o,s,a,l){const c=(e-n)*r;let u=0;u=o!==s?-a*i- -17:(-i*l+.5)*s;for(const h of t)for(const t of h.positionedGlyphs)t.x+=c,t.y+=u})(t.positionedLines,g,x,b,f,m,o,v,r.length),t.top+=-b*v,t.bottom=t.top+v,t.left+=-x*f,t.right=t.left+f}(b,e,n,i,_,s,a,l,h,c,d,m),!function(t){for(const e of t)if(0!==e.positionedGlyphs.length)return!1;return!0}(x)&&b}const iu={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},ru={10:!0,32:!0,38:!0,40:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0};function ou(t,e,n,i,r,o){if(e.imageName){const t=i[e.imageName];return t?t.displaySize[0]*e.scale*24/o+r:0}{const i=n[e.fontStack],o=i&&i[t];return o?o.metrics.advance*e.scale+r:0}}function su(t,e,n,i){const r=Math.pow(t-e,2);return i?t<e?r/2:2*r:r+Math.abs(n)*n}function au(t,e,n){let i=0;return 10===t&&(i-=1e4),n&&(i+=150),40!==t&&65288!==t||(i+=50),41!==e&&65289!==e||(i+=50),i}function lu(t,e,n,i,r,o){let s=null,a=su(e,n,r,o);for(const l of i){const t=su(e-l.x,n,r,o)+l.badness;t<=a&&(s=l,a=t)}return{index:t,x:e,priorBreak:s,badness:a}}function cu(t){return t?cu(t.priorBreak).concat(t.index):[]}function uu(t,e,n,i,r,o,s){if("point"!==o)return[];if(!t)return[];const a=[],l=function(t,e,n,i,r,o){let s=0;for(let a=0;a<t.length();a++){const n=t.getSection(a);s+=ou(t.getCharCode(a),n,i,r,e,o)}return s/Math.max(1,Math.ceil(s/n))}(t,e,n,i,r,s),c=t.text.indexOf("\u200b")>=0;let u=0;for(let d=0;d<t.length();d++){const n=t.getSection(d),o=t.getCharCode(d);if(iu[o]||(u+=ou(o,n,i,r,e,s)),d<t.length()-1){const e=!((h=o)<11904||!(br(h)||xr(h)||Dr(h)||Mr(h)||Sr(h)||fr(h)||wr(h)||_r(h)||Er(h)||kr(h)||Tr(h)||Fr(h)||yr(h)||gr(h)||mr(h)||Cr(h)||vr(h)||zr(h)||Ir(h)||Ar(h)));(ru[o]||e||n.imageName)&&a.push(lu(d+1,u,l,a,au(o,t.getCharCode(d+1),e&&c),!1))}}var h;return cu(lu(t.length(),u,l,a,0,!0))}function hu(t){let e=.5,n=.5;switch(t){case"right":case"top-right":case"bottom-right":e=1;break;case"left":case"top-left":case"bottom-left":e=0}switch(t){case"bottom":case"bottom-right":case"bottom-left":n=1;break;case"top":case"top-right":case"top-left":n=0}return{horizontalAlign:e,verticalAlign:n}}function du(t,e,n,i,r){if(!i&&!r)return;const o=t[n],s=(t[n].x+o.metrics.advance*o.scale)*i;for(let a=e;a<=n;a++)t[a].x-=s,t[a].y+=r}function pu(t,e,n){const{horizontalAlign:i,verticalAlign:r}=hu(n),o=e[0]-t.displaySize[0]*i,s=e[1]-t.displaySize[1]*r;return{image:t,top:s,bottom:s+t.displaySize[1],left:o,right:o+t.displaySize[0]}}function fu(t,e,n,i,r,o){const s=t.image;let a;if(s.content){const t=s.content,e=s.pixelRatio||1;a=[t[0]/e,t[1]/e,s.displaySize[0]-t[2]/e,s.displaySize[1]-t[3]/e]}const l=e.left*o,c=e.right*o;let u,h,d,p;"width"===n||"both"===n?(p=r[0]+l-i[3],h=r[0]+c+i[1]):(p=r[0]+(l+c-s.displaySize[0])/2,h=p+s.displaySize[0]);const f=e.top*o,m=e.bottom*o;return"height"===n||"both"===n?(u=r[1]+f-i[0],d=r[1]+m+i[2]):(u=r[1]+(f+m-s.displaySize[1])/2,d=u+s.displaySize[1]),{image:s,top:u,right:h,bottom:d,left:p,collisionPadding:a}}class mu extends r{constructor(t,e,n,i){super(t,e),this.angle=n,void 0!==i&&(this.segment=i)}clone(){return new mu(this.x,this.y,this.angle,this.segment)}}function gu(t,e,n,i,r){if(void 0===e.segment)return!0;let o=e,s=e.segment+1,a=0;for(;a>-n/2;){if(s--,s<0)return!1;a-=t[s].dist(o),o=t[s]}a+=t[s].dist(t[s+1]),s++;const l=[];let c=0;for(;a<n/2;){const e=t[s],n=t[s+1];if(!n)return!1;let o=t[s-1].angleTo(e)-e.angleTo(n);for(o=Math.abs((o+3*Math.PI)%(2*Math.PI)-Math.PI),l.push({distance:a,angleDelta:o}),c+=o;a-l[0].distance>i;)c-=l.shift().angleDelta;if(c>r)return!1;s++,a+=e.dist(n)}return!0}function _u(t){let e=0;for(let n=0;n<t.length-1;n++)e+=t[n].dist(t[n+1]);return e}function yu(t,e,n){return t?.6*e*n:0}function vu(t,e){return Math.max(t?t.right-t.left:0,e?e.right-e.left:0)}function xu(t,e,n,i,r,o){const s=yu(n,r,o),a=vu(n,i)*o;let l=0;const c=_u(t)/2;for(let u=0;u<t.length-1;u++){const n=t[u],i=t[u+1],r=n.dist(i);if(l+r>c){const o=(c-l)/r,h=nn(n.x,i.x,o),d=nn(n.y,i.y,o),p=new mu(h,d,i.angleTo(n),u);return p._round(),!s||gu(t,p,a,s,e)?p:void 0}l+=r}}function bu(t,e,n,i,r,o,s,a,l){const c=yu(i,o,s),u=vu(i,r),h=u*s,d=0===t[0].x||t[0].x===l||0===t[0].y||t[0].y===l;return e-h<e/4&&(e=h+e/4),wu(t,d?e/2*a%e:(u/2+2*o)*s*a%e,e,c,n,h,d,!1,l)}function wu(t,e,n,i,r,o,s,a,l){const c=o/2,u=_u(t);let h=0,d=e-n,p=[];for(let f=0;f<t.length-1;f++){const e=t[f],s=t[f+1],a=e.dist(s),m=s.angleTo(e);for(;d+n<h+a;){d+=n;const g=(d-h)/a,_=nn(e.x,s.x,g),y=nn(e.y,s.y,g);if(_>=0&&_<l&&y>=0&&y<l&&d-c>=0&&d+c<=u){const e=new mu(_,y,m,f);e._round(),i&&!gu(t,e,o,i,r)||p.push(e)}}h+=a}return a||p.length||s||(p=wu(t,h/2,n,i,r,o,s,!0,l)),p}function Cu(t,e,n,i,o){const s=[];for(let a=0;a<t.length;a++){const l=t[a];let c;for(let t=0;t<l.length-1;t++){let a=l[t],u=l[t+1];a.x<e&&u.x<e||(a.x<e?a=new r(e,a.y+(e-a.x)/(u.x-a.x)*(u.y-a.y))._round():u.x<e&&(u=new r(e,a.y+(e-a.x)/(u.x-a.x)*(u.y-a.y))._round()),a.y<n&&u.y<n||(a.y<n?a=new r(a.x+(n-a.y)/(u.y-a.y)*(u.x-a.x),n)._round():u.y<n&&(u=new r(a.x+(n-a.y)/(u.y-a.y)*(u.x-a.x),n)._round()),a.x>=i&&u.x>=i||(a.x>=i?a=new r(i,a.y+(i-a.x)/(u.x-a.x)*(u.y-a.y))._round():u.x>=i&&(u=new r(i,a.y+(i-a.x)/(u.x-a.x)*(u.y-a.y))._round()),a.y>=o&&u.y>=o||(a.y>=o?a=new r(a.x+(o-a.y)/(u.y-a.y)*(u.x-a.x),o)._round():u.y>=o&&(u=new r(a.x+(o-a.y)/(u.y-a.y)*(u.x-a.x),o)._round()),c&&a.equals(c[c.length-1])||(c=[a],s.push(c)),c.push(u)))))}}return s}or("Anchor",mu);var Tu=ku,Su=ku,Eu=1e20;function ku(t,e,n,i,r,o){this.fontSize=t||24,this.buffer=void 0===e?3:e,this.cutoff=i||.25,this.fontFamily=r||"sans-serif",this.fontWeight=o||"normal",this.radius=n||8;var s=this.size=this.fontSize+2*this.buffer,a=s+2*this.buffer;this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=s,this.ctx=this.canvas.getContext("2d"),this.ctx.font=this.fontWeight+" "+this.fontSize+"px "+this.fontFamily,this.ctx.textAlign="left",this.ctx.fillStyle="black",this.gridOuter=new Float64Array(a*a),this.gridInner=new Float64Array(a*a),this.f=new Float64Array(a),this.z=new Float64Array(a+1),this.v=new Uint16Array(a),this.useMetrics=void 0!==this.ctx.measureText("A").actualBoundingBoxLeft,this.middle=Math.round(s/2*(navigator.userAgent.indexOf("Gecko/")>=0?1.2:1))}function Au(t,e,n,i,r,o){for(var s=0;s<e;s++)Iu(t,s,e,n,i,r,o);for(var a=0;a<n;a++)Iu(t,a*e,1,e,i,r,o)}function Iu(t,e,n,i,r,o,s){var a,l,c,u;for(o[0]=0,s[0]=-Eu,s[1]=Eu,a=0;a<i;a++)r[a]=t[e+a*n];for(a=1,l=0,c=0;a<i;a++){do{c=(r[a]-r[u=o[l]]+a*a-u*u)/(a-u)/2}while(c<=s[l]&&--l>-1);o[++l]=a,s[l]=c,s[l+1]=Eu}for(a=0,l=0;a<i;a++){for(;s[l+1]<a;)l++;t[e+a*n]=r[u=o[l]]+(a-u)*(a-u)}}ku.prototype._draw=function(t,e){var n,i,r,o,s,a,l,c,u,h=this.ctx.measureText(t),d=h.width,p=2*this.buffer;e&&this.useMetrics?(s=Math.floor(h.actualBoundingBoxAscent),c=this.buffer+Math.ceil(h.actualBoundingBoxAscent),a=this.buffer,l=this.buffer,n=(i=Math.min(this.size,Math.ceil(h.actualBoundingBoxRight-h.actualBoundingBoxLeft)))+p,r=(o=Math.min(this.size-a,Math.ceil(h.actualBoundingBoxAscent+h.actualBoundingBoxDescent)))+p,this.ctx.textBaseline="alphabetic"):(n=i=this.size,r=o=this.size,s=19*this.fontSize/24,a=l=0,c=this.middle,this.ctx.textBaseline="middle"),i&&o&&(this.ctx.clearRect(l,a,i,o),this.ctx.fillText(t,this.buffer,c),u=this.ctx.getImageData(l,a,i,o));var f=new Uint8ClampedArray(n*r);return function(t,e,n,i,r,o,s){o.fill(Eu,0,e*n),s.fill(0,0,e*n);for(var a=(e-i)/2,l=0;l<r;l++)for(var c=0;c<i;c++){var u=(l+a)*e+c+a,h=t.data[4*(l*i+c)+3]/255;if(1===h)o[u]=0,s[u]=Eu;else if(0===h)o[u]=Eu,s[u]=0;else{var d=Math.max(0,.5-h),p=Math.max(0,h-.5);o[u]=d*d,s[u]=p*p}}}(u,n,r,i,o,this.gridOuter,this.gridInner),Au(this.gridOuter,n,r,this.f,this.v,this.z),Au(this.gridInner,n,r,this.f,this.v,this.z),function(t,e,n,i,r,o,s){for(var a=0;a<e*n;a++){var l=Math.sqrt(i[a])-Math.sqrt(r[a]);t[a]=Math.round(255-255*(l/o+s))}}(f,n,r,this.gridOuter,this.gridInner,this.radius,this.cutoff),{data:f,metrics:{width:i,height:o,sdfWidth:n,sdfHeight:r,top:s,left:0,advance:d}}},ku.prototype.draw=function(t){return this._draw(t,!1).data},ku.prototype.drawWithMetrics=function(t){return this._draw(t,!0)},Tu.default=Su;const Pu={none:0,ideographs:1,all:2};class Mu{constructor(t,e,n){this.requestManager=t,this.localGlyphMode=e,this.localFontFamily=n,this.entries={},this.localGlyphs={200:{},400:{},500:{},900:{}}}setURL(t){this.url=t}getGlyphs(t,e){const n=[];for(const i in t)for(const e of t[i])n.push({stack:i,id:e});_(n,({stack:t,id:e},n)=>{let i=this.entries[t];i||(i=this.entries[t]={glyphs:{},requests:{},ranges:{}});let r=i.glyphs[e];if(void 0!==r)return void n(null,{stack:t,id:e,glyph:r});if(r=this._tinySDF(i,t,e),r)return i.glyphs[e]=r,void n(null,{stack:t,id:e,glyph:r});const o=Math.floor(e/256);if(256*o>65535)return void n(new Error("glyphs > 65535 not supported"));if(i.ranges[o])return void n(null,{stack:t,id:e,glyph:r});let s=i.requests[o];s||(s=i.requests[o]=[],Mu.loadGlyphRange(t,o,this.url,this.requestManager,(t,e)=>{if(e){for(const t in e)this._doesCharSupportLocalGlyph(+t)||(i.glyphs[+t]=e[+t]);i.ranges[o]=!0}for(const n of s)n(t,e);delete i.requests[o]})),s.push((i,r)=>{i?n(i):r&&n(null,{stack:t,id:e,glyph:r[e]||null})})},(t,n)=>{if(t)e(t);else if(n){const t={};for(const{stack:e,id:i,glyph:r}of n)(t[e]||(t[e]={}))[i]=r&&{id:r.id,bitmap:r.bitmap.clone(),metrics:r.metrics};e(null,t)}})}_doesCharSupportLocalGlyph(t){return this.localGlyphMode!==Pu.none&&(this.localGlyphMode===Pu.all?!!this.localFontFamily:!!this.localFontFamily&&(kr(t)||Pr(t)||yr(t)||vr(t)))}_tinySDF(t,e,n){const i=this.localFontFamily;if(!i)return;if(!this._doesCharSupportLocalGlyph(n))return;let r=t.tinySDF;if(!r){let n="400";/bold/i.test(e)?n="900":/medium/i.test(e)?n="500":/light/i.test(e)&&(n="200"),r=t.tinySDF=new Mu.TinySDF(48,6,16,.25,i,n)}if(this.localGlyphs[r.fontWeight][n])return this.localGlyphs[r.fontWeight][n];const{data:o,metrics:s}=r.drawWithMetrics(String.fromCharCode(n)),{sdfWidth:a,sdfHeight:l,width:c,height:u,left:h,top:d,advance:p}=s;return this.localGlyphs[r.fontWeight][n]={id:n,bitmap:new Ua({width:a,height:l},o),metrics:{width:c/2,height:u/2,left:h/2,top:d/2-27,advance:p/2,localGlyph:!0}}}}function Ou(t,e,n,i){const o=[],s=t.image,a=s.pixelRatio,l=s.paddedRect.w-2,c=s.paddedRect.h-2,u=t.right-t.left,h=t.bottom-t.top,d=s.stretchX||[[0,l]],p=s.stretchY||[[0,c]],f=(t,e)=>t+e[1]-e[0],m=d.reduce(f,0),g=p.reduce(f,0),_=l-m,y=c-g;let v=0,x=m,b=0,w=g,C=0,T=_,S=0,E=y;if(s.content&&i){const t=s.content;v=zu(d,0,t[0]),b=zu(p,0,t[1]),x=zu(d,t[0],t[2]),w=zu(p,t[1],t[3]),C=t[0]-v,S=t[1]-b,T=t[2]-t[0]-x,E=t[3]-t[1]-w}const k=(i,o,l,c)=>{const d=Lu(i.stretch-v,x,u,t.left),p=Ru(i.fixed-C,T,i.stretch,m),f=Lu(o.stretch-b,w,h,t.top),_=Ru(o.fixed-S,E,o.stretch,g),y=Lu(l.stretch-v,x,u,t.left),k=Ru(l.fixed-C,T,l.stretch,m),A=Lu(c.stretch-b,w,h,t.top),I=Ru(c.fixed-S,E,c.stretch,g),P=new r(d,f),M=new r(y,f),O=new r(y,A),z=new r(d,A),D=new r(p/a,_/a),L=new r(k/a,I/a),R=e*Math.PI/180;if(R){const t=Math.sin(R),e=Math.cos(R),n=[e,-t,t,e];P._matMult(n),M._matMult(n),z._matMult(n),O._matMult(n)}const F=i.stretch+i.fixed,B=o.stretch+o.fixed;return{tl:P,tr:M,bl:z,br:O,tex:{x:s.paddedRect.x+1+F,y:s.paddedRect.y+1+B,w:l.stretch+l.fixed-F,h:c.stretch+c.fixed-B},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:D,pixelOffsetBR:L,minFontScaleX:T/a/u,minFontScaleY:E/a/h,isSDF:n}};if(i&&(s.stretchX||s.stretchY)){const t=Du(d,_,m),e=Du(p,y,g);for(let n=0;n<t.length-1;n++){const i=t[n],r=t[n+1];for(let t=0;t<e.length-1;t++)o.push(k(i,e[t],r,e[t+1]))}}else o.push(k({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:l+1},{fixed:0,stretch:c+1}));return o}function zu(t,e,n){let i=0;for(const r of t)i+=Math.max(e,Math.min(n,r[1]))-Math.max(e,Math.min(n,r[0]));return i}function Du(t,e,n){const i=[{fixed:-1,stretch:0}];for(const[r,o]of t){const t=i[i.length-1];i.push({fixed:r-t.stretch,stretch:t.stretch}),i.push({fixed:r-t.stretch,stretch:t.stretch+(o-r)})}return i.push({fixed:e+1,stretch:n}),i}function Lu(t,e,n,i){return t/e*n+i}function Ru(t,e,n,i){return t-e*n/i}Mu.loadGlyphRange=function(t,e,n,i,r){const o=256*e,s=o+255,a=i.transformRequest(i.normalizeGlyphsURL(n).replace("{fontstack}",t).replace("{range}",`${o}-${s}`),bt.Glyphs);St(a,(t,e)=>{if(t)r(t);else if(e){const t={};for(const n of function(t){return new kc(t).readFields(Hc,[])}(e))t[n.id]=n;r(null,t)}})},Mu.TinySDF=Tu;class Fu{constructor(t=[],e=Bu){if(this.data=t,this.length=this.data.length,this.compare=e,this.length>0)for(let n=(this.length>>1)-1;n>=0;n--)this._down(n)}push(t){this.data.push(t),this.length++,this._up(this.length-1)}pop(){if(0===this.length)return;const t=this.data[0],e=this.data.pop();return this.length--,this.length>0&&(this.data[0]=e,this._down(0)),t}peek(){return this.data[0]}_up(t){const{data:e,compare:n}=this,i=e[t];for(;t>0;){const r=t-1>>1,o=e[r];if(n(i,o)>=0)break;e[t]=o,t=r}e[t]=i}_down(t){const{data:e,compare:n}=this,i=this.length>>1,r=e[t];for(;t<i;){let i=1+(t<<1),o=e[i];const s=i+1;if(s<this.length&&n(e[s],o)<0&&(i=s,o=e[s]),n(o,r)>=0)break;e[t]=o,t=i}e[t]=r}}function Bu(t,e){return t<e?-1:t>e?1:0}function Vu(t,e=1,n=!1){let i=1/0,o=1/0,s=-1/0,a=-1/0;const l=t[0];for(let r=0;r<l.length;r++){const t=l[r];(!r||t.x<i)&&(i=t.x),(!r||t.y<o)&&(o=t.y),(!r||t.x>s)&&(s=t.x),(!r||t.y>a)&&(a=t.y)}const c=Math.min(s-i,a-o);let u=c/2;const h=new Fu([],Uu);if(0===c)return new r(i,o);for(let r=i;r<s;r+=c)for(let e=o;e<a;e+=c)h.push(new Nu(r+u,e+u,u,t));let d=function(t){let e=0,n=0,i=0;const r=t[0];for(let o=0,s=r.length,a=s-1;o<s;a=o++){const t=r[o],s=r[a],l=t.x*s.y-s.x*t.y;n+=(t.x+s.x)*l,i+=(t.y+s.y)*l,e+=3*l}return new Nu(n/e,i/e,0,t)}(t),p=h.length;for(;h.length;){const i=h.pop();(i.d>d.d||!d.d)&&(d=i,n&&console.log("found best %d after %d probes",Math.round(1e4*i.d)/1e4,p)),i.max-d.d<=e||(u=i.h/2,h.push(new Nu(i.p.x-u,i.p.y-u,u,t)),h.push(new Nu(i.p.x+u,i.p.y-u,u,t)),h.push(new Nu(i.p.x-u,i.p.y+u,u,t)),h.push(new Nu(i.p.x+u,i.p.y+u,u,t)),p+=4)}return n&&(console.log("num probes: "+p),console.log("best distance: "+d.d)),d.p}function Uu(t,e){return e.max-t.max}function Nu(t,e,n,i){this.p=new r(t,e),this.h=n,this.d=function(t,e){let n=!1,i=1/0;for(let r=0;r<e.length;r++){const o=e[r];for(let e=0,r=o.length,s=r-1;e<r;s=e++){const r=o[e],a=o[s];r.y>t.y!=a.y>t.y&&t.x<(a.x-r.x)*(t.y-r.y)/(a.y-r.y)+r.x&&(n=!n),i=Math.min(i,ta(t,r,a))}}return(n?1:-1)*Math.sqrt(i)}(this.p,i),this.max=this.d+this.h*Math.SQRT2}const ju=Number.POSITIVE_INFINITY;function qu(t,e){return e[1]!==ju?function(t,e,n){let i=0,r=0;switch(e=Math.abs(e),n=Math.abs(n),t){case"top-right":case"top-left":case"top":r=n-7;break;case"bottom-right":case"bottom-left":case"bottom":r=7-n}switch(t){case"top-right":case"bottom-right":case"right":i=-e;break;case"top-left":case"bottom-left":case"left":i=e}return[i,r]}(t,e[0],e[1]):function(t,e){let n=0,i=0;e<0&&(e=0);const r=e/Math.sqrt(2);switch(t){case"top-right":case"top-left":i=r-7;break;case"bottom-right":case"bottom-left":i=7-r;break;case"bottom":i=7-e;break;case"top":i=e-7}switch(t){case"top-right":case"bottom-right":n=-r;break;case"top-left":case"bottom-left":n=r;break;case"left":n=e;break;case"right":n=-e}return[n,i]}(t,e[0])}function $u(t,e,n,i,r,o,s,a){t.createArrays(),t.tilePixelRatio=Us/(512*t.overscaling),t.compareText={},t.iconsNeedLinear=!1;const l=t.layers[0].layout,c=t.layers[0]._unevaluatedLayout._values,u={};if("composite"===t.textSizeData.kind){const{minZoom:e,maxZoom:n}=t.textSizeData;u.compositeTextSizes=[c["text-size"].possiblyEvaluate(new ro(e),s),c["text-size"].possiblyEvaluate(new ro(n),s)]}if("composite"===t.iconSizeData.kind){const{minZoom:e,maxZoom:n}=t.iconSizeData;u.compositeIconSizes=[c["icon-size"].possiblyEvaluate(new ro(e),s),c["icon-size"].possiblyEvaluate(new ro(n),s)]}u.layoutTextSize=c["text-size"].possiblyEvaluate(new ro(a+1),s),u.layoutIconSize=c["icon-size"].possiblyEvaluate(new ro(a+1),s),u.textMaxSize=c["text-size"].possiblyEvaluate(new ro(18),s);const h="map"===l.get("text-rotation-alignment")&&"point"!==l.get("symbol-placement"),d=l.get("text-keep-upright"),p=l.get("text-size");for(const f of t.features){const o=l.get("text-font").evaluate(f,{},s).join(","),a=p.evaluate(f,{},s),c=u.layoutTextSize.evaluate(f,{},s),m=(u.layoutIconSize.evaluate(f,{},s),{horizontal:{},vertical:void 0}),g=f.text;let _,y=[0,0];if(g){const i=g.toString(),u=24*l.get("text-letter-spacing").evaluate(f,{},s),p=24*l.get("text-line-height").evaluate(f,{},s),_=Vr(i)?u:0,v=l.get("text-anchor").evaluate(f,{},s),x=l.get("text-variable-anchor");if(!x){const t=l.get("text-radial-offset").evaluate(f,{},s);y=t?qu(v,[24*t,ju]):l.get("text-offset").evaluate(f,{},s).map(t=>24*t)}let b=h?"center":l.get("text-justify").evaluate(f,{},s);const w=l.get("symbol-placement"),C="point"===w?24*l.get("text-max-width").evaluate(f,{},s):0,T=()=>{t.allowVerticalPlacement&&Br(i)&&(m.vertical=nu(g,e,n,r,o,C,p,v,"left",_,y,Qc.vertical,!0,w,c,a))};if(!h&&x){const t="auto"===b?x.map(t=>Gu(t)):[b];let i=!1;for(let s=0;s<t.length;s++){const l=t[s];if(!m.horizontal[l])if(i)m.horizontal[l]=m.horizontal[0];else{const t=nu(g,e,n,r,o,C,p,"center",l,_,y,Qc.horizontal,!1,w,c,a);t&&(m.horizontal[l]=t,i=1===t.positionedLines.length)}}T()}else{"auto"===b&&(b=Gu(v));const t=nu(g,e,n,r,o,C,p,v,b,_,y,Qc.horizontal,!1,w,c,a);t&&(m.horizontal[b]=t),T(),Br(i)&&h&&d&&(m.vertical=nu(g,e,n,r,o,C,p,v,b,_,y,Qc.vertical,!1,w,c,a))}}let v=!1;if(f.icon&&f.icon.name){const e=i[f.icon.name];e&&(_=pu(r[f.icon.name],l.get("icon-offset").evaluate(f,{},s),l.get("icon-anchor").evaluate(f,{},s)),v=e.sdf,void 0===t.sdfIcons?t.sdfIcons=e.sdf:t.sdfIcons!==e.sdf&&M("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(e.pixelRatio!==t.pixelRatio||0!==l.get("icon-rotate").constantOr(1))&&(t.iconsNeedLinear=!0))}const x=Xu(m.horizontal)||m.vertical;t.iconsInText||(t.iconsInText=!!x&&x.iconsInText),(x||_)&&Zu(t,f,m,_,i,u,c,0,y,v,s)}o&&t.generateCollisionDebugBuffers(a,t.collisionBoxArray)}function Gu(t){switch(t){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function Zu(t,e,n,i,r,o,s,a,l,c,h){let d=o.textMaxSize.evaluate(e,{},h);void 0===d&&(d=s);const p=t.layers[0].layout,f=p.get("icon-offset").evaluate(e,{},h),m=Xu(n.horizontal),g=s/24,_=t.tilePixelRatio*g,y=t.tilePixelRatio*d/24,v=t.tilePixelRatio*p.get("symbol-spacing"),x=p.get("text-padding")*t.tilePixelRatio,b=p.get("icon-padding")*t.tilePixelRatio,w=u(p.get("text-max-angle")),C="map"===p.get("text-rotation-alignment")&&"point"!==p.get("symbol-placement"),T="map"===p.get("icon-rotation-alignment")&&"point"!==p.get("symbol-placement"),S=p.get("symbol-placement"),E=v/2,k=p.get("icon-text-fit");let A;i&&"none"!==k&&(t.allowVerticalPlacement&&n.vertical&&(A=fu(i,n.vertical,k,p.get("icon-text-fit-padding"),f,g)),m&&(i=fu(i,m,k,p.get("icon-text-fit-padding"),f,g)));const I=(a,u)=>{u.x<0||u.x>=Us||u.y<0||u.y>=Us||function(t,e,n,i,r,o,s,a,l,c,u,h,d,p,f,m,g,_,y,v,x,b,w,C,T){const S=t.addToLineVertexArray(e,n);let E,k,A,I,P,O,z,D=0,L=0,R=0,F=0,B=-1,V=-1;const U={};let N=us(""),j=0,q=0;if(void 0===a._unevaluatedLayout.getValue("text-radial-offset")?[j,q]=a.layout.get("text-offset").evaluate(x,{},C).map(t=>24*t):(j=24*a.layout.get("text-radial-offset").evaluate(x,{},C),q=ju),t.allowVerticalPlacement&&i.vertical){const t=i.vertical;if(f)O=Yu(t),s&&(z=Yu(s));else{const n=a.layout.get("text-rotate").evaluate(x,{},C)+90;A=Ku(l,e,c,u,h,t,0,p,n),s&&(I=Ku(l,e,c,u,h,s,0,_,n))}}if(r){const n=a.layout.get("icon-rotate").evaluate(x,{},C),i="none"!==a.layout.get("icon-text-fit"),o=Ou(r,n,w,i),d=s?Ou(s,n,w,i):void 0;k=Ku(l,e,c,u,h,r,0,_,n),D=4*o.length;const p=t.iconSizeData;let f=null;"source"===p.kind?(f=[yc*a.layout.get("icon-size").evaluate(x,{},C)],f[0]>Hu&&M(t.layerIds[0]+': Value for "icon-size" is >= 255. Reduce your "icon-size".')):"composite"===p.kind&&(f=[yc*b.compositeIconSizes[0].evaluate(x,{},C),yc*b.compositeIconSizes[1].evaluate(x,{},C)],(f[0]>Hu||f[1]>Hu)&&M(t.layerIds[0]+': Value for "icon-size" is >= 255. Reduce your "icon-size".')),t.addSymbols(t.icon,o,f,v,y,x,!1,e,S.lineStartIndex,S.lineLength,-1,C),B=t.icon.placedSymbolArray.length-1,d&&(L=4*d.length,t.addSymbols(t.icon,d,f,v,y,x,Qc.vertical,e,S.lineStartIndex,S.lineLength,-1,C),V=t.icon.placedSymbolArray.length-1)}for(const M in i.horizontal){const n=i.horizontal[M];E||(N=us(n.text),f?P=Yu(n):E=Ku(l,e,c,u,h,n,0,p,a.layout.get("text-rotate").evaluate(x,{},C)));const r=1===n.positionedLines.length;if(R+=Wu(t,e,n,o,a,f,x,m,S,i.vertical?Qc.horizontal:Qc.horizontalOnly,r?Object.keys(i.horizontal):[M],U,B,b,C),r)break}i.vertical&&(F+=Wu(t,e,i.vertical,o,a,f,x,m,S,Qc.vertical,["vertical"],U,V,b,C));let $=-1;const G=(t,e)=>t?Math.max(t,e):e;$=G(P,$),$=G(O,$),$=G(z,$);const Z=$>-1?1:0;Z&&($*=T/24),t.glyphOffsetArray.length>=sh.MAX_GLYPHS&&M("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),void 0!==x.sortKey&&t.addToSortKeyRanges(t.symbolInstances.length,x.sortKey),t.symbolInstances.emplaceBack(e.x,e.y,U.right>=0?U.right:-1,U.center>=0?U.center:-1,U.left>=0?U.left:-1,U.vertical||-1,B,V,N,void 0!==E?E:t.collisionBoxArray.length,void 0!==E?E+1:t.collisionBoxArray.length,void 0!==A?A:t.collisionBoxArray.length,void 0!==A?A+1:t.collisionBoxArray.length,void 0!==k?k:t.collisionBoxArray.length,void 0!==k?k+1:t.collisionBoxArray.length,I||t.collisionBoxArray.length,I?I+1:t.collisionBoxArray.length,c,R,F,D,L,Z,0,d,j,q,$)}(t,u,a,n,i,r,A,t.layers[0],t.collisionBoxArray,e.index,e.sourceLayerIndex,t.index,_,x,C,l,0,b,T,f,e,o,c,h,s)};if("line"===S)for(const u of Cu(e.geometry,0,0,Us,Us)){const e=bu(u,v,w,n.vertical||m,i,24,y,t.overscaling,Us);for(const n of e){const e=m;e&&Ju(t,e.text,E,n)||I(u,n)}}else if("line-center"===S){for(const t of e.geometry)if(t.length>1){const e=xu(t,w,n.vertical||m,i,24,y);e&&I(t,e)}}else if("Polygon"===e.type)for(const u of Sl(e.geometry,0)){const t=Vu(u,16);I(u[0],new mu(t.x,t.y,0))}else if("LineString"===e.type)for(const u of e.geometry)I(u,new mu(u[0].x,u[0].y,0));else if("Point"===e.type)for(const u of e.geometry)for(const t of u)I([t],new mu(t.x,t.y,0))}const Hu=32640;function Wu(t,e,n,i,o,s,a,l,c,u,h,d,p,f,m){const g=function(t,e,n,i,o,s,a,l){const c=i.layout.get("text-rotate").evaluate(s,{})*Math.PI/180,u=[];for(const h of e.positionedLines)for(const t of h.positionedGlyphs){if(!t.rect)continue;const i=t.rect||{};let s=4,d=!0,p=1,f=0;const m=(o||l)&&t.vertical,g=t.metrics.advance*t.scale/2;if(l&&e.verticalizable){const e=24*(t.scale-1),n=(24-t.metrics.width*t.scale)/2;f=h.lineOffset/2-(t.imageName?-n:e)}if(t.imageName){const e=a[t.imageName];d=e.sdf,p=e.pixelRatio,s=1/p}const _=o?[t.x+g,t.y]:[0,0];let y=o?[0,0]:[t.x+g+n[0],t.y+n[1]-f],v=[0,0];m&&(v=y,y=[0,0]);const x=(t.metrics.left-s)*t.scale-g+y[0],b=(-t.metrics.top-s)*t.scale+y[1],w=x+i.w*t.scale/(p*(t.localGlyph?2:1)),C=b+i.h*t.scale/(p*(t.localGlyph?2:1)),T=new r(x,b),S=new r(w,b),E=new r(x,C),k=new r(w,C);if(m){const e=new r(-g,g- -17),n=-Math.PI/2,i=12-g,o=new r(22-i,-(t.imageName?i:0)),s=new r(...v);T._rotateAround(n,e)._add(o)._add(s),S._rotateAround(n,e)._add(o)._add(s),E._rotateAround(n,e)._add(o)._add(s),k._rotateAround(n,e)._add(o)._add(s)}if(c){const t=Math.sin(c),e=Math.cos(c),n=[e,-t,t,e];T._matMult(n),S._matMult(n),E._matMult(n),k._matMult(n)}const A=new r(0,0),I=new r(0,0);u.push({tl:T,tr:S,bl:E,br:k,tex:i,writingMode:e.writingMode,glyphOffset:_,sectionIndex:t.sectionIndex,isSDF:d,pixelOffsetTL:A,pixelOffsetBR:I,minFontScaleX:0,minFontScaleY:0})}return u}(0,n,l,o,s,a,i,t.allowVerticalPlacement),_=t.textSizeData;let y=null;"source"===_.kind?(y=[yc*o.layout.get("text-size").evaluate(a,{},m)],y[0]>Hu&&M(t.layerIds[0]+': Value for "text-size" is >= 255. Reduce your "text-size".')):"composite"===_.kind&&(y=[yc*f.compositeTextSizes[0].evaluate(a,{},m),yc*f.compositeTextSizes[1].evaluate(a,{},m)],(y[0]>Hu||y[1]>Hu)&&M(t.layerIds[0]+': Value for "text-size" is >= 255. Reduce your "text-size".')),t.addSymbols(t.text,g,y,l,s,a,u,e,c.lineStartIndex,c.lineLength,p,m);for(const r of h)d[r]=t.text.placedSymbolArray.length-1;return 4*g.length}function Xu(t){for(const e in t)return t[e];return null}function Ku(t,e,n,i,o,s,a,l,c){let h=s.top,d=s.bottom,p=s.left,f=s.right;const m=s.collisionPadding;if(m&&(p-=m[0],h-=m[1],f+=m[2],d+=m[3]),c){const t=new r(p,h),e=new r(f,h),n=new r(p,d),i=new r(f,d),o=u(c);t._rotate(o),e._rotate(o),n._rotate(o),i._rotate(o),p=Math.min(t.x,e.x,n.x,i.x),f=Math.max(t.x,e.x,n.x,i.x),h=Math.min(t.y,e.y,n.y,i.y),d=Math.max(t.y,e.y,n.y,i.y)}return t.emplaceBack(e.x,e.y,p,h,f,d,l,n,i,o),t.length-1}function Yu(t){t.collisionPadding&&(t.top-=t.collisionPadding[1],t.bottom+=t.collisionPadding[3]);const e=t.bottom-t.top;return e>0?Math.max(10,e):null}function Ju(t,e,n,i){const r=t.compareText;if(e in r){const t=r[e];for(let e=t.length-1;e>=0;e--)if(i.dist(t[e])<n)return!0}else r[e]=[];return r[e].push(i),!1}const Qu=ql.VectorTileFeature.types,th=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function eh(t,e,n,i,r,o,s,a,l,c,u,h,d){const p=a?Math.min(Hu,Math.round(a[0])):0,f=a?Math.min(Hu,Math.round(a[1])):0;t.emplaceBack(e,n,Math.round(32*i),Math.round(32*r),o,s,(p<<1)+(l?1:0),f,16*c,16*u,256*h,256*d)}function nh(t,e,n){t.emplaceBack(e.x,e.y,n),t.emplaceBack(e.x,e.y,n),t.emplaceBack(e.x,e.y,n),t.emplaceBack(e.x,e.y,n)}function ih(t){for(const e of t.sections)if(Gr(e.text))return!0;return!1}class rh{constructor(t){this.layoutVertexArray=new Oo,this.indexArray=new Vo,this.programConfigurations=t,this.segments=new Vs,this.dynamicLayoutVertexArray=new zo,this.opacityVertexArray=new Do,this.placedSymbolArray=new Yo}isEmpty(){return 0===this.layoutVertexArray.length&&0===this.indexArray.length&&0===this.dynamicLayoutVertexArray.length&&0===this.opacityVertexArray.length}upload(t,e,n,i){this.isEmpty()||(n&&(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,dc.members),this.indexBuffer=t.createIndexBuffer(this.indexArray,e),this.dynamicLayoutVertexBuffer=t.createVertexBuffer(this.dynamicLayoutVertexArray,pc.members,!0),this.opacityVertexBuffer=t.createVertexBuffer(this.opacityVertexArray,th,!0),this.opacityVertexBuffer.itemSize=1),(n||i)&&this.programConfigurations.upload(t))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())}}or("SymbolBuffers",rh);class oh{constructor(t,e,n){this.layoutVertexArray=new t,this.layoutAttributes=e,this.indexArray=new n,this.segments=new Vs,this.collisionVertexArray=new Bo,this.collisionVertexArrayExt=new zo}upload(t){this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=t.createVertexBuffer(this.collisionVertexArray,fc.members,!0),this.collisionVertexBufferExt=t.createVertexBuffer(this.collisionVertexArrayExt,mc.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy(),this.collisionVertexBufferExt.destroy())}}or("CollisionBuffers",oh);class sh{constructor(t){this.collisionBoxArray=t.collisionBoxArray,this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(t=>t.id),this.index=t.index,this.pixelRatio=t.pixelRatio,this.sourceLayerIndex=t.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=pa([]),this.placementViewportMatrix=pa([]);const e=this.layers[0]._unevaluatedLayout._values;this.textSizeData=vc(this.zoom,e["text-size"]),this.iconSizeData=vc(this.zoom,e["icon-size"]);const n=this.layers[0].layout,i=n.get("symbol-sort-key"),r=n.get("symbol-z-order");this.canOverlap=n.get("text-allow-overlap")||n.get("icon-allow-overlap")||n.get("text-ignore-placement")||n.get("icon-ignore-placement"),this.sortFeaturesByKey="viewport-y"!==r&&void 0!==i.constantOr(1),this.sortFeaturesByY=("viewport-y"===r||"auto"===r&&!this.sortFeaturesByKey)&&this.canOverlap,"point"===n.get("symbol-placement")&&(this.writingModes=n.get("text-writing-mode").map(t=>Qc[t])),this.stateDependentLayerIds=this.layers.filter(t=>t.isStateDependent()).map(t=>t.id),this.sourceID=t.sourceID}createArrays(){this.text=new rh(new Is(this.layers,this.zoom,t=>/^text/.test(t))),this.icon=new rh(new Is(this.layers,this.zoom,t=>/^icon/.test(t))),this.glyphOffsetArray=new ts,this.lineVertexArray=new es,this.symbolInstances=new Qo}calculateGlyphDependencies(t,e,n,i,r){for(let o=0;o<t.length;o++)if(e[t.charCodeAt(o)]=!0,(n||i)&&r){const n=Tc[t.charAt(o)];n&&(e[n.charCodeAt(0)]=!0)}}populate(t,e,n){const i=this.layers[0],r=i.layout,o=r.get("text-font"),s=r.get("text-field"),a=r.get("icon-image"),l=("constant"!==s.value.kind||s.value.value instanceof pe&&!s.value.value.isEmpty()||s.value.value.toString().length>0)&&("constant"!==o.value.kind||o.value.value.length>0),c="constant"!==a.value.kind||!!a.value.value||Object.keys(a.parameters).length>0,u=r.get("symbol-sort-key");if(this.features=[],!l&&!c)return;const h=e.iconDependencies,d=e.glyphDependencies,p=e.availableImages,f=new ro(this.zoom);for(const{feature:m,id:g,index:_,sourceLayerIndex:y}of t){const t=i._featureFilter.needGeometry,e=$s(m,t);if(!i._featureFilter.filter(f,e,n))continue;let s,a;if(t||(e.geometry=qs(m)),l){const t=i.getValueAndResolveTokens("text-field",e,n,p),r=pe.factory(t);ih(r)&&(this.hasRTLText=!0),(!this.hasRTLText||"unavailable"===eo()||this.hasRTLText&&io.isParsed())&&(s=Cc(r,i,e))}if(c){const t=i.getValueAndResolveTokens("icon-image",e,n,p);a=t instanceof fe?t:fe.fromString(t)}if(!s&&!a)continue;const v=this.sortFeaturesByKey?u.evaluate(e,{},n):void 0;if(this.features.push({id:g,text:s,icon:a,index:_,sourceLayerIndex:y,geometry:e.geometry,properties:m.properties,type:Qu[m.type],sortKey:v}),a&&(h[a.name]=!0),s){const t=o.evaluate(e,{},n).join(","),i="map"===r.get("text-rotation-alignment")&&"point"!==r.get("symbol-placement");this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(Qc.vertical)>=0;for(const e of s.sections)if(e.image)h[e.image.name]=!0;else{const n=Br(s.toString()),r=e.fontStack||t,o=d[r]=d[r]||{};this.calculateGlyphDependencies(e.text,o,i,this.allowVerticalPlacement,n)}}}"line"===r.get("symbol-placement")&&(this.features=function(t){const e={},n={},i=[];let r=0;function o(e){i.push(t[e]),r++}function s(t,e,r){const o=n[t];return delete n[t],n[e]=o,i[o].geometry[0].pop(),i[o].geometry[0]=i[o].geometry[0].concat(r[0]),o}function a(t,n,r){const o=e[n];return delete e[n],e[t]=o,i[o].geometry[0].shift(),i[o].geometry[0]=r[0].concat(i[o].geometry[0]),o}function l(t,e,n){const i=n?e[0][e[0].length-1]:e[0][0];return`${t}:${i.x}:${i.y}`}for(let c=0;c<t.length;c++){const u=t[c],h=u.geometry,d=u.text?u.text.toString():null;if(!d){o(c);continue}const p=l(d,h),f=l(d,h,!0);if(p in n&&f in e&&n[p]!==e[f]){const t=a(p,f,h),r=s(p,f,i[t].geometry);delete e[p],delete n[f],n[l(d,i[r].geometry,!0)]=r,i[t].geometry=null}else p in n?s(p,f,h):f in e?a(p,f,h):(o(c),e[p]=r-1,n[f]=r-1)}return i.filter(t=>t.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((t,e)=>t.sortKey-e.sortKey)}update(t,e,n){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(t,e,this.layers,n),this.icon.programConfigurations.updatePaintArrays(t,e,this.layers,n))}isEmpty(){return 0===this.symbolInstances.length&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(t){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(t),this.iconCollisionBox.upload(t)),this.text.upload(t,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(t,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(t,e){const n=this.lineVertexArray.length;if(void 0!==t.segment){let n=t.dist(e[t.segment+1]),i=t.dist(e[t.segment]);const r={};for(let o=t.segment+1;o<e.length;o++)r[o]={x:e[o].x,y:e[o].y,tileUnitDistanceFromAnchor:n},o<e.length-1&&(n+=e[o+1].dist(e[o]));for(let o=t.segment||0;o>=0;o--)r[o]={x:e[o].x,y:e[o].y,tileUnitDistanceFromAnchor:i},o>0&&(i+=e[o-1].dist(e[o]));for(let t=0;t<e.length;t++){const e=r[t];this.lineVertexArray.emplaceBack(e.x,e.y,e.tileUnitDistanceFromAnchor)}}return{lineStartIndex:n,lineLength:this.lineVertexArray.length-n}}addSymbols(t,e,n,i,r,o,s,a,l,c,u,h){const d=t.indexArray,p=t.layoutVertexArray,f=t.segments.prepareSegment(4*e.length,p,d,this.canOverlap?o.sortKey:void 0),m=this.glyphOffsetArray.length,g=f.vertexLength,_=this.allowVerticalPlacement&&s===Qc.vertical?Math.PI/2:0,y=o.text&&o.text.sections;for(let v=0;v<e.length;v++){const{tl:i,tr:r,bl:s,br:l,tex:c,pixelOffsetTL:u,pixelOffsetBR:m,minFontScaleX:g,minFontScaleY:x,glyphOffset:b,isSDF:w,sectionIndex:C}=e[v],T=f.vertexLength,S=b[1];eh(p,a.x,a.y,i.x,S+i.y,c.x,c.y,n,w,u.x,u.y,g,x),eh(p,a.x,a.y,r.x,S+r.y,c.x+c.w,c.y,n,w,m.x,u.y,g,x),eh(p,a.x,a.y,s.x,S+s.y,c.x,c.y+c.h,n,w,u.x,m.y,g,x),eh(p,a.x,a.y,l.x,S+l.y,c.x+c.w,c.y+c.h,n,w,m.x,m.y,g,x),nh(t.dynamicLayoutVertexArray,a,_),d.emplaceBack(T,T+1,T+2),d.emplaceBack(T+1,T+2,T+3),f.vertexLength+=4,f.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(b[0]),v!==e.length-1&&C===e[v+1].sectionIndex||t.programConfigurations.populatePaintArrays(p.length,o,o.index,{},h,y&&y[C])}t.placedSymbolArray.emplaceBack(a.x,a.y,m,this.glyphOffsetArray.length-m,g,l,c,a.segment,n?n[0]:0,n?n[1]:0,i[0],i[1],s,0,!1,0,u)}_commitLayoutVertex(t,e,n,i,r){t.emplaceBack(e.x,e.y,n,i,Math.round(r.x),Math.round(r.y))}_addCollisionDebugVertices(t,e,n,i,o){const s=n.segments.prepareSegment(4,n.layoutVertexArray,n.indexArray),a=s.vertexLength,l=o.anchorX,c=o.anchorY;for(let r=0;r<4;r++)n.collisionVertexArray.emplaceBack(0,0,0,0);n.collisionVertexArrayExt.emplaceBack(e,-t.padding,-t.padding),n.collisionVertexArrayExt.emplaceBack(e,t.padding,-t.padding),n.collisionVertexArrayExt.emplaceBack(e,t.padding,t.padding),n.collisionVertexArrayExt.emplaceBack(e,-t.padding,t.padding),this._commitLayoutVertex(n.layoutVertexArray,i,l,c,new r(t.x1,t.y1)),this._commitLayoutVertex(n.layoutVertexArray,i,l,c,new r(t.x2,t.y1)),this._commitLayoutVertex(n.layoutVertexArray,i,l,c,new r(t.x2,t.y2)),this._commitLayoutVertex(n.layoutVertexArray,i,l,c,new r(t.x1,t.y2)),s.vertexLength+=4;const u=n.indexArray;u.emplaceBack(a,a+1),u.emplaceBack(a+1,a+2),u.emplaceBack(a+2,a+3),u.emplaceBack(a+3,a),s.primitiveLength+=4}_addTextDebugCollisionBoxes(t,e,n,i,r,o){for(let s=i;s<r;s++){const i=n.get(s),r=this.getSymbolInstanceTextSize(t,o,e,s);this._addCollisionDebugVertices(i,r,this.textCollisionBox,i.anchorPoint,o)}}_addIconDebugCollisionBoxes(t,e,n,i,r,o){for(let s=i;s<r;s++){const i=n.get(s),r=this.getSymbolInstanceIconSize(t,e,s);this._addCollisionDebugVertices(i,r,this.iconCollisionBox,i.anchorPoint,o)}}generateCollisionDebugBuffers(t,e){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new oh(Ro,gc.members,Go),this.iconCollisionBox=new oh(Ro,gc.members,Go);const n=bc(this.iconSizeData,t),i=bc(this.textSizeData,t);for(let r=0;r<this.symbolInstances.length;r++){const o=this.symbolInstances.get(r);this._addTextDebugCollisionBoxes(i,t,e,o.textBoxStartIndex,o.textBoxEndIndex,o),this._addTextDebugCollisionBoxes(i,t,e,o.verticalTextBoxStartIndex,o.verticalTextBoxEndIndex,o),this._addIconDebugCollisionBoxes(n,t,e,o.iconBoxStartIndex,o.iconBoxEndIndex,o),this._addIconDebugCollisionBoxes(n,t,e,o.verticalIconBoxStartIndex,o.verticalIconBoxEndIndex,o)}}getSymbolInstanceTextSize(t,e,n,i){const r=this.text.placedSymbolArray.get(e.rightJustifiedTextSymbolIndex>=0?e.rightJustifiedTextSymbolIndex:e.centerJustifiedTextSymbolIndex>=0?e.centerJustifiedTextSymbolIndex:e.leftJustifiedTextSymbolIndex>=0?e.leftJustifiedTextSymbolIndex:e.verticalPlacedTextSymbolIndex>=0?e.verticalPlacedTextSymbolIndex:i),o=xc(this.textSizeData,t,r)/24;return this.tilePixelRatio*o}getSymbolInstanceIconSize(t,e,n){const i=this.icon.placedSymbolArray.get(n),r=xc(this.iconSizeData,t,i);return this.tilePixelRatio*r}_commitDebugCollisionVertexUpdate(t,e,n){t.emplaceBack(e,-n,-n),t.emplaceBack(e,n,-n),t.emplaceBack(e,n,n),t.emplaceBack(e,-n,n)}_updateTextDebugCollisionBoxes(t,e,n,i,r,o){for(let s=i;s<r;s++){const i=n.get(s),r=this.getSymbolInstanceTextSize(t,o,e,s);this._commitDebugCollisionVertexUpdate(this.textCollisionBox.collisionVertexArrayExt,r,i.padding)}}_updateIconDebugCollisionBoxes(t,e,n,i,r){for(let o=i;o<r;o++){const i=n.get(o),r=this.getSymbolInstanceIconSize(t,e,o);this._commitDebugCollisionVertexUpdate(this.iconCollisionBox.collisionVertexArrayExt,r,i.padding)}}updateCollisionDebugBuffers(t,e){if(!this.hasDebugData())return;this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexArrayExt.clear(),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexArrayExt.clear();const n=bc(this.iconSizeData,t),i=bc(this.textSizeData,t);for(let r=0;r<this.symbolInstances.length;r++){const o=this.symbolInstances.get(r);this._updateTextDebugCollisionBoxes(i,t,e,o.textBoxStartIndex,o.textBoxEndIndex,o),this._updateTextDebugCollisionBoxes(i,t,e,o.verticalTextBoxStartIndex,o.verticalTextBoxEndIndex,o),this._updateIconDebugCollisionBoxes(n,t,e,o.iconBoxStartIndex,o.iconBoxEndIndex),this._updateIconDebugCollisionBoxes(n,t,e,o.verticalIconBoxStartIndex,o.verticalIconBoxEndIndex)}this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexBufferExt&&this.textCollisionBox.collisionVertexBufferExt.updateData(this.textCollisionBox.collisionVertexArrayExt),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexBufferExt&&this.iconCollisionBox.collisionVertexBufferExt.updateData(this.iconCollisionBox.collisionVertexArrayExt)}_deserializeCollisionBoxesForSymbol(t,e,n,i,r,o,s,a,l){const c={};for(let u=e;u<n;u++){const e=t.get(u);c.textBox={x1:e.x1,y1:e.y1,x2:e.x2,y2:e.y2,padding:e.padding,anchorPointX:e.anchorPointX,anchorPointY:e.anchorPointY},c.textFeatureIndex=e.featureIndex;break}for(let u=i;u<r;u++){const e=t.get(u);c.verticalTextBox={x1:e.x1,y1:e.y1,x2:e.x2,y2:e.y2,padding:e.padding,anchorPointX:e.anchorPointX,anchorPointY:e.anchorPointY},c.verticalTextFeatureIndex=e.featureIndex;break}for(let u=o;u<s;u++){const e=t.get(u);c.iconBox={x1:e.x1,y1:e.y1,x2:e.x2,y2:e.y2,padding:e.padding,anchorPointX:e.anchorPointX,anchorPointY:e.anchorPointY},c.iconFeatureIndex=e.featureIndex;break}for(let u=a;u<l;u++){const e=t.get(u);c.verticalIconBox={x1:e.x1,y1:e.y1,x2:e.x2,y2:e.y2,padding:e.padding,anchorPointX:e.anchorPointX,anchorPointY:e.anchorPointY},c.verticalIconFeatureIndex=e.featureIndex;break}return c}deserializeCollisionBoxes(t){this.collisionArrays=[];for(let e=0;e<this.symbolInstances.length;e++){const n=this.symbolInstances.get(e);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(t,n.textBoxStartIndex,n.textBoxEndIndex,n.verticalTextBoxStartIndex,n.verticalTextBoxEndIndex,n.iconBoxStartIndex,n.iconBoxEndIndex,n.verticalIconBoxStartIndex,n.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(t,e){const n=t.placedSymbolArray.get(e),i=n.vertexStartIndex+4*n.numGlyphs;for(let r=n.vertexStartIndex;r<i;r+=4)t.indexArray.emplaceBack(r,r+1,r+2),t.indexArray.emplaceBack(r+1,r+2,r+3)}getSortedSymbolIndexes(t){if(this.sortedAngle===t&&void 0!==this.symbolInstanceIndexes)return this.symbolInstanceIndexes;const e=Math.sin(t),n=Math.cos(t),i=[],r=[],o=[];for(let s=0;s<this.symbolInstances.length;++s){o.push(s);const t=this.symbolInstances.get(s);i.push(0|Math.round(e*t.anchorX+n*t.anchorY)),r.push(t.featureIndex)}return o.sort((t,e)=>i[t]-i[e]||r[e]-r[t]),o}addToSortKeyRanges(t,e){const n=this.sortKeyRanges[this.sortKeyRanges.length-1];n&&n.sortKey===e?n.symbolInstanceEnd=t+1:this.sortKeyRanges.push({sortKey:e,symbolInstanceStart:t,symbolInstanceEnd:t+1})}sortFeatures(t){if(this.sortFeaturesByY&&this.sortedAngle!==t&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(t),this.sortedAngle=t,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const t of this.symbolInstanceIndexes){const e=this.symbolInstances.get(t);this.featureSortOrder.push(e.featureIndex),[e.rightJustifiedTextSymbolIndex,e.centerJustifiedTextSymbolIndex,e.leftJustifiedTextSymbolIndex].forEach((t,e,n)=>{t>=0&&n.indexOf(t)===e&&this.addIndicesForPlacedSymbol(this.text,t)}),e.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,e.verticalPlacedTextSymbolIndex),e.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,e.placedIconSymbolIndex),e.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,e.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}or("SymbolBucket",sh,{omit:["layers","collisionBoxArray","features","compareText"]}),sh.MAX_GLYPHS=65535,sh.addDynamicAttributes=nh;const ah=new vo({"symbol-placement":new fo(Bt.layout_symbol["symbol-placement"]),"symbol-spacing":new fo(Bt.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new fo(Bt.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new mo(Bt.layout_symbol["symbol-sort-key"]),"symbol-z-order":new fo(Bt.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new fo(Bt.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new fo(Bt.layout_symbol["icon-ignore-placement"]),"icon-optional":new fo(Bt.layout_symbol["icon-optional"]),"icon-rotation-alignment":new fo(Bt.layout_symbol["icon-rotation-alignment"]),"icon-size":new mo(Bt.layout_symbol["icon-size"]),"icon-text-fit":new fo(Bt.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new fo(Bt.layout_symbol["icon-text-fit-padding"]),"icon-image":new mo(Bt.layout_symbol["icon-image"]),"icon-rotate":new mo(Bt.layout_symbol["icon-rotate"]),"icon-padding":new fo(Bt.layout_symbol["icon-padding"]),"icon-keep-upright":new fo(Bt.layout_symbol["icon-keep-upright"]),"icon-offset":new mo(Bt.layout_symbol["icon-offset"]),"icon-anchor":new mo(Bt.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new fo(Bt.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new fo(Bt.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new fo(Bt.layout_symbol["text-rotation-alignment"]),"text-field":new mo(Bt.layout_symbol["text-field"]),"text-font":new mo(Bt.layout_symbol["text-font"]),"text-size":new mo(Bt.layout_symbol["text-size"]),"text-max-width":new mo(Bt.layout_symbol["text-max-width"]),"text-line-height":new mo(Bt.layout_symbol["text-line-height"]),"text-letter-spacing":new mo(Bt.layout_symbol["text-letter-spacing"]),"text-justify":new mo(Bt.layout_symbol["text-justify"]),"text-radial-offset":new mo(Bt.layout_symbol["text-radial-offset"]),"text-variable-anchor":new fo(Bt.layout_symbol["text-variable-anchor"]),"text-anchor":new mo(Bt.layout_symbol["text-anchor"]),"text-max-angle":new fo(Bt.layout_symbol["text-max-angle"]),"text-writing-mode":new fo(Bt.layout_symbol["text-writing-mode"]),"text-rotate":new mo(Bt.layout_symbol["text-rotate"]),"text-padding":new fo(Bt.layout_symbol["text-padding"]),"text-keep-upright":new fo(Bt.layout_symbol["text-keep-upright"]),"text-transform":new mo(Bt.layout_symbol["text-transform"]),"text-offset":new mo(Bt.layout_symbol["text-offset"]),"text-allow-overlap":new fo(Bt.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new fo(Bt.layout_symbol["text-ignore-placement"]),"text-optional":new fo(Bt.layout_symbol["text-optional"])});var lh={paint:new vo({"icon-opacity":new mo(Bt.paint_symbol["icon-opacity"]),"icon-color":new mo(Bt.paint_symbol["icon-color"]),"icon-halo-color":new mo(Bt.paint_symbol["icon-halo-color"]),"icon-halo-width":new mo(Bt.paint_symbol["icon-halo-width"]),"icon-halo-blur":new mo(Bt.paint_symbol["icon-halo-blur"]),"icon-translate":new fo(Bt.paint_symbol["icon-translate"]),"icon-translate-anchor":new fo(Bt.paint_symbol["icon-translate-anchor"]),"text-opacity":new mo(Bt.paint_symbol["text-opacity"]),"text-color":new mo(Bt.paint_symbol["text-color"],{runtimeType:Kt,getOverride:t=>t.textColor,hasOverride:t=>!!t.textColor}),"text-halo-color":new mo(Bt.paint_symbol["text-halo-color"]),"text-halo-width":new mo(Bt.paint_symbol["text-halo-width"]),"text-halo-blur":new mo(Bt.paint_symbol["text-halo-blur"]),"text-translate":new fo(Bt.paint_symbol["text-translate"]),"text-translate-anchor":new fo(Bt.paint_symbol["text-translate-anchor"])}),layout:ah};class ch{constructor(t){this.type=t.property.overrides?t.property.overrides.runtimeType:Zt,this.defaultValue=t}evaluate(t){if(t.formattedSection){const e=this.defaultValue.property.overrides;if(e&&e.hasOverride(t.formattedSection))return e.getOverride(t.formattedSection)}return t.feature&&t.featureState?this.defaultValue.evaluate(t.feature,t.featureState):this.defaultValue.property.specification.default}eachChild(t){this.defaultValue.isConstant()||t(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}or("FormatSectionOverride",ch,{omit:["defaultValue"]});class uh extends Rs{constructor(t){super(t,lh)}recalculate(t,e){if(super.recalculate(t,e),"auto"===this.layout.get("icon-rotation-alignment")&&(this.layout._values["icon-rotation-alignment"]="point"!==this.layout.get("symbol-placement")?"map":"viewport"),"auto"===this.layout.get("text-rotation-alignment")&&(this.layout._values["text-rotation-alignment"]="point"!==this.layout.get("symbol-placement")?"map":"viewport"),"auto"===this.layout.get("text-pitch-alignment")&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),"auto"===this.layout.get("icon-pitch-alignment")&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),"point"===this.layout.get("symbol-placement")){const t=this.layout.get("text-writing-mode");if(t){const e=[];for(const n of t)e.indexOf(n)<0&&e.push(n);this.layout._values["text-writing-mode"]=e}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()}getValueAndResolveTokens(t,e,n,i){const r=this.layout.get(t).evaluate(e,{},n,i),o=this._unevaluatedLayout._values[t];return o.isDataDriven()||ai(o.value)||!r?r:function(t,e){return e.replace(/{([^{}]+)}/g,(e,n)=>n in t?String(t[n]):"")}(e.properties,r)}createBucket(t){return new sh(t)}queryRadius(){return 0}queryIntersectsFeature(){return!1}_setPaintOverrides(){for(const t of lh.paint.overridableProperties){if(!uh.hasPaintOverride(this.layout,t))continue;const e=this.paint.get(t),n=new ch(e),i=new si(n,e.property.specification);let r=null;r="constant"===e.value.kind||"source"===e.value.kind?new ci("source",i):new ui("composite",i,e.value.zoomStops,e.value._interpolationType),this.paint._values[t]=new ho(e.property,r,e.parameters)}}_handleOverridablePaintPropertyUpdate(t,e,n){return!(!this.layout||e.isDataDriven()||n.isDataDriven())&&uh.hasPaintOverride(this.layout,t)}static hasPaintOverride(t,e){const n=t.get("text-field"),i=lh.paint.properties[e];let r=!1;const o=t=>{for(const e of t)if(i.overrides&&i.overrides.hasOverride(e))return void(r=!0)};if("constant"===n.value.kind&&n.value.value instanceof pe)o(n.value.value.sections);else if("source"===n.value.kind){const t=e=>{r||(e instanceof ve&&_e(e.value)===te?o(e.value.sections):e instanceof Ce?o(e.sections):e.eachChild(t))},e=n.value;e._styleExpression&&t(e._styleExpression.expression)}return r}getProgramConfiguration(t){return new As(this,t)}}var hh={paint:new vo({"background-color":new fo(Bt.paint_background["background-color"]),"background-pattern":new _o(Bt.paint_background["background-pattern"]),"background-opacity":new fo(Bt.paint_background["background-opacity"])})},dh={paint:new vo({"raster-opacity":new fo(Bt.paint_raster["raster-opacity"]),"raster-hue-rotate":new fo(Bt.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new fo(Bt.paint_raster["raster-brightness-min"]),"raster-brightness-max":new fo(Bt.paint_raster["raster-brightness-max"]),"raster-saturation":new fo(Bt.paint_raster["raster-saturation"]),"raster-contrast":new fo(Bt.paint_raster["raster-contrast"]),"raster-resampling":new fo(Bt.paint_raster["raster-resampling"]),"raster-fade-duration":new fo(Bt.paint_raster["raster-fade-duration"])})};class ph extends Rs{constructor(t){super(t,{}),this.implementation=t}is3D(){return"3d"===this.implementation.renderingMode}hasOffscreenPass(){return void 0!==this.implementation.prerender}recalculate(){}updateTransitions(){}hasTransition(){}serialize(){}onAdd(t){this.implementation.onAdd&&this.implementation.onAdd(t,t.painter.context.gl)}onRemove(t){this.implementation.onRemove&&this.implementation.onRemove(t,t.painter.context.gl)}}var fh={paint:new vo({"sky-type":new fo(Bt.paint_sky["sky-type"]),"sky-atmosphere-sun":new fo(Bt.paint_sky["sky-atmosphere-sun"]),"sky-atmosphere-sun-intensity":new fo(Bt.paint_sky["sky-atmosphere-sun-intensity"]),"sky-gradient-center":new fo(Bt.paint_sky["sky-gradient-center"]),"sky-gradient-radius":new fo(Bt.paint_sky["sky-gradient-radius"]),"sky-gradient":new yo(Bt.paint_sky["sky-gradient"]),"sky-atmosphere-halo-color":new fo(Bt.paint_sky["sky-atmosphere-halo-color"]),"sky-atmosphere-color":new fo(Bt.paint_sky["sky-atmosphere-color"]),"sky-opacity":new fo(Bt.paint_sky["sky-opacity"])})};function mh(t,e,n){const i=ya(0,0,1),r=Pa(Ia());return function(t,e,n){n*=.5;var i=e[0],r=e[1],o=e[2],s=e[3],a=Math.sin(n),l=Math.cos(n);t[0]=i*l-o*a,t[1]=r*l+s*a,t[2]=o*l+i*a,t[3]=s*l-r*a}(r,r,n?-u(t)+Math.PI:u(t)),Ma(r,r,-u(e)),Ca(i,i,r),wa(i,i)}const gh={circle:class extends Rs{constructor(t){super(t,ua)}createBucket(t){return new Zs(t)}queryRadius(t){const e=t;return oa("circle-radius",this,e)+oa("circle-stroke-width",this,e)+sa(this.paint.get("circle-translate"))}queryIntersectsFeature(t,e,n,i,r,o,s,a){const l="map"===this.paint.get("circle-pitch-alignment");if(l&&t.queryGeometry.isAboveHorizon)return!1;const c=la(this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),o.angle,t.pixelToTileUnitsFactor),u=this.paint.get("circle-radius").evaluate(e,n)+this.paint.get("circle-stroke-width").evaluate(e,n),h=l?u*t.pixelToTileUnitsFactor:u;for(const d of i)for(const e of d){const n=e.add(c),i=a&&o.elevation?o.elevation.exaggeration()*a.getElevationAt(n.x,n.y,!0):0,r=l?n:Oa(n,i,s),u=l?t.tilespaceRays.map(t=>La(t,i)):t.queryGeometry.screenGeometry;let d=h;const p=Aa([],[e.x,e.y,i,1],s);if("viewport"===this.paint.get("circle-pitch-scale")&&"map"===this.paint.get("circle-pitch-alignment")?d*=p[3]/o.cameraToCenterDistance:"map"===this.paint.get("circle-pitch-scale")&&"viewport"===this.paint.get("circle-pitch-alignment")&&(d*=o.cameraToCenterDistance/p[3]),Ws(u,r,d))return!0}return!1}getProgramIds(){return["circle"]}getProgramConfiguration(t){return new As(this,t)}},heatmap:class extends Rs{createBucket(t){return new Ra(t)}constructor(t){super(t,ja),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(t){"heatmap-color"===t&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=qa({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)}queryRadius(){return 0}queryIntersectsFeature(){return!1}hasOffscreenPass(){return 0!==this.paint.get("heatmap-opacity")&&"none"!==this.visibility}getProgramIds(){return["heatmap","heatmapTexture"]}getProgramConfiguration(t){return new As(this,t)}},hillshade:class extends Rs{constructor(t){super(t,$a)}hasOffscreenPass(){return 0!==this.paint.get("hillshade-exaggeration")&&"none"!==this.visibility}getProgramIds(){return["hillshade","hillshadePrepare"]}getProgramConfiguration(t){return new As(this,t)}},fill:class extends Rs{constructor(t){super(t,Ml)}getProgramIds(){const t=this.paint.get("fill-pattern"),e=t&&t.constantOr(1),n=[e?"fillPattern":"fill"];return this.paint.get("fill-antialias")&&n.push(e&&!this.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline"),n}getProgramConfiguration(t){return new As(this,t)}recalculate(t,e){super.recalculate(t,e);const n=this.paint._values["fill-outline-color"];"constant"===n.value.kind&&void 0===n.value.value&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(t){return new Il(t)}queryRadius(){return sa(this.paint.get("fill-translate"))}queryIntersectsFeature(t,e,n,i,r,o){return!t.queryGeometry.isAboveHorizon&&Xs(aa(t.tilespaceGeometry,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),o.angle,t.pixelToTileUnitsFactor),i)}isTileClipped(){return!0}},"fill-extrusion":class extends Rs{constructor(t){super(t,Kl)}createBucket(t){return new Wl(t)}queryRadius(){return sa(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}getProgramIds(){return[this.paint.get("fill-extrusion-pattern").constantOr(1)?"fillExtrusionPattern":"fillExtrusion"]}getProgramConfiguration(t){return new As(this,t)}queryIntersectsFeature(t,e,n,i,o,s,a,l,c){const u=la(this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),s.angle,t.pixelToTileUnitsFactor),h=this.paint.get("fill-extrusion-height").evaluate(e,n),d=this.paint.get("fill-extrusion-base").evaluate(e,n),p=[0,0],f=l&&s.elevation,m=s.elevation?s.elevation.exaggeration():1;if(f){const e=t.tile.getBucket(this).centroidVertexArray,n=c+1;if(n<e.length){const t=e.get(n);p[0]=t.a_centroid_pos0,p[1]=t.a_centroid_pos1}}if(0===p[0]&&1===p[1])return!1;const g=function(t,e,n,i,o,s,a,l,c){return s?function(t,e,n,i,r,o,s,a,l){const c=[],u=[],h=[0,0,0,1];for(const d of t){const t=[],p=[];for(const c of d){const u=c.x+i.x,d=c.y+i.y,f=tc(u,d,e,n,o,s,a,l);h[0]=u,h[1]=d,h[2]=f.base,h[3]=1,Aa(h,h,r),h[3]=Math.max(h[3],1e-5);const m=Ql([h[0]/h[3],h[1]/h[3],h[2]/h[3]]);h[0]=u,h[1]=d,h[2]=f.top,h[3]=1,Aa(h,h,r),h[3]=Math.max(h[3],1e-5);const g=Ql([h[0]/h[3],h[1]/h[3],h[2]/h[3]]);t.push(m),p.push(g)}c.push(t),u.push(p)}return[c,u]}(t,e,n,i,o,s,a,l,c):function(t,e,n,i,o){const s=[],a=[],l=o[8]*e,c=o[9]*e,u=o[10]*e,h=o[11]*e,d=o[8]*n,p=o[9]*n,f=o[10]*n,m=o[11]*n;for(const g of t){const t=[],e=[];for(const n of g){const s=n.x+i.x,a=n.y+i.y,g=o[0]*s+o[4]*a+o[12],_=o[1]*s+o[5]*a+o[13],y=o[2]*s+o[6]*a+o[14],v=o[3]*s+o[7]*a+o[15],x=g+l,b=_+c,w=y+u,C=Math.max(v+h,1e-5),T=g+d,S=_+p,E=y+f,k=Math.max(v+m,1e-5),A=new r(x/C,b/C);A.z=w/C,t.push(A);const I=new r(T/k,S/k);I.z=E/k,e.push(I)}s.push(t),a.push(e)}return[s,a]}(t,e,n,i,o)}(i,d,h,u,a,f?l:null,p,m,s.center.lat),_=t.queryGeometry;return function(t,e,n){let i=1/0;Xs(n,e)&&(i=Jl(n,e[0]));for(let r=0;r<e.length;r++){const o=e[r],s=t[r];for(let t=0;t<o.length-1;t++){const e=o[t],r=[e,o[t+1],s[t+1],s[t],e];Hs(n,r)&&(i=Math.min(i,Jl(n,r)))}}return i!==1/0&&i}(g[0],g[1],_.isPointQuery()?_.screenBounds:_.screenGeometry)}},line:class extends Rs{constructor(t){super(t,cc),this.gradientVersion=0}_handleSpecialPaintPropertyUpdate(t){if("line-gradient"===t){const t=this._transitionablePaint._values["line-gradient"].value.expression;this.stepInterpolant=t._styleExpression&&t._styleExpression.expression instanceof en,this.gradientVersion=(this.gradientVersion+1)%a}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}recalculate(t,e){super.recalculate(t,e),this.paint._values["line-floorwidth"]=uc.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,t)}createBucket(t){return new ac(t)}getProgramIds(){const t=this.paint.get("line-dasharray"),e=this.paint.get("line-pattern").constantOr(1),n=this.paint.get("line-gradient");return[e?"linePattern":t?"lineSDF":n?"lineGradient":"line"]}getProgramConfiguration(t){return new As(this,t)}queryRadius(t){const e=t,n=hc(oa("line-width",this,e),oa("line-gap-width",this,e)),i=oa("line-offset",this,e);return n/2+Math.abs(i)+sa(this.paint.get("line-translate"))}queryIntersectsFeature(t,e,n,i,o,s){if(t.queryGeometry.isAboveHorizon)return!1;const a=aa(t.tilespaceGeometry,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),s.angle,t.pixelToTileUnitsFactor),l=t.pixelToTileUnitsFactor/2*hc(this.paint.get("line-width").evaluate(e,n),this.paint.get("line-gap-width").evaluate(e,n)),c=this.paint.get("line-offset").evaluate(e,n);return c&&(i=function(t,e){const n=[],i=new r(0,0);for(let r=0;r<t.length;r++){const o=t[r],s=[];for(let t=0;t<o.length;t++){const n=o[t-1],r=o[t],a=o[t+1],l=0===t?i:r.sub(n)._unit()._perp(),c=t===o.length-1?i:a.sub(r)._unit()._perp(),u=l._add(c)._unit();u._mult(1/(u.x*c.x+u.y*c.y)),s.push(u._mult(e)._add(r))}n.push(s)}return n}(i,c*t.pixelToTileUnitsFactor)),function(t,e,n){for(let i=0;i<e.length;i++){const r=e[i];if(t.length>=3)for(let e=0;e<r.length;e++)if(na(t,r[e]))return!0;if(Ks(t,r,n))return!0}return!1}(a,i,l)}isTileClipped(){return!0}},symbol:uh,background:class extends Rs{constructor(t){super(t,hh)}getProgramIds(){return[this.paint.get("background-pattern")?"backgroundPattern":"background"]}},raster:class extends Rs{constructor(t){super(t,dh)}getProgramIds(){return["raster"]}},sky:class extends Rs{constructor(t){super(t,fh),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(t){"sky-gradient"===t?this._updateColorRamp():"sky-atmosphere-sun"!==t&&"sky-atmosphere-halo-color"!==t&&"sky-atmosphere-color"!==t&&"sky-atmosphere-sun-intensity"!==t||(this._skyboxInvalidated=!0)}_updateColorRamp(){this.colorRamp=qa({expression:this._transitionablePaint._values["sky-gradient"].value.expression,evaluationKey:"skyRadialProgress"}),this.colorRampTexture&&(this.colorRampTexture.destroy(),this.colorRampTexture=null)}needsSkyboxCapture(t){if(this._skyboxInvalidated||!this.skyboxTexture||!this.skyboxGeometry)return!0;if(!this.paint.get("sky-atmosphere-sun")){const e=t.style.light.properties.get("position");return this._lightPosition.azimuthal!==e.azimuthal||this._lightPosition.polar!==e.polar}}getCenter(t,e){const n=this.paint.get("sky-type");if("atmosphere"===n){const n=this.paint.get("sky-atmosphere-sun"),i=!n,r=t.style.light,o=r.properties.get("position");return i&&"viewport"===r.properties.get("anchor")&&M("The sun direction is attached to a light with viewport anchor, lighting may behave unexpectedly."),i?mh(o.azimuthal,90-o.polar,e):mh(n[0],90-n[1],e)}if("gradient"===n){const t=this.paint.get("sky-gradient-center");return mh(t[0],90-t[1],e)}}is3D(){return!1}isSky(){return!0}markSkyboxValid(t){this._skyboxInvalidated=!1,this._lightPosition=t.style.light.properties.get("position")}hasOffscreenPass(){return!0}getProgramIds(){const t=this.paint.get("sky-type");return"atmosphere"===t?["skyboxCapture","skybox"]:"gradient"===t?["skyboxGradient"]:null}}},{HTMLImageElement:_h,HTMLCanvasElement:yh,HTMLVideoElement:vh,ImageData:xh,ImageBitmap:bh}=s;class wh{constructor(t,e,n,i){this.context=t,this.format=n,this.texture=t.gl.createTexture(),this.update(e,i)}update(t,e,n){const{width:i,height:r}=t,o=!(this.size&&this.size[0]===i&&this.size[1]===r||n),{context:s}=this,{gl:a}=s;if(this.useMipmap=Boolean(e&&e.useMipmap),a.bindTexture(a.TEXTURE_2D,this.texture),s.pixelStoreUnpackFlipY.set(!1),s.pixelStoreUnpack.set(1),s.pixelStoreUnpackPremultiplyAlpha.set(this.format===a.RGBA&&(!e||!1!==e.premultiply)),o)this.size=[i,r],t instanceof _h||t instanceof yh||t instanceof vh||t instanceof xh||bh&&t instanceof bh?a.texImage2D(a.TEXTURE_2D,0,this.format,this.format,a.UNSIGNED_BYTE,t):a.texImage2D(a.TEXTURE_2D,0,this.format,i,r,0,this.format,a.UNSIGNED_BYTE,t.data);else{const{x:e,y:o}=n||{x:0,y:0};t instanceof _h||t instanceof yh||t instanceof vh||t instanceof xh||bh&&t instanceof bh?a.texSubImage2D(a.TEXTURE_2D,0,e,o,a.RGBA,a.UNSIGNED_BYTE,t):a.texSubImage2D(a.TEXTURE_2D,0,e,o,i,r,a.RGBA,a.UNSIGNED_BYTE,t.data)}this.useMipmap&&this.isSizePowerOfTwo()&&a.generateMipmap(a.TEXTURE_2D)}bind(t,e,n){const{context:i}=this,{gl:r}=i;r.bindTexture(r.TEXTURE_2D,this.texture),n!==r.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(n=r.LINEAR),t!==this.filter&&(r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MAG_FILTER,t),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MIN_FILTER,n||t),this.filter=t),e!==this.wrap&&(r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_S,e),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_T,e),this.wrap=e)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){const{gl:t}=this.context;t.deleteTexture(this.texture),this.texture=null}}class Ch{constructor(t,e){t&&(e?this.setSouthWest(t).setNorthEast(e):4===t.length?this.setSouthWest([t[0],t[1]]).setNorthEast([t[2],t[3]]):this.setSouthWest(t[0]).setNorthEast(t[1]))}setNorthEast(t){return this._ne=t instanceof Sh?new Sh(t.lng,t.lat):Sh.convert(t),this}setSouthWest(t){return this._sw=t instanceof Sh?new Sh(t.lng,t.lat):Sh.convert(t),this}extend(t){const e=this._sw,n=this._ne;let i,r;if(t instanceof Sh)i=t,r=t;else{if(!(t instanceof Ch))return Array.isArray(t)?4===t.length||t.every(Array.isArray)?this.extend(Ch.convert(t)):this.extend(Sh.convert(t)):this;if(i=t._sw,r=t._ne,!i||!r)return this}return e||n?(e.lng=Math.min(i.lng,e.lng),e.lat=Math.min(i.lat,e.lat),n.lng=Math.max(r.lng,n.lng),n.lat=Math.max(r.lat,n.lat)):(this._sw=new Sh(i.lng,i.lat),this._ne=new Sh(r.lng,r.lat)),this}getCenter(){return new Sh((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new Sh(this.getWest(),this.getNorth())}getSouthEast(){return new Sh(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(t){const{lng:e,lat:n}=Sh.convert(t);let i=this._sw.lng<=e&&e<=this._ne.lng;return this._sw.lng>this._ne.lng&&(i=this._sw.lng>=e&&e>=this._ne.lng),this._sw.lat<=n&&n<=this._ne.lat&&i}static convert(t){return!t||t instanceof Ch?t:new Ch(t)}}const Th=6371008.8;class Sh{constructor(t,e){if(isNaN(t)||isNaN(e))throw new Error(`Invalid LngLat object: (${t}, ${e})`);if(this.lng=+t,this.lat=+e,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new Sh(g(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(t){const e=Math.PI/180,n=this.lat*e,i=t.lat*e,r=Math.sin(n)*Math.sin(i)+Math.cos(n)*Math.cos(i)*Math.cos((t.lng-this.lng)*e);return Th*Math.acos(Math.min(r,1))}toBounds(t=0){const e=360*t/40075017,n=e/Math.cos(Math.PI/180*this.lat);return new Ch(new Sh(this.lng-n,this.lat-e),new Sh(this.lng+n,this.lat+e))}static convert(t){if(t instanceof Sh)return t;if(Array.isArray(t)&&(2===t.length||3===t.length))return new Sh(Number(t[0]),Number(t[1]));if(!Array.isArray(t)&&"object"==typeof t&&null!==t)return new Sh(Number("lng"in t?t.lng:t.lon),Number(t.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}const Eh=2*Math.PI*Th;function kh(t){return Eh*Math.cos(t*Math.PI/180)}function Ah(t){return(180+t)/360}function Ih(t){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+t*Math.PI/360)))/360}function Ph(t,e){return t/kh(e)}function Mh(t){return 360/Math.PI*Math.atan(Math.exp((180-360*t)*Math.PI/180))-90}function Oh(t,e){return t*kh(Mh(e))}class zh{constructor(t,e,n=0){this.x=+t,this.y=+e,this.z=+n}static fromLngLat(t,e=0){const n=Sh.convert(t);return new zh(Ah(n.lng),Ih(n.lat),Ph(e,n.lat))}toLngLat(){return new Sh(360*this.x-180,Mh(this.y))}toAltitude(){return Oh(this.z,this.y)}meterInMercatorCoordinateUnits(){return 1/Eh*(t=Mh(this.y),1/Math.cos(t*Math.PI/180));var t}}class Dh{constructor(t,e){this.width=t,this.height=e,this.nextRow=0,this.image=new Ua({width:t,height:e}),this.positions={},this.uploaded=!1}getDash(t,e){const n=this.getKey(t,e);return this.positions[n]}trim(){const t=this.width,e=this.height=C(this.nextRow);this.image.resize({width:t,height:e})}getKey(t,e){return t.join(",")+e}getDashRanges(t,e,n){const i=[];let r=t.length%2==1?-t[t.length-1]*n:0,o=t[0]*n,s=!0;i.push({left:r,right:o,isDash:s,zeroLength:0===t[0]});let a=t[0];for(let l=1;l<t.length;l++){s=!s;const e=t[l];r=a*n,a+=e,o=a*n,i.push({left:r,right:o,isDash:s,zeroLength:0===e})}return i}addRoundDash(t,e,n){const i=e/2;for(let r=-n;r<=n;r++){const e=this.width*(this.nextRow+n+r);let o=0,s=t[o];for(let a=0;a<this.width;a++){a/s.right>1&&(s=t[++o]);const l=Math.abs(a-s.left),c=Math.abs(a-s.right),u=Math.min(l,c);let h;const d=r/n*(i+1);if(s.isDash){const t=i-Math.abs(d);h=Math.sqrt(u*u+t*t)}else h=i-Math.sqrt(u*u+d*d);this.image.data[e+a]=Math.max(0,Math.min(255,h+128))}}}addRegularDash(t,e){for(let a=t.length-1;a>=0;--a){const e=t[a],n=t[a+1];e.zeroLength?t.splice(a,1):n&&n.isDash===e.isDash&&(n.left=e.left,t.splice(a,1))}const n=t[0],i=t[t.length-1];n.isDash===i.isDash&&(n.left=i.left-this.width,i.right=n.right+this.width);const r=this.width*this.nextRow;let o=0,s=t[o];for(let a=0;a<this.width;a++){a/s.right>1&&(s=t[++o]);const n=Math.abs(a-s.left),i=Math.abs(a-s.right),l=Math.min(n,i);this.image.data[r+a]=Math.max(0,Math.min(255,(s.isDash?l:-l)+e+128))}}addDash(t,e){const n=this.getKey(t,e);if(this.positions[n])return this.positions[n];const i="round"===e,r=i?7:0,o=2*r+1;if(this.nextRow+o>this.height)return M("LineAtlas out of space"),null;0===t.length&&t.push(1);let s=0;for(let c=0;c<t.length;c++)t[c]<0&&(M("Negative value is found in line dasharray, replacing values with 0"),t[c]=0),s+=t[c];if(0!==s){const n=this.width/s,o=this.getDashRanges(t,this.width,n);i?this.addRoundDash(o,n,r):this.addRegularDash(o,"square"===e?.5*n:0)}const a=this.nextRow+r;this.nextRow+=o;const l={tl:[a,r],br:[s,0]};return this.positions[n]=l,l}}or("LineAtlas",Dh);class Lh{constructor(t){this._callback=t,this._triggered=!1,"undefined"!=typeof MessageChannel&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._callback()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._callback()},0))}remove(){delete this._channel,this._callback=()=>{}}}const Rh=s.performance;function Fh(t){const e=t?t.url.toString():void 0;return Rh.getEntriesByName(e)}class Bh{constructor(){this.tasks={},this.taskQueue=[],S(["process"],this),this.invoker=new Lh(this.process),this.nextId=0}add(t,e){const n=this.nextId++,i=function({type:t,isSymbolTile:e,zoom:n}){return n=n||0,"message"===t?0:"maybePrepare"!==t||e?"parseTile"!==t||e?"parseTile"===t&&e?300-n:"maybePrepare"===t&&e?400-n:500:200-n:100-n}(e);if(0===i){D();try{t()}finally{}return{cancel:()=>{}}}return this.tasks[n]={fn:t,metadata:e,priority:i,id:n},this.taskQueue.push(n),this.invoker.trigger(),{cancel:()=>{delete this.tasks[n]}}}process(){D();try{if(this.taskQueue=this.taskQueue.filter(t=>!!this.tasks[t]),!this.taskQueue.length)return;const t=this.pick();if(null===t)return;const e=this.tasks[t];if(delete this.tasks[t],this.taskQueue.length&&this.invoker.trigger(),!e)return;e.fn()}finally{}}pick(){let t=null,e=1/0;for(let i=0;i<this.taskQueue.length;i++){const n=this.tasks[this.taskQueue[i]];n.priority<e&&(e=n.priority,t=i)}if(null===t)return null;const n=this.taskQueue[t];return this.taskQueue.splice(t,1),n}remove(){this.invoker.remove()}}function Vh(t,e,n){var i=2*Math.PI*6378137/256/Math.pow(2,n);return[t*i-2*Math.PI*6378137/2,e*i-2*Math.PI*6378137/2]}class Uh{constructor(t,e,n){this.z=t,this.x=e,this.y=n,this.key=qh(0,t,t,e,n)}equals(t){return this.z===t.z&&this.x===t.x&&this.y===t.y}url(t,e){const n=(r=this.y,o=this.z,s=Vh(256*(i=this.x),256*(r=Math.pow(2,o)-r-1),o),a=Vh(256*(i+1),256*(r+1),o),s[0]+","+s[1]+","+a[0]+","+a[1]);var i,r,o,s,a;const l=function(t,e,n){let i,r="";for(let o=t;o>0;o--)i=1<<o-1,r+=(e&i?1:0)+(n&i?2:0);return r}(this.z,this.x,this.y);return t[(this.x+this.y)%t.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace("{z}",String(this.z)).replace("{x}",String(this.x)).replace("{y}",String("tms"===e?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",l).replace("{bbox-epsg-3857}",n)}getTilePoint(t){const e=Math.pow(2,this.z);return new r((t.x*e-this.x)*Us,(t.y*e-this.y)*Us)}getTileVec3(t){const e=Math.pow(2,this.z);return ya((t.x*e-this.x)*Us,(t.y*e-this.y)*Us,Oh(t.z,t.y))}toString(){return`${this.z}/${this.x}/${this.y}`}}class Nh{constructor(t,e){this.wrap=t,this.canonical=e,this.key=qh(t,e.z,e.z,e.x,e.y)}}class jh{constructor(t,e,n,i,r){this.overscaledZ=t,this.wrap=e,this.canonical=new Uh(n,+i,+r),this.key=0===e&&t===n?this.canonical.key:qh(e,t,n,i,r)}equals(t){return this.overscaledZ===t.overscaledZ&&this.wrap===t.wrap&&this.canonical.equals(t.canonical)}scaledTo(t){const e=this.canonical.z-t;return t>this.canonical.z?new jh(t,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new jh(t,this.wrap,t,this.canonical.x>>e,this.canonical.y>>e)}calculateScaledKey(t,e=!0){if(this.overscaledZ===t&&e)return this.key;if(t>this.canonical.z)return qh(this.wrap*+e,t,this.canonical.z,this.canonical.x,this.canonical.y);{const n=this.canonical.z-t;return qh(this.wrap*+e,t,t,this.canonical.x>>n,this.canonical.y>>n)}}isChildOf(t){if(t.wrap!==this.wrap)return!1;const e=this.canonical.z-t.canonical.z;return 0===t.overscaledZ||t.overscaledZ<this.overscaledZ&&t.canonical.x===this.canonical.x>>e&&t.canonical.y===this.canonical.y>>e}children(t){if(this.overscaledZ>=t)return[new jh(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const e=this.canonical.z+1,n=2*this.canonical.x,i=2*this.canonical.y;return[new jh(e,this.wrap,e,n,i),new jh(e,this.wrap,e,n+1,i),new jh(e,this.wrap,e,n,i+1),new jh(e,this.wrap,e,n+1,i+1)]}isLessThan(t){return this.wrap<t.wrap||!(this.wrap>t.wrap)&&(this.overscaledZ<t.overscaledZ||!(this.overscaledZ>t.overscaledZ)&&(this.canonical.x<t.canonical.x||!(this.canonical.x>t.canonical.x)&&this.canonical.y<t.canonical.y))}wrapped(){return new jh(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(t){return new jh(this.overscaledZ,t,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new Nh(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}getTilePoint(t){return this.canonical.getTilePoint(new zh(t.x-this.wrap,t.y))}getTileVec3(t){return this.canonical.getTileVec3(new zh(t.x-this.wrap,t.y,t.z))}}function qh(t,e,n,i,r){const o=1<<Math.min(n,22);let s=o*(r%o)+i%o;return t&&n<22&&(s+=o*o*((t<0?-2*t-1:2*t)%(1<<2*(22-n)))),16*(32*s+n)+(e-n)}or("CanonicalTileID",Uh),or("OverscaledTileID",jh,{omit:["projMatrix"]});class $h{constructor(t){this._stringToNumber={},this._numberToString=[];for(let e=0;e<t.length;e++){const n=t[e];this._stringToNumber[n]=e,this._numberToString[e]=n}}encode(t){return this._stringToNumber[t]}decode(t){return this._numberToString[t]}}class Gh{constructor(t,e,n,i,r){this.type="Feature",this._vectorTileFeature=t,t._z=e,t._x=n,t._y=i,this.properties=t.properties,this.id=r}get geometry(){return void 0===this._geometry&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry}set geometry(t){this._geometry=t}toJSON(){const t={geometry:this.geometry};for(const e in this)"_geometry"!==e&&"_vectorTileFeature"!==e&&(t[e]=this[e]);return t}}var Zh=To([{name:"a_pos",type:"Int16",components:2}]);class Hh{constructor(t,e,n){this.tileID=t,this.uid=b(),this.uses=0,this.tileSize=e,this.tileZoom=n,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.expiredRequestCount=0,this.state="loading"}registerFadeDuration(t){const e=t+this.timeAdded;e<j.now()||this.fadeEndTime&&e<this.fadeEndTime||(this.fadeEndTime=e)}wasRequested(){return"errored"===this.state||"loaded"===this.state||"reloading"===this.state}loadVectorData(t,e,n){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",t){t.featureIndex&&(this.latestFeatureIndex=t.featureIndex,t.rawTileData?(this.latestRawTileData=t.rawTileData,this.latestFeatureIndex.rawTileData=t.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=t.collisionBoxArray,this.buckets=function(t,e){const n={};if(!e)return n;for(const i of t){const t=i.layerIds.map(t=>e.getLayer(t)).filter(Boolean);if(0!==t.length){i.layers=t,i.stateDependentLayerIds&&(i.stateDependentLayers=i.stateDependentLayerIds.map(e=>t.filter(t=>t.id===e)[0]));for(const e of t)n[e.id]=i}}return n}(t.buckets,e.style),this.hasSymbolBuckets=!1;for(const t in this.buckets){const e=this.buckets[t];if(e instanceof sh){if(this.hasSymbolBuckets=!0,!n)break;e.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const t in this.buckets){const e=this.buckets[t];if(e instanceof sh&&e.hasRTLText){this.hasRTLText=!0,io.isLoading()||io.isLoaded()||"deferred"!==eo()||no();break}}this.queryPadding=0;for(const t in this.buckets){const n=this.buckets[t];this.queryPadding=Math.max(this.queryPadding,e.style.getLayer(t).queryRadius(n))}t.imageAtlas&&(this.imageAtlas=t.imageAtlas),t.glyphAtlasImage&&(this.glyphAtlasImage=t.glyphAtlasImage),t.lineAtlas&&(this.lineAtlas=t.lineAtlas)}else this.collisionBoxArray=new Xo}unloadVectorData(){for(const t in this.buckets)this.buckets[t].destroy();this.buckets={},this.imageAtlas&&(this.imageAtlas=null),this.lineAtlas&&(this.lineAtlas=null),this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.lineAtlasTexture&&this.lineAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"}getBucket(t){return this.buckets[t.id]}upload(t){for(const n in this.buckets){const e=this.buckets[n];e.uploadPending()&&e.upload(t)}const e=t.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new wh(t,this.imageAtlas.image,e.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new wh(t,this.glyphAtlasImage,e.ALPHA),this.glyphAtlasImage=null),this.lineAtlas&&!this.lineAtlas.uploaded&&(this.lineAtlasTexture=new wh(t,this.lineAtlas.image,e.ALPHA),this.lineAtlas.uploaded=!0)}prepare(t){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(t,this.imageAtlasTexture)}queryRenderedFeatures(t,e,n,i,r,o,s,a){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({tileResult:i,pixelPosMatrix:s,transform:o,params:r},t,e,n):{}}querySourceFeatures(t,e){const n=this.latestFeatureIndex;if(!n||!n.rawTileData)return;const i=n.loadVTLayers(),r=e?e.sourceLayer:"",o=i._geojsonTileLayer||i[r];if(!o)return;const s=wi(e&&e.filter),{z:a,x:l,y:c}=this.tileID.canonical,u={z:a,x:l,y:c};for(let h=0;h<o.length;h++){const e=o.feature(h);if(s.needGeometry){const t=$s(e,!0);if(!s.filter(new ro(this.tileID.overscaledZ),t,this.tileID.canonical))continue}else if(!s.filter(new ro(this.tileID.overscaledZ),e))continue;const i=n.getId(e,r),d=new Gh(e,a,l,c,i);d.tile=u,t.push(d)}}hasData(){return"loaded"===this.state||"reloading"===this.state||"expired"===this.state}patternsLoaded(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(t){const e=this.expirationTime;if(t.cacheControl){const e=L(t.cacheControl);e["max-age"]&&(this.expirationTime=Date.now()+1e3*e["max-age"])}else t.expires&&(this.expirationTime=new Date(t.expires).getTime());if(this.expirationTime){const t=Date.now();let n=!1;if(this.expirationTime>t)n=!1;else if(e)if(this.expirationTime<e)n=!0;else{const i=this.expirationTime-e;i?this.expirationTime=t+Math.max(i,3e4):n=!0}else n=!0;n?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-(new Date).getTime(),Math.pow(2,31)-1)}setFeatureState(t,e){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||0===Object.keys(t).length)return;const n=this.latestFeatureIndex.loadVTLayers();for(const i in this.buckets){if(!e.style.hasLayer(i))continue;const r=this.buckets[i],o=r.layers[0].sourceLayer||"_geojsonTileLayer",s=n[o],a=t[o];if(!s||!a||0===Object.keys(a).length)continue;r.update(a,s,this.imageAtlas&&this.imageAtlas.patternPositions||{});const l=e&&e.style&&e.style.getLayer(i);l&&(this.queryPadding=Math.max(this.queryPadding,l.queryRadius(r)))}}holdingForFade(){return void 0!==this.symbolFadeHoldUntil}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<j.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(t){this.symbolFadeHoldUntil=j.now()+t}setDependencies(t,e){const n={};for(const i of e)n[i]=!0;this.dependencies[t]=n}hasDependency(t,e){for(const n of t){const t=this.dependencies[n];if(t)for(const n of e)if(t[n])return!0}return!1}clearQueryDebugViz(){}}class Wh{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(t,e,n){const i=String(e);if(this.stateChanges[t]=this.stateChanges[t]||{},this.stateChanges[t][i]=this.stateChanges[t][i]||{},v(this.stateChanges[t][i],n),null===this.deletedStates[t]){this.deletedStates[t]={};for(const e in this.state[t])e!==i&&(this.deletedStates[t][e]=null)}else if(this.deletedStates[t]&&null===this.deletedStates[t][i]){this.deletedStates[t][i]={};for(const e in this.state[t][i])n[e]||(this.deletedStates[t][i][e]=null)}else for(const r in n)this.deletedStates[t]&&this.deletedStates[t][i]&&null===this.deletedStates[t][i][r]&&delete this.deletedStates[t][i][r]}removeFeatureState(t,e,n){if(null===this.deletedStates[t])return;const i=String(e);if(this.deletedStates[t]=this.deletedStates[t]||{},n&&void 0!==e)null!==this.deletedStates[t][i]&&(this.deletedStates[t][i]=this.deletedStates[t][i]||{},this.deletedStates[t][i][n]=null);else if(void 0!==e)if(this.stateChanges[t]&&this.stateChanges[t][i])for(n in this.deletedStates[t][i]={},this.stateChanges[t][i])this.deletedStates[t][i][n]=null;else this.deletedStates[t][i]=null;else this.deletedStates[t]=null}getState(t,e){const n=String(e),i=v({},(this.state[t]||{})[n],(this.stateChanges[t]||{})[n]);if(null===this.deletedStates[t])return{};if(this.deletedStates[t]){const n=this.deletedStates[t][e];if(null===n)return{};for(const t in n)delete i[t]}return i}initializeTileState(t,e){t.setFeatureState(this.state,e)}coalesceChanges(t,e){const n={};for(const i in this.stateChanges){this.state[i]=this.state[i]||{};const t={};for(const e in this.stateChanges[i])this.state[i][e]||(this.state[i][e]={}),v(this.state[i][e],this.stateChanges[i][e]),t[e]=this.state[i][e];n[i]=t}for(const i in this.deletedStates){this.state[i]=this.state[i]||{};const t={};if(null===this.deletedStates[i])for(const e in this.state[i])t[e]={},this.state[i][e]={};else for(const e in this.deletedStates[i]){if(null===this.deletedStates[i][e])this.state[i][e]={};else for(const t of Object.keys(this.deletedStates[i][e]))delete this.state[i][e][t];t[e]=this.state[i][e]}n[i]=n[i]||{},v(n[i],t)}if(this.stateChanges={},this.deletedStates={},0!==Object.keys(n).length)for(const i in t)t[i].setFeatureState(n,e)}}class Xh{constructor(t){this.size=t,this.minimums=[],this.maximums=[],this.leaves=[]}getElevation(t,e){const n=this.toIdx(t,e);return{min:this.minimums[n],max:this.maximums[n]}}isLeaf(t,e){return this.leaves[this.toIdx(t,e)]}toIdx(t,e){return e*this.size+t}}function Kh(t,e,n,i){let r=0,o=Number.MAX_VALUE;for(let s=0;s<3;s++)if(Math.abs(i[s])<1e-15){if(n[s]<t[s]||n[s]>e[s])return null}else{const a=1/i[s];let l=(t[s]-n[s])*a,c=(e[s]-n[s])*a;if(l>c){const t=l;l=c,c=t}if(l>r&&(r=l),c<o&&(o=c),r>o)return null}return r}function Yh(t,e,n,i,r,o,s,a,l,c,u){const h=i-t,d=r-e,p=o-n,f=s-t,m=a-e,g=l-n,_=u[1]*g-u[2]*m,y=u[2]*f-u[0]*g,v=u[0]*m-u[1]*f,x=h*_+d*y+p*v;if(Math.abs(x)<1e-15)return null;const b=1/x,w=c[0]-t,C=c[1]-e,T=c[2]-n,S=(w*_+C*y+T*v)*b;if(S<0||S>1)return null;const E=C*p-T*d,k=T*h-w*p,A=w*d-C*h,I=(u[0]*E+u[1]*k+u[2]*A)*b;return I<0||S+I>1?null:(f*E+m*k+g*A)*b}function Jh(t,e,n){return(t-e)/(n-e)}function Qh(t,e,n,i,r,o,s,a,l){const c=1<<n,u=o-i,h=s-r,d=(t+1)/c*u+i,p=(e+0)/c*h+r,f=(e+1)/c*h+r;a[0]=(t+0)/c*u+i,a[1]=p,l[0]=d,l[1]=f}class td{constructor(t){if(this.maximums=[],this.minimums=[],this.leaves=[],this.childOffsets=[],this.nodeCount=0,this.dem=t,this._siblingOffset=[[0,0],[1,0],[0,1],[1,1]],!this.dem)return;const e=function(t){const e=Math.ceil(Math.log2(t.dim/8)),n=[];let i=Math.ceil(Math.pow(2,e));const r=1/i,o=(t,e,n,i,r)=>{const o=i?1:0,s=(t+1)*n-o,a=e*n,l=(e+1)*n-o;r[0]=t*n,r[1]=a,r[2]=s,r[3]=l};let s=new Xh(i);const a=[];for(let l=0;l<i*i;l++){o(l%i,Math.floor(l/i),r,!1,a);const e=nd(a[0],a[1],t),n=nd(a[2],a[1],t),c=nd(a[2],a[3],t),u=nd(a[0],a[3],t);s.minimums.push(Math.min(e,n,c,u)),s.maximums.push(Math.max(e,n,c,u)),s.leaves.push(1)}for(n.push(s),i/=2;i>=1;i/=2){const t=n[n.length-1];s=new Xh(i);for(let e=0;e<i*i;e++){o(e%i,Math.floor(e/i),2,!0,a);const n=t.getElevation(a[0],a[1]),r=t.getElevation(a[2],a[1]),l=t.getElevation(a[2],a[3]),c=t.getElevation(a[0],a[3]),u=t.isLeaf(a[0],a[1]),h=t.isLeaf(a[2],a[1]),d=t.isLeaf(a[2],a[3]),p=t.isLeaf(a[0],a[3]),f=Math.min(n.min,r.min,l.min,c.min),m=Math.max(n.max,r.max,l.max,c.max),g=u&&h&&d&&p;s.maximums.push(m),s.minimums.push(f),s.leaves.push(m-f<=5&&g?1:0)}n.push(s)}return n}(this.dem),n=e.length-1,i=e[n];this._addNode(i.minimums[0],i.maximums[0],i.leaves[0]),this._construct(e,0,0,n,0)}raycastRoot(t,e,n,i,r,o,s=1){return Kh([t,e,-100],[n,i,this.maximums[0]*s],r,o)}raycast(t,e,n,i,r,o,s=1){if(!this.nodeCount)return null;const a=this.raycastRoot(t,e,n,i,r,o,s);if(null==a)return null;const l=[],c=[],u=[],h=[],d=[{idx:0,t:a,nodex:0,nodey:0,depth:0}];for(;d.length>0;){const{idx:a,t:p,nodex:f,nodey:m,depth:g}=d.pop();if(this.leaves[a]){Qh(f,m,g,t,e,n,i,u,h);const a=1<<g,l=(f+0)/a,c=(f+1)/a,d=(m+0)/a,_=(m+1)/a,y=nd(l,d,this.dem)*s,v=nd(c,d,this.dem)*s,x=nd(c,_,this.dem)*s,b=nd(l,_,this.dem)*s,w=Yh(u[0],u[1],y,h[0],u[1],v,h[0],h[1],x,r,o),C=Yh(h[0],h[1],x,u[0],h[1],b,u[0],u[1],y,r,o),T=Math.min(null!==w?w:Number.MAX_VALUE,null!==C?C:Number.MAX_VALUE);if(T!==Number.MAX_VALUE)return T;{const t=ba([],r,o,p);if(ed(y,v,b,x,Jh(t[0],u[0],h[0]),Jh(t[1],u[1],h[1]))>=t[2])return p}continue}let _=0;for(let d=0;d<this._siblingOffset.length;d++){Qh((f<<1)+this._siblingOffset[d][0],(m<<1)+this._siblingOffset[d][1],g+1,t,e,n,i,u,h),u[2]=-100,h[2]=this.maximums[this.childOffsets[a]+d]*s;const p=Kh(u,h,r,o);if(null!=p){const t=p;l[d]=t;let e=!1;for(let n=0;n<_&&!e;n++)t>=l[c[n]]&&(c.splice(n,0,d),e=!0);e||(c[_]=d),_++}}for(let t=0;t<_;t++){const e=c[t];d.push({idx:this.childOffsets[a]+e,t:l[e],nodex:(f<<1)+this._siblingOffset[e][0],nodey:(m<<1)+this._siblingOffset[e][1],depth:g+1})}}return null}_addNode(t,e,n){return this.minimums.push(t),this.maximums.push(e),this.leaves.push(n),this.childOffsets.push(0),this.nodeCount++}_construct(t,e,n,i,r){if(1===t[i].isLeaf(e,n))return;this.childOffsets[r]||(this.childOffsets[r]=this.nodeCount);const o=i-1,s=t[o];let a,l=0;for(let c=0;c<this._siblingOffset.length;c++){const t=2*e+this._siblingOffset[c][0],i=2*n+this._siblingOffset[c][1],r=s.getElevation(t,i),o=s.isLeaf(t,i),u=this._addNode(r.min,r.max,o);o&&(l|=1<<c),a||(a=u)}for(let c=0;c<this._siblingOffset.length;c++)l&1<<c||this._construct(t,2*e+this._siblingOffset[c][0],2*n+this._siblingOffset[c][1],o,a+c)}}function ed(t,e,n,i,r,o){return nn(nn(t,n,o),nn(e,i,o),r)}function nd(t,e,n){const i=n.dim,r=m(t*i-.5,0,i-1),o=m(e*i-.5,0,i-1),s=Math.floor(r),a=Math.floor(o),l=Math.min(s+1,i-1),c=Math.min(a+1,i-1);return ed(n.get(s,a),n.get(l,a),n.get(s,c),n.get(l,c),r-s,o-a)}const id={mapbox:[6553.6,25.6,.1,1e4],terrarium:[256,1,1/256,32768]};class rd{get tree(){return this._tree||this._buildQuadTree(),this._tree}constructor(t,e,n,i=!1,r=!1){if(this.uid=t,e.height!==e.width)throw new RangeError("DEM tiles must be square");if(n&&"mapbox"!==n&&"terrarium"!==n)return M(`"${n}" is not a valid encoding type. Valid types include "mapbox" and "terrarium".`);this.stride=e.height;const o=this.dim=e.height-2;if(this.data=new Uint32Array(e.data.buffer),this.encoding=n||"mapbox",this.borderReady=i,!i){for(let t=0;t<o;t++)this.data[this._idx(-1,t)]=this.data[this._idx(0,t)],this.data[this._idx(o,t)]=this.data[this._idx(o-1,t)],this.data[this._idx(t,-1)]=this.data[this._idx(t,0)],this.data[this._idx(t,o)]=this.data[this._idx(t,o-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(o,-1)]=this.data[this._idx(o-1,0)],this.data[this._idx(-1,o)]=this.data[this._idx(0,o-1)],this.data[this._idx(o,o)]=this.data[this._idx(o-1,o-1)],r&&this._buildQuadTree()}}_buildQuadTree(){this._tree=new td(this)}get(t,e,n=!1){const i=new Uint8Array(this.data.buffer);n&&(t=m(t,-1,this.dim),e=m(e,-1,this.dim));const r=4*this._idx(t,e);return("terrarium"===this.encoding?this._unpackTerrarium:this._unpackMapbox)(i[r],i[r+1],i[r+2])}static getUnpackVector(t){return id[t]}get unpackVector(){return id[this.encoding]}_idx(t,e){if(t<-1||t>=this.dim+1||e<-1||e>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(e+1)*this.stride+(t+1)}_unpackMapbox(t,e,n){return(256*t*256+256*e+n)/10-1e4}_unpackTerrarium(t,e,n){return 256*t+e+n/256-32768}static pack(t,e){const n=[0,0,0,0],i=rd.getUnpackVector(e);let r=Math.floor((t+i[3])/i[2]);return n[2]=r%256,r=Math.floor(r/256),n[1]=r%256,r=Math.floor(r/256),n[0]=r,n}getPixels(){return new Na({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))}backfillBorder(t,e,n){if(this.dim!==t.dim)throw new Error("dem dimension mismatch");let i=e*this.dim,r=e*this.dim+this.dim,o=n*this.dim,s=n*this.dim+this.dim;switch(e){case-1:i=r-1;break;case 1:r=i+1}switch(n){case-1:o=s-1;break;case 1:s=o+1}const a=-e*this.dim,l=-n*this.dim;for(let c=o;c<s;c++)for(let e=i;e<r;e++)this.data[this._idx(e,c)]=t.data[this._idx(e+a,c+l)]}onDeserialize(){this._tree&&(this._tree.dem=this)}}or("DEMData",rd),or("DemMinMaxQuadTree",td,{omit:["dem"]});class od{constructor(t,e){this.max=t,this.onRemove=e,this.reset()}reset(){for(const t in this.data)for(const e of this.data[t])e.timeout&&clearTimeout(e.timeout),this.onRemove(e.value);return this.data={},this.order=[],this}add(t,e,n){const i=t.wrapped().key;void 0===this.data[i]&&(this.data[i]=[]);const r={value:e,timeout:void 0};if(void 0!==n&&(r.timeout=setTimeout(()=>{this.remove(t,r)},n)),this.data[i].push(r),this.order.push(i),this.order.length>this.max){const t=this._getAndRemoveByKey(this.order[0]);t&&this.onRemove(t)}return this}has(t){return t.wrapped().key in this.data}getAndRemove(t){return this.has(t)?this._getAndRemoveByKey(t.wrapped().key):null}_getAndRemoveByKey(t){const e=this.data[t].shift();return e.timeout&&clearTimeout(e.timeout),0===this.data[t].length&&delete this.data[t],this.order.splice(this.order.indexOf(t),1),e.value}getByKey(t){const e=this.data[t];return e?e[0].value:null}get(t){return this.has(t)?this.data[t.wrapped().key][0].value:null}remove(t,e){if(!this.has(t))return this;const n=t.wrapped().key,i=void 0===e?0:this.data[n].indexOf(e),r=this.data[n][i];return this.data[n].splice(i,1),r.timeout&&clearTimeout(r.timeout),0===this.data[n].length&&delete this.data[n],this.onRemove(r.value),this.order.splice(this.order.indexOf(n),1),this}setMaxSize(t){for(this.max=t;this.order.length>this.max;){const t=this._getAndRemoveByKey(this.order[0]);t&&this.onRemove(t)}return this}filter(t){const e=[];for(const n in this.data)for(const i of this.data[n])t(i.value)||e.push(i);for(const n of e)this.remove(n.value.tileID,n)}}class sd{constructor(t,e,n){this.func=t,this.mask=e,this.range=n}}sd.ReadOnly=!1,sd.ReadWrite=!0,sd.disabled=new sd(519,sd.ReadOnly,[0,1]);class ad{constructor(t,e,n,i,r,o){this.test=t,this.ref=e,this.mask=n,this.fail=i,this.depthFail=r,this.pass=o}}ad.disabled=new ad({func:519,mask:0},0,0,7680,7680,7680);class ld{constructor(t,e,n){this.blendFunction=t,this.blendColor=e,this.mask=n}}ld.Replace=[1,0],ld.disabled=new ld(ld.Replace,ue.transparent,[!1,!1,!1,!1]),ld.unblended=new ld(ld.Replace,ue.transparent,[!0,!0,!0,!0]),ld.alphaBlended=new ld([1,771],ue.transparent,[!0,!0,!0,!0]);class cd{constructor(t,e,n){this.enable=t,this.mode=e,this.frontFace=n}}cd.disabled=new cd(!1,1029,2305),cd.backCCW=new cd(!0,1029,2305),cd.backCW=new cd(!0,1029,2304),cd.frontCW=new cd(!0,1028,2304),cd.frontCCW=new cd(!0,1028,2305);class ud extends Ft{constructor(t,e,n){super(),this.id=t,this._onlySymbols=n,e.on("data",t=>{"source"===t.dataType&&"metadata"===t.sourceDataType&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&"source"===t.dataType&&"content"===t.sourceDataType&&(this.reload(),this.transform&&this.update(this.transform))}),e.on("error",()=>{this._sourceErrored=!0}),this._source=e,this._tiles={},this._cache=new od(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new Wh}onAdd(t){this.map=t,this._maxTileCacheSize=t?t._maxTileCacheSize:null}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded)return!1;if(!this._source.loaded())return!1;for(const t in this._tiles){const e=this._tiles[t];if("loaded"!==e.state&&"errored"!==e.state)return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const t=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,t&&this.reload(),this.transform&&this.update(this.transform)}_loadTile(t,e){return t.isSymbolTile=this._onlySymbols,this._source.loadTile(t,e)}_unloadTile(t){if(this._source.unloadTile)return this._source.unloadTile(t,()=>{})}_abortTile(t){if(this._source.abortTile)return this._source.abortTile(t,()=>{})}serialize(){return this._source.serialize()}prepare(t){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const e in this._tiles){const n=this._tiles[e];n.upload(t),n.prepare(this.map.style.imageManager)}}getIds(){return y(this._tiles).map(t=>t.tileID).sort(hd).map(t=>t.key)}getRenderableIds(t){const e=[];for(const n in this._tiles)this._isIdRenderable(+n,t)&&e.push(this._tiles[n]);return t?e.sort((t,e)=>{const n=t.tileID,i=e.tileID,o=new r(n.canonical.x,n.canonical.y)._rotate(this.transform.angle),s=new r(i.canonical.x,i.canonical.y)._rotate(this.transform.angle);return n.overscaledZ-i.overscaledZ||s.y-o.y||s.x-o.x}).map(t=>t.tileID.key):e.map(t=>t.tileID).sort(hd).map(t=>t.key)}hasRenderableParent(t){const e=this.findLoadedParent(t,0);return!!e&&this._isIdRenderable(e.tileID.key)}_isIdRenderable(t,e){return this._tiles[t]&&this._tiles[t].hasData()&&!this._coveredTiles[t]&&(e||!this._tiles[t].holdingForFade())}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const t in this._tiles)"errored"!==this._tiles[t].state&&this._reloadTile(+t,"reloading")}}_reloadTile(t,e){const n=this._tiles[t];n&&("loading"!==n.state&&(n.state=e),this._loadTile(n,this._tileLoaded.bind(this,n,t,e)))}_tileLoaded(t,e,n,i){if(i)return t.state="errored",void(404!==i.status?this._source.fire(new Rt(i,{tile:t})):this.update(this.transform));t.timeAdded=j.now(),"expired"===n&&(t.refreshedUponExpiration=!0),this._setTileReloadTimer(e,t),"raster-dem"===this.getSource().type&&t.dem&&this._backfillDEM(t),this._state.initializeTileState(t,this.map?this.map.painter:null),this._source.fire(new Lt("data",{dataType:"source",tile:t,coord:t.tileID,sourceCacheId:this.id}))}_backfillDEM(t){const e=this.getRenderableIds();for(let i=0;i<e.length;i++){const r=e[i];if(t.neighboringTiles&&t.neighboringTiles[r]){const e=this.getTileByID(r);n(t,e),n(e,t)}}function n(t,e){if(!t.dem||t.dem.borderReady)return;t.needsHillshadePrepare=!0,t.needsDEMTextureUpload=!0;let n=e.tileID.canonical.x-t.tileID.canonical.x;const i=e.tileID.canonical.y-t.tileID.canonical.y,r=Math.pow(2,t.tileID.canonical.z),o=e.tileID.key;0===n&&0===i||Math.abs(i)>1||(Math.abs(n)>1&&(1===Math.abs(n+r)?n+=r:1===Math.abs(n-r)&&(n-=r)),e.dem&&t.dem&&(t.dem.backfillBorder(e.dem,n,i),t.neighboringTiles&&t.neighboringTiles[o]&&(t.neighboringTiles[o].backfilled=!0)))}}getTile(t){return this.getTileByID(t.key)}getTileByID(t){return this._tiles[t]}_retainLoadedChildren(t,e,n,i){for(const r in this._tiles){let o=this._tiles[r];if(i[r]||!o.hasData()||o.tileID.overscaledZ<=e||o.tileID.overscaledZ>n)continue;let s=o.tileID;for(;o&&o.tileID.overscaledZ>e+1;){const t=o.tileID.scaledTo(o.tileID.overscaledZ-1);o=this._tiles[t.key],o&&o.hasData()&&(s=t)}let a=s;for(;a.overscaledZ>e;)if(a=a.scaledTo(a.overscaledZ-1),t[a.key]){i[s.key]=s;break}}}findLoadedParent(t,e){if(t.key in this._loadedParentTiles){const n=this._loadedParentTiles[t.key];return n&&n.tileID.overscaledZ>=e?n:null}for(let n=t.overscaledZ-1;n>=e;n--){const e=t.scaledTo(n),i=this._getLoadedTile(e);if(i)return i}}_getLoadedTile(t){const e=this._tiles[t.key];return e&&e.hasData()?e:this._cache.getByKey(this._source.reparseOverscaled?t.wrapped().key:t.canonical.key)}updateCacheSize(t,e){e=e||this._source.tileSize;const n=Math.ceil(t.width/e)+1,i=Math.ceil(t.height/e)+1,r=Math.floor(n*i*5),o="number"==typeof this._maxTileCacheSize?Math.min(this._maxTileCacheSize,r):r;this._cache.setMaxSize(o)}handleWrapJump(t){const e=Math.round((t-(void 0===this._prevLng?t:this._prevLng))/360);if(this._prevLng=t,e){const t={};for(const n in this._tiles){const i=this._tiles[n];i.tileID=i.tileID.unwrapTo(i.tileID.wrap+e),t[i.tileID.key]=i}this._tiles=t;for(const e in this._timers)clearTimeout(this._timers[e]),delete this._timers[e];for(const e in this._tiles)this._setTileReloadTimer(+e,this._tiles[e])}}update(t,e,n){if(this.transform=t,!this._sourceLoaded||this._paused||this.transform.freezeTileCoverage)return;if(this.usedForTerrain&&!n)return;let i;this.updateCacheSize(t,e),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used||this.usedForTerrain?this._source.tileID?i=t.getVisibleUnwrappedCoordinates(this._source.tileID).map(t=>new jh(t.canonical.z,t.wrap,t.canonical.z,t.canonical.x,t.canonical.y)):(i=t.coveringTiles({tileSize:e||this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!n,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain}),this._source.hasTile&&(i=i.filter(t=>this._source.hasTile(t)))):i=[];const r=this._updateRetainedTiles(i);if(dd(this._source.type)&&0!==i.length){const t={},e={},n=Object.keys(r);for(const i of n){const n=r[i],o=this._tiles[i];if(!o||o.fadeEndTime&&o.fadeEndTime<=j.now())continue;const s=this.findLoadedParent(n,Math.max(n.overscaledZ-ud.maxOverzooming,this._source.minzoom));s&&(this._addTile(s.tileID),t[s.tileID.key]=s.tileID),e[i]=n}const o=i[i.length-1].overscaledZ;for(const i in this._tiles){const t=this._tiles[i];if(r[i]||!t.hasData())continue;let n=t.tileID;for(;n.overscaledZ>o;){n=n.scaledTo(n.overscaledZ-1);const o=this._tiles[n.key];if(o&&o.hasData()&&e[n.key]){r[i]=t.tileID;break}}}for(const i in t)r[i]||(this._coveredTiles[i]=!0,r[i]=t[i])}for(const s in r)this._tiles[s].clearFadeHold();const o=function(t,e){const n=[];for(const i in t)i in e||n.push(i);return n}(this._tiles,r);for(const s of o){const t=this._tiles[s];t.hasSymbolBuckets&&!t.holdingForFade()?t.setHoldDuration(this.map._fadeDuration):t.hasSymbolBuckets&&!t.symbolFadeFinished()||this._removeTile(+s)}this._updateLoadedParentTileCache(),this._onlySymbols&&this._source.afterUpdate&&this._source.afterUpdate()}releaseSymbolFadeTiles(){for(const t in this._tiles)this._tiles[t].holdingForFade()&&this._removeTile(+t)}_updateRetainedTiles(t){const e={};if(0===t.length)return e;const n={},i=t[t.length-1].overscaledZ,r=t[0].overscaledZ,o=Math.max(r-ud.maxOverzooming,this._source.minzoom),s=Math.max(r+ud.maxUnderzooming,this._source.minzoom),a={};for(const l of t){const t=this._addTile(l);e[l.key]=l,t.hasData()||i<this._source.maxzoom&&(a[l.key]=l)}this._retainLoadedChildren(a,i,s,e);for(const l of t){let t=this._tiles[l.key];if(t.hasData())continue;if(l.canonical.z>=this._source.maxzoom){const t=l.children(this._source.maxzoom)[0],n=this.getTile(t);if(n&&n.hasData()){e[t.key]=t;continue}}else{const t=l.children(this._source.maxzoom);if(e[t[0].key]&&e[t[1].key]&&e[t[2].key]&&e[t[3].key])continue}let i=t.wasRequested();for(let r=l.overscaledZ-1;r>=o;--r){const o=l.scaledTo(r);if(n[o.key])break;if(n[o.key]=!0,t=this.getTile(o),!t&&i&&(t=this._addTile(o)),t&&(e[o.key]=o,i=t.wasRequested(),t.hasData()))break}}return e}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const t in this._tiles){const e=[];let n,i=this._tiles[t].tileID;for(;i.overscaledZ>0;){if(i.key in this._loadedParentTiles){n=this._loadedParentTiles[i.key];break}e.push(i.key);const t=i.scaledTo(i.overscaledZ-1);if(n=this._getLoadedTile(t),n)break;i=t}for(const t of e)this._loadedParentTiles[t]=n}}_addTile(t){let e=this._tiles[t.key];if(e)return e;e=this._cache.getAndRemove(t),e&&(this._setTileReloadTimer(t.key,e),e.tileID=t,this._state.initializeTileState(e,this.map?this.map.painter:null),this._cacheTimers[t.key]&&(clearTimeout(this._cacheTimers[t.key]),delete this._cacheTimers[t.key],this._setTileReloadTimer(t.key,e)));const n=Boolean(e);return n||(e=new Hh(t,this._source.tileSize*t.overscaleFactor(),this.transform.tileZoom),this._loadTile(e,this._tileLoaded.bind(this,e,t.key,e.state))),e?(e.uses++,this._tiles[t.key]=e,n||this._source.fire(new Lt("dataloading",{tile:e,coord:e.tileID,dataType:"source"})),e):null}_setTileReloadTimer(t,e){t in this._timers&&(clearTimeout(this._timers[t]),delete this._timers[t]);const n=e.getExpiryTimeout();n&&(this._timers[t]=setTimeout(()=>{this._reloadTile(t,"expired"),delete this._timers[t]},n))}_removeTile(t){const e=this._tiles[t];e&&(e.uses--,delete this._tiles[t],this._timers[t]&&(clearTimeout(this._timers[t]),delete this._timers[t]),e.uses>0||(e.hasData()&&"reloading"!==e.state?this._cache.add(e.tileID,e,e.getExpiryTimeout()):(e.aborted=!0,this._abortTile(e),this._unloadTile(e))))}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const t in this._tiles)this._removeTile(+t);this._cache.reset()}tilesIn(t,e,n){const i=[],r=this.transform;if(!r)return i;for(const o in this._tiles){const s=this._tiles[o];if(n&&s.clearQueryDebugViz(),s.holdingForFade())continue;const a=t.containsTile(s,r,e);a&&i.push(a)}return i}getVisibleCoordinates(t){const e=this.getRenderableIds(t).map(t=>this._tiles[t].tileID);for(const n of e)n.projMatrix=this.transform.calculateProjMatrix(n.toUnwrapped());return e}hasTransition(){if(this._source.hasTransition())return!0;if(dd(this._source.type))for(const t in this._tiles){const e=this._tiles[t];if(void 0!==e.fadeEndTime&&e.fadeEndTime>=j.now())return!0}return!1}setFeatureState(t,e,n){this._state.updateState(t=t||"_geojsonTileLayer",e,n)}removeFeatureState(t,e,n){this._state.removeFeatureState(t=t||"_geojsonTileLayer",e,n)}getFeatureState(t,e){return this._state.getState(t=t||"_geojsonTileLayer",e)}setDependencies(t,e,n){const i=this._tiles[t];i&&i.setDependencies(e,n)}reloadTilesForDependencies(t,e){for(const n in this._tiles)this._tiles[n].hasDependency(t,e)&&this._reloadTile(+n,"reloading");this._cache.filter(n=>!n.hasDependency(t,e))}}function hd(t,e){const n=Math.abs(2*t.wrap)-+(t.wrap<0),i=Math.abs(2*e.wrap)-+(e.wrap<0);return t.overscaledZ-e.overscaledZ||i-n||e.canonical.y-t.canonical.y||e.canonical.x-t.canonical.x}function dd(t){return"raster"===t||"image"===t||"video"===t}ud.maxOverzooming=10,ud.maxUnderzooming=3;class pd{constructor(t,e,n){this._demTile=t,this._dem=this._demTile.dem,this._scale=e,this._offset=n}static create(t,e,n){const i=n||t.findDEMTileFor(e);if(!i||!i.dem)return;const r=i.dem,o=i.tileID,s=1<<e.canonical.z-o.canonical.z;return new pd(i,i.tileSize/Us/s,[(e.canonical.x/s-o.canonical.x)*r.dim,(e.canonical.y/s-o.canonical.y)*r.dim])}tileCoordToPixel(t,e){const n=e*this._scale+this._offset[1],i=Math.floor(t*this._scale+this._offset[0]),o=Math.floor(n);return new r(i,o)}getElevationAt(t,e,n,i){const r=t*this._scale+this._offset[0],o=e*this._scale+this._offset[1],s=Math.floor(r),a=Math.floor(o),l=this._dem;return i=!!i,n?nn(nn(l.get(s,a,i),l.get(s,a+1,i),o-a),nn(l.get(s+1,a,i),l.get(s+1,a+1,i),o-a),r-s):l.get(s,a,i)}getElevationAtPixel(t,e,n){return this._dem.get(t,e,!!n)}getMeterToDEM(t){return(1<<this._demTile.tileID.canonical.z)*Ph(1,t)*this._dem.stride}}class fd{constructor(t,e){this.tileID=t,this.x=t.canonical.x,this.y=t.canonical.y,this.z=t.canonical.z,this.grid=new tr(Us,16,0),this.featureIndexArray=new is,this.promoteId=e}insert(t,e,n,i,r,o=0){const s=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(n,i,r,o);const a=this.grid;for(let l=0;l<e.length;l++){const t=e[l],n=[1/0,1/0,-1/0,-1/0];for(let e=0;e<t.length;e++){const i=t[e];n[0]=Math.min(n[0],i.x),n[1]=Math.min(n[1],i.y),n[2]=Math.max(n[2],i.x),n[3]=Math.max(n[3],i.y)}n[0]<Us&&n[1]<Us&&n[2]>=0&&n[3]>=0&&a.insert(s,n[0],n[1],n[2],n[3])}}loadVTLayers(){return this.vtLayers||(this.vtLayers=new ql.VectorTile(new kc(this.rawTileData)).layers,this.sourceLayerCoder=new $h(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers}query(t,e,n,i){this.loadVTLayers();const r=t.params||{},o=wi(r.filter),s=t.tileResult,a=t.transform,l=s.bufferedTilespaceBounds,c=this.grid.query(l.min.x,l.min.y,l.max.x,l.max.y,(t,e,n,i)=>ia(s.bufferedTilespaceGeometry,t,e,n,i));c.sort(gd);let u=null;a.elevation&&c.length>0&&(u=pd.create(a.elevation,this.tileID));const h={};let d;for(let p=0;p<c.length;p++){const a=c[p];if(a===d)continue;d=a;const l=this.featureIndexArray.get(a);let f=null;this.loadMatchingFeature(h,l,o,r.layers,r.availableImages,e,n,i,(e,n,i,r=0)=>(f||(f=qs(e)),n.queryIntersectsFeature(s,e,i,f,this.z,t.transform,t.pixelPosMatrix,u,r)))}return h}loadMatchingFeature(t,e,n,i,r,o,s,a,l){const{featureIndex:c,bucketIndex:u,sourceLayerIndex:h,layoutVertexArrayOffset:d}=e,p=this.bucketLayerIDs[u];if(i&&!function(t,e){for(let n=0;n<t.length;n++)if(e.indexOf(t[n])>=0)return!0;return!1}(i,p))return;const f=this.sourceLayerCoder.decode(h),m=this.vtLayers[f].feature(c);if(n.needGeometry){const t=$s(m,!0);if(!n.filter(new ro(this.tileID.overscaledZ),t,this.tileID.canonical))return}else if(!n.filter(new ro(this.tileID.overscaledZ),m))return;const g=this.getId(m,f);for(let _=0;_<p.length;_++){const e=p[_];if(i&&i.indexOf(e)<0)continue;const n=o[e];if(!n)continue;let u={};void 0!==g&&a&&(u=a.getState(n.sourceLayer||"_geojsonTileLayer",g));const h=v({},s[e]);h.paint=md(h.paint,n.paint,m,u,r),h.layout=md(h.layout,n.layout,m,u,r);const f=!l||l(m,n,u,d);if(!f)continue;const y=new Gh(m,this.z,this.x,this.y,g);y.layer=h;let x=t[e];void 0===x&&(x=t[e]=[]),x.push({featureIndex:c,feature:y,intersectionZ:f})}}lookupSymbolFeatures(t,e,n,i,r,o,s,a){const l={};this.loadVTLayers();const c=wi(r);for(const u of t)this.loadMatchingFeature(l,{bucketIndex:n,sourceLayerIndex:i,featureIndex:u,layoutVertexArrayOffset:0},c,o,s,a,e);return l}hasLayer(t){for(const e of this.bucketLayerIDs)for(const n of e)if(t===n)return!0;return!1}getId(t,e){let n=t.id;return this.promoteId&&(n=t.properties["string"==typeof this.promoteId?this.promoteId:this.promoteId[e]],"boolean"==typeof n&&(n=Number(n))),n}}function md(t,e,n,i,r){return k(t,(t,o)=>{const s=e instanceof po?e.get(o):null;return s&&s.evaluate?s.evaluate(n,i,r):s})}function gd(t,e){return e-t}or("FeatureIndex",fd,{omit:["rawTileData","sourceLayerCoder"]});class _d{constructor(t){const e={},n=[];for(const s in t){const i=t[s],r=e[s]={};for(const t in i){const e=i[+t];if(!e||0===e.bitmap.width||0===e.bitmap.height)continue;const o=e.metrics.localGlyph?2:1,s={x:0,y:0,w:e.bitmap.width+2*o,h:e.bitmap.height+2*o};n.push(s),r[t]={rect:s,metrics:e.metrics}}}const{w:i,h:r}=Kc(n),o=new Ua({width:i||1,height:r||1});for(const s in t){const n=t[s];for(const t in n){const i=n[+t];if(!i||0===i.bitmap.width||0===i.bitmap.height)continue;const r=e[s][t].rect,a=i.metrics.localGlyph?2:1;Ua.copy(i.bitmap,o,{x:0,y:0},{x:r.x+a,y:r.y+a},i.bitmap)}}this.image=o,this.positions=e}}or("GlyphAtlas",_d);class yd{constructor(t){this.tileID=new jh(t.tileID.overscaledZ,t.tileID.wrap,t.tileID.canonical.z,t.tileID.canonical.x,t.tileID.canonical.y),this.tileZoom=t.tileZoom,this.uid=t.uid,this.zoom=t.zoom,this.pixelRatio=t.pixelRatio,this.tileSize=t.tileSize,this.source=t.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=t.showCollisionBoxes,this.collectResourceTiming=!!t.collectResourceTiming,this.returnDependencies=!!t.returnDependencies,this.promoteId=t.promoteId,this.enableTerrain=!!t.enableTerrain,this.isSymbolTile=t.isSymbolTile}parse(t,e,n,i,r){this.status="parsing",this.data=t,this.collisionBoxArray=new Xo;const o=new $h(Object.keys(t.layers).sort()),s=new fd(this.tileID,this.promoteId);s.bucketLayerIDs=[];const a={},l=new Dh(256,256),c={featureIndex:s,iconDependencies:{},patternDependencies:{},glyphDependencies:{},lineAtlas:l,availableImages:n},u=e.familiesBySource[this.source];for(const y in u){const e=t.layers[y];if(!e)continue;let i=!1,r=!1;for(const t of u[y])"symbol"===t[0].type?i=!0:r=!0;if(!0===this.isSymbolTile&&!i)continue;if(!1===this.isSymbolTile&&!r)continue;1===e.version&&M(`Vector tile source "${this.source}" layer "${y}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const l=o.encode(y),h=[];for(let t=0;t<e.length;t++){const n=e.feature(t),i=s.getId(n,y);h.push({feature:n,id:i,index:t,sourceLayerIndex:l})}for(const t of u[y]){const e=t[0];void 0!==this.isSymbolTile&&"symbol"===e.type!==this.isSymbolTile||e.minzoom&&this.zoom<Math.floor(e.minzoom)||e.maxzoom&&this.zoom>=e.maxzoom||"none"!==e.visibility&&(vd(t,this.zoom,n),(a[e.id]=e.createBucket({index:s.bucketLayerIDs.length,layers:t,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:l,sourceID:this.source,enableTerrain:this.enableTerrain})).populate(h,c,this.tileID.canonical),s.bucketLayerIDs.push(t.map(t=>t.id)))}}let h,d,p,f;l.trim();const m={type:"maybePrepare",isSymbolTile:this.isSymbolTile,zoom:this.zoom},g=k(c.glyphDependencies,t=>Object.keys(t).map(Number));Object.keys(g).length?i.send("getGlyphs",{uid:this.uid,stacks:g},(t,e)=>{h||(h=t,d=e,x.call(this))},void 0,!1,m):d={};const _=Object.keys(c.iconDependencies);_.length?i.send("getImages",{icons:_,source:this.source,tileID:this.tileID,type:"icons"},(t,e)=>{h||(h=t,p=e,x.call(this))},void 0,!1,m):p={};const v=Object.keys(c.patternDependencies);function x(){if(h)return r(h);if(d&&p&&f){const t=new _d(d),e=new Jc(p,f);for(const i in a){const r=a[i];r instanceof sh?(vd(r.layers,this.zoom,n),$u(r,d,t.positions,p,e.iconPositions,this.showCollisionBoxes,this.tileID.canonical,this.tileZoom)):r.hasPattern&&(r instanceof ac||r instanceof Il||r instanceof Wl)&&(vd(r.layers,this.zoom,n),r.addFeatures(c,this.tileID.canonical,e.patternPositions))}this.status="done",r(null,{buckets:y(a).filter(t=>!t.isEmpty()),featureIndex:s,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:t.image,lineAtlas:l,imageAtlas:e,glyphMap:this.returnDependencies?d:null,iconMap:this.returnDependencies?p:null,glyphPositions:this.returnDependencies?t.positions:null})}}v.length?i.send("getImages",{icons:v,source:this.source,tileID:this.tileID,type:"patterns"},(t,e)=>{h||(h=t,f=e,x.call(this))},void 0,!1,m):f={},x.call(this)}}function vd(t,e,n){const i=new ro(e);for(const r of t)r.recalculate(i,n)}class xd{constructor(t){this.entries={},this.scheduler=t}request(t,e,n,i){const r=this.entries[t]=this.entries[t]||{callbacks:[]};if(r.result){const[t,n]=r.result;return this.scheduler?this.scheduler.add(()=>{i(t,n)},e):i(t,n),()=>{}}return r.callbacks.push(i),r.cancel||(r.cancel=n((n,i)=>{r.result=[n,i];for(const t of r.callbacks)this.scheduler?this.scheduler.add(()=>{t(n,i)},e):t(n,i);setTimeout(()=>delete this.entries[t],3e3)})),()=>{r.result||(r.callbacks=r.callbacks.filter(t=>t!==i),r.callbacks.length||(r.cancel(),delete this.entries[t]))}}}function bd(t,e,n){const i=JSON.stringify(t.request);return t.data&&(this.deduped.entries[i]={result:[null,t.data]}),this.deduped.request(i,{type:"parseTile",isSymbolTile:t.isSymbolTile,zoom:t.tileZoom},e=>{const i=St(t.request,(t,i,r,o)=>{t?e(t):i&&e(null,{vectorTile:n?void 0:new ql.VectorTile(new kc(i)),rawData:i,cacheControl:r,expires:o})});return()=>{i.cancel(),e()}},e)}t.ARRAY_TYPE=ha,t.AUTH_ERR_MSG=J,t.Actor=class{constructor(t,e,n){this.target=t,this.parent=e,this.mapId=n,this.callbacks={},this.cancelCallbacks={},S(["receive"],this),this.target.addEventListener("message",this.receive,!1),this.globalScope=D()?t:s,this.scheduler=new Bh}send(t,e,n,i,r=!1,o){const s=Math.round(1e18*Math.random()).toString(36).substring(0,10);n&&(n.metadata=o,this.callbacks[s]=n);const a=U(this.globalScope)?void 0:[];return this.target.postMessage({id:s,type:t,hasCallback:!!n,targetMapId:i,mustQueue:r,sourceMapId:this.mapId,data:lr(e,a)},a),{cancel:()=>{n&&delete this.callbacks[s],this.target.postMessage({id:s,type:"<cancel>",targetMapId:i,sourceMapId:this.mapId})}}}receive(t){const e=t.data,n=e.id;if(n&&(!e.targetMapId||this.mapId===e.targetMapId))if("<cancel>"===e.type){const t=this.cancelCallbacks[n];delete this.cancelCallbacks[n],t&&t.cancel()}else if(e.mustQueue||D()){const t=this.callbacks[n];this.cancelCallbacks[n]=this.scheduler.add(()=>this.processTask(n,e),t&&t.metadata||{type:"message"})}else this.processTask(n,e)}processTask(t,e){if("<response>"===e.type){const n=this.callbacks[t];delete this.callbacks[t],n&&(e.error?n(cr(e.error)):n(null,cr(e.data)))}else{const n=U(this.globalScope)?void 0:[],i=e.hasCallback?(e,i)=>{delete this.cancelCallbacks[t],this.target.postMessage({id:t,type:"<response>",sourceMapId:this.mapId,error:e?lr(e):null,data:lr(i,n)},n)}:t=>{},r=cr(e.data);if(this.parent[e.type])this.parent[e.type](e.sourceMapId,r,i);else if(this.parent.getWorkerSource){const t=e.type.split(".");this.parent.getWorkerSource(e.sourceMapId,t[0],r.source)[t[1]](r,i)}else i(new Error("Could not find function "+e.type))}}remove(){this.scheduler.remove(),this.target.removeEventListener("message",this.receive,!1)}},t.CanonicalTileID=Uh,t.Color=ue,t.ColorMode=ld,t.CullFaceMode=cd,t.DEMData=rd,t.DataConstantProperty=fo,t.DedupedRequest=xd,t.DepthMode=sd,t.EXTENT=Us,t.Elevation=class{getAtPointOrZero(t,e=0){return this.getAtPoint(t,e)||0}getAtPoint(t,e,n=!0){null==e&&(e=null);const i=this._source();if(!i)return e;if(t.y<0||t.y>1)return e;const r=i.getSource().maxzoom,o=1<<r,s=Math.floor(t.x),a=t.x-s,l=new jh(r,s,r,Math.floor(a*o),Math.floor(t.y*o)),c=this.findDEMTileFor(l);if(!c||!c.dem)return e;const u=c.dem,h=1<<c.tileID.canonical.z,d=(a*h-c.tileID.canonical.x)*u.dim,p=(t.y*h-c.tileID.canonical.y)*u.dim,f=Math.floor(d),m=Math.floor(p);return(n?this.exaggeration():1)*nn(nn(u.get(f,m),u.get(f,m+1),p-m),nn(u.get(f+1,m),u.get(f+1,m+1),p-m),d-f)}getAtTileOffset(t,e,n){const i=1<<t.canonical.z;return this.getAtPointOrZero(new zh(t.wrap+(t.canonical.x+e/Us)/i,(t.canonical.y+n/Us)/i))}getForTilePoints(t,e,n,i){const r=pd.create(this,t,i);return!!r&&(e.forEach(t=>{t[2]=this.exaggeration()*r.getElevationAt(t[0],t[1],n)}),!0)}getMinMaxForTile(t){const e=this.findDEMTileFor(t);if(!e||!e.dem)return null;const n=e.dem.tree,i=e.tileID,r=1<<t.canonical.z-i.canonical.z;let o=t.canonical.x/r-i.canonical.x,s=t.canonical.y/r-i.canonical.y,a=0;for(let l=0;l<t.canonical.z-i.canonical.z&&!n.leaves[a];l++){o*=2,s*=2;const t=2*Math.floor(s)+Math.floor(o);a=n.childOffsets[a]+t,o%=1,s%=1}return{min:this.exaggeration()*n.minimums[a],max:this.exaggeration()*n.maximums[a]}}getMinElevationBelowMSL(){throw new Error("Pure virtual method called.")}raycast(t,e,n){throw new Error("Pure virtual method called.")}pointCoordinate(t){throw new Error("Pure virtual method called.")}_source(){throw new Error("Pure virtual method called.")}exaggeration(){throw new Error("Pure virtual method called.")}findDEMTileFor(t){throw new Error("Pure virtual method called.")}get visibleDemTiles(){throw new Error("Getter must be implemented in subclass.")}},t.ErrorEvent=Rt,t.EvaluationParameters=ro,t.Event=Lt,t.Evented=Ft,t.GlyphManager=Mu,t.ImagePosition=Yc,t.LineAtlas=Dh,t.LngLat=Sh,t.LngLatBounds=Ch,t.LocalGlyphMode=Pu,t.MAX_SAFE_INTEGER=a,t.MercatorCoordinate=zh,t.ONE_EM=24,t.OverscaledTileID=jh,t.Properties=vo,t.RGBAImage=Na,t.RequestManager=class{constructor(t,e,n){this._transformRequestFn=t,this._customAccessToken=e,this._silenceAuthErrors=!!n,this._createSkuToken()}_createSkuToken(){const t=function(){let t="";for(let e=0;e<10;e++)t+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(62*Math.random())];return{token:["1",Y,t].join(""),tokenExpiresAt:Date.now()+432e5}}();this._skuToken=t.token,this._skuTokenExpiresAt=t.tokenExpiresAt}_isSkuTokenExpired(){return Date.now()>this._skuTokenExpiresAt}transformRequest(t,e){return this._transformRequestFn&&this._transformRequestFn(t,e)||{url:t}}normalizeStyleURL(t,e){if(!Q(t))return t;const n=nt(t);return n.path="/styles/v1"+n.path,this._makeAPIURL(n,this._customAccessToken||e)}normalizeGlyphsURL(t,e){if(!Q(t))return t;const n=nt(t);return n.path="/fonts/v1"+n.path,this._makeAPIURL(n,this._customAccessToken||e)}normalizeSourceURL(t,e){if(!Q(t))return t;const n=nt(t);return n.path=`/v4/${n.authority}.json`,n.params.push("secure"),this._makeAPIURL(n,this._customAccessToken||e)}normalizeSpriteURL(t,e,n,i){const r=nt(t);return Q(t)?(r.path=`/styles/v1${r.path}/sprite${e}${n}`,this._makeAPIURL(r,this._customAccessToken||i)):(r.path+=`${e}${n}`,it(r))}normalizeTileURL(t,e,n){if(this._isSkuTokenExpired()&&this._createSkuToken(),t&&!Q(t))return t;const i=nt(t);i.path=i.path.replace(/(\.(png|jpg)\d*)(?=$)/,`${e||n&&"raster"!==i.authority&&512===n?"@2x":""}${G.supported?".webp":"$1"}`),"raster"===i.authority?i.path=`/${$.RASTER_URL_PREFIX}${i.path}`:(i.path=i.path.replace(/^.+\/v4\//,"/"),i.path=`/${$.TILE_URL_VERSION}${i.path}`);const r=this._customAccessToken||function(t){for(const e of t){const t=e.match(/^access_token=(.*)$/);if(t)return t[1]}return null}(i.params)||$.ACCESS_TOKEN;return $.REQUIRE_ACCESS_TOKEN&&r&&this._skuToken&&i.params.push("sku="+this._skuToken),this._makeAPIURL(i,r)}canonicalizeTileURL(t,e){const n=nt(t);if(!n.path.match(/^(\/v4\/|\/raster\/v1\/)/)||!n.path.match(/\.[\w]+$/))return t;let i="mapbox://";n.path.match(/^\/raster\/v1\//)?i+="raster/"+n.path.replace(`/${$.RASTER_URL_PREFIX}/`,""):i+="tiles/"+n.path.replace(`/${$.TILE_URL_VERSION}/`,"");let r=n.params;return e&&(r=r.filter(t=>!t.match(/^access_token=/))),r.length&&(i+="?"+r.join("&")),i}canonicalizeTileset(t,e){const n=!!e&&Q(e),i=[];for(const r of t.tiles||[])tt(r)?i.push(this.canonicalizeTileURL(r,n)):i.push(r);return i}_makeAPIURL(t,e){const n="See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes",i=nt($.API_URL);if(t.protocol=i.protocol,t.authority=i.authority,"http"===t.protocol){const e=t.params.indexOf("secure");e>=0&&t.params.splice(e,1)}if("/"!==i.path&&(t.path=`${i.path}${t.path}`),!$.REQUIRE_ACCESS_TOKEN)return it(t);if(e=e||$.ACCESS_TOKEN,!this._silenceAuthErrors){if(!e)throw new Error("An API access token is required to use Mapbox GL. "+n);if("s"===e[0])throw new Error("Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). "+n)}return t.params=t.params.filter(t=>-1===t.indexOf("access_token")),t.params.push("access_token="+(e||"")),it(t)}},t.ResourceType=bt,t.SegmentVector=Vs,t.SourceCache=ud,t.StencilMode=ad,t.StructArrayLayout1ui2=Zo,t.StructArrayLayout2f1f2i16=Fo,t.StructArrayLayout2i4=Eo,t.StructArrayLayout2ui4=Go,t.StructArrayLayout3f12=zo,t.StructArrayLayout3ui6=Vo,t.StructArrayLayout4i8=ko,t.Texture=wh,t.Tile=Hh,t.Transitionable=ao,t.Uniform1f=_s,t.Uniform1i=class extends gs{constructor(t,e){super(t,e),this.current=0}set(t){this.current!==t&&(this.current=t,this.gl.uniform1i(this.location,t))}},t.Uniform2f=class extends gs{constructor(t,e){super(t,e),this.current=[0,0]}set(t){t[0]===this.current[0]&&t[1]===this.current[1]||(this.current=t,this.gl.uniform2f(this.location,t[0],t[1]))}},t.Uniform3f=class extends gs{constructor(t,e){super(t,e),this.current=[0,0,0]}set(t){t[0]===this.current[0]&&t[1]===this.current[1]&&t[2]===this.current[2]||(this.current=t,this.gl.uniform3f(this.location,t[0],t[1],t[2]))}},t.Uniform4f=ys,t.UniformColor=vs,t.UniformMatrix3f=class extends gs{constructor(t,e){super(t,e),this.current=bs}set(t){for(let e=0;e<9;e++)if(t[e]!==this.current[e]){this.current=t,this.gl.uniformMatrix3fv(this.location,!1,t);break}}},t.UniformMatrix4f=class extends gs{constructor(t,e){super(t,e),this.current=xs}set(t){if(t[12]!==this.current[12]||t[0]!==this.current[0])return this.current=t,void this.gl.uniformMatrix4fv(this.location,!1,t);for(let e=1;e<16;e++)if(t[e]!==this.current[e]){this.current=t,this.gl.uniformMatrix4fv(this.location,!1,t);break}}},t.UnwrappedTileID=Nh,t.ValidationError=Vt,t.VectorTileWorkerSource=class extends Ft{constructor(t,e,n,i,r){super(),this.actor=t,this.layerIndex=e,this.availableImages=n,this.loadVectorData=r||bd,this.loading={},this.loaded={},this.deduped=new xd(t.scheduler),this.isSpriteLoaded=i,this.scheduler=t.scheduler}loadTile(t,e){const n=t.uid,i=t&&t.request,r=i&&i.collectResourceTiming,o=this.loading[n]=new yd(t);o.abort=this.loadVectorData(t,(s,a)=>{const l=!this.loading[n];if(delete this.loading[n],l||s||!a)return o.status="done",l||(this.loaded[n]=o),e(s);const c=a.rawData,u={};a.expires&&(u.expires=a.expires),a.cacheControl&&(u.cacheControl=a.cacheControl),o.vectorTile=a.vectorTile||new ql.VectorTile(new kc(c));const h=()=>{o.parse(o.vectorTile,this.layerIndex,this.availableImages,this.actor,(t,n)=>{if(t||!n)return e(t);const o={};if(r){const t=Fh(i);t.length>0&&(o.resourceTiming=JSON.parse(JSON.stringify(t)))}e(null,v({rawTileData:c.slice(0)},n,u,o))})};this.isSpriteLoaded?h():this.once("isSpriteLoaded",()=>{this.scheduler?this.scheduler.add(h,{type:"parseTile",isSymbolTile:t.isSymbolTile,zoom:t.tileZoom}):h()}),this.loaded=this.loaded||{},this.loaded[n]=o})}reloadTile(t,e){const n=this.loaded,i=t.uid,r=this;if(n&&n[i]){const o=n[i];o.showCollisionBoxes=t.showCollisionBoxes,o.enableTerrain=!!t.enableTerrain;const s=(t,n)=>{const i=o.reloadCallback;i&&(delete o.reloadCallback,o.parse(o.vectorTile,r.layerIndex,this.availableImages,r.actor,i)),e(t,n)};"parsing"===o.status?o.reloadCallback=s:"done"===o.status&&(o.vectorTile?o.parse(o.vectorTile,this.layerIndex,this.availableImages,this.actor,s):s())}}abortTile(t,e){const n=t.uid,i=this.loading[n];i&&(i.abort&&i.abort(),delete this.loading[n]),e()}removeTile(t,e){const n=this.loaded,i=t.uid;n&&n[i]&&delete n[i],e()}},t.WritingMode=Qc,t.ZoomHistory=ur,t.add=function(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t},t.addDynamicAttributes=nh,t.altitudeFromMercatorZ=Oh,t.asyncAll=_,t.bezier=p,t.bindAll=S,t.bufferConvexPolygon=function(t,e){const n=[];for(let i=0;i<t.length;i++){const r=g(i-1,-1,t.length-1),o=g(i+1,-1,t.length-1),s=t[i],a=t[o],l=t[r].sub(s).unit(),c=a.sub(s).unit(),u=c.angleWithSep(l.x,l.y),h=l.add(c).unit().mult(-1*e/Math.sin(u/2));n.push(s.add(h))}return n},t.cacheEntryPossiblyAdded=function(t){xt++,xt>_t&&(t.getActor().send("enforceCacheSizeLimit",gt),xt=0)},t.clamp=m,t.clearTileCache=function(t){const e=s.caches.delete(pt);t&&e.catch(t).then(()=>t())},t.clipLine=Cu,t.clone=function(t){var e=new ha(3);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e},t.clone$1=function(t){var e=new ha(16);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e},t.clone$2=I,t.collisionCircleLayout=_c,t.config=$,t.conjugate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=e[3],t},t.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t},t.create=ga,t.create$1=function(){var t=new ha(16);return ha!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0),t[0]=1,t[5]=1,t[10]=1,t[15]=1,t},t.create$2=da,t.createExpression=li,t.createFilter=wi,t.createLayout=To,t.createStyleLayer=function(t){return"custom"===t.type?new ph(t):new gh[t.type](t)},t.cross=function(t,e,n){var i=e[0],r=e[1],o=e[2],s=n[0],a=n[1],l=n[2];return t[0]=r*l-o*a,t[1]=o*s-i*l,t[2]=i*a-r*s,t},t.degToRad=u,t.div=function(t,e,n){return t[0]=e[0]/n[0],t[1]=e[1]/n[1],t[2]=e[2]/n[2],t},t.dot=function(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]},t.dot$1=function(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]+t[3]*e[3]},t.ease=f,t.easeCubicInOut=d,t.emitValidationErrors=Qi,t.endsWith=E,t.enforceCacheSizeLimit=function(t){yt(),ft&&ft.then(e=>{e.keys().then(n=>{for(let i=0;i<n.length-t;i++)e.delete(n[i])})})},t.evaluateSizeForFeature=xc,t.evaluateSizeForZoom=bc,t.evaluateVariableOffset=qu,t.evented=to,t.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]},t.exactEquals$1=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]},t.exported=j,t.exported$1=G,t.extend=v,t.filterObject=A,t.fromMat4=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[4],t[4]=e[5],t[5]=e[6],t[6]=e[8],t[7]=e[9],t[8]=e[10],t},t.fromQuat=function(t,e){var n=e[0],i=e[1],r=e[2],o=e[3],s=n+n,a=i+i,l=r+r,c=n*s,u=i*s,h=i*a,d=r*s,p=r*a,f=r*l,m=o*s,g=o*a,_=o*l;return t[0]=1-h-f,t[1]=u+_,t[2]=d-g,t[3]=0,t[4]=u-_,t[5]=1-c-f,t[6]=p+m,t[7]=0,t[8]=d+g,t[9]=p-m,t[10]=1-c-h,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},t.fromRotation=function(t,e){var n=Math.sin(e),i=Math.cos(e);return t[0]=i,t[1]=n,t[2]=0,t[3]=-n,t[4]=i,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},t.fromScaling=function(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=e[1],t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=e[2],t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},t.furthestTileCorner=function(t){const e=Math.round((t+45+360)%360/90)%4;return h[e]},t.getAABBPointSquareDist=function(t,e,n){let i=0;for(let r=0;r<2;++r){const o=n?n[r]:0;t[r]>o&&(i+=(t[r]-o)*(t[r]-o)),e[r]<o&&(i+=(o-e[r])*(o-e[r]))}return i},t.getAnchorAlignment=hu,t.getAnchorJustification=Gu,t.getBounds=function(t){let e=1/0,n=1/0,i=-1/0,o=-1/0;for(const r of t)e=Math.min(e,r.x),n=Math.min(n,r.y),i=Math.max(i,r.x),o=Math.max(o,r.y);return{min:new r(e,n),max:new r(i,o)}},t.getImage=Ot,t.getJSON=function(t,e){return Tt(v(t,{type:"json"}),e)},t.getMapSessionAPI=ht,t.getPerformanceMeasurement=Fh,t.getRTLTextPluginStatus=eo,t.getReferrer=Ct,t.getVideo=function(t,e){const n=s.document.createElement("video");n.muted=!0,n.onloadstart=function(){e(null,n)};for(let i=0;i<t.length;i++){const e=s.document.createElement("source");At(t[i])||(n.crossOrigin="Anonymous"),e.src=t[i],n.appendChild(e)}return{cancel:()=>{}}},t.identity=pa,t.identity$1=Pa,t.invert=function(t,e){var n=e[0],i=e[1],r=e[2],o=e[3],s=e[4],a=e[5],l=e[6],c=e[7],u=e[8],h=e[9],d=e[10],p=e[11],f=e[12],m=e[13],g=e[14],_=e[15],y=n*a-i*s,v=n*l-r*s,x=n*c-o*s,b=i*l-r*a,w=i*c-o*a,C=r*c-o*l,T=u*m-h*f,S=u*g-d*f,E=u*_-p*f,k=h*g-d*m,A=h*_-p*m,I=d*_-p*g,P=y*I-v*A+x*k+b*E-w*S+C*T;return P?(t[0]=(a*I-l*A+c*k)*(P=1/P),t[1]=(r*A-i*I-o*k)*P,t[2]=(m*C-g*w+_*b)*P,t[3]=(d*w-h*C-p*b)*P,t[4]=(l*E-s*I-c*S)*P,t[5]=(n*I-r*E+o*S)*P,t[6]=(g*x-f*C-_*v)*P,t[7]=(u*C-d*x+p*v)*P,t[8]=(s*A-a*E+c*T)*P,t[9]=(i*E-n*A-o*T)*P,t[10]=(f*w-m*x+_*y)*P,t[11]=(h*x-u*w-p*y)*P,t[12]=(a*S-s*k-l*T)*P,t[13]=(n*k-i*S+r*T)*P,t[14]=(m*v-f*b-g*y)*P,t[15]=(u*b-h*v+d*y)*P,t):null},t.isMapAuthenticated=function(t){return dt.has(t)},t.isMapboxURL=Q,t.latFromMercatorY=Mh,t.len=ka,t.length=_a,t.length$1=function(t){return Math.hypot(t[0],t[1],t[2],t[3])},t.loadVectorTile=bd,t.makeRequest=Tt,t.mercatorXfromLng=Ah,t.mercatorYfromLat=Ih,t.mercatorZfromAltitude=Ph,t.mul=function(t,e,n){return t[0]=e[0]*n[0],t[1]=e[1]*n[1],t[2]=e[2]*n[2],t[3]=e[3]*n[3],t},t.mul$1=ma,t.mul$2=Ea,t.multiply=fa,t.multiply$1=xa,t.nextPowerOfTwo=C,t.normalize=wa,t.normalize$1=function(t,e){var n=e[0],i=e[1],r=e[2],o=e[3],s=n*n+i*i+r*r+o*o;return s>0&&(s=1/Math.sqrt(s)),t[0]=n*s,t[1]=i*s,t[2]=r*s,t[3]=o*s,t},t.number=nn,t.ortho=function(t,e,n,i,r,o,s){var a=1/(e-n),l=1/(i-r),c=1/(o-s);return t[0]=-2*a,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*l,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*c,t[11]=0,t[12]=(e+n)*a,t[13]=(r+i)*l,t[14]=(s+o)*c,t[15]=1,t},t.pbf=kc,t.perspective=function(t,e,n,i,r){var o,s=1/Math.tan(e/2);return t[0]=s/n,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=s,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,null!=r&&r!==1/0?(t[10]=(r+i)*(o=1/(i-r)),t[14]=2*r*i*o):(t[10]=-1,t[14]=-2*i),t},t.pick=function(t,e){const n={};for(let i=0;i<e.length;i++){const r=e[i];r in t&&(n[r]=t[r])}return n},t.plugin=io,t.pointGeometry=r,t.polygonIntersectsBox=ia,t.polygonIntersectsPolygon=Hs,t.polygonizeBounds=function(t,e,n=0,i=!0){const o=new r(n,n),s=t.sub(o),a=e.add(o),l=[s,new r(a.x,s.y),a,new r(s.x,a.y)];return i&&l.push(s),l},t.posAttributes=Zh,t.postMapLoadEvent=ct,t.postTurnstileEvent=at,t.potpack=Kc,t.prevPowerOfTwo=function(t){return t<=1?1:Math.pow(2,Math.floor(Math.log(t)/Math.LN2))},t.radToDeg=function(t){return t*c},t.refProperties=["type","source","source-layer","minzoom","maxzoom","filter","layout"],t.registerForPluginStateChange=function(t){return t({pluginStatus:Kr,pluginURL:Yr}),to.on("pluginStateChange",t),t},t.removeAuthState=function(t){dt.delete(t)},t.renderColorRamp=qa,t.rotateX=function(t,e,n){var i=Math.sin(n),r=Math.cos(n),o=e[4],s=e[5],a=e[6],l=e[7],c=e[8],u=e[9],h=e[10],d=e[11];return e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=o*r+c*i,t[5]=s*r+u*i,t[6]=a*r+h*i,t[7]=l*r+d*i,t[8]=c*r-o*i,t[9]=u*r-s*i,t[10]=h*r-a*i,t[11]=d*r-l*i,t},t.rotateX$1=Ma,t.rotateY=function(t,e,n){var i=Math.sin(n),r=Math.cos(n),o=e[0],s=e[1],a=e[2],l=e[3],c=e[8],u=e[9],h=e[10],d=e[11];return e!==t&&(t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=o*r-c*i,t[1]=s*r-u*i,t[2]=a*r-h*i,t[3]=l*r-d*i,t[8]=o*i+c*r,t[9]=s*i+u*r,t[10]=a*i+h*r,t[11]=l*i+d*r,t},t.rotateZ=function(t,e,n){var i=Math.sin(n),r=Math.cos(n),o=e[0],s=e[1],a=e[2],l=e[3],c=e[4],u=e[5],h=e[6],d=e[7];return e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=o*r+c*i,t[1]=s*r+u*i,t[2]=a*r+h*i,t[3]=l*r+d*i,t[4]=c*r-o*i,t[5]=u*r-s*i,t[6]=h*r-a*i,t[7]=d*r-l*i,t},t.rotateZ$1=function(t,e,n){n*=.5;var i=e[0],r=e[1],o=e[2],s=e[3],a=Math.sin(n),l=Math.cos(n);return t[0]=i*l+r*a,t[1]=r*l-i*a,t[2]=o*l+s*a,t[3]=s*l-o*a,t},t.scale=function(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t},t.scale$1=function(t,e,n){var i=n[0],r=n[1],o=n[2];return t[0]=e[0]*i,t[1]=e[1]*i,t[2]=e[2]*i,t[3]=e[3]*i,t[4]=e[4]*r,t[5]=e[5]*r,t[6]=e[6]*r,t[7]=e[7]*r,t[8]=e[8]*o,t[9]=e[9]*o,t[10]=e[10]*o,t[11]=e[11]*o,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},t.scale$2=function(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t},t.scaleAndAdd=ba,t.setCacheLimits=function(t,e){gt=t,_t=e},t.setRTLTextPlugin=function(t,e,n=!1){if(Kr===Zr||Kr===Hr||Kr===Wr)throw new Error("setRTLTextPlugin cannot be called multiple times.");Yr=j.resolveURL(t),Kr=Zr,Xr=e,Qr(),n||no()},t.smoothstep=function(t,e,n){return(n=m((n-t)/(e-t),0,1))*n*(3-2*n)},t.spec=Bt,t.storeAuthState=function(t,e){e?dt.add(t):dt.delete(t)},t.sub=Sa,t.subtract=va,t.symbolSize=wc,t.transformMat3=function(t,e,n){var i=e[0],r=e[1],o=e[2];return t[0]=i*n[0]+r*n[3]+o*n[6],t[1]=i*n[1]+r*n[4]+o*n[7],t[2]=i*n[2]+r*n[5]+o*n[8],t},t.transformMat4=Aa,t.transformMat4$1=function(t,e,n){var i=e[0],r=e[1],o=e[2],s=n[3]*i+n[7]*r+n[11]*o+n[15];return t[0]=(n[0]*i+n[4]*r+n[8]*o+n[12])/(s=s||1),t[1]=(n[1]*i+n[5]*r+n[9]*o+n[13])/s,t[2]=(n[2]*i+n[6]*r+n[10]*o+n[14])/s,t},t.transformQuat=Ca,t.translate=function(t,e,n){var i,r,o,s,a,l,c,u,h,d,p,f,m=n[0],g=n[1],_=n[2];return e===t?(t[12]=e[0]*m+e[4]*g+e[8]*_+e[12],t[13]=e[1]*m+e[5]*g+e[9]*_+e[13],t[14]=e[2]*m+e[6]*g+e[10]*_+e[14],t[15]=e[3]*m+e[7]*g+e[11]*_+e[15]):(r=e[1],o=e[2],s=e[3],a=e[4],l=e[5],c=e[6],u=e[7],h=e[8],d=e[9],p=e[10],f=e[11],t[0]=i=e[0],t[1]=r,t[2]=o,t[3]=s,t[4]=a,t[5]=l,t[6]=c,t[7]=u,t[8]=h,t[9]=d,t[10]=p,t[11]=f,t[12]=i*m+a*g+h*_+e[12],t[13]=r*m+l*g+d*_+e[13],t[14]=o*m+c*g+p*_+e[14],t[15]=s*m+u*g+f*_+e[15]),t},t.triggerPluginCompletionEvent=Jr,t.uniqueId=b,t.validateCustomStyleLayer=function(t){const e=[],n=t.id;return void 0===n&&e.push({message:`layers.${n}: missing required property "id"`}),void 0===t.render&&e.push({message:`layers.${n}: missing required method "render"`}),t.renderingMode&&"2d"!==t.renderingMode&&"3d"!==t.renderingMode&&e.push({message:`layers.${n}: property "renderingMode" must be either "2d" or "3d"`}),e},t.validateFog=Ki,t.validateLight=Xi,t.validateStyle=Wi,t.values=y,t.vectorTile=ql,t.version=e,t.warnOnce=M,t.window=s,t.wrap=g}),i(0,function(t){function e(t){const n=typeof t;if("number"===n||"boolean"===n||"string"===n||null==t)return JSON.stringify(t);if(Array.isArray(t)){let n="[";for(const i of t)n+=e(i)+",";return n+"]"}const i=Object.keys(t).sort();let r="{";for(let o=0;o<i.length;o++)r+=`${JSON.stringify(i[o])}:${e(t[i[o]])},`;return r+"}"}function n(n){let i="";for(const r of t.refProperties)i+="/"+e(n[r]);return i}class i{constructor(t){this.keyCache={},t&&this.replace(t)}replace(t){this._layerConfigs={},this._layers={},this.update(t,[])}update(e,i){for(const n of e){this._layerConfigs[n.id]=n;const e=this._layers[n.id]=t.createStyleLayer(n);e._featureFilter=t.createFilter(e.filter),this.keyCache[n.id]&&delete this.keyCache[n.id]}for(const t of i)delete this.keyCache[t],delete this._layerConfigs[t],delete this._layers[t];this.familiesBySource={};const r=function(t,e){const i={};for(let o=0;o<t.length;o++){const r=e&&e[t[o].id]||n(t[o]);e&&(e[t[o].id]=r);let s=i[r];s||(s=i[r]=[]),s.push(t[o])}const r=[];for(const n in i)r.push(i[n]);return r}(t.values(this._layerConfigs),this.keyCache);for(const t of r){const e=t.map(t=>this._layers[t.id]),n=e[0];if("none"===n.visibility)continue;const i=n.source||"";let r=this.familiesBySource[i];r||(r=this.familiesBySource[i]={});const o=n.sourceLayer||"_geojsonTileLayer";let s=r[o];s||(s=r[o]=[]),s.push(e)}}}const{ImageBitmap:r}=t.window;class o{loadTile(e,n){const{uid:i,encoding:o,rawImageData:s,padding:a,buildQuadTree:l}=e,c=r&&s instanceof r?this.getImageData(s,a):s;n(null,new t.DEMData(i,c,o,a<1,l))}getImageData(e,n){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(e.width,e.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d")),this.offscreenCanvas.width=e.width,this.offscreenCanvas.height=e.height,this.offscreenCanvasContext.drawImage(e,0,0,e.width,e.height);const i=this.offscreenCanvasContext.getImageData(-n,-n,e.width+2*n,e.height+2*n);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),new t.RGBAImage({width:i.width,height:i.height},i.data)}}var s=function t(e,n){var i,r=e&&e.type;if("FeatureCollection"===r)for(i=0;i<e.features.length;i++)t(e.features[i],n);else if("GeometryCollection"===r)for(i=0;i<e.geometries.length;i++)t(e.geometries[i],n);else if("Feature"===r)t(e.geometry,n);else if("Polygon"===r)a(e.coordinates,n);else if("MultiPolygon"===r)for(i=0;i<e.coordinates.length;i++)a(e.coordinates[i],n);return e};function a(t,e){if(0!==t.length){l(t[0],e);for(var n=1;n<t.length;n++)l(t[n],!e)}}function l(t,e){for(var n=0,i=0,r=t.length,o=r-1;i<r;o=i++)n+=(t[i][0]-t[o][0])*(t[o][1]+t[i][1]);n>=0!=!!e&&t.reverse()}const c=t.vectorTile.VectorTileFeature.prototype.toGeoJSON;class u{constructor(e){this._feature=e,this.extent=t.EXTENT,this.type=e.type,this.properties=e.tags,"id"in e&&!isNaN(e.id)&&(this.id=parseInt(e.id,10))}loadGeometry(){if(1===this._feature.type){const e=[];for(const n of this._feature.geometry)e.push([new t.pointGeometry(n[0],n[1])]);return e}{const e=[];for(const n of this._feature.geometry){const i=[];for(const e of n)i.push(new t.pointGeometry(e[0],e[1]));e.push(i)}return e}}toGeoJSON(t,e,n){return c.call(this,t,e,n)}}class h{constructor(e){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=t.EXTENT,this.length=e.length,this._features=e}feature(t){return new u(this._features[t])}}var d=t.vectorTile.VectorTileFeature,p=f;function f(t,e){this.options=e||{},this.features=t,this.length=t.length}function m(t,e){this.id="number"==typeof t.id?t.id:void 0,this.type=t.type,this.rawGeometry=1===t.type?[t.geometry]:t.geometry,this.properties=t.tags,this.extent=e||4096}f.prototype.feature=function(t){return new m(this.features[t],this.options.extent)},m.prototype.loadGeometry=function(){var e=this.rawGeometry;this.geometry=[];for(var n=0;n<e.length;n++){for(var i=e[n],r=[],o=0;o<i.length;o++)r.push(new t.pointGeometry(i[o][0],i[o][1]));this.geometry.push(r)}return this.geometry},m.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var t=this.geometry,e=1/0,n=-1/0,i=1/0,r=-1/0,o=0;o<t.length;o++)for(var s=t[o],a=0;a<s.length;a++){var l=s[a];e=Math.min(e,l.x),n=Math.max(n,l.x),i=Math.min(i,l.y),r=Math.max(r,l.y)}return[e,i,n,r]},m.prototype.toGeoJSON=d.prototype.toGeoJSON;var g=y,_=p;function y(e){var n=new t.pbf;return function(t,e){for(var n in t.layers)e.writeMessage(3,v,t.layers[n])}(e,n),n.finish()}function v(t,e){var n;e.writeVarintField(15,t.version||1),e.writeStringField(1,t.name||""),e.writeVarintField(5,t.extent||4096);var i={keys:[],values:[],keycache:{},valuecache:{}};for(n=0;n<t.length;n++)i.feature=t.feature(n),e.writeMessage(2,x,i);var r=i.keys;for(n=0;n<r.length;n++)e.writeStringField(3,r[n]);var o=i.values;for(n=0;n<o.length;n++)e.writeMessage(4,S,o[n])}function x(t,e){var n=t.feature;void 0!==n.id&&e.writeVarintField(1,n.id),e.writeMessage(2,b,t),e.writeVarintField(3,n.type),e.writeMessage(4,T,n)}function b(t,e){var n=t.feature,i=t.keys,r=t.values,o=t.keycache,s=t.valuecache;for(var a in n.properties){var l=o[a];void 0===l&&(i.push(a),o[a]=l=i.length-1),e.writeVarint(l);var c=n.properties[a],u=typeof c;"string"!==u&&"boolean"!==u&&"number"!==u&&(c=JSON.stringify(c));var h=u+":"+c,d=s[h];void 0===d&&(r.push(c),s[h]=d=r.length-1),e.writeVarint(d)}}function w(t,e){return(e<<3)+(7&t)}function C(t){return t<<1^t>>31}function T(t,e){for(var n=t.loadGeometry(),i=t.type,r=0,o=0,s=n.length,a=0;a<s;a++){var l=n[a],c=1;1===i&&(c=l.length),e.writeVarint(w(1,c));for(var u=3===i?l.length-1:l.length,h=0;h<u;h++){1===h&&1!==i&&e.writeVarint(w(2,u-1));var d=l[h].x-r,p=l[h].y-o;e.writeVarint(C(d)),e.writeVarint(C(p)),r+=d,o+=p}3===i&&e.writeVarint(w(7,1))}}function S(t,e){var n=typeof t;"string"===n?e.writeStringField(1,t):"boolean"===n?e.writeBooleanField(7,t):"number"===n&&(t%1!=0?e.writeDoubleField(3,t):t<0?e.writeSVarintField(6,t):e.writeVarintField(5,t))}function E(t,e,n,i,r,o){if(r-i<=n)return;const s=i+r>>1;k(t,e,s,i,r,o%2),E(t,e,n,i,s-1,o+1),E(t,e,n,s+1,r,o+1)}function k(t,e,n,i,r,o){for(;r>i;){if(r-i>600){const s=r-i+1,a=n-i+1,l=Math.log(s),c=.5*Math.exp(2*l/3),u=.5*Math.sqrt(l*c*(s-c)/s)*(a-s/2<0?-1:1);k(t,e,n,Math.max(i,Math.floor(n-a*c/s+u)),Math.min(r,Math.floor(n+(s-a)*c/s+u)),o)}const s=e[2*n+o];let a=i,l=r;for(A(t,e,i,n),e[2*r+o]>s&&A(t,e,i,r);a<l;){for(A(t,e,a,l),a++,l--;e[2*a+o]<s;)a++;for(;e[2*l+o]>s;)l--}e[2*i+o]===s?A(t,e,i,l):(l++,A(t,e,l,r)),l<=n&&(i=l+1),n<=l&&(r=l-1)}}function A(t,e,n,i){I(t,n,i),I(e,2*n,2*i),I(e,2*n+1,2*i+1)}function I(t,e,n){const i=t[e];t[e]=t[n],t[n]=i}function P(t,e,n,i){const r=t-n,o=e-i;return r*r+o*o}g.fromVectorTileJs=y,g.fromGeojsonVt=function(t,e){e=e||{};var n={};for(var i in t)n[i]=new p(t[i].features,e),n[i].name=i,n[i].version=e.version,n[i].extent=e.extent;return y({layers:n})},g.GeoJSONWrapper=_;const M=t=>t[0],O=t=>t[1];class z{constructor(t,e=M,n=O,i=64,r=Float64Array){this.nodeSize=i,this.points=t;const o=t.length<65536?Uint16Array:Uint32Array,s=this.ids=new o(t.length),a=this.coords=new r(2*t.length);for(let l=0;l<t.length;l++)s[l]=l,a[2*l]=e(t[l]),a[2*l+1]=n(t[l]);E(s,a,i,0,s.length-1,0)}range(t,e,n,i){return function(t,e,n,i,r,o,s){const a=[0,t.length-1,0],l=[];let c,u;for(;a.length;){const h=a.pop(),d=a.pop(),p=a.pop();if(d-p<=s){for(let s=p;s<=d;s++)c=e[2*s],u=e[2*s+1],c>=n&&c<=r&&u>=i&&u<=o&&l.push(t[s]);continue}const f=Math.floor((p+d)/2);c=e[2*f],u=e[2*f+1],c>=n&&c<=r&&u>=i&&u<=o&&l.push(t[f]);const m=(h+1)%2;(0===h?n<=c:i<=u)&&(a.push(p),a.push(f-1),a.push(m)),(0===h?r>=c:o>=u)&&(a.push(f+1),a.push(d),a.push(m))}return l}(this.ids,this.coords,t,e,n,i,this.nodeSize)}within(t,e,n){return function(t,e,n,i,r,o){const s=[0,t.length-1,0],a=[],l=r*r;for(;s.length;){const c=s.pop(),u=s.pop(),h=s.pop();if(u-h<=o){for(let r=h;r<=u;r++)P(e[2*r],e[2*r+1],n,i)<=l&&a.push(t[r]);continue}const d=Math.floor((h+u)/2),p=e[2*d],f=e[2*d+1];P(p,f,n,i)<=l&&a.push(t[d]);const m=(c+1)%2;(0===c?n-r<=p:i-r<=f)&&(s.push(h),s.push(d-1),s.push(m)),(0===c?n+r>=p:i+r>=f)&&(s.push(d+1),s.push(u),s.push(m))}return a}(this.ids,this.coords,t,e,n,this.nodeSize)}}const D={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:t=>t},L=Math.fround||(R=new Float32Array(1),t=>(R[0]=+t,R[0]));var R;class F{constructor(t){this.options=G(Object.create(D),t),this.trees=new Array(this.options.maxZoom+1)}load(t){const{log:e,minZoom:n,maxZoom:i,nodeSize:r}=this.options;e&&console.time("total time");const o=`prepare ${t.length} points`;e&&console.time(o),this.points=t;let s=[];for(let a=0;a<t.length;a++)t[a].geometry&&s.push(V(t[a],a));this.trees[i+1]=new z(s,Z,H,r,Float32Array),e&&console.timeEnd(o);for(let a=i;a>=n;a--){const t=+Date.now();s=this._cluster(s,a),this.trees[a]=new z(s,Z,H,r,Float32Array),e&&console.log("z%d: %d clusters in %dms",a,s.length,+Date.now()-t)}return e&&console.timeEnd("total time"),this}getClusters(t,e){let n=((t[0]+180)%360+360)%360-180;const i=Math.max(-90,Math.min(90,t[1]));let r=180===t[2]?180:((t[2]+180)%360+360)%360-180;const o=Math.max(-90,Math.min(90,t[3]));if(t[2]-t[0]>=360)n=-180,r=180;else if(n>r){const t=this.getClusters([n,i,180,o],e),s=this.getClusters([-180,i,r,o],e);return t.concat(s)}const s=this.trees[this._limitZoom(e)],a=s.range(j(n),q(o),j(r),q(i)),l=[];for(const c of a){const t=s.points[c];l.push(t.numPoints?U(t):this.points[t.index])}return l}getChildren(t){const e=this._getOriginId(t),n=this._getOriginZoom(t),i="No cluster with the specified id.",r=this.trees[n];if(!r)throw new Error(i);const o=r.points[e];if(!o)throw new Error(i);const s=this.options.radius/(this.options.extent*Math.pow(2,n-1)),a=r.within(o.x,o.y,s),l=[];for(const c of a){const e=r.points[c];e.parentId===t&&l.push(e.numPoints?U(e):this.points[e.index])}if(0===l.length)throw new Error(i);return l}getLeaves(t,e,n){const i=[];return this._appendLeaves(i,t,e=e||10,n=n||0,0),i}getTile(t,e,n){const i=this.trees[this._limitZoom(t)],r=Math.pow(2,t),{extent:o,radius:s}=this.options,a=s/o,l=(n-a)/r,c=(n+1+a)/r,u={features:[]};return this._addTileFeatures(i.range((e-a)/r,l,(e+1+a)/r,c),i.points,e,n,r,u),0===e&&this._addTileFeatures(i.range(1-a/r,l,1,c),i.points,r,n,r,u),e===r-1&&this._addTileFeatures(i.range(0,l,a/r,c),i.points,-1,n,r,u),u.features.length?u:null}getClusterExpansionZoom(t){let e=this._getOriginZoom(t)-1;for(;e<=this.options.maxZoom;){const n=this.getChildren(t);if(e++,1!==n.length)break;t=n[0].properties.cluster_id}return e}_appendLeaves(t,e,n,i,r){const o=this.getChildren(e);for(const s of o){const e=s.properties;if(e&&e.cluster?r+e.point_count<=i?r+=e.point_count:r=this._appendLeaves(t,e.cluster_id,n,i,r):r<i?r++:t.push(s),t.length===n)break}return r}_addTileFeatures(t,e,n,i,r,o){for(const s of t){const t=e[s],a=t.numPoints;let l,c,u;if(a)l=N(t),c=t.x,u=t.y;else{const e=this.points[t.index];l=e.properties,c=j(e.geometry.coordinates[0]),u=q(e.geometry.coordinates[1])}const h={type:1,geometry:[[Math.round(this.options.extent*(c*r-n)),Math.round(this.options.extent*(u*r-i))]],tags:l};let d;a?d=t.id:this.options.generateId?d=t.index:this.points[t.index].id&&(d=this.points[t.index].id),void 0!==d&&(h.id=d),o.features.push(h)}}_limitZoom(t){return Math.max(this.options.minZoom,Math.min(+t,this.options.maxZoom+1))}_cluster(t,e){const n=[],{radius:i,extent:r,reduce:o,minPoints:s}=this.options,a=i/(r*Math.pow(2,e));for(let l=0;l<t.length;l++){const i=t[l];if(i.zoom<=e)continue;i.zoom=e;const r=this.trees[e+1],c=r.within(i.x,i.y,a),u=i.numPoints||1;let h=u;for(const t of c){const n=r.points[t];n.zoom>e&&(h+=n.numPoints||1)}if(h>=s){let t=i.x*u,s=i.y*u,a=o&&u>1?this._map(i,!0):null;const d=(l<<5)+(e+1)+this.points.length;for(const n of c){const l=r.points[n];if(l.zoom<=e)continue;l.zoom=e;const c=l.numPoints||1;t+=l.x*c,s+=l.y*c,l.parentId=d,o&&(a||(a=this._map(i,!0)),o(a,this._map(l)))}i.parentId=d,n.push(B(t/h,s/h,d,h,a))}else if(n.push(i),h>1)for(const t of c){const i=r.points[t];i.zoom<=e||(i.zoom=e,n.push(i))}}return n}_getOriginId(t){return t-this.points.length>>5}_getOriginZoom(t){return(t-this.points.length)%32}_map(t,e){if(t.numPoints)return e?G({},t.properties):t.properties;const n=this.points[t.index].properties,i=this.options.map(n);return e&&i===n?G({},i):i}}function B(t,e,n,i,r){return{x:L(t),y:L(e),zoom:1/0,id:n,parentId:-1,numPoints:i,properties:r}}function V(t,e){const[n,i]=t.geometry.coordinates;return{x:L(j(n)),y:L(q(i)),zoom:1/0,index:e,parentId:-1}}function U(t){return{type:"Feature",id:t.id,properties:N(t),geometry:{type:"Point",coordinates:[(e=t.x,360*(e-.5)),$(t.y)]}};var e}function N(t){const e=t.numPoints,n=e>=1e4?Math.round(e/1e3)+"k":e>=1e3?Math.round(e/100)/10+"k":e;return G(G({},t.properties),{cluster:!0,cluster_id:t.id,point_count:e,point_count_abbreviated:n})}function j(t){return t/360+.5}function q(t){const e=Math.sin(t*Math.PI/180),n=.5-.25*Math.log((1+e)/(1-e))/Math.PI;return n<0?0:n>1?1:n}function $(t){const e=(180-360*t)*Math.PI/180;return 360*Math.atan(Math.exp(e))/Math.PI-90}function G(t,e){for(const n in e)t[n]=e[n];return t}function Z(t){return t.x}function H(t){return t.y}function W(t,e,n,i){for(var r,o=i,s=n-e>>1,a=n-e,l=t[e],c=t[e+1],u=t[n],h=t[n+1],d=e+3;d<n;d+=3){var p=X(t[d],t[d+1],l,c,u,h);if(p>o)r=d,o=p;else if(p===o){var f=Math.abs(d-s);f<a&&(r=d,a=f)}}o>i&&(r-e>3&&W(t,e,r,i),t[r+2]=o,n-r>3&&W(t,r,n,i))}function X(t,e,n,i,r,o){var s=r-n,a=o-i;if(0!==s||0!==a){var l=((t-n)*s+(e-i)*a)/(s*s+a*a);l>1?(n=r,i=o):l>0&&(n+=s*l,i+=a*l)}return(s=t-n)*s+(a=e-i)*a}function K(t,e,n,i){var r={id:void 0===t?null:t,type:e,geometry:n,tags:i,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(t){var e=t.geometry,n=t.type;if("Point"===n||"MultiPoint"===n||"LineString"===n)Y(t,e);else if("Polygon"===n||"MultiLineString"===n)for(var i=0;i<e.length;i++)Y(t,e[i]);else if("MultiPolygon"===n)for(i=0;i<e.length;i++)for(var r=0;r<e[i].length;r++)Y(t,e[i][r])}(r),r}function Y(t,e){for(var n=0;n<e.length;n+=3)t.minX=Math.min(t.minX,e[n]),t.minY=Math.min(t.minY,e[n+1]),t.maxX=Math.max(t.maxX,e[n]),t.maxY=Math.max(t.maxY,e[n+1])}function J(t,e,n,i){if(e.geometry){var r=e.geometry.coordinates,o=e.geometry.type,s=Math.pow(n.tolerance/((1<<n.maxZoom)*n.extent),2),a=[],l=e.id;if(n.promoteId?l=e.properties[n.promoteId]:n.generateId&&(l=i||0),"Point"===o)Q(r,a);else if("MultiPoint"===o)for(var c=0;c<r.length;c++)Q(r[c],a);else if("LineString"===o)tt(r,a,s,!1);else if("MultiLineString"===o){if(n.lineMetrics){for(c=0;c<r.length;c++)tt(r[c],a=[],s,!1),t.push(K(l,"LineString",a,e.properties));return}et(r,a,s,!1)}else if("Polygon"===o)et(r,a,s,!0);else{if("MultiPolygon"!==o){if("GeometryCollection"===o){for(c=0;c<e.geometry.geometries.length;c++)J(t,{id:l,geometry:e.geometry.geometries[c],properties:e.properties},n,i);return}throw new Error("Input data is not a valid GeoJSON object.")}for(c=0;c<r.length;c++){var u=[];et(r[c],u,s,!0),a.push(u)}}t.push(K(l,o,a,e.properties))}}function Q(t,e){e.push(nt(t[0])),e.push(it(t[1])),e.push(0)}function tt(t,e,n,i){for(var r,o,s=0,a=0;a<t.length;a++){var l=nt(t[a][0]),c=it(t[a][1]);e.push(l),e.push(c),e.push(0),a>0&&(s+=i?(r*c-l*o)/2:Math.sqrt(Math.pow(l-r,2)+Math.pow(c-o,2))),r=l,o=c}var u=e.length-3;e[2]=1,W(e,0,u,n),e[u+2]=1,e.size=Math.abs(s),e.start=0,e.end=e.size}function et(t,e,n,i){for(var r=0;r<t.length;r++){var o=[];tt(t[r],o,n,i),e.push(o)}}function nt(t){return t/360+.5}function it(t){var e=Math.sin(t*Math.PI/180),n=.5-.25*Math.log((1+e)/(1-e))/Math.PI;return n<0?0:n>1?1:n}function rt(t,e,n,i,r,o,s,a){if(i/=e,o>=(n/=e)&&s<i)return t;if(s<n||o>=i)return null;for(var l=[],c=0;c<t.length;c++){var u=t[c],h=u.geometry,d=u.type,p=0===r?u.minX:u.minY,f=0===r?u.maxX:u.maxY;if(p>=n&&f<i)l.push(u);else if(!(f<n||p>=i)){var m=[];if("Point"===d||"MultiPoint"===d)ot(h,m,n,i,r);else if("LineString"===d)st(h,m,n,i,r,!1,a.lineMetrics);else if("MultiLineString"===d)lt(h,m,n,i,r,!1);else if("Polygon"===d)lt(h,m,n,i,r,!0);else if("MultiPolygon"===d)for(var g=0;g<h.length;g++){var _=[];lt(h[g],_,n,i,r,!0),_.length&&m.push(_)}if(m.length){if(a.lineMetrics&&"LineString"===d){for(g=0;g<m.length;g++)l.push(K(u.id,d,m[g],u.tags));continue}"LineString"!==d&&"MultiLineString"!==d||(1===m.length?(d="LineString",m=m[0]):d="MultiLineString"),"Point"!==d&&"MultiPoint"!==d||(d=3===m.length?"Point":"MultiPoint"),l.push(K(u.id,d,m,u.tags))}}}return l.length?l:null}function ot(t,e,n,i,r){for(var o=0;o<t.length;o+=3){var s=t[o+r];s>=n&&s<=i&&(e.push(t[o]),e.push(t[o+1]),e.push(t[o+2]))}}function st(t,e,n,i,r,o,s){for(var a,l,c=at(t),u=0===r?ut:ht,h=t.start,d=0;d<t.length-3;d+=3){var p=t[d],f=t[d+1],m=t[d+2],g=t[d+3],_=t[d+4],y=0===r?p:f,v=0===r?g:_,x=!1;s&&(a=Math.sqrt(Math.pow(p-g,2)+Math.pow(f-_,2))),y<n?v>n&&(l=u(c,p,f,g,_,n),s&&(c.start=h+a*l)):y>i?v<i&&(l=u(c,p,f,g,_,i),s&&(c.start=h+a*l)):ct(c,p,f,m),v<n&&y>=n&&(l=u(c,p,f,g,_,n),x=!0),v>i&&y<=i&&(l=u(c,p,f,g,_,i),x=!0),!o&&x&&(s&&(c.end=h+a*l),e.push(c),c=at(t)),s&&(h+=a)}var b=t.length-3;p=t[b],f=t[b+1],m=t[b+2],(y=0===r?p:f)>=n&&y<=i&&ct(c,p,f,m),b=c.length-3,o&&b>=3&&(c[b]!==c[0]||c[b+1]!==c[1])&&ct(c,c[0],c[1],c[2]),c.length&&e.push(c)}function at(t){var e=[];return e.size=t.size,e.start=t.start,e.end=t.end,e}function lt(t,e,n,i,r,o){for(var s=0;s<t.length;s++)st(t[s],e,n,i,r,o,!1)}function ct(t,e,n,i){t.push(e),t.push(n),t.push(i)}function ut(t,e,n,i,r,o){var s=(o-e)/(i-e);return t.push(o),t.push(n+(r-n)*s),t.push(1),s}function ht(t,e,n,i,r,o){var s=(o-n)/(r-n);return t.push(e+(i-e)*s),t.push(o),t.push(1),s}function dt(t,e){for(var n=[],i=0;i<t.length;i++){var r,o=t[i],s=o.type;if("Point"===s||"MultiPoint"===s||"LineString"===s)r=pt(o.geometry,e);else if("MultiLineString"===s||"Polygon"===s){r=[];for(var a=0;a<o.geometry.length;a++)r.push(pt(o.geometry[a],e))}else if("MultiPolygon"===s)for(r=[],a=0;a<o.geometry.length;a++){for(var l=[],c=0;c<o.geometry[a].length;c++)l.push(pt(o.geometry[a][c],e));r.push(l)}n.push(K(o.id,s,r,o.tags))}return n}function pt(t,e){var n=[];n.size=t.size,void 0!==t.start&&(n.start=t.start,n.end=t.end);for(var i=0;i<t.length;i+=3)n.push(t[i]+e,t[i+1],t[i+2]);return n}function ft(t,e){if(t.transformed)return t;var n,i,r,o=1<<t.z,s=t.x,a=t.y;for(n=0;n<t.features.length;n++){var l=t.features[n],c=l.geometry,u=l.type;if(l.geometry=[],1===u)for(i=0;i<c.length;i+=2)l.geometry.push(mt(c[i],c[i+1],e,o,s,a));else for(i=0;i<c.length;i++){var h=[];for(r=0;r<c[i].length;r+=2)h.push(mt(c[i][r],c[i][r+1],e,o,s,a));l.geometry.push(h)}}return t.transformed=!0,t}function mt(t,e,n,i,r,o){return[Math.round(n*(t*i-r)),Math.round(n*(e*i-o))]}function gt(t,e,n,i,r){for(var o=e===r.maxZoom?0:r.tolerance/((1<<e)*r.extent),s={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:n,y:i,z:e,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},a=0;a<t.length;a++){s.numFeatures++,_t(s,t[a],o,r);var l=t[a].minX,c=t[a].minY,u=t[a].maxX,h=t[a].maxY;l<s.minX&&(s.minX=l),c<s.minY&&(s.minY=c),u>s.maxX&&(s.maxX=u),h>s.maxY&&(s.maxY=h)}return s}function _t(t,e,n,i){var r=e.geometry,o=e.type,s=[];if("Point"===o||"MultiPoint"===o)for(var a=0;a<r.length;a+=3)s.push(r[a]),s.push(r[a+1]),t.numPoints++,t.numSimplified++;else if("LineString"===o)yt(s,r,t,n,!1,!1);else if("MultiLineString"===o||"Polygon"===o)for(a=0;a<r.length;a++)yt(s,r[a],t,n,"Polygon"===o,0===a);else if("MultiPolygon"===o)for(var l=0;l<r.length;l++){var c=r[l];for(a=0;a<c.length;a++)yt(s,c[a],t,n,!0,0===a)}if(s.length){var u=e.tags||null;if("LineString"===o&&i.lineMetrics){for(var h in u={},e.tags)u[h]=e.tags[h];u.mapbox_clip_start=r.start/r.size,u.mapbox_clip_end=r.end/r.size}var d={geometry:s,type:"Polygon"===o||"MultiPolygon"===o?3:"LineString"===o||"MultiLineString"===o?2:1,tags:u};null!==e.id&&(d.id=e.id),t.features.push(d)}}function yt(t,e,n,i,r,o){var s=i*i;if(i>0&&e.size<(r?s:i))n.numPoints+=e.length/3;else{for(var a=[],l=0;l<e.length;l+=3)(0===i||e[l+2]>s)&&(n.numSimplified++,a.push(e[l]),a.push(e[l+1])),n.numPoints++;r&&function(t,e){for(var n=0,i=0,r=t.length,o=r-2;i<r;o=i,i+=2)n+=(t[i]-t[o])*(t[i+1]+t[o+1]);if(n>0===e)for(i=0,r=t.length;i<r/2;i+=2){var s=t[i],a=t[i+1];t[i]=t[r-2-i],t[i+1]=t[r-1-i],t[r-2-i]=s,t[r-1-i]=a}}(a,o),t.push(a)}}function vt(t,e){var n=(e=this.options=function(t,e){for(var n in e)t[n]=e[n];return t}(Object.create(this.options),e)).debug;if(n&&console.time("preprocess data"),e.maxZoom<0||e.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(e.promoteId&&e.generateId)throw new Error("promoteId and generateId cannot be used together.");var i=function(t,e){var n=[];if("FeatureCollection"===t.type)for(var i=0;i<t.features.length;i++)J(n,t.features[i],e,i);else J(n,"Feature"===t.type?t:{geometry:t},e);return n}(t,e);this.tiles={},this.tileCoords=[],n&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",e.indexMaxZoom,e.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),(i=function(t,e){var n=e.buffer/e.extent,i=t,r=rt(t,1,-1-n,n,0,-1,2,e),o=rt(t,1,1-n,2+n,0,-1,2,e);return(r||o)&&(i=rt(t,1,-n,1+n,0,-1,2,e)||[],r&&(i=dt(r,1).concat(i)),o&&(i=i.concat(dt(o,-1)))),i}(i,e)).length&&this.splitTile(i,0,0,0),n&&(i.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function xt(t,e,n){return 32*((1<<t)*n+e)+t}function bt(t,e){const n=t.tileID.canonical;if(!this._geoJSONIndex)return e(null,null);const i=this._geoJSONIndex.getTile(n.z,n.x,n.y);if(!i)return e(null,null);const r=new h(i.features);let o=g(r);0===o.byteOffset&&o.byteLength===o.buffer.byteLength||(o=new Uint8Array(o)),e(null,{vectorTile:r,rawData:o.buffer})}vt.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},vt.prototype.splitTile=function(t,e,n,i,r,o,s){for(var a=[t,e,n,i],l=this.options,c=l.debug;a.length;){i=a.pop(),n=a.pop(),e=a.pop(),t=a.pop();var u=1<<e,h=xt(e,n,i),d=this.tiles[h];if(!d&&(c>1&&console.time("creation"),d=this.tiles[h]=gt(t,e,n,i,l),this.tileCoords.push({z:e,x:n,y:i}),c)){c>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",e,n,i,d.numFeatures,d.numPoints,d.numSimplified),console.timeEnd("creation"));var p="z"+e;this.stats[p]=(this.stats[p]||0)+1,this.total++}if(d.source=t,r){if(e===l.maxZoom||e===r)continue;var f=1<<r-e;if(n!==Math.floor(o/f)||i!==Math.floor(s/f))continue}else if(e===l.indexMaxZoom||d.numPoints<=l.indexMaxPoints)continue;if(d.source=null,0!==t.length){c>1&&console.time("clipping");var m,g,_,y,v,x,b=.5*l.buffer/l.extent,w=.5-b,C=.5+b,T=1+b;m=g=_=y=null,v=rt(t,u,n-b,n+C,0,d.minX,d.maxX,l),x=rt(t,u,n+w,n+T,0,d.minX,d.maxX,l),t=null,v&&(m=rt(v,u,i-b,i+C,1,d.minY,d.maxY,l),g=rt(v,u,i+w,i+T,1,d.minY,d.maxY,l),v=null),x&&(_=rt(x,u,i-b,i+C,1,d.minY,d.maxY,l),y=rt(x,u,i+w,i+T,1,d.minY,d.maxY,l),x=null),c>1&&console.timeEnd("clipping"),a.push(m||[],e+1,2*n,2*i),a.push(g||[],e+1,2*n,2*i+1),a.push(_||[],e+1,2*n+1,2*i),a.push(y||[],e+1,2*n+1,2*i+1)}}},vt.prototype.getTile=function(t,e,n){var i=this.options,r=i.extent,o=i.debug;if(t<0||t>24)return null;var s=1<<t,a=xt(t,e=(e%s+s)%s,n);if(this.tiles[a])return ft(this.tiles[a],r);o>1&&console.log("drilling down to z%d-%d-%d",t,e,n);for(var l,c=t,u=e,h=n;!l&&c>0;)c--,u=Math.floor(u/2),h=Math.floor(h/2),l=this.tiles[xt(c,u,h)];return l&&l.source?(o>1&&console.log("found parent tile z%d-%d-%d",c,u,h),o>1&&console.time("drilling down"),this.splitTile(l.source,c,u,h,t,e,n),o>1&&console.timeEnd("drilling down"),this.tiles[a]?ft(this.tiles[a],r):null):null};class wt extends t.VectorTileWorkerSource{constructor(t,e,n,i,r){super(t,e,n,i,bt),r&&(this.loadGeoJSON=r)}loadData(e,n){const i=e&&e.request,r=i&&i.collectResourceTiming;this.loadGeoJSON(e,(o,a)=>{if(o||!a)return n(o);if("object"!=typeof a)return n(new Error(`Input data given to '${e.source}' is not a valid GeoJSON object.`));{s(a,!0);try{if(e.filter){const n=t.createExpression(e.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if("error"===n.result)throw new Error(n.value.map(t=>`${t.key}: ${t.message}`).join(", "));const i=a.features.filter(t=>n.value.evaluate({zoom:0},t));a={type:"FeatureCollection",features:i}}this._geoJSONIndex=e.cluster?new F(function({superclusterOptions:e,clusterProperties:n}){if(!n||!e)return e;const i={},r={},o={accumulated:null,zoom:0},s={properties:null},a=Object.keys(n);for(const l of a){const[e,o]=n[l],s=t.createExpression(o),a=t.createExpression("string"==typeof e?[e,["accumulated"],["get",l]]:e);i[l]=s.value,r[l]=a.value}return e.map=t=>{s.properties=t;const e={};for(const n of a)e[n]=i[n].evaluate(o,s);return e},e.reduce=(t,e)=>{s.properties=e;for(const n of a)o.accumulated=t[n],t[n]=r[n].evaluate(o,s)},e}(e)).load(a.features):function(t,e){return new vt(t,e)}(a,e.geojsonVtOptions)}catch(o){return n(o)}this.loaded={};const l={};if(r){const n=t.getPerformanceMeasurement(i);n&&(l.resourceTiming={},l.resourceTiming[e.source]=JSON.parse(JSON.stringify(n)))}n(null,l)}})}reloadTile(t,e){const n=this.loaded;return n&&n[t.uid]?super.reloadTile(t,e):this.loadTile(t,e)}loadGeoJSON(e,n){if(e.request)t.getJSON(e.request,n);else{if("string"!=typeof e.data)return n(new Error(`Input data given to '${e.source}' is not a valid GeoJSON object.`));try{return n(null,JSON.parse(e.data))}catch(t){return n(new Error(`Input data given to '${e.source}' is not a valid GeoJSON object.`))}}}getClusterExpansionZoom(t,e){try{e(null,this._geoJSONIndex.getClusterExpansionZoom(t.clusterId))}catch(t){e(t)}}getClusterChildren(t,e){try{e(null,this._geoJSONIndex.getChildren(t.clusterId))}catch(t){e(t)}}getClusterLeaves(t,e){try{e(null,this._geoJSONIndex.getLeaves(t.clusterId,t.limit,t.offset))}catch(t){e(t)}}}class Ct{constructor(e){this.self=e,this.actor=new t.Actor(e,this),this.layerIndexes={},this.availableImages={},this.isSpriteLoaded=!1,this.workerSourceTypes={vector:t.VectorTileWorkerSource,geojson:wt},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=(t,e)=>{if(this.workerSourceTypes[t])throw new Error(`Worker source with name "${t}" already registered.`);this.workerSourceTypes[t]=e},this.self.registerRTLTextPlugin=e=>{if(t.plugin.isParsed())throw new Error("RTL text plugin already registered.");t.plugin.applyArabicShaping=e.applyArabicShaping,t.plugin.processBidirectionalText=e.processBidirectionalText,t.plugin.processStyledBidirectionalText=e.processStyledBidirectionalText}}checkIfReady(t,e,n){n()}setReferrer(t,e){this.referrer=e}spriteLoaded(e,n){this.isSpriteLoaded=n;for(const i in this.workerSources[e]){const r=this.workerSources[e][i];for(const e in r)r[e]instanceof t.VectorTileWorkerSource&&(r[e].isSpriteLoaded=n,r[e].fire(new t.Event("isSpriteLoaded")))}}setImages(t,e,n){this.availableImages[t]=e;for(const i in this.workerSources[t]){const n=this.workerSources[t][i];for(const t in n)n[t].availableImages=e}n()}enableTerrain(t,e,n){this.terrain=e,n()}setLayers(t,e,n){this.getLayerIndex(t).replace(e),n()}updateLayers(t,e,n){this.getLayerIndex(t).update(e.layers,e.removedIds),n()}loadTile(e,n,i){const r=this.enableTerrain?t.extend({enableTerrain:this.terrain},n):n;this.getWorkerSource(e,n.type,n.source).loadTile(r,i)}loadDEMTile(e,n,i){const r=this.enableTerrain?t.extend({buildQuadTree:this.terrain},n):n;this.getDEMWorkerSource(e,n.source).loadTile(r,i)}reloadTile(e,n,i){const r=this.enableTerrain?t.extend({enableTerrain:this.terrain},n):n;this.getWorkerSource(e,n.type,n.source).reloadTile(r,i)}abortTile(t,e,n){this.getWorkerSource(t,e.type,e.source).abortTile(e,n)}removeTile(t,e,n){this.getWorkerSource(t,e.type,e.source).removeTile(e,n)}removeSource(t,e,n){if(!this.workerSources[t]||!this.workerSources[t][e.type]||!this.workerSources[t][e.type][e.source])return;const i=this.workerSources[t][e.type][e.source];delete this.workerSources[t][e.type][e.source],void 0!==i.removeSource?i.removeSource(e,n):n()}loadWorkerSource(t,e,n){try{this.self.importScripts(e.url),n()}catch(t){n(t.toString())}}syncRTLPluginState(e,n,i){try{t.plugin.setState(n);const e=t.plugin.getPluginURL();if(t.plugin.isLoaded()&&!t.plugin.isParsed()&&null!=e){this.self.importScripts(e);const n=t.plugin.isParsed();i(n?void 0:new Error("RTL Text Plugin failed to import scripts from "+e),n)}}catch(t){i(t.toString())}}getAvailableImages(t){let e=this.availableImages[t];return e||(e=[]),e}getLayerIndex(t){let e=this.layerIndexes[t];return e||(e=this.layerIndexes[t]=new i),e}getWorkerSource(t,e,n){return this.workerSources[t]||(this.workerSources[t]={}),this.workerSources[t][e]||(this.workerSources[t][e]={}),this.workerSources[t][e][n]||(this.workerSources[t][e][n]=new this.workerSourceTypes[e]({send:(e,n,i,r,o,s)=>{this.actor.send(e,n,i,t,o,s)},scheduler:this.actor.scheduler},this.getLayerIndex(t),this.getAvailableImages(t),this.isSpriteLoaded)),this.workerSources[t][e][n]}getDEMWorkerSource(t,e){return this.demWorkerSources[t]||(this.demWorkerSources[t]={}),this.demWorkerSources[t][e]||(this.demWorkerSources[t][e]=new o),this.demWorkerSources[t][e]}enforceCacheSizeLimit(e,n){t.enforceCacheSizeLimit(n)}getWorkerPerformanceMetrics(t,e,n){n(void 0,void 0)}}return"undefined"!=typeof WorkerGlobalScope&&"undefined"!=typeof self&&self instanceof WorkerGlobalScope&&(self.worker=new Ct(self)),Ct}),i(0,function(t){var e=n;function n(t){return!function(t){return"undefined"==typeof window||"undefined"==typeof document?"not a browser":Array.prototype&&Array.prototype.every&&Array.prototype.filter&&Array.prototype.forEach&&Array.prototype.indexOf&&Array.prototype.lastIndexOf&&Array.prototype.map&&Array.prototype.some&&Array.prototype.reduce&&Array.prototype.reduceRight&&Array.isArray?Function.prototype&&Function.prototype.bind?Object.keys&&Object.create&&Object.getPrototypeOf&&Object.getOwnPropertyNames&&Object.isSealed&&Object.isFrozen&&Object.isExtensible&&Object.getOwnPropertyDescriptor&&Object.defineProperty&&Object.defineProperties&&Object.seal&&Object.freeze&&Object.preventExtensions?"JSON"in window&&"parse"in JSON&&"stringify"in JSON?function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var t,e,n=new Blob([""],{type:"text/javascript"}),i=URL.createObjectURL(n);try{e=new Worker(i),t=!0}catch(e){t=!1}return e&&e.terminate(),URL.revokeObjectURL(i),t}()?"Uint8ClampedArray"in window?ArrayBuffer.isView?function(){var t=document.createElement("canvas");t.width=t.height=1;var e=t.getContext("2d");if(!e)return!1;var n=e.getImageData(0,0,1,1);return n&&n.width===t.width}()?(void 0===i[e=t&&t.failIfMajorPerformanceCaveat]&&(i[e]=function(t){var e,i=function(t){var e=document.createElement("canvas"),i=Object.create(n.webGLContextAttributes);return i.failIfMajorPerformanceCaveat=t,e.getContext("webgl",i)||e.getContext("experimental-webgl",i)}(t);if(!i)return!1;try{e=i.createShader(i.VERTEX_SHADER)}catch(t){return!1}return!(!e||i.isContextLost())&&(i.shaderSource(e,"void main() {}"),i.compileShader(e),!0===i.getShaderParameter(e,i.COMPILE_STATUS))}(e)),i[e]?document.documentMode?"insufficient ECMAScript 6 support":void 0:"insufficient WebGL support"):"insufficient Canvas/getImageData support":"insufficient ArrayBuffer support":"insufficient Uint8ClampedArray support":"insufficient worker support":"insufficient JSON support":"insufficient Object support":"insufficient Function support":"insufficent Array support";var e}(t)}var i={};function r(t,e){if(Array.isArray(t)){if(!Array.isArray(e)||t.length!==e.length)return!1;for(let n=0;n<t.length;n++)if(!r(t[n],e[n]))return!1;return!0}if("object"==typeof t&&null!==t&&null!==e){if("object"!=typeof e)return!1;if(Object.keys(t).length!==Object.keys(e).length)return!1;for(const n in t)if(!r(t[n],e[n]))return!1;return!0}return t===e}n.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0};const o={create:function(e,n,i){const r=t.window.document.createElement(e);return void 0!==n&&(r.className=n),i&&i.appendChild(r),r},createNS:function(e,n){return t.window.document.createElementNS(e,n)}},s=t.window.document&&t.window.document.documentElement.style,a=s&&void 0!==s.userSelect?"userSelect":"WebkitUserSelect";let l;o.disableDrag=function(){s&&a&&(l=s[a],s[a]="none")},o.enableDrag=function(){s&&a&&(s[a]=l)},o.setTransform=function(t,e){t.style.transform=e};let c=!1;try{const e=Object.defineProperty({},"passive",{get(){c=!0}});t.window.addEventListener("test",e,e),t.window.removeEventListener("test",e,e)}catch(t){c=!1}o.addEventListener=function(t,e,n,i={}){t.addEventListener(e,n,"passive"in i&&c?i:i.capture)},o.removeEventListener=function(t,e,n,i={}){t.removeEventListener(e,n,"passive"in i&&c?i:i.capture)};const u=function(e){e.preventDefault(),e.stopPropagation(),t.window.removeEventListener("click",u,!0)};function h(e,n,i){const r=e.offsetWidth===n.width?1:e.offsetWidth/n.width;return new t.pointGeometry((i.clientX-n.left)*r,(i.clientY-n.top)*r)}o.suppressClick=function(){t.window.addEventListener("click",u,!0),t.window.setTimeout(()=>{t.window.removeEventListener("click",u,!0)},0)},o.mousePos=function(t,e){const n=t.getBoundingClientRect();return h(t,n,e)},o.touchPos=function(t,e){const n=t.getBoundingClientRect(),i=[];for(let r=0;r<e.length;r++)i.push(h(t,n,e[r]));return i},o.mouseButton=function(e){return void 0!==t.window.InstallTrigger&&2===e.button&&e.ctrlKey&&t.window.navigator.platform.toUpperCase().indexOf("MAC")>=0?0:e.button},o.remove=function(t){t.parentNode&&t.parentNode.removeChild(t)};class d{constructor(t,e){this.pos=t,this.dir=e}intersectsPlane(e,n,i){const r=t.dot(n,this.dir);if(Math.abs(r)<1e-6)return!1;const o=t.dot(t.sub(t.create(),e,this.pos),n)/r,s=t.scaleAndAdd(t.create(),this.pos,this.dir,o);return t.copy(i,s),!0}}class p{constructor(t,e){this.points=t,this.planes=e}static fromInvProjectionMatrix(e,n,i){const r=Math.pow(2,i),o=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(i=>{const o=t.transformMat4([],i,e),s=1/o[3]/n*r;return t.mul(o,o,[s,s,1/o[3],s])}),s=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(e=>{const n=t.sub([],o[e[0]],o[e[1]]),i=t.sub([],o[e[2]],o[e[1]]),r=t.normalize([],t.cross([],n,i)),s=-t.dot(r,o[e[1]]);return r.concat(s)});return new p(o,s)}}class f{constructor(e,n){this.min=e,this.max=n,this.center=t.scale([],t.add([],this.min,this.max),.5)}quadrant(e){const n=[e%2==0,e<2],i=t.clone(this.min),r=t.clone(this.max);for(let t=0;t<n.length;t++)i[t]=n[t]?this.min[t]:this.center[t],r[t]=n[t]?this.center[t]:this.max[t];return r[2]=this.max[2],new f(i,r)}distanceX(t){return Math.max(Math.min(this.max[0],t[0]),this.min[0])-t[0]}distanceY(t){return Math.max(Math.min(this.max[1],t[1]),this.min[1])-t[1]}distanceZ(t){return Math.max(Math.min(this.max[2],t[2]),this.min[2])-t[2]}intersects(e){const n=[[this.min[0],this.min[1],this.min[2],1],[this.max[0],this.min[1],this.min[2],1],[this.max[0],this.max[1],this.min[2],1],[this.min[0],this.max[1],this.min[2],1],[this.min[0],this.min[1],this.max[2],1],[this.max[0],this.min[1],this.max[2],1],[this.max[0],this.max[1],this.max[2],1],[this.min[0],this.max[1],this.max[2],1]];let i=!0;for(let r=0;r<e.planes.length;r++){const o=e.planes[r];let s=0;for(let e=0;e<n.length;e++)s+=t.dot$1(o,n[e])>=0;if(0===s)return 0;s!==n.length&&(i=!1)}if(i)return 2;for(let t=0;t<3;t++){let n=Number.MAX_VALUE,i=-Number.MAX_VALUE;for(let r=0;r<e.points.length;r++){const o=e.points[r][t]-this.min[t];n=Math.min(n,o),i=Math.max(i,o)}if(i<0||n>this.max[t]-this.min[t])return 0}return 1}}function m(t){const{userImage:e}=t;return!!(e&&e.render&&e.render())&&(t.data.replace(new Uint8Array(e.data.buffer)),!0)}class g extends t.Evented{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new t.RGBAImage({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(t){if(this.loaded!==t&&(this.loaded=t,t)){for(const{ids:t,callback:e}of this.requestors)this._notify(t,e);this.requestors=[]}}getImage(t){return this.images[t]}addImage(t,e){this._validate(t,e)&&(this.images[t]=e)}_validate(e,n){let i=!0;return this._validateStretch(n.stretchX,n.data&&n.data.width)||(this.fire(new t.ErrorEvent(new Error(`Image "${e}" has invalid "stretchX" value`))),i=!1),this._validateStretch(n.stretchY,n.data&&n.data.height)||(this.fire(new t.ErrorEvent(new Error(`Image "${e}" has invalid "stretchY" value`))),i=!1),this._validateContent(n.content,n)||(this.fire(new t.ErrorEvent(new Error(`Image "${e}" has invalid "content" value`))),i=!1),i}_validateStretch(t,e){if(!t)return!0;let n=0;for(const i of t){if(i[0]<n||i[1]<i[0]||e<i[1])return!1;n=i[1]}return!0}_validateContent(t,e){return!(t&&(4!==t.length||t[0]<0||e.data.width<t[0]||t[1]<0||e.data.height<t[1]||t[2]<0||e.data.width<t[2]||t[3]<0||e.data.height<t[3]||t[2]<t[0]||t[3]<t[1]))}updateImage(t,e){e.version=this.images[t].version+1,this.images[t]=e,this.updatedImages[t]=!0}removeImage(t){const e=this.images[t];delete this.images[t],delete this.patterns[t],e.userImage&&e.userImage.onRemove&&e.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(t,e){let n=!0;if(!this.isLoaded())for(const i of t)this.images[i]||(n=!1);this.isLoaded()||n?this._notify(t,e):this.requestors.push({ids:t,callback:e})}_notify(e,n){const i={};for(const r of e){this.images[r]||this.fire(new t.Event("styleimagemissing",{id:r}));const e=this.images[r];e?i[r]={data:e.data.clone(),pixelRatio:e.pixelRatio,sdf:e.sdf,version:e.version,stretchX:e.stretchX,stretchY:e.stretchY,content:e.content,hasRenderCallback:Boolean(e.userImage&&e.userImage.render)}:t.warnOnce(`Image "${r}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}n(null,i)}getPixelSize(){const{width:t,height:e}=this.atlasImage;return{width:t,height:e}}getPattern(e){const n=this.patterns[e],i=this.getImage(e);if(!i)return null;if(n&&n.position.version===i.version)return n.position;if(n)n.position.version=i.version;else{const n={w:i.data.width+2,h:i.data.height+2,x:0,y:0},r=new t.ImagePosition(n,i);this.patterns[e]={bin:n,position:r}}return this._updatePatternAtlas(),this.patterns[e].position}bind(e){const n=e.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new t.Texture(e,this.atlasImage,n.RGBA),this.atlasTexture.bind(n.LINEAR,n.CLAMP_TO_EDGE)}_updatePatternAtlas(){const e=[];for(const t in this.patterns)e.push(this.patterns[t].bin);const{w:n,h:i}=t.potpack(e),r=this.atlasImage;r.resize({width:n||1,height:i||1});for(const o in this.patterns){const{bin:e}=this.patterns[o],n=e.x+1,i=e.y+1,s=this.images[o].data,a=s.width,l=s.height;t.RGBAImage.copy(s,r,{x:0,y:0},{x:n,y:i},{width:a,height:l}),t.RGBAImage.copy(s,r,{x:0,y:l-1},{x:n,y:i-1},{width:a,height:1}),t.RGBAImage.copy(s,r,{x:0,y:0},{x:n,y:i+l},{width:a,height:1}),t.RGBAImage.copy(s,r,{x:a-1,y:0},{x:n-1,y:i},{width:1,height:l}),t.RGBAImage.copy(s,r,{x:0,y:0},{x:n+a,y:i},{width:1,height:l})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(t){for(const e of t){if(this.callbackDispatchedThisFrame[e])continue;this.callbackDispatchedThisFrame[e]=!0;const t=this.images[e];m(t)&&this.updateImage(e,t)}}}const _=new t.Properties({anchor:new t.DataConstantProperty(t.spec.light.anchor),position:new class{constructor(){this.specification=t.spec.light.position}possiblyEvaluate(e,n){return function([e,n,i]){const r=t.degToRad(n+90),o=t.degToRad(i);return{x:e*Math.cos(r)*Math.sin(o),y:e*Math.sin(r)*Math.sin(o),z:e*Math.cos(o),azimuthal:n,polar:i}}(e.expression.evaluate(n))}interpolate(e,n,i){return{x:t.number(e.x,n.x,i),y:t.number(e.y,n.y,i),z:t.number(e.z,n.z,i),azimuthal:t.number(e.azimuthal,n.azimuthal,i),polar:t.number(e.polar,n.polar,i)}}},color:new t.DataConstantProperty(t.spec.light.color),intensity:new t.DataConstantProperty(t.spec.light.intensity)}),y="-transition";class v extends t.Evented{constructor(e){super(),this._transitionable=new t.Transitionable(_),this.setLight(e),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(e,n={}){if(!this._validate(t.validateLight,e,n))for(const i in e){const n=e[i];t.endsWith(i,y)?this._transitionable.setTransition(i.slice(0,-y.length),n):this._transitionable.setValue(i,n)}}updateTransitions(t){this._transitioning=this._transitionable.transitioned(t,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(t){this.properties=this._transitioning.possiblyEvaluate(t)}_validate(e,n,i){return(!i||!1!==i.validate)&&t.emitValidationErrors(this,e.call(t.validateStyle,t.extend({value:n,style:{glyphs:!0,sprite:!0},styleSpec:t.spec})))}}const x=new t.Properties({source:new t.DataConstantProperty(t.spec.terrain.source),exaggeration:new t.DataConstantProperty(t.spec.terrain.exaggeration)}),b="-transition";class w extends t.Evented{constructor(e){super(),this._transitionable=new t.Transitionable(x),this.set(e),this._transitioning=this._transitionable.untransitioned()}get(){return this._transitionable.serialize()}set(e){for(const n in e){const i=e[n];t.endsWith(n,b)?this._transitionable.setTransition(n.slice(0,-b.length),i):this._transitionable.setValue(n,i)}}updateTransitions(t){this._transitioning=this._transitionable.transitioned(t,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(t){this.properties=this._transitioning.possiblyEvaluate(t)}}function C(e,n,i,r){const o=t.smoothstep(45,65,i),[s,a]=T(e,r),l=t.length(n);let c=1-Math.min(1,Math.exp((l-s)/(a-s)*-6));return c*=c*c,c=Math.min(1,1.00747*c),c*o*e.alpha}function T(t,e){const n=.5/Math.tan(.5*e);return[t.range[0]+n,t.range[1]+n]}const S=new t.Properties({range:new t.DataConstantProperty(t.spec.fog.range),color:new t.DataConstantProperty(t.spec.fog.color),"horizon-blend":new t.DataConstantProperty(t.spec.fog["horizon-blend"])}),E="-transition";class k extends t.Evented{constructor(e){super(),this._transitionable=new t.Transitionable(S),this.set(e),this._transitioning=this._transitionable.untransitioned()}get state(){return{range:this.properties.get("range"),horizonBlend:this.properties.get("horizon-blend"),alpha:this.properties.get("color").a}}get(){return this._transitionable.serialize()}set(e){if(!this._validate(t.validateFog,e))for(const n in e){const i=e[n];t.endsWith(n,E)?this._transitionable.setTransition(n.slice(0,-E.length),i):this._transitionable.setValue(n,i)}}getOpacity(e){const n=this.properties&&this.properties.get("color")||1;return t.smoothstep(45,65,e)*n.a}getOpacityAtLatLng(e,n){return function(e,n,i){const r=t.MercatorCoordinate.fromLngLat(n),o=i.elevation?i.elevation.getAtPointOrZero(r):0,s=[r.x,r.y,o];return t.transformMat4$1(s,s,i.mercatorFogMatrix),C(e,s,i.pitch,i._fov)}(this.state,e,n)}getFovAdjustedRange(t){return T(this.state,t)}updateTransitions(t){this._transitioning=this._transitionable.transitioned(t,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(t){this.properties=this._transitioning.possiblyEvaluate(t)}_validate(e,n,i){return(!i||!1!==i.validate)&&t.emitValidationErrors(this,e.call(t.validateStyle,t.extend({value:n,style:{glyphs:!0,sprite:!0},styleSpec:t.spec})))}}class A{constructor(e,n){this.workerPool=e,this.actors=[],this.currentActor=0,this.id=t.uniqueId();const i=this.workerPool.acquire(this.id);for(let t=0;t<i.length;t++){const e=new A.Actor(i[t],n,this.id);e.name="Worker "+t,this.actors.push(e)}this.ready=!1,this.broadcast("checkIfReady",null,()=>{this.ready=!0})}broadcast(e,n,i){t.asyncAll(this.actors,(t,i)=>{t.send(e,n,i)},i=i||function(){})}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(){this.actors.forEach(t=>{t.remove()}),this.actors=[],this.workerPool.release(this.id)}}function I(e,n,i){return n*(t.EXTENT/(e.tileSize*Math.pow(2,i-e.tileID.overscaledZ)))}A.Actor=t.Actor;class P{constructor(t,e,n,i){this.screenBounds=t,this.cameraPoint=e,this._screenRaycastCache={},this._cameraRaycastCache={},this.isAboveHorizon=n,this.screenGeometry=this.bufferedScreenGeometry(0),this.screenGeometryMercator=this.screenGeometry.map(t=>i.pointCoordinate3D(t)),this.cameraGeometry=this.bufferedCameraGeometry(0)}static createFromScreenPoints(e,n){let i,r;if(e instanceof t.pointGeometry||"number"==typeof e[0]){const o=t.pointGeometry.convert(e);i=[t.pointGeometry.convert(e)],r=n.isPointAboveHorizon(o)}else{const o=t.pointGeometry.convert(e[0]),s=t.pointGeometry.convert(e[1]);i=[o,s],r=t.polygonizeBounds(o,s).every(t=>n.isPointAboveHorizon(t))}return new P(i,n.getCameraPoint(),r,n)}isPointQuery(){return 1===this.screenBounds.length}bufferedScreenGeometry(e){return t.polygonizeBounds(this.screenBounds[0],1===this.screenBounds.length?this.screenBounds[0]:this.screenBounds[1],e)}bufferedCameraGeometry(e){const n=this.screenBounds[0],i=1===this.screenBounds.length?this.screenBounds[0].add(new t.pointGeometry(1,1)):this.screenBounds[1],r=t.polygonizeBounds(n,i,0,!1);return this.cameraPoint.y>i.y&&(this.cameraPoint.x>n.x&&this.cameraPoint.x<i.x?r.splice(3,0,this.cameraPoint):this.cameraPoint.x>=i.x?r[2]=this.cameraPoint:this.cameraPoint.x<=n.x&&(r[3]=this.cameraPoint)),t.bufferConvexPolygon(r,e)}containsTile(e,n,i){const r=e.queryPadding+1,o=i?this._bufferedCameraMercator(r,n).map(t=>e.tileID.getTilePoint(t)):this._bufferedScreenMercator(r,n).map(t=>e.tileID.getTilePoint(t)),s=this.screenGeometryMercator.map(t=>e.tileID.getTileVec3(t)),a=s.map(e=>new t.pointGeometry(e[0],e[1])),l=n.getFreeCameraOptions().position||new t.MercatorCoordinate(0,0,0),c=e.tileID.getTileVec3(l),u=s.map(e=>{const n=t.sub(e,e,c);return t.normalize(n,n),new d(c,n)}),h=I(e,1,n.zoom);if(t.polygonIntersectsBox(o,0,0,t.EXTENT,t.EXTENT))return{queryGeometry:this,tilespaceGeometry:a,tilespaceRays:u,bufferedTilespaceGeometry:o,bufferedTilespaceBounds:(p=t.getBounds(o),p.min.x=t.clamp(p.min.x,0,t.EXTENT),p.min.y=t.clamp(p.min.y,0,t.EXTENT),p.max.x=t.clamp(p.max.x,0,t.EXTENT),p.max.y=t.clamp(p.max.y,0,t.EXTENT),p),tile:e,tileID:e.tileID,pixelToTileUnitsFactor:h};var p}_bufferedScreenMercator(t,e){const n=M(t);if(this._screenRaycastCache[n])return this._screenRaycastCache[n];{const i=this.bufferedScreenGeometry(t).map(t=>e.pointCoordinate3D(t));return this._screenRaycastCache[n]=i,i}}_bufferedCameraMercator(t,e){const n=M(t);if(this._cameraRaycastCache[n])return this._cameraRaycastCache[n];{const i=this.bufferedCameraGeometry(t).map(t=>e.pointCoordinate3D(t));return this._cameraRaycastCache[n]=i,i}}}function M(t){return 100*t|0}function O(e,n,i){const r=function(r,o){if(r)return i(r);if(o){const r=t.pick(t.extend(o,e),["tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds","scheme","tileSize","encoding"]);o.vector_layers&&(r.vectorLayers=o.vector_layers,r.vectorLayerIds=r.vectorLayers.map(t=>t.id)),r.tiles=n.canonicalizeTileset(r,e.url),i(null,r)}};return e.url?t.getJSON(n.transformRequest(n.normalizeSourceURL(e.url),t.ResourceType.Source),r):t.exported.frame(()=>r(null,e))}class z{constructor(e,n,i){this.bounds=t.LngLatBounds.convert(this.validateBounds(e)),this.minzoom=n||0,this.maxzoom=i||24}validateBounds(t){return Array.isArray(t)&&4===t.length?[Math.max(-180,t[0]),Math.max(-90,t[1]),Math.min(180,t[2]),Math.min(90,t[3])]:[-180,-90,180,90]}contains(e){const n=Math.pow(2,e.z),i=Math.floor(t.mercatorXfromLng(this.bounds.getWest())*n),r=Math.floor(t.mercatorYfromLat(this.bounds.getNorth())*n),o=Math.ceil(t.mercatorXfromLng(this.bounds.getEast())*n),s=Math.ceil(t.mercatorYfromLat(this.bounds.getSouth())*n);return e.x>=i&&e.x<o&&e.y>=r&&e.y<s}}class D{constructor(t,e,n){this.context=t;const i=t.gl;this.buffer=i.createBuffer(),this.dynamicDraw=Boolean(n),this.context.unbindVAO(),t.bindElementBuffer.set(this.buffer),i.bufferData(i.ELEMENT_ARRAY_BUFFER,e.arrayBuffer,this.dynamicDraw?i.DYNAMIC_DRAW:i.STATIC_DRAW),this.dynamicDraw||delete e.arrayBuffer}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(t){const e=this.context.gl;this.context.unbindVAO(),this.bind(),e.bufferSubData(e.ELEMENT_ARRAY_BUFFER,0,t.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const L={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class R{constructor(t,e,n,i){this.length=e.length,this.attributes=n,this.itemSize=e.bytesPerElement,this.dynamicDraw=i,this.context=t;const r=t.gl;this.buffer=r.createBuffer(),t.bindVertexBuffer.set(this.buffer),r.bufferData(r.ARRAY_BUFFER,e.arrayBuffer,this.dynamicDraw?r.DYNAMIC_DRAW:r.STATIC_DRAW),this.dynamicDraw||delete e.arrayBuffer}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(t){const e=this.context.gl;this.bind(),e.bufferSubData(e.ARRAY_BUFFER,0,t.arrayBuffer)}enableAttributes(t,e){for(let n=0;n<this.attributes.length;n++){const i=e.attributes[this.attributes[n].name];void 0!==i&&t.enableVertexAttribArray(i)}}setVertexAttribPointers(t,e,n){for(let i=0;i<this.attributes.length;i++){const r=this.attributes[i],o=e.attributes[r.name];void 0!==o&&t.vertexAttribPointer(o,r.components,t[L[r.type]],!1,this.itemSize,r.offset+this.itemSize*(n||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class F{constructor(t){this.gl=t.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(t){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class B extends F{getDefault(){return t.Color.transparent}set(t){const e=this.current;(t.r!==e.r||t.g!==e.g||t.b!==e.b||t.a!==e.a||this.dirty)&&(this.gl.clearColor(t.r,t.g,t.b,t.a),this.current=t,this.dirty=!1)}}class V extends F{getDefault(){return 1}set(t){(t!==this.current||this.dirty)&&(this.gl.clearDepth(t),this.current=t,this.dirty=!1)}}class U extends F{getDefault(){return 0}set(t){(t!==this.current||this.dirty)&&(this.gl.clearStencil(t),this.current=t,this.dirty=!1)}}class N extends F{getDefault(){return[!0,!0,!0,!0]}set(t){const e=this.current;(t[0]!==e[0]||t[1]!==e[1]||t[2]!==e[2]||t[3]!==e[3]||this.dirty)&&(this.gl.colorMask(t[0],t[1],t[2],t[3]),this.current=t,this.dirty=!1)}}class j extends F{getDefault(){return!0}set(t){(t!==this.current||this.dirty)&&(this.gl.depthMask(t),this.current=t,this.dirty=!1)}}class q extends F{getDefault(){return 255}set(t){(t!==this.current||this.dirty)&&(this.gl.stencilMask(t),this.current=t,this.dirty=!1)}}class $ extends F{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(t){const e=this.current;(t.func!==e.func||t.ref!==e.ref||t.mask!==e.mask||this.dirty)&&(this.gl.stencilFunc(t.func,t.ref,t.mask),this.current=t,this.dirty=!1)}}class G extends F{getDefault(){const t=this.gl;return[t.KEEP,t.KEEP,t.KEEP]}set(t){const e=this.current;(t[0]!==e[0]||t[1]!==e[1]||t[2]!==e[2]||this.dirty)&&(this.gl.stencilOp(t[0],t[1],t[2]),this.current=t,this.dirty=!1)}}class Z extends F{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const e=this.gl;t?e.enable(e.STENCIL_TEST):e.disable(e.STENCIL_TEST),this.current=t,this.dirty=!1}}class H extends F{getDefault(){return[0,1]}set(t){const e=this.current;(t[0]!==e[0]||t[1]!==e[1]||this.dirty)&&(this.gl.depthRange(t[0],t[1]),this.current=t,this.dirty=!1)}}class W extends F{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const e=this.gl;t?e.enable(e.DEPTH_TEST):e.disable(e.DEPTH_TEST),this.current=t,this.dirty=!1}}class X extends F{getDefault(){return this.gl.LESS}set(t){(t!==this.current||this.dirty)&&(this.gl.depthFunc(t),this.current=t,this.dirty=!1)}}class K extends F{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const e=this.gl;t?e.enable(e.BLEND):e.disable(e.BLEND),this.current=t,this.dirty=!1}}class Y extends F{getDefault(){const t=this.gl;return[t.ONE,t.ZERO]}set(t){const e=this.current;(t[0]!==e[0]||t[1]!==e[1]||this.dirty)&&(this.gl.blendFunc(t[0],t[1]),this.current=t,this.dirty=!1)}}class J extends F{getDefault(){return t.Color.transparent}set(t){const e=this.current;(t.r!==e.r||t.g!==e.g||t.b!==e.b||t.a!==e.a||this.dirty)&&(this.gl.blendColor(t.r,t.g,t.b,t.a),this.current=t,this.dirty=!1)}}class Q extends F{getDefault(){return this.gl.FUNC_ADD}set(t){(t!==this.current||this.dirty)&&(this.gl.blendEquation(t),this.current=t,this.dirty=!1)}}class tt extends F{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const e=this.gl;t?e.enable(e.CULL_FACE):e.disable(e.CULL_FACE),this.current=t,this.dirty=!1}}class et extends F{getDefault(){return this.gl.BACK}set(t){(t!==this.current||this.dirty)&&(this.gl.cullFace(t),this.current=t,this.dirty=!1)}}class nt extends F{getDefault(){return this.gl.CCW}set(t){(t!==this.current||this.dirty)&&(this.gl.frontFace(t),this.current=t,this.dirty=!1)}}class it extends F{getDefault(){return null}set(t){(t!==this.current||this.dirty)&&(this.gl.useProgram(t),this.current=t,this.dirty=!1)}}class rt extends F{getDefault(){return this.gl.TEXTURE0}set(t){(t!==this.current||this.dirty)&&(this.gl.activeTexture(t),this.current=t,this.dirty=!1)}}class ot extends F{getDefault(){const t=this.gl;return[0,0,t.drawingBufferWidth,t.drawingBufferHeight]}set(t){const e=this.current;(t[0]!==e[0]||t[1]!==e[1]||t[2]!==e[2]||t[3]!==e[3]||this.dirty)&&(this.gl.viewport(t[0],t[1],t[2],t[3]),this.current=t,this.dirty=!1)}}class st extends F{getDefault(){return null}set(t){if(t===this.current&&!this.dirty)return;const e=this.gl;e.bindFramebuffer(e.FRAMEBUFFER,t),this.current=t,this.dirty=!1}}class at extends F{getDefault(){return null}set(t){if(t===this.current&&!this.dirty)return;const e=this.gl;e.bindRenderbuffer(e.RENDERBUFFER,t),this.current=t,this.dirty=!1}}class lt extends F{getDefault(){return null}set(t){if(t===this.current&&!this.dirty)return;const e=this.gl;e.bindTexture(e.TEXTURE_2D,t),this.current=t,this.dirty=!1}}class ct extends F{getDefault(){return null}set(t){if(t===this.current&&!this.dirty)return;const e=this.gl;e.bindBuffer(e.ARRAY_BUFFER,t),this.current=t,this.dirty=!1}}class ut extends F{getDefault(){return null}set(t){const e=this.gl;e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,t),this.current=t,this.dirty=!1}}class ht extends F{constructor(t){super(t),this.vao=t.extVertexArrayObject}getDefault(){return null}set(t){this.vao&&(t!==this.current||this.dirty)&&(this.vao.bindVertexArrayOES(t),this.current=t,this.dirty=!1)}}class dt extends F{getDefault(){return 4}set(t){if(t===this.current&&!this.dirty)return;const e=this.gl;e.pixelStorei(e.UNPACK_ALIGNMENT,t),this.current=t,this.dirty=!1}}class pt extends F{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const e=this.gl;e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,t),this.current=t,this.dirty=!1}}class ft extends F{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const e=this.gl;e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,t),this.current=t,this.dirty=!1}}class mt extends F{constructor(t,e){super(t),this.context=t,this.parent=e}getDefault(){return null}}class gt extends mt{setDirty(){this.dirty=!0}set(t){if(t===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const e=this.gl;e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,t,0),this.current=t,this.dirty=!1}}class _t extends mt{attachment(){return this.gl.DEPTH_ATTACHMENT}set(t){if(t===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const e=this.gl;e.framebufferRenderbuffer(e.FRAMEBUFFER,this.attachment(),e.RENDERBUFFER,t),this.current=t,this.dirty=!1}}class yt extends _t{attachment(){return this.gl.DEPTH_STENCIL_ATTACHMENT}}class vt{constructor(t,e,n,i){this.context=t,this.width=e,this.height=n;const r=this.framebuffer=t.gl.createFramebuffer();this.colorAttachment=new gt(t,r),i&&(this.depthAttachment=new _t(t,r))}destroy(){const t=this.context.gl,e=this.colorAttachment.get();if(e&&t.deleteTexture(e),this.depthAttachment){const e=this.depthAttachment.get();e&&t.deleteRenderbuffer(e)}t.deleteFramebuffer(this.framebuffer)}}class xt{constructor(t){this.gl=t,this.extVertexArrayObject=this.gl.getExtension("OES_vertex_array_object"),this.clearColor=new B(this),this.clearDepth=new V(this),this.clearStencil=new U(this),this.colorMask=new N(this),this.depthMask=new j(this),this.stencilMask=new q(this),this.stencilFunc=new $(this),this.stencilOp=new G(this),this.stencilTest=new Z(this),this.depthRange=new H(this),this.depthTest=new W(this),this.depthFunc=new X(this),this.blend=new K(this),this.blendFunc=new Y(this),this.blendColor=new J(this),this.blendEquation=new Q(this),this.cullFace=new tt(this),this.cullFaceSide=new et(this),this.frontFace=new nt(this),this.program=new it(this),this.activeTexture=new rt(this),this.viewport=new ot(this),this.bindFramebuffer=new st(this),this.bindRenderbuffer=new at(this),this.bindTexture=new lt(this),this.bindVertexBuffer=new ct(this),this.bindElementBuffer=new ut(this),this.bindVertexArrayOES=this.extVertexArrayObject&&new ht(this),this.pixelStoreUnpack=new dt(this),this.pixelStoreUnpackPremultiplyAlpha=new pt(this),this.pixelStoreUnpackFlipY=new ft(this),this.extTextureFilterAnisotropic=t.getExtension("EXT_texture_filter_anisotropic")||t.getExtension("MOZ_EXT_texture_filter_anisotropic")||t.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=t.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.extTextureFilterAnisotropicForceOff=!1,this.extTextureHalfFloat=t.getExtension("OES_texture_half_float"),this.extTextureHalfFloat&&(t.getExtension("OES_texture_half_float_linear"),this.extRenderToTextureHalfFloat=t.getExtension("EXT_color_buffer_half_float")),this.extTimerQuery=t.getExtension("EXT_disjoint_timer_query"),this.maxTextureSize=t.getParameter(t.MAX_TEXTURE_SIZE)}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.extVertexArrayObject&&(this.bindVertexArrayOES.dirty=!0),this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(t,e){return new D(this,t,e)}createVertexBuffer(t,e,n){return new R(this,t,e,n)}createRenderbuffer(t,e,n){const i=this.gl,r=i.createRenderbuffer();return this.bindRenderbuffer.set(r),i.renderbufferStorage(i.RENDERBUFFER,t,e,n),this.bindRenderbuffer.set(null),r}createFramebuffer(t,e,n){return new vt(this,t,e,n)}clear({color:t,depth:e,stencil:n}){const i=this.gl;let r=0;t&&(r|=i.COLOR_BUFFER_BIT,this.clearColor.set(t),this.colorMask.set([!0,!0,!0,!0])),void 0!==e&&(r|=i.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(e),this.depthMask.set(!0)),void 0!==n&&(r|=i.STENCIL_BUFFER_BIT,this.clearStencil.set(n),this.stencilMask.set(255)),i.clear(r)}setCullFace(t){!1===t.enable?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(t.mode),this.frontFace.set(t.frontFace))}setDepthMode(t){t.func!==this.gl.ALWAYS||t.mask?(this.depthTest.set(!0),this.depthFunc.set(t.func),this.depthMask.set(t.mask),this.depthRange.set(t.range)):this.depthTest.set(!1)}setStencilMode(t){t.test.func!==this.gl.ALWAYS||t.mask?(this.stencilTest.set(!0),this.stencilMask.set(t.mask),this.stencilOp.set([t.fail,t.depthFail,t.pass]),this.stencilFunc.set({func:t.test.func,ref:t.ref,mask:t.test.mask})):this.stencilTest.set(!1)}setColorMode(e){r(e.blendFunction,t.ColorMode.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(e.blendFunction),this.blendColor.set(e.blendColor)),this.colorMask.set(e.mask)}unbindVAO(){this.extVertexArrayObject&&this.bindVertexArrayOES.set(null)}}class bt extends t.Evented{constructor(e,n,i,r){super(),this.id=e,this.dispatcher=i,this.setEventedParent(r),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=t.extend({type:"raster"},n),t.extend(this,t.pick(n,["url","scheme","tileSize"]))}load(){this._loaded=!1,this.fire(new t.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=O(this._options,this.map._requestManager,(e,n)=>{this._tileJSONRequest=null,this._loaded=!0,e?this.fire(new t.ErrorEvent(e)):n&&(t.extend(this,n),n.bounds&&(this.tileBounds=new z(n.bounds,this.minzoom,this.maxzoom)),t.postTurnstileEvent(n.tiles),this.fire(new t.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new t.Event("data",{dataType:"source",sourceDataType:"content"})))})}loaded(){return this._loaded}onAdd(t){this.map=t,this.load()}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}serialize(){return t.extend({},this._options)}hasTile(t){return!this.tileBounds||this.tileBounds.contains(t.canonical)}loadTile(e,n){const i=t.exported.devicePixelRatio>=2,r=this.map._requestManager.normalizeTileURL(e.tileID.canonical.url(this.tiles,this.scheme),i,this.tileSize);e.request=t.getImage(this.map._requestManager.transformRequest(r,t.ResourceType.Tile),(i,r,o,s)=>{if(delete e.request,e.aborted)e.state="unloaded",n(null);else if(i)e.state="errored",n(i);else if(r){this.map._refreshExpiredTiles&&e.setExpiryData({cacheControl:o,expires:s});const i=this.map.painter.context,a=i.gl;e.texture=this.map.painter.getTileTexture(r.width),e.texture?e.texture.update(r,{useMipmap:!0}):(e.texture=new t.Texture(i,r,a.RGBA,{useMipmap:!0}),e.texture.bind(a.LINEAR,a.CLAMP_TO_EDGE,a.LINEAR_MIPMAP_NEAREST),i.extTextureFilterAnisotropic&&a.texParameterf(a.TEXTURE_2D,i.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,i.extTextureFilterAnisotropicMax)),e.state="loaded",t.cacheEntryPossiblyAdded(this.dispatcher),n(null)}})}abortTile(t,e){t.request&&(t.request.cancel(),delete t.request),e()}unloadTile(t,e){t.texture&&this.map.painter.saveTileTexture(t.texture),e()}hasTransition(){return!1}}let wt;var Ct=t.createLayout([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);class Tt extends t.Evented{constructor(t,e,n,i){super(),this.id=t,this.dispatcher=n,this.coordinates=e.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(i),this.options=e}load(e,n){this._loaded=!1,this.fire(new t.Event("dataloading",{dataType:"source"})),this.url=this.options.url,t.getImage(this.map._requestManager.transformRequest(this.url,t.ResourceType.Image),(i,r)=>{this._loaded=!0,i?this.fire(new t.ErrorEvent(i)):r&&(this.image=r,e&&(this.coordinates=e),n&&n(),this._finishLoading())})}loaded(){return this._loaded}updateImage(t){return this.image&&t.url?(this.options.url=t.url,this.load(t.coordinates,()=>{this.texture=null}),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new t.Event("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(t){this.map=t,this.load()}setCoordinates(e){this.coordinates=e;const n=e.map(t.MercatorCoordinate.fromLngLat);this.tileID=function(e){let n=1/0,i=1/0,r=-1/0,o=-1/0;for(const t of e)n=Math.min(n,t.x),i=Math.min(i,t.y),r=Math.max(r,t.x),o=Math.max(o,t.y);const s=Math.max(r-n,o-i),a=Math.max(0,Math.floor(-Math.log(s)/Math.LN2)),l=Math.pow(2,a);return new t.CanonicalTileID(a,Math.floor((n+r)/2*l),Math.floor((i+o)/2*l))}(n),this.minzoom=this.maxzoom=this.tileID.z;const i=n.map(t=>this.tileID.getTilePoint(t)._round());return this._boundsArray=new t.StructArrayLayout4i8,this._boundsArray.emplaceBack(i[0].x,i[0].y,0,0),this._boundsArray.emplaceBack(i[1].x,i[1].y,t.EXTENT,0),this._boundsArray.emplaceBack(i[3].x,i[3].y,0,t.EXTENT),this._boundsArray.emplaceBack(i[2].x,i[2].y,t.EXTENT,t.EXTENT),this.boundsBuffer&&(this.boundsBuffer.destroy(),delete this.boundsBuffer),this.fire(new t.Event("data",{dataType:"source",sourceDataType:"content"})),this}prepare(){if(0===Object.keys(this.tiles).length||!this.image)return;const e=this.map.painter.context,n=e.gl;this.boundsBuffer||(this.boundsBuffer=e.createVertexBuffer(this._boundsArray,Ct.members)),this.boundsSegments||(this.boundsSegments=t.SegmentVector.simpleSegment(0,0,4,2)),this.texture||(this.texture=new t.Texture(e,this.image,n.RGBA),this.texture.bind(n.LINEAR,n.CLAMP_TO_EDGE));for(const t in this.tiles){const e=this.tiles[t];"loaded"!==e.state&&(e.state="loaded",e.texture=this.texture)}}loadTile(t,e){this.tileID&&this.tileID.equals(t.tileID.canonical)?(this.tiles[String(t.tileID.wrap)]=t,t.buckets={},e(null)):(t.state="errored",e(null))}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}}const St={vector:class extends t.Evented{constructor(e,n,i,r){if(super(),this.id=e,this.dispatcher=i,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,t.extend(this,t.pick(n,["url","scheme","tileSize","promoteId"])),this._options=t.extend({type:"vector"},n),this._collectResourceTiming=n.collectResourceTiming,512!==this.tileSize)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(r),this._tileWorkers={},this._deduped=new t.DedupedRequest}load(){this._loaded=!1,this.fire(new t.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=O(this._options,this.map._requestManager,(e,n)=>{this._tileJSONRequest=null,this._loaded=!0,e?this.fire(new t.ErrorEvent(e)):n&&(t.extend(this,n),n.bounds&&(this.tileBounds=new z(n.bounds,this.minzoom,this.maxzoom)),t.postTurnstileEvent(n.tiles,this.map._requestManager._customAccessToken),this.fire(new t.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new t.Event("data",{dataType:"source",sourceDataType:"content"})))})}loaded(){return this._loaded}hasTile(t){return!this.tileBounds||this.tileBounds.contains(t.canonical)}onAdd(t){this.map=t,this.load()}setSourceProperty(t){this._tileJSONRequest&&this._tileJSONRequest.cancel(),t();const e=this.map.style._getSourceCaches(this.id);for(const n of e)n.clearTiles();this.load()}setTiles(t){return this.setSourceProperty(()=>{this._options.tiles=t}),this}setUrl(t){return this.setSourceProperty(()=>{this.url=t,this._options.url=t}),this}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}serialize(){return t.extend({},this._options)}loadTile(e,n){const i=this.map._requestManager.normalizeTileURL(e.tileID.canonical.url(this.tiles,this.scheme)),r={request:this.map._requestManager.transformRequest(i,t.ResourceType.Tile),data:void 0,uid:e.uid,tileID:e.tileID,tileZoom:e.tileZoom,zoom:e.tileID.overscaledZ,tileSize:this.tileSize*e.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:t.exported.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,isSymbolTile:e.isSymbolTile};if(r.request.collectResourceTiming=this._collectResourceTiming,e.actor&&"expired"!==e.state)"loading"===e.state?e.reloadCallback=n:e.request=e.actor.send("reloadTile",r,o.bind(this));else if(e.actor=this._tileWorkers[i]=this._tileWorkers[i]||this.dispatcher.getActor(),this.dispatcher.ready)e.request=e.actor.send("loadTile",r,o.bind(this),void 0,!0);else{const n=t.loadVectorTile.call({deduped:this._deduped},r,(t,n)=>{t||!n?o.call(this,t):(r.data={cacheControl:n.cacheControl,expires:n.expires,rawData:n.rawData.slice(0)},e.actor&&e.actor.send("loadTile",r,o.bind(this),void 0,!0))},!0);e.request={cancel:n}}function o(i,r){return delete e.request,e.aborted?n(null):i&&404!==i.status?n(i):(r&&r.resourceTiming&&(e.resourceTiming=r.resourceTiming),this.map._refreshExpiredTiles&&r&&e.setExpiryData(r),e.loadVectorData(r,this.map.painter),t.cacheEntryPossiblyAdded(this.dispatcher),n(null),void(e.reloadCallback&&(this.loadTile(e,e.reloadCallback),e.reloadCallback=null)))}}abortTile(t){t.request&&(t.request.cancel(),delete t.request),t.actor&&t.actor.send("abortTile",{uid:t.uid,type:this.type,source:this.id})}unloadTile(t){t.unloadVectorData(),t.actor&&t.actor.send("removeTile",{uid:t.uid,type:this.type,source:this.id})}hasTransition(){return!1}afterUpdate(){this._tileWorkers={}}},raster:bt,"raster-dem":class extends bt{constructor(e,n,i,r){super(e,n,i,r),this.type="raster-dem",this.maxzoom=22,this._options=t.extend({type:"raster-dem"},n),this.encoding=n.encoding||"mapbox"}loadTile(e,n){const i=this.map._requestManager.normalizeTileURL(e.tileID.canonical.url(this.tiles,this.scheme),!1,this.tileSize);function r(t,i){t&&(e.state="errored",n(t)),i&&(e.dem=i,e.dem.onDeserialize(),e.needsHillshadePrepare=!0,e.needsDEMTextureUpload=!0,e.state="loaded",n(null))}e.request=t.getImage(this.map._requestManager.transformRequest(i,t.ResourceType.Tile),(function(i,o,s,a){if(delete e.request,e.aborted)e.state="unloaded",n(null);else if(i)e.state="errored",n(i);else if(o){this.map._refreshExpiredTiles&&e.setExpiryData({cacheControl:s,expires:a});const n=t.window.ImageBitmap&&o instanceof t.window.ImageBitmap&&(null==wt&&(wt=t.window.OffscreenCanvas&&new t.window.OffscreenCanvas(1,1).getContext("2d")&&"function"==typeof t.window.createImageBitmap),wt),i=1-(o.width-t.prevPowerOfTwo(o.width))/2;i<1||e.neighboringTiles||(e.neighboringTiles=this._getNeighboringTiles(e.tileID));const l=n?o:t.exported.getImageData(o,i),c={uid:e.uid,coord:e.tileID,source:this.id,rawImageData:l,encoding:this.encoding,padding:i};e.actor&&"expired"!==e.state||(e.actor=this.dispatcher.getActor(),e.actor.send("loadDEMTile",c,r.bind(this),void 0,!0))}}).bind(this))}_getNeighboringTiles(e){const n=e.canonical,i=Math.pow(2,n.z),r=(n.x-1+i)%i,o=0===n.x?e.wrap-1:e.wrap,s=(n.x+1+i)%i,a=n.x+1===i?e.wrap+1:e.wrap,l={};return l[new t.OverscaledTileID(e.overscaledZ,o,n.z,r,n.y).key]={backfilled:!1},l[new t.OverscaledTileID(e.overscaledZ,a,n.z,s,n.y).key]={backfilled:!1},n.y>0&&(l[new t.OverscaledTileID(e.overscaledZ,o,n.z,r,n.y-1).key]={backfilled:!1},l[new t.OverscaledTileID(e.overscaledZ,e.wrap,n.z,n.x,n.y-1).key]={backfilled:!1},l[new t.OverscaledTileID(e.overscaledZ,a,n.z,s,n.y-1).key]={backfilled:!1}),n.y+1<i&&(l[new t.OverscaledTileID(e.overscaledZ,o,n.z,r,n.y+1).key]={backfilled:!1},l[new t.OverscaledTileID(e.overscaledZ,e.wrap,n.z,n.x,n.y+1).key]={backfilled:!1},l[new t.OverscaledTileID(e.overscaledZ,a,n.z,s,n.y+1).key]={backfilled:!1}),l}unloadTile(t){t.demTexture&&this.map.painter.saveTileTexture(t.demTexture),t.fbo&&(t.fbo.destroy(),delete t.fbo),t.dem&&delete t.dem,delete t.neighboringTiles,t.state="unloaded"}},geojson:class extends t.Evented{constructor(e,n,i,r){super(),this.id=e,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._loaded=!1,this.actor=i.getActor(),this.setEventedParent(r),this._data=n.data,this._options=t.extend({},n),this._collectResourceTiming=n.collectResourceTiming,void 0!==n.maxzoom&&(this.maxzoom=n.maxzoom),n.type&&(this.type=n.type),n.attribution&&(this.attribution=n.attribution),this.promoteId=n.promoteId;const o=t.EXTENT/this.tileSize;this.workerOptions=t.extend({source:this.id,cluster:n.cluster||!1,geojsonVtOptions:{buffer:(void 0!==n.buffer?n.buffer:128)*o,tolerance:(void 0!==n.tolerance?n.tolerance:.375)*o,extent:t.EXTENT,maxZoom:this.maxzoom,lineMetrics:n.lineMetrics||!1,generateId:n.generateId||!1},superclusterOptions:{maxZoom:void 0!==n.clusterMaxZoom?n.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,n.clusterMinPoints||2),extent:t.EXTENT,radius:(void 0!==n.clusterRadius?n.clusterRadius:50)*o,log:!1,generateId:n.generateId||!1},clusterProperties:n.clusterProperties,filter:n.filter},n.workerOptions)}onAdd(t){this.map=t,this.setData(this._data)}setData(t){return this._data=t,this._updateWorkerData(),this}getClusterExpansionZoom(t,e){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:t,source:this.id},e),this}getClusterChildren(t,e){return this.actor.send("geojson.getClusterChildren",{clusterId:t,source:this.id},e),this}getClusterLeaves(t,e,n,i){return this.actor.send("geojson.getClusterLeaves",{source:this.id,clusterId:t,limit:e,offset:n},i),this}_updateWorkerData(){if(this._pendingLoad)return void(this._coalesce=!0);this.fire(new t.Event("dataloading",{dataType:"source"})),this._loaded=!1;const e=t.extend({},this.workerOptions),n=this._data;"string"==typeof n?(e.request=this.map._requestManager.transformRequest(t.exported.resolveURL(n),t.ResourceType.Source),e.request.collectResourceTiming=this._collectResourceTiming):e.data=JSON.stringify(n),this._pendingLoad=this.actor.send(this.type+".loadData",e,(e,n)=>{if(this._loaded=!0,this._pendingLoad=null,e)this.fire(new t.ErrorEvent(e));else{const e={dataType:"source",sourceDataType:this._metadataFired?"content":"metadata"};this._collectResourceTiming&&n&&n.resourceTiming&&n.resourceTiming[this.id]&&(e.resourceTiming=n.resourceTiming[this.id]),this.fire(new t.Event("data",e)),this._metadataFired=!0}this._coalesce&&(this._updateWorkerData(),this._coalesce=!1)})}loaded(){return this._loaded}loadTile(e,n){const i=e.actor?"reloadTile":"loadTile";e.actor=this.actor,e.request=this.actor.send(i,{type:this.type,uid:e.uid,tileID:e.tileID,tileZoom:e.tileZoom,zoom:e.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:t.exported.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId},(t,r)=>(delete e.request,e.unloadVectorData(),e.aborted?n(null):t?n(t):(e.loadVectorData(r,this.map.painter,"reloadTile"===i),n(null))),void 0,"loadTile"===i)}abortTile(t){t.request&&(t.request.cancel(),delete t.request),t.aborted=!0}unloadTile(t){t.unloadVectorData(),this.actor.send("removeTile",{uid:t.uid,type:this.type,source:this.id})}onRemove(){this._pendingLoad&&this._pendingLoad.cancel()}serialize(){return t.extend({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}},video:class extends Tt{constructor(t,e,n,i){super(t,e,n,i),this.roundZoom=!0,this.type="video",this.options=e}load(){this._loaded=!1;const e=this.options;this.urls=[];for(const n of e.urls)this.urls.push(this.map._requestManager.transformRequest(n,t.ResourceType.Source).url);t.getVideo(this.urls,(e,n)=>{this._loaded=!0,e?this.fire(new t.ErrorEvent(e)):n&&(this.video=n,this.video.loop=!0,this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading())})}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(e){if(this.video){const n=this.video.seekable;e<n.start(0)||e>n.end(0)?this.fire(new t.ErrorEvent(new t.ValidationError("sources."+this.id,null,`Playback for this video can be set only between the ${n.start(0)} and ${n.end(0)}-second mark.`))):this.video.currentTime=e}}getVideo(){return this.video}onAdd(t){this.map||(this.map=t,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(0===Object.keys(this.tiles).length||this.video.readyState<2)return;const e=this.map.painter.context,n=e.gl;this.boundsBuffer||(this.boundsBuffer=e.createVertexBuffer(this._boundsArray,Ct.members)),this.boundsSegments||(this.boundsSegments=t.SegmentVector.simpleSegment(0,0,4,2)),this.texture?this.video.paused||(this.texture.bind(n.LINEAR,n.CLAMP_TO_EDGE),n.texSubImage2D(n.TEXTURE_2D,0,0,0,n.RGBA,n.UNSIGNED_BYTE,this.video)):(this.texture=new t.Texture(e,this.video,n.RGBA),this.texture.bind(n.LINEAR,n.CLAMP_TO_EDGE));for(const t in this.tiles){const e=this.tiles[t];"loaded"!==e.state&&(e.state="loaded",e.texture=this.texture)}}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}},image:Tt,canvas:class extends Tt{constructor(e,n,i,r){super(e,n,i,r),n.coordinates?Array.isArray(n.coordinates)&&4===n.coordinates.length&&!n.coordinates.some(t=>!Array.isArray(t)||2!==t.length||t.some(t=>"number"!=typeof t))||this.fire(new t.ErrorEvent(new t.ValidationError("sources."+e,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new t.ErrorEvent(new t.ValidationError("sources."+e,null,'missing required property "coordinates"'))),n.animate&&"boolean"!=typeof n.animate&&this.fire(new t.ErrorEvent(new t.ValidationError("sources."+e,null,'optional "animate" property must be a boolean value'))),n.canvas?"string"==typeof n.canvas||n.canvas instanceof t.window.HTMLCanvasElement||this.fire(new t.ErrorEvent(new t.ValidationError("sources."+e,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new t.ErrorEvent(new t.ValidationError("sources."+e,null,'missing required property "canvas"'))),this.options=n,this.animate=void 0===n.animate||n.animate}load(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof t.window.HTMLCanvasElement?this.options.canvas:t.window.document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new t.ErrorEvent(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())}getCanvas(){return this.canvas}onAdd(t){this.map=t,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let e=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,e=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,e=!0),this._hasInvalidDimensions())return;if(0===Object.keys(this.tiles).length)return;const n=this.map.painter.context,i=n.gl;this.boundsBuffer||(this.boundsBuffer=n.createVertexBuffer(this._boundsArray,Ct.members)),this.boundsSegments||(this.boundsSegments=t.SegmentVector.simpleSegment(0,0,4,2)),this.texture?(e||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new t.Texture(n,this.canvas,i.RGBA,{premultiply:!0});for(const t in this.tiles){const e=this.tiles[t];"loaded"!==e.state&&(e.state="loaded",e.texture=this.texture)}}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const t of[this.canvas.width,this.canvas.height])if(isNaN(t)||t<=0)return!0;return!1}}},Et=function(e,n,i,r){const o=new St[n.type](e,n,i,r);if(o.id!==e)throw new Error(`Expected Source id to be ${e} instead of ${o.id}`);return t.bindAll(["load","abort","unload","serialize","prepare"],o),o};function kt(e,n){const i=t.identity([]);return t.scale$1(i,i,[.5*e.width,.5*-e.height,1]),t.translate(i,i,[1,-1,0]),t.multiply(i,i,e.calculateProjMatrix(n.toUnwrapped()))}function At(t,e,n,i,r,o,s,a=!1){const l=t.tilesIn(i,s,a);l.sort(Pt);const c=[];for(const h of l)c.push({wrappedTileID:h.tile.tileID.wrapped().key,queryResults:h.tile.queryRenderedFeatures(e,n,t._state,h,r,o,kt(t.transform,h.tile.tileID),a)});const u=function(t){const e={},n={};for(const i of t){const t=i.queryResults,r=i.wrappedTileID,o=n[r]=n[r]||{};for(const n in t){const i=t[n],r=o[n]=o[n]||{},s=e[n]=e[n]||[];for(const t of i)r[t.featureIndex]||(r[t.featureIndex]=!0,s.push(t))}}return e}(c);for(const h in u)u[h].forEach(e=>{const n=e.feature,i=t.getFeatureState(n.layer["source-layer"],n.id);n.source=n.layer.source,n.layer["source-layer"]&&(n.sourceLayer=n.layer["source-layer"]),n.state=i});return u}function It(t,e){const n=t.getRenderableIds().map(e=>t.getTileByID(e)),i=[],r={};for(let o=0;o<n.length;o++){const t=n[o],s=t.tileID.canonical.key;r[s]||(r[s]=!0,t.querySourceFeatures(i,e))}return i}function Pt(t,e){const n=t.tileID,i=e.tileID;return n.overscaledZ-i.overscaledZ||n.canonical.y-i.canonical.y||n.wrap-i.wrap||n.canonical.x-i.canonical.x}function Mt(){return null!=Zr.workerClass?new Zr.workerClass:new t.window.Worker(Zr.workerUrl)}const Ot="mapboxgl_preloaded_worker_pool";class zt{constructor(){this.active={}}acquire(t){if(!this.workers)for(this.workers=[];this.workers.length<zt.workerCount;)this.workers.push(new Mt);return this.active[t]=!0,this.workers.slice()}release(t){delete this.active[t],0===this.numActive()&&(this.workers.forEach(t=>{t.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[Ot]}numActive(){return Object.keys(this.active).length}}let Dt;function Lt(){return Dt||(Dt=new zt),Dt}function Rt(e,n){const i={};for(const t in e)"ref"!==t&&(i[t]=e[t]);return t.refProperties.forEach(t=>{t in n&&(i[t]=n[t])}),i}function Ft(t){t=t.slice();const e=Object.create(null);for(let n=0;n<t.length;n++)e[t[n].id]=t[n];for(let n=0;n<t.length;n++)"ref"in t[n]&&(t[n]=Rt(t[n],e[t[n].ref]));return t}zt.workerCount=2;const Bt={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight",setTerrain:"setTerrain",setFog:"setFog"};function Vt(t,e,n){n.push({command:Bt.addSource,args:[t,e[t]]})}function Ut(t,e,n){e.push({command:Bt.removeSource,args:[t]}),n[t]=!0}function Nt(t,e,n,i){Ut(t,n,i),Vt(t,e,n)}function jt(t,e,n){let i;for(i in t[n])if(t[n].hasOwnProperty(i)&&"data"!==i&&!r(t[n][i],e[n][i]))return!1;for(i in e[n])if(e[n].hasOwnProperty(i)&&"data"!==i&&!r(t[n][i],e[n][i]))return!1;return!0}function qt(t,e,n,i,o,s){let a;for(a in e=e||{},t=t||{})t.hasOwnProperty(a)&&(r(t[a],e[a])||n.push({command:s,args:[i,a,e[a],o]}));for(a in e)e.hasOwnProperty(a)&&!t.hasOwnProperty(a)&&(r(t[a],e[a])||n.push({command:s,args:[i,a,e[a],o]}))}function $t(t){return t.id}function Gt(t,e){return t[e.id]=e,t}class Zt{constructor(t,e){this.reset(t,e)}reset(t,e){this.points=t||[],this._distances=[0];for(let n=1;n<this.points.length;n++)this._distances[n]=this._distances[n-1]+this.points[n].dist(this.points[n-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(e||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(e){if(1===this.points.length)return this.points[0];e=t.clamp(e,0,1);let n=1,i=this._distances[n];const r=e*this.paddedLength+this.padding;for(;i<r&&n<this._distances.length;)i=this._distances[++n];const o=n-1,s=this._distances[o],a=i-s,l=a>0?(r-s)/a:0;return this.points[o].mult(1-l).add(this.points[n].mult(l))}}class Ht{constructor(t,e,n){const i=this.boxCells=[],r=this.circleCells=[];this.xCellCount=Math.ceil(t/n),this.yCellCount=Math.ceil(e/n);for(let o=0;o<this.xCellCount*this.yCellCount;o++)i.push([]),r.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=t,this.height=e,this.xScale=this.xCellCount/t,this.yScale=this.yCellCount/e,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(t,e,n,i,r){this._forEachCell(e,n,i,r,this._insertBoxCell,this.boxUid++),this.boxKeys.push(t),this.bboxes.push(e),this.bboxes.push(n),this.bboxes.push(i),this.bboxes.push(r)}insertCircle(t,e,n,i){this._forEachCell(e-i,n-i,e+i,n+i,this._insertCircleCell,this.circleUid++),this.circleKeys.push(t),this.circles.push(e),this.circles.push(n),this.circles.push(i)}_insertBoxCell(t,e,n,i,r,o){this.boxCells[r].push(o)}_insertCircleCell(t,e,n,i,r,o){this.circleCells[r].push(o)}_query(t,e,n,i,r,o){if(n<0||t>this.width||i<0||e>this.height)return!r&&[];const s=[];if(t<=0&&e<=0&&this.width<=n&&this.height<=i){if(r)return!0;for(let t=0;t<this.boxKeys.length;t++)s.push({key:this.boxKeys[t],x1:this.bboxes[4*t],y1:this.bboxes[4*t+1],x2:this.bboxes[4*t+2],y2:this.bboxes[4*t+3]});for(let t=0;t<this.circleKeys.length;t++){const e=this.circles[3*t],n=this.circles[3*t+1],i=this.circles[3*t+2];s.push({key:this.circleKeys[t],x1:e-i,y1:n-i,x2:e+i,y2:n+i})}return o?s.filter(o):s}return this._forEachCell(t,e,n,i,this._queryCell,s,{hitTest:r,seenUids:{box:{},circle:{}}},o),r?s.length>0:s}_queryCircle(t,e,n,i,r){const o=t-n,s=t+n,a=e-n,l=e+n;if(s<0||o>this.width||l<0||a>this.height)return!i&&[];const c=[];return this._forEachCell(o,a,s,l,this._queryCellCircle,c,{hitTest:i,circle:{x:t,y:e,radius:n},seenUids:{box:{},circle:{}}},r),i?c.length>0:c}query(t,e,n,i,r){return this._query(t,e,n,i,!1,r)}hitTest(t,e,n,i,r){return this._query(t,e,n,i,!0,r)}hitTestCircle(t,e,n,i){return this._queryCircle(t,e,n,!0,i)}_queryCell(t,e,n,i,r,o,s,a){const l=s.seenUids,c=this.boxCells[r];if(null!==c){const r=this.bboxes;for(const u of c)if(!l.box[u]){l.box[u]=!0;const c=4*u;if(t<=r[c+2]&&e<=r[c+3]&&n>=r[c+0]&&i>=r[c+1]&&(!a||a(this.boxKeys[u]))){if(s.hitTest)return o.push(!0),!0;o.push({key:this.boxKeys[u],x1:r[c],y1:r[c+1],x2:r[c+2],y2:r[c+3]})}}}const u=this.circleCells[r];if(null!==u){const r=this.circles;for(const c of u)if(!l.circle[c]){l.circle[c]=!0;const u=3*c;if(this._circleAndRectCollide(r[u],r[u+1],r[u+2],t,e,n,i)&&(!a||a(this.circleKeys[c]))){if(s.hitTest)return o.push(!0),!0;{const t=r[u],e=r[u+1],n=r[u+2];o.push({key:this.circleKeys[c],x1:t-n,y1:e-n,x2:t+n,y2:e+n})}}}}}_queryCellCircle(t,e,n,i,r,o,s,a){const l=s.circle,c=s.seenUids,u=this.boxCells[r];if(null!==u){const t=this.bboxes;for(const e of u)if(!c.box[e]){c.box[e]=!0;const n=4*e;if(this._circleAndRectCollide(l.x,l.y,l.radius,t[n+0],t[n+1],t[n+2],t[n+3])&&(!a||a(this.boxKeys[e])))return o.push(!0),!0}}const h=this.circleCells[r];if(null!==h){const t=this.circles;for(const e of h)if(!c.circle[e]){c.circle[e]=!0;const n=3*e;if(this._circlesCollide(t[n],t[n+1],t[n+2],l.x,l.y,l.radius)&&(!a||a(this.circleKeys[e])))return o.push(!0),!0}}}_forEachCell(t,e,n,i,r,o,s,a){const l=this._convertToXCellCoord(t),c=this._convertToYCellCoord(e),u=this._convertToXCellCoord(n),h=this._convertToYCellCoord(i);for(let d=l;d<=u;d++)for(let l=c;l<=h;l++)if(r.call(this,t,e,n,i,this.xCellCount*l+d,o,s,a))return}_convertToXCellCoord(t){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(t*this.xScale)))}_convertToYCellCoord(t){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(t*this.yScale)))}_circlesCollide(t,e,n,i,r,o){const s=i-t,a=r-e,l=n+o;return l*l>s*s+a*a}_circleAndRectCollide(t,e,n,i,r,o,s){const a=(o-i)/2,l=Math.abs(t-(i+a));if(l>a+n)return!1;const c=(s-r)/2,u=Math.abs(e-(r+c));if(u>c+n)return!1;if(l<=a||u<=c)return!0;const h=l-a,d=u-c;return h*h+d*d<=n*n}}function Wt(e,n,i,r,o){const s=t.create$1();return n?(t.scale$1(s,s,[1/o,1/o,1]),i||t.rotateZ(s,s,r.angle)):t.multiply(s,r.labelPlaneMatrix,e),s}function Xt(e,n,i,r,o){if(n){const n=t.clone$1(e);return t.scale$1(n,n,[o,o,1]),i||t.rotateZ(n,n,-r.angle),n}return r.glCoordMatrix}function Kt(e,n,i=0){const r=[e.x,e.y,i,1];i?t.transformMat4(r,r,n):ae(r,r,n);const o=r[3];return{point:new t.pointGeometry(r[0]/o,r[1]/o),signedDistanceFromCamera:o}}function Yt(t,e){return Math.min(.5+t/e*.5,1.5)}function Jt(t,e){const n=t[0]/t[3],i=t[1]/t[3];return n>=-e[0]&&n<=e[0]&&i>=-e[1]&&i<=e[1]}function Qt(e,n,i,r,o,s,a,l,c){const u=r?e.textSizeData:e.iconSizeData,h=t.evaluateSizeForZoom(u,i.transform.zoom),d=[256/i.width*2+1,256/i.height*2+1],p=r?e.text.dynamicLayoutVertexArray:e.icon.dynamicLayoutVertexArray;p.clear();const f=e.lineVertexArray,m=r?e.text.placedSymbolArray:e.icon.placedSymbolArray,g=i.transform.width/i.transform.height;let _=!1;for(let y=0;y<m.length;y++){const r=m.get(y);if(r.hidden||r.writingMode===t.WritingMode.vertical&&!_){se(r.numGlyphs,p);continue}_=!1;const v=c?c({x:r.anchorX,y:r.anchorY}):0,x=[r.anchorX,r.anchorY,v,1];if(t.transformMat4(x,x,n),!Jt(x,d)){se(r.numGlyphs,p);continue}const b=Yt(i.transform.cameraToCenterDistance,x[3]),w=t.evaluateSizeForFeature(u,h,r),C=a?w/b:w*b,T=new t.pointGeometry(r.anchorX,r.anchorY),S=Kt(T,o,v);if(S.signedDistanceFromCamera<=0){se(r.numGlyphs,p);continue}const E=S.point;let k={};const A=a?null:c,I=ne(r,C,!1,l,n,o,s,e.glyphOffsetArray,f,p,E,T,k,g,A);_=I.useVertical,A&&I.needsFlipping&&(k={}),(I.notEnoughRoom||_||I.needsFlipping&&ne(r,C,!0,l,n,o,s,e.glyphOffsetArray,f,p,E,T,k,g,A).notEnoughRoom)&&se(r.numGlyphs,p)}r?e.text.dynamicLayoutVertexBuffer.updateData(p):e.icon.dynamicLayoutVertexBuffer.updateData(p)}function te(t,e,n,i,r,o,s,a,l,c,u,h,d){const p=a.glyphStartIndex+a.numGlyphs,f=a.lineStartIndex,m=a.lineStartIndex+a.lineLength,g=e.getoffsetX(a.glyphStartIndex),_=e.getoffsetX(p-1),y=re(t*g,n,i,r,o,s,a.segment,f,m,l,c,u,h,d,!0);if(!y)return null;const v=re(t*_,n,i,r,o,s,a.segment,f,m,l,c,u,h,d,!0);return v?{first:y,last:v}:null}function ee(e,n,i,r){return e===t.WritingMode.horizontal&&Math.abs(i.y-n.y)>Math.abs(i.x-n.x)*r?{useVertical:!0}:(e===t.WritingMode.vertical?n.y<i.y:n.x>i.x)?{needsFlipping:!0}:null}function ne(e,n,i,r,o,s,a,l,c,u,h,d,p,f,m){const g=n/24,_=e.lineOffsetX*g,y=e.lineOffsetY*g;let v;if(e.numGlyphs>1){const t=e.glyphStartIndex+e.numGlyphs,n=e.lineStartIndex,o=e.lineStartIndex+e.lineLength,u=te(g,l,_,y,i,h,d,e,c,s,p,m);if(!u)return{notEnoughRoom:!0};const x=Kt(u.first.point,a).point,b=Kt(u.last.point,a).point;if(r&&!i){const t=ee(e.writingMode,x,b,f);if(t)return t}v=[u.first];for(let r=e.glyphStartIndex+1;r<t-1;r++)v.push(re(g*l.getoffsetX(r),_,y,i,h,d,e.segment,n,o,c,s,p,m));v.push(u.last)}else{if(r&&!i){const n=Kt(d,o).point,i=e.lineStartIndex+e.segment+1,r=new t.pointGeometry(c.getx(i),c.gety(i)),s=Kt(r,o),a=s.signedDistanceFromCamera>0?s.point:ie(d,r,n,1,o),l=ee(e.writingMode,n,a,f);if(l)return l}const n=re(g*l.getoffsetX(e.glyphStartIndex),_,y,i,h,d,e.segment,e.lineStartIndex,e.lineStartIndex+e.lineLength,c,s,p,m);if(!n)return{notEnoughRoom:!0};v=[n]}for(const x of v)t.addDynamicAttributes(u,x.point,x.angle);return{}}function ie(t,e,n,i,r,o){const s=t.add(t.sub(e)._unit()),a=Kt(s,r,o?o(s):0).point,l=n.sub(a);return n.add(l._mult(i/l.mag()))}function re(e,n,i,r,o,s,a,l,c,u,h,d,p,f,m){const g=r?e-n:e+n;let _=g>0?1:-1,y=0;r&&(_*=-1,y=Math.PI),_<0&&(y+=Math.PI);let v=_>0?l+a:l+a+1,x=o,b=o,w=0,C=0;const T=Math.abs(g),S=[],E=[];let k=s;const A=()=>{const e=v-_;return 0===w?s:new t.pointGeometry(u.getx(e),u.gety(e))},I=()=>ie(A(),k,b,T-w+1,h,p);for(;w+C<=T;){if(v+=_,v<l||v>=c)return null;if(b=x,S.push(x),f&&E.push(k||A()),x=d[v],void 0===x){k=new t.pointGeometry(u.getx(v),u.gety(v));const e=Kt(k,h,p?p(k):0);x=e.signedDistanceFromCamera>0?d[v]=e.point:I()}else k=null;w+=C,C=b.dist(x)}m&&p&&(k=k||new t.pointGeometry(u.getx(v),u.gety(v)),d[v]=x=void 0===d[v]?x:I(),C=b.dist(x));const P=(T-w)/C,M=x.sub(b),O=M.mult(P)._add(b);i&&O._add(M._unit()._perp()._mult(i*_));const z=y+Math.atan2(x.y-b.y,x.x-b.x);return S.push(O),f&&(k=k||new t.pointGeometry(u.getx(v),u.gety(v)),E.push(function(e,n,i){const r=1-i;return new t.pointGeometry(e.x*r+n.x*i,e.y*r+n.y*i)}(E.length>0?E[E.length-1]:k,k,P))),{point:O,angle:z,path:S,tilePath:E}}const oe=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function se(t,e){for(let n=0;n<t;n++){const t=e.length;e.resize(t+4),e.float32.set(oe,3*t)}}function ae(t,e,n){const i=e[0],r=e[1];return t[0]=n[0]*i+n[4]*r+n[12],t[1]=n[1]*i+n[5]*r+n[13],t[3]=n[3]*i+n[7]*r+n[15],t}const le=100;class ce{constructor(t,e,n=new Ht(t.width+200,t.height+200,25),i=new Ht(t.width+200,t.height+200,25)){this.transform=t,this.grid=n,this.ignoredGrid=i,this.pitchfactor=Math.cos(t._pitch)*t.cameraToCenterDistance,this.screenRightBoundary=t.width+le,this.screenBottomBoundary=t.height+le,this.gridRightBoundary=t.width+200,this.gridBottomBoundary=t.height+200,this.fogState=e}placeCollisionBox(t,e,n,i,r,o,s){const a=this.projectAndGetPerspectiveRatio(o,e.anchorPointX,e.anchorPointY,e.elevation,e.tileID),l=r*a.perspectiveRatio,c=(e.x1*t+n.x-e.padding)*l+a.point.x,u=(e.y1*t+n.y-e.padding)*l+a.point.y,h=(e.x2*t+n.x+e.padding)*l+a.point.x,d=(e.y2*t+n.y+e.padding)*l+a.point.y,p=a.perspectiveRatio<=.55||a.aboveHorizon;return!this.isInsideGrid(c,u,h,d)||!i&&this.grid.hitTest(c,u,h,d,s)||p?{box:[],offscreen:!1}:{box:[c,u,h,d],offscreen:this.isOffscreen(c,u,h,d)}}placeCollisionCircles(e,n,i,r,o,s,a,l,c,u,h,d,p,f){const m=[],g=this.transform.elevation,_=g?t=>g.getAtTileOffset(f,t.x,t.y):t=>0,y=new t.pointGeometry(n.anchorX,n.anchorY),v=_(y),x=this.projectAndGetPerspectiveRatio(s,y.x,y.y,v,f),{perspectiveRatio:b}=x,w=(u?o/b:o*b)/t.ONE_EM,C=Kt(y,a,v).point,T=x.signedDistanceFromCamera>0?te(w,r,n.lineOffsetX*w,n.lineOffsetY*w,!1,C,y,n,i,a,{},g&&!u?_:null,u&&!!g):null;let S=!1,E=!1,k=!0;if(T&&!x.aboveHorizon){const n=.5*d*b+p,i=new t.pointGeometry(-100,-100),r=new t.pointGeometry(this.screenRightBoundary,this.screenBottomBoundary),o=new Zt,s=T.first,a=T.last;let u=[];for(let t=s.path.length-1;t>=1;t--)u.push(s.path[t]);for(let t=1;t<a.path.length;t++)u.push(a.path[t]);const f=2.5*n;if(l){const t=u.map(g?(t,e)=>{const n=_(e<s.path.length-1?s.tilePath[s.path.length-1-e]:a.tilePath[e-s.path.length+2]);return Kt(t,l,n)}:t=>Kt(t,l));u=t.some(t=>t.signedDistanceFromCamera<=0)?[]:t.map(t=>t.point)}let y=[];if(u.length>0){const e=u[0].clone(),n=u[0].clone();for(let t=1;t<u.length;t++)e.x=Math.min(e.x,u[t].x),e.y=Math.min(e.y,u[t].y),n.x=Math.max(n.x,u[t].x),n.y=Math.max(n.y,u[t].y);y=e.x>=i.x&&n.x<=r.x&&e.y>=i.y&&n.y<=r.y?[u]:n.x<i.x||e.x>r.x||n.y<i.y||e.y>r.y?[]:t.clipLine([u],i.x,i.y,r.x,r.y)}for(const t of y){o.reset(t,.25*n);let i=0;i=o.length<=.5*n?1:Math.ceil(o.paddedLength/f)+1;for(let t=0;t<i;t++){const r=t/Math.max(i-1,1),s=o.lerp(r),a=s.x+le,l=s.y+le;m.push(a,l,n,0);const u=a-n,d=l-n,p=a+n,f=l+n;if(k=k&&this.isOffscreen(u,d,p,f),E=E||this.isInsideGrid(u,d,p,f),!e&&this.grid.hitTestCircle(a,l,n,h)&&(S=!0,!c))return{circles:[],offscreen:!1,collisionDetected:S}}}}return{circles:!c&&S||!E?[]:m,offscreen:k,collisionDetected:S}}queryRenderedSymbols(e){if(0===e.length||0===this.grid.keysLength()&&0===this.ignoredGrid.keysLength())return{};const n=[];let i=1/0,r=1/0,o=-1/0,s=-1/0;for(const u of e){const e=new t.pointGeometry(u.x+le,u.y+le);i=Math.min(i,e.x),r=Math.min(r,e.y),o=Math.max(o,e.x),s=Math.max(s,e.y),n.push(e)}const a=this.grid.query(i,r,o,s).concat(this.ignoredGrid.query(i,r,o,s)),l={},c={};for(const u of a){const e=u.key;if(void 0===l[e.bucketInstanceId]&&(l[e.bucketInstanceId]={}),l[e.bucketInstanceId][e.featureIndex])continue;const i=[new t.pointGeometry(u.x1,u.y1),new t.pointGeometry(u.x2,u.y1),new t.pointGeometry(u.x2,u.y2),new t.pointGeometry(u.x1,u.y2)];t.polygonIntersectsPolygon(n,i)&&(l[e.bucketInstanceId][e.featureIndex]=!0,void 0===c[e.bucketInstanceId]&&(c[e.bucketInstanceId]=[]),c[e.bucketInstanceId].push(e.featureIndex))}return c}insertCollisionBox(t,e,n,i,r){(e?this.ignoredGrid:this.grid).insert({bucketInstanceId:n,featureIndex:i,collisionGroupID:r},t[0],t[1],t[2],t[3])}insertCollisionCircles(t,e,n,i,r){const o=e?this.ignoredGrid:this.grid,s={bucketInstanceId:n,featureIndex:i,collisionGroupID:r};for(let a=0;a<t.length;a+=4)o.insertCircle(s,t[a],t[a+1],t[a+2])}projectAndGetPerspectiveRatio(e,n,i,r,o){const s=[n,i,r||0,1];let a=!1;if(r||this.transform.pitch>0){t.transformMat4(s,s,e);let l=!1;this.fogState&&o&&(l=function(e,n,i,r,o,s){const a=s.calculateFogTileMatrix(o),l=[n,i,r];return t.transformMat4$1(l,l,a),C(e,l,s.pitch,s._fov)}(this.fogState,n,i,r||0,o.toUnwrapped(),this.transform)>.9),a=s[2]>s[3]||l}else ae(s,s,e);return{point:new t.pointGeometry((s[0]/s[3]+1)/2*this.transform.width+le,(-s[1]/s[3]+1)/2*this.transform.height+le),perspectiveRatio:Math.min(.5+this.transform.cameraToCenterDistance/s[3]*.5,1.5),signedDistanceFromCamera:s[3],aboveHorizon:a}}isOffscreen(t,e,n,i){return n<le||t>=this.screenRightBoundary||i<le||e>this.screenBottomBoundary}isInsideGrid(t,e,n,i){return n>=0&&t<this.gridRightBoundary&&i>=0&&e<this.gridBottomBoundary}getViewportMatrix(){const e=t.identity([]);return t.translate(e,e,[-100,-100,0]),e}}class ue{constructor(t,e,n,i){this.opacity=t?Math.max(0,Math.min(1,t.opacity+(t.placed?e:-e))):i&&n?1:0,this.placed=n}isHidden(){return 0===this.opacity&&!this.placed}}class he{constructor(t,e,n,i,r){this.text=new ue(t?t.text:null,e,n,r),this.icon=new ue(t?t.icon:null,e,i,r)}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class de{constructor(t,e,n){this.text=t,this.icon=e,this.skipFade=n}}class pe{constructor(){this.invProjMatrix=t.create$1(),this.viewportMatrix=t.create$1(),this.circles=[]}}class fe{constructor(t,e,n,i,r){this.bucketInstanceId=t,this.featureIndex=e,this.sourceLayerIndex=n,this.bucketIndex=i,this.tileID=r}}class me{constructor(t){this.crossSourceCollisions=t,this.maxGroupID=0,this.collisionGroups={}}get(t){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[t]){const e=++this.maxGroupID;this.collisionGroups[t]={ID:e,predicate:t=>t.collisionGroupID===e}}return this.collisionGroups[t]}}function ge(e,n,i,r,o){const{horizontalAlign:s,verticalAlign:a}=t.getAnchorAlignment(e),l=-(s-.5)*n,c=-(a-.5)*i,u=t.evaluateVariableOffset(e,r);return new t.pointGeometry(l+u[0]*o,c+u[1]*o)}function _e(e,n,i,r,o){const s=new t.pointGeometry(e,n);return i&&s._rotate(r?o:-o),s}class ye{constructor(t,e,n,i,r){this.transform=t.clone(),this.collisionIndex=new ce(this.transform,r),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=e,this.retainedQueryData={},this.collisionGroups=new me(n),this.collisionCircleArrays={},this.prevPlacement=i,i&&(i.prevPlacement=void 0),this.placedOrientations={}}getBucketParts(e,n,i,r){const o=i.getBucket(n),s=i.latestFeatureIndex;if(!o||!s||n.id!==o.layerIds[0])return;const a=i.collisionBoxArray,l=o.layers[0].layout,c=Math.pow(2,this.transform.zoom-i.tileID.overscaledZ),u=i.tileSize/t.EXTENT,h=this.transform.calculateProjMatrix(i.tileID.toUnwrapped()),d="map"===l.get("text-pitch-alignment"),p="map"===l.get("text-rotation-alignment"),f=I(i,1,this.transform.zoom),m=Wt(h,d,p,this.transform,f);let g=null;if(d){const e=Xt(h,d,p,this.transform,f);g=t.multiply([],this.transform.labelPlaneMatrix,e)}this.retainedQueryData[o.bucketInstanceId]=new fe(o.bucketInstanceId,s,o.sourceLayerIndex,o.index,i.tileID);const _={bucket:o,layout:l,posMatrix:h,textLabelPlaneMatrix:m,labelToScreenMatrix:g,scale:c,textPixelRatio:u,holdingForFade:i.holdingForFade(),collisionBoxArray:a,partiallyEvaluatedTextSize:t.evaluateSizeForZoom(o.textSizeData,this.transform.zoom),partiallyEvaluatedIconSize:t.evaluateSizeForZoom(o.iconSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(o.sourceID)};if(r)for(const t of o.sortKeyRanges){const{sortKey:n,symbolInstanceStart:i,symbolInstanceEnd:r}=t;e.push({sortKey:n,symbolInstanceStart:i,symbolInstanceEnd:r,parameters:_})}else e.push({symbolInstanceStart:0,symbolInstanceEnd:o.symbolInstances.length,parameters:_})}attemptAnchorPlacement(t,e,n,i,r,o,s,a,l,c,u,h,d,p,f,m,g,_){const y=[h.textOffset0,h.textOffset1],v=p.getSymbolInstanceTextSize(g,h,this.transform.zoom,d),x=ge(t,n,i,y,r),b=this.collisionIndex.placeCollisionBox(v,e,_e(x.x,x.y,o,s,this.transform.angle),u,a,l,c.predicate);if((!m||0!==this.collisionIndex.placeCollisionBox(p.getSymbolInstanceIconSize(_,this.transform.zoom,d),m,_e(x.x,x.y,o,s,this.transform.angle),u,a,l,c.predicate).box.length)&&b.box.length>0){let e;return this.prevPlacement&&this.prevPlacement.variableOffsets[h.crossTileID]&&this.prevPlacement.placements[h.crossTileID]&&this.prevPlacement.placements[h.crossTileID].text&&(e=this.prevPlacement.variableOffsets[h.crossTileID].anchor),this.variableOffsets[h.crossTileID]={textOffset:y,width:n,height:i,anchor:t,textBoxScale:r,prevAnchor:e},this.markUsedJustification(p,t,h,f),p.allowVerticalPlacement&&(this.markUsedOrientation(p,f,h),this.placedOrientations[h.crossTileID]=f),{shift:x,placedGlyphBoxes:b}}}placeLayerBucketPart(e,n,i){const{bucket:r,layout:o,posMatrix:s,textLabelPlaneMatrix:a,labelToScreenMatrix:l,textPixelRatio:c,holdingForFade:u,collisionBoxArray:h,partiallyEvaluatedTextSize:d,partiallyEvaluatedIconSize:p,collisionGroup:f}=e.parameters,m=o.get("text-optional"),g=o.get("icon-optional"),_=o.get("text-allow-overlap"),y=o.get("icon-allow-overlap"),v="map"===o.get("text-rotation-alignment"),x="map"===o.get("text-pitch-alignment"),b="none"!==o.get("icon-text-fit"),w="viewport-y"===o.get("symbol-z-order"),C=_&&(y||!r.hasIconData()||g),T=y&&(_||!r.hasTextData()||m);!r.collisionArrays&&h&&r.deserializeCollisionBoxes(h),i&&r.updateCollisionDebugBuffers(this.transform.zoom,h);const S=(e,h,w)=>{if(n[e.crossTileID])return;if(u)return void(this.placements[e.crossTileID]=new de(!1,!1,!1));let S=!1,E=!1,k=!0,A=null,I={box:null,offscreen:null},P={box:null,offscreen:null},M=null,O=null,z=null,D=0,L=0,R=0;w.textFeatureIndex?D=w.textFeatureIndex:e.useRuntimeCollisionCircles&&(D=e.featureIndex),w.verticalTextFeatureIndex&&(L=w.verticalTextFeatureIndex);const F=t=>{t.tileID=this.retainedQueryData[r.bucketInstanceId].tileID,(this.transform.elevation||t.elevation)&&(t.elevation=this.transform.elevation?this.transform.elevation.getAtTileOffset(this.retainedQueryData[r.bucketInstanceId].tileID,t.anchorPointX,t.anchorPointY):0)},B=w.textBox;if(B){F(B);const n=n=>{let i=t.WritingMode.horizontal;if(r.allowVerticalPlacement&&!n&&this.prevPlacement){const t=this.prevPlacement.placedOrientations[e.crossTileID];t&&(this.placedOrientations[e.crossTileID]=t,i=t,this.markUsedOrientation(r,i,e))}return i},i=(n,i)=>{if(r.allowVerticalPlacement&&e.numVerticalGlyphVertices>0&&w.verticalTextBox){for(const e of r.writingModes)if(e===t.WritingMode.vertical?(I=i(),P=I):I=n(),I&&I.box&&I.box.length)break}else I=n()};if(o.get("text-variable-anchor")){let a=o.get("text-variable-anchor");if(this.prevPlacement&&this.prevPlacement.variableOffsets[e.crossTileID]){const t=this.prevPlacement.variableOffsets[e.crossTileID];a.indexOf(t.anchor)>0&&(a=a.filter(e=>e!==t.anchor),a.unshift(t.anchor))}const l=(t,n,i)=>{const o=e.textBoxScale,l=(t.x2-t.x1)*o+2*t.padding,u=(t.y2-t.y1)*o+2*t.padding,m=b&&!y?n:null;m&&F(m);let g={box:[],offscreen:!1};const w=_?2*a.length:a.length;for(let _=0;_<w;++_){const n=this.attemptAnchorPlacement(a[_%a.length],t,l,u,o,v,x,c,s,f,_>=a.length,e,h,r,i,m,d,p);if(n&&(g=n.placedGlyphBoxes,g&&g.box&&g.box.length)){S=!0,A=n.shift;break}}return g};i(()=>l(B,w.iconBox,t.WritingMode.horizontal),()=>{const n=w.verticalTextBox;return n&&F(n),r.allowVerticalPlacement&&!(I&&I.box&&I.box.length)&&e.numVerticalGlyphVertices>0&&n?l(n,w.verticalIconBox,t.WritingMode.vertical):{box:null,offscreen:null}}),I&&(S=I.box,k=I.offscreen);const u=n(I&&I.box);if(!S&&this.prevPlacement){const t=this.prevPlacement.variableOffsets[e.crossTileID];t&&(this.variableOffsets[e.crossTileID]=t,this.markUsedJustification(r,t.anchor,e,u))}}else{const o=(n,i)=>{const o=r.getSymbolInstanceTextSize(d,e,this.transform.zoom,h),a=this.collisionIndex.placeCollisionBox(o,n,new t.pointGeometry(0,0),_,c,s,f.predicate);return a&&a.box&&a.box.length&&(this.markUsedOrientation(r,i,e),this.placedOrientations[e.crossTileID]=i),a};i(()=>o(B,t.WritingMode.horizontal),()=>{const n=w.verticalTextBox;return r.allowVerticalPlacement&&e.numVerticalGlyphVertices>0&&n?(F(n),o(n,t.WritingMode.vertical)):{box:null,offscreen:null}}),n(I&&I.box&&I.box.length)}}if(M=I,S=M&&M.box&&M.box.length>0,k=M&&M.offscreen,e.useRuntimeCollisionCircles){const n=r.text.placedSymbolArray.get(e.centerJustifiedTextSymbolIndex),c=t.evaluateSizeForFeature(r.textSizeData,d,n),u=o.get("text-padding");O=this.collisionIndex.placeCollisionCircles(_,n,r.lineVertexArray,r.glyphOffsetArray,c,s,a,l,i,x,f.predicate,e.collisionCircleDiameter,u,this.retainedQueryData[r.bucketInstanceId].tileID),S=_||O.circles.length>0&&!O.collisionDetected,k=k&&O.offscreen}if(w.iconFeatureIndex&&(R=w.iconFeatureIndex),w.iconBox){const e=e=>{F(e);const n=b&&A?_e(A.x,A.y,v,x,this.transform.angle):new t.pointGeometry(0,0),i=r.getSymbolInstanceIconSize(p,this.transform.zoom,h);return this.collisionIndex.placeCollisionBox(i,e,n,y,c,s,f.predicate)};P&&P.box&&P.box.length&&w.verticalIconBox?(z=e(w.verticalIconBox),E=z.box.length>0):(z=e(w.iconBox),E=z.box.length>0),k=k&&z.offscreen}const V=m||0===e.numHorizontalGlyphVertices&&0===e.numVerticalGlyphVertices,U=g||0===e.numIconVertices;if(V||U?U?V||(E=E&&S):S=E&&S:E=S=E&&S,S&&M&&M.box&&this.collisionIndex.insertCollisionBox(M.box,o.get("text-ignore-placement"),r.bucketInstanceId,P&&P.box&&L?L:D,f.ID),E&&z&&this.collisionIndex.insertCollisionBox(z.box,o.get("icon-ignore-placement"),r.bucketInstanceId,R,f.ID),O&&(S&&this.collisionIndex.insertCollisionCircles(O.circles,o.get("text-ignore-placement"),r.bucketInstanceId,D,f.ID),i)){const t=r.bucketInstanceId;let e=this.collisionCircleArrays[t];void 0===e&&(e=this.collisionCircleArrays[t]=new pe);for(let n=0;n<O.circles.length;n+=4)e.circles.push(O.circles[n+0]),e.circles.push(O.circles[n+1]),e.circles.push(O.circles[n+2]),e.circles.push(O.collisionDetected?1:0)}this.placements[e.crossTileID]=new de(S||C,E||T,k||r.justReloaded),n[e.crossTileID]=!0};if(w){const t=r.getSortedSymbolIndexes(this.transform.angle);for(let e=t.length-1;e>=0;--e){const n=t[e];S(r.symbolInstances.get(n),n,r.collisionArrays[n])}}else for(let t=e.symbolInstanceStart;t<e.symbolInstanceEnd;t++)S(r.symbolInstances.get(t),t,r.collisionArrays[t]);if(i&&r.bucketInstanceId in this.collisionCircleArrays){const e=this.collisionCircleArrays[r.bucketInstanceId];t.invert(e.invProjMatrix,s),e.viewportMatrix=this.collisionIndex.getViewportMatrix()}r.justReloaded=!1}markUsedJustification(e,n,i,r){let o;o=r===t.WritingMode.vertical?i.verticalPlacedTextSymbolIndex:{left:i.leftJustifiedTextSymbolIndex,center:i.centerJustifiedTextSymbolIndex,right:i.rightJustifiedTextSymbolIndex}[t.getAnchorJustification(n)];const s=[i.leftJustifiedTextSymbolIndex,i.centerJustifiedTextSymbolIndex,i.rightJustifiedTextSymbolIndex,i.verticalPlacedTextSymbolIndex];for(const t of s)t>=0&&(e.text.placedSymbolArray.get(t).crossTileID=o>=0&&t!==o?0:i.crossTileID)}markUsedOrientation(e,n,i){const r=n===t.WritingMode.horizontal||n===t.WritingMode.horizontalOnly?n:0,o=n===t.WritingMode.vertical?n:0,s=[i.leftJustifiedTextSymbolIndex,i.centerJustifiedTextSymbolIndex,i.rightJustifiedTextSymbolIndex];for(const t of s)e.text.placedSymbolArray.get(t).placedOrientation=r;i.verticalPlacedTextSymbolIndex&&(e.text.placedSymbolArray.get(i.verticalPlacedTextSymbolIndex).placedOrientation=o)}commit(t){this.commitTime=t,this.zoomAtLastRecencyCheck=this.transform.zoom;const e=this.prevPlacement;let n=!1;this.prevZoomAdjustment=e?e.zoomAdjustment(this.transform.zoom):0;const i=e?e.symbolFadeChange(t):1,r=e?e.opacities:{},o=e?e.variableOffsets:{},s=e?e.placedOrientations:{};for(const a in this.placements){const t=this.placements[a],e=r[a];e?(this.opacities[a]=new he(e,i,t.text,t.icon),n=n||t.text!==e.text.placed||t.icon!==e.icon.placed):(this.opacities[a]=new he(null,i,t.text,t.icon,t.skipFade),n=n||t.text||t.icon)}for(const a in r){const t=r[a];if(!this.opacities[a]){const e=new he(t,i,!1,!1);e.isHidden()||(this.opacities[a]=e,n=n||t.text.placed||t.icon.placed)}}for(const a in o)this.variableOffsets[a]||!this.opacities[a]||this.opacities[a].isHidden()||(this.variableOffsets[a]=o[a]);for(const a in s)this.placedOrientations[a]||!this.opacities[a]||this.opacities[a].isHidden()||(this.placedOrientations[a]=s[a]);n?this.lastPlacementChangeTime=t:"number"!=typeof this.lastPlacementChangeTime&&(this.lastPlacementChangeTime=e?e.lastPlacementChangeTime:t)}updateLayerOpacities(t,e){const n={};for(const i of e){const e=i.getBucket(t);e&&i.latestFeatureIndex&&t.id===e.layerIds[0]&&this.updateBucketOpacities(e,n,i.collisionBoxArray)}}updateBucketOpacities(e,n,i){e.hasTextData()&&e.text.opacityVertexArray.clear(),e.hasIconData()&&e.icon.opacityVertexArray.clear(),e.hasIconCollisionBoxData()&&e.iconCollisionBox.collisionVertexArray.clear(),e.hasTextCollisionBoxData()&&e.textCollisionBox.collisionVertexArray.clear();const r=e.layers[0].layout,o=new he(null,0,!1,!1,!0),s=r.get("text-allow-overlap"),a=r.get("icon-allow-overlap"),l=r.get("text-variable-anchor"),c="map"===r.get("text-rotation-alignment"),u="map"===r.get("text-pitch-alignment"),h="none"!==r.get("icon-text-fit"),d=new he(null,0,s&&(a||!e.hasIconData()||r.get("icon-optional")),a&&(s||!e.hasTextData()||r.get("text-optional")),!0);!e.collisionArrays&&i&&(e.hasIconCollisionBoxData()||e.hasTextCollisionBoxData())&&e.deserializeCollisionBoxes(i);const p=(t,e,n)=>{for(let i=0;i<e/4;i++)t.opacityVertexArray.emplaceBack(n)};for(let f=0;f<e.symbolInstances.length;f++){const i=e.symbolInstances.get(f),{numHorizontalGlyphVertices:r,numVerticalGlyphVertices:s,crossTileID:a}=i;let m=this.opacities[a];n[a]?m=o:m||(m=d,this.opacities[a]=m),n[a]=!0;const g=i.numIconVertices>0,_=this.placedOrientations[i.crossTileID],y=_===t.WritingMode.vertical,v=_===t.WritingMode.horizontal||_===t.WritingMode.horizontalOnly;if(r>0||s>0){const t=ke(m.text);p(e.text,r,y?Ae:t),p(e.text,s,v?Ae:t);const n=m.text.isHidden();[i.rightJustifiedTextSymbolIndex,i.centerJustifiedTextSymbolIndex,i.leftJustifiedTextSymbolIndex].forEach(t=>{t>=0&&(e.text.placedSymbolArray.get(t).hidden=n||y?1:0)}),i.verticalPlacedTextSymbolIndex>=0&&(e.text.placedSymbolArray.get(i.verticalPlacedTextSymbolIndex).hidden=n||v?1:0);const o=this.variableOffsets[i.crossTileID];o&&this.markUsedJustification(e,o.anchor,i,_);const a=this.placedOrientations[i.crossTileID];a&&(this.markUsedJustification(e,"left",i,a),this.markUsedOrientation(e,a,i))}if(g){const t=ke(m.icon),n=!(h&&i.verticalPlacedIconSymbolIndex&&y);i.placedIconSymbolIndex>=0&&(p(e.icon,i.numIconVertices,n?t:Ae),e.icon.placedSymbolArray.get(i.placedIconSymbolIndex).hidden=m.icon.isHidden()),i.verticalPlacedIconSymbolIndex>=0&&(p(e.icon,i.numVerticalIconVertices,n?Ae:t),e.icon.placedSymbolArray.get(i.verticalPlacedIconSymbolIndex).hidden=m.icon.isHidden())}if(e.hasIconCollisionBoxData()||e.hasTextCollisionBoxData()){const n=e.collisionArrays[f];if(n){let i=new t.pointGeometry(0,0);if(n.textBox||n.verticalTextBox){let t=!0;if(l){const e=this.variableOffsets[a];e?(i=ge(e.anchor,e.width,e.height,e.textOffset,e.textBoxScale),c&&i._rotate(u?this.transform.angle:-this.transform.angle)):t=!1}n.textBox&&ve(e.textCollisionBox.collisionVertexArray,m.text.placed,!t||y,i.x,i.y),n.verticalTextBox&&ve(e.textCollisionBox.collisionVertexArray,m.text.placed,!t||v,i.x,i.y)}const r=Boolean(!v&&n.verticalIconBox);n.iconBox&&ve(e.iconCollisionBox.collisionVertexArray,m.icon.placed,r,h?i.x:0,h?i.y:0),n.verticalIconBox&&ve(e.iconCollisionBox.collisionVertexArray,m.icon.placed,!r,h?i.x:0,h?i.y:0)}}}if(e.sortFeatures(this.transform.angle),this.retainedQueryData[e.bucketInstanceId]&&(this.retainedQueryData[e.bucketInstanceId].featureSortOrder=e.featureSortOrder),e.hasTextData()&&e.text.opacityVertexBuffer&&e.text.opacityVertexBuffer.updateData(e.text.opacityVertexArray),e.hasIconData()&&e.icon.opacityVertexBuffer&&e.icon.opacityVertexBuffer.updateData(e.icon.opacityVertexArray),e.hasIconCollisionBoxData()&&e.iconCollisionBox.collisionVertexBuffer&&e.iconCollisionBox.collisionVertexBuffer.updateData(e.iconCollisionBox.collisionVertexArray),e.hasTextCollisionBoxData()&&e.textCollisionBox.collisionVertexBuffer&&e.textCollisionBox.collisionVertexBuffer.updateData(e.textCollisionBox.collisionVertexArray),e.bucketInstanceId in this.collisionCircleArrays){const t=this.collisionCircleArrays[e.bucketInstanceId];e.placementInvProjMatrix=t.invProjMatrix,e.placementViewportMatrix=t.viewportMatrix,e.collisionCircleArray=t.circles,delete this.collisionCircleArrays[e.bucketInstanceId]}}symbolFadeChange(t){return 0===this.fadeDuration?1:(t-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(t){return Math.max(0,(this.transform.zoom-t)/1.5)}hasTransitions(t){return this.stale||t-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(t,e){const n=this.zoomAtLastRecencyCheck===e?1-this.zoomAdjustment(e):1;return this.zoomAtLastRecencyCheck=e,this.commitTime+this.fadeDuration*n>t}setStale(){this.stale=!0}}function ve(t,e,n,i,r){t.emplaceBack(e?1:0,n?1:0,i||0,r||0),t.emplaceBack(e?1:0,n?1:0,i||0,r||0),t.emplaceBack(e?1:0,n?1:0,i||0,r||0),t.emplaceBack(e?1:0,n?1:0,i||0,r||0)}const xe=Math.pow(2,25),be=Math.pow(2,24),we=Math.pow(2,17),Ce=Math.pow(2,16),Te=Math.pow(2,9),Se=Math.pow(2,8),Ee=Math.pow(2,1);function ke(t){if(0===t.opacity&&!t.placed)return 0;if(1===t.opacity&&t.placed)return 4294967295;const e=t.placed?1:0,n=Math.floor(127*t.opacity);return n*xe+e*be+n*we+e*Ce+n*Te+e*Se+n*Ee+e}const Ae=0;class Ie{constructor(t){this._sortAcrossTiles="viewport-y"!==t.layout.get("symbol-z-order")&&void 0!==t.layout.get("symbol-sort-key").constantOr(1),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]}continuePlacement(t,e,n,i,r){const o=this._bucketParts;for(;this._currentTileIndex<t.length;)if(e.getBucketParts(o,i,t[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,r())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,o.sort((t,e)=>t.sortKey-e.sortKey));this._currentPartIndex<o.length;)if(e.placeLayerBucketPart(o[this._currentPartIndex],this._seenCrossTileIDs,n),this._currentPartIndex++,r())return!0;return!1}}class Pe{constructor(t,e,n,i,r,o,s,a){this.placement=new ye(t,r,o,s,a),this._currentPlacementIndex=e.length-1,this._forceFullPlacement=n,this._showCollisionBoxes=i,this._done=!1}isDone(){return this._done}continuePlacement(e,n,i){const r=t.exported.now(),o=()=>{const e=t.exported.now()-r;return!this._forceFullPlacement&&e>2};for(;this._currentPlacementIndex>=0;){const t=n[e[this._currentPlacementIndex]],r=this.placement.collisionIndex.transform.zoom;if("symbol"===t.type&&(!t.minzoom||t.minzoom<=r)&&(!t.maxzoom||t.maxzoom>r)){if(this._inProgressLayer||(this._inProgressLayer=new Ie(t)),this._inProgressLayer.continuePlacement(i[t.source],this.placement,this._showCollisionBoxes,t,o))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(t){return this.placement.commit(t),this.placement}}const Me=512/t.EXTENT/2;class Oe{constructor(t,e,n){this.tileID=t,this.indexedSymbolInstances={},this.bucketInstanceId=n;for(let i=0;i<e.length;i++){const n=e.get(i),r=n.key;this.indexedSymbolInstances[r]||(this.indexedSymbolInstances[r]=[]),this.indexedSymbolInstances[r].push({crossTileID:n.crossTileID,coord:this.getScaledCoordinates(n,t)})}}getScaledCoordinates(e,n){const i=Me/Math.pow(2,n.canonical.z-this.tileID.canonical.z);return{x:Math.floor((n.canonical.x*t.EXTENT+e.anchorX)*i),y:Math.floor((n.canonical.y*t.EXTENT+e.anchorY)*i)}}findMatches(t,e,n){const i=this.tileID.canonical.z<e.canonical.z?1:Math.pow(2,this.tileID.canonical.z-e.canonical.z);for(let r=0;r<t.length;r++){const o=t.get(r);if(o.crossTileID)continue;const s=this.indexedSymbolInstances[o.key];if(!s)continue;const a=this.getScaledCoordinates(o,e);for(const t of s)if(Math.abs(t.coord.x-a.x)<=i&&Math.abs(t.coord.y-a.y)<=i&&!n[t.crossTileID]){n[t.crossTileID]=!0,o.crossTileID=t.crossTileID;break}}}}class ze{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class De{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(t){const e=Math.round((t-this.lng)/360);if(0!==e)for(const n in this.indexes){const t=this.indexes[n],i={};for(const n in t){const r=t[n];r.tileID=r.tileID.unwrapTo(r.tileID.wrap+e),i[r.tileID.key]=r}this.indexes[n]=i}this.lng=t}addBucket(t,e,n){if(this.indexes[t.overscaledZ]&&this.indexes[t.overscaledZ][t.key]){if(this.indexes[t.overscaledZ][t.key].bucketInstanceId===e.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(t.overscaledZ,this.indexes[t.overscaledZ][t.key])}for(let r=0;r<e.symbolInstances.length;r++)e.symbolInstances.get(r).crossTileID=0;this.usedCrossTileIDs[t.overscaledZ]||(this.usedCrossTileIDs[t.overscaledZ]={});const i=this.usedCrossTileIDs[t.overscaledZ];for(const r in this.indexes){const n=this.indexes[r];if(Number(r)>t.overscaledZ)for(const r in n){const o=n[r];o.tileID.isChildOf(t)&&o.findMatches(e.symbolInstances,t,i)}else{const o=n[t.scaledTo(Number(r)).key];o&&o.findMatches(e.symbolInstances,t,i)}}for(let r=0;r<e.symbolInstances.length;r++){const t=e.symbolInstances.get(r);t.crossTileID||(t.crossTileID=n.generate(),i[t.crossTileID]=!0)}return void 0===this.indexes[t.overscaledZ]&&(this.indexes[t.overscaledZ]={}),this.indexes[t.overscaledZ][t.key]=new Oe(t,e.symbolInstances,e.bucketInstanceId),!0}removeBucketCrossTileIDs(t,e){for(const n in e.indexedSymbolInstances)for(const i of e.indexedSymbolInstances[n])delete this.usedCrossTileIDs[t][i.crossTileID]}removeStaleBuckets(t){let e=!1;for(const n in this.indexes){const i=this.indexes[n];for(const r in i)t[i[r].bucketInstanceId]||(this.removeBucketCrossTileIDs(n,i[r]),delete i[r],e=!0)}return e}}class Le{constructor(){this.layerIndexes={},this.crossTileIDs=new ze,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(t,e,n){let i=this.layerIndexes[t.id];void 0===i&&(i=this.layerIndexes[t.id]=new De);let r=!1;const o={};i.handleWrapJump(n);for(const s of e){const e=s.getBucket(t);e&&t.id===e.layerIds[0]&&(e.bucketInstanceId||(e.bucketInstanceId=++this.maxBucketInstanceId),i.addBucket(s.tileID,e,this.crossTileIDs)&&(r=!0),o[e.bucketInstanceId]=!0)}return i.removeStaleBuckets(o)&&(r=!0),r}pruneUnusedLayers(t){const e={};t.forEach(t=>{e[t]=!0});for(const n in this.layerIndexes)e[n]||delete this.layerIndexes[n]}}const Re=(e,n)=>t.emitValidationErrors(e,n&&n.filter(t=>"source.canvas"!==t.identifier)),Fe=t.pick(Bt,["addLayer","removeLayer","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData","setTerrain","setFog"]),Be=t.pick(Bt,["setCenter","setZoom","setBearing","setPitch"]),Ve=function(){const e={},n=t.spec.$version;for(const i in t.spec.$root){const r=t.spec.$root[i];if(r.required){let t=null;t="version"===i?n:"array"===r.type?[]:{},null!=t&&(e[i]=t)}}return e}(),Ue={fill:!0,line:!0,background:!0,hillshade:!0,raster:!0};class Ne extends t.Evented{constructor(e,n={}){super(),this.map=e,this.dispatcher=new A(Lt(),this),this.imageManager=new g,this.imageManager.setEventedParent(this),this.glyphManager=new t.GlyphManager(e._requestManager,n.localFontFamily?t.LocalGlyphMode.all:n.localIdeographFontFamily?t.LocalGlyphMode.ideographs:t.LocalGlyphMode.none,n.localFontFamily||n.localIdeographFontFamily),this.lineAtlas=new t.LineAtlas(256,512),this.crossTileSymbolIndex=new Le,this._layers={},this._num3DLayers=0,this._numSymbolLayers=0,this._numCircleLayers=0,this._serializedLayers={},this._sourceCaches={},this._otherSourceCaches={},this._symbolSourceCaches={},this.zoomHistory=new t.ZoomHistory,this._loaded=!1,this._availableImages=[],this._order=[],this._drapedFirstOrder=[],this._markersNeedUpdate=!1,this._resetUpdates(),this.dispatcher.broadcast("setReferrer",t.getReferrer());const i=this;this._rtlTextPluginCallback=Ne.registerForPluginStateChange(e=>{i.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:e.pluginStatus,pluginURL:e.pluginURL},(e,n)=>{if(t.triggerPluginCompletionEvent(e),n&&n.every(t=>t))for(const t in i._sourceCaches){const e=i._sourceCaches[t],n=e.getSource().type;"vector"!==n&&"geojson"!==n||e.reload()}})}),this.on("data",t=>{if("source"!==t.dataType||"metadata"!==t.sourceDataType)return;const e=this.getSource(t.sourceId);if(e&&e.vectorLayerIds)for(const n in this._layers){const t=this._layers[n];t.source===e.id&&this._validateLayer(t)}})}loadURL(e,n={}){this.fire(new t.Event("dataloading",{dataType:"style"}));const i="boolean"==typeof n.validate?n.validate:!t.isMapboxURL(e);e=this.map._requestManager.normalizeStyleURL(e,n.accessToken);const r=this.map._requestManager.transformRequest(e,t.ResourceType.Style);this._request=t.getJSON(r,(e,n)=>{this._request=null,e?this.fire(new t.ErrorEvent(e)):n&&this._load(n,i)})}loadJSON(e,n={}){this.fire(new t.Event("dataloading",{dataType:"style"})),this._request=t.exported.frame(()=>{this._request=null,this._load(e,!1!==n.validate)})}loadEmpty(){this.fire(new t.Event("dataloading",{dataType:"style"})),this._load(Ve,!1)}_updateLayerCount(t,e){const n=e?1:-1;t.is3D()&&(this._num3DLayers+=n),"circle"===t.type&&(this._numCircleLayers+=n),"symbol"===t.type&&(this._numSymbolLayers+=n)}_load(e,n){if(n&&Re(this,t.validateStyle(e)))return;this._loaded=!0,this.stylesheet=e;for(const t in e.sources)this.addSource(t,e.sources[t],{validate:!1});this._changed=!1,e.sprite?this._loadSprite(e.sprite):(this.imageManager.setLoaded(!0),this.dispatcher.broadcast("spriteLoaded",!0)),this.glyphManager.setURL(e.glyphs);const i=Ft(this.stylesheet.layers);this._order=i.map(t=>t.id),this._layers={},this._serializedLayers={};for(let r of i)r=t.createStyleLayer(r),r.setEventedParent(this,{layer:{id:r.id}}),this._layers[r.id]=r,this._serializedLayers[r.id]=r.serialize(),this._updateLayerCount(r,!0);this.dispatcher.broadcast("setLayers",this._serializeLayers(this._order)),this.light=new v(this.stylesheet.light),this.stylesheet.terrain&&this._createTerrain(this.stylesheet.terrain),this.stylesheet.fog&&this._createFog(this.stylesheet.fog),this._updateDrapeFirstLayers(),this.fire(new t.Event("data",{dataType:"style"})),this.fire(new t.Event("style.load"))}_loadSprite(e){this._spriteRequest=function(e,n,i){let r,o,s;const a=t.exported.devicePixelRatio>1?"@2x":"";let l=t.getJSON(n.transformRequest(n.normalizeSpriteURL(e,a,".json"),t.ResourceType.SpriteJSON),(t,e)=>{l=null,s||(s=t,r=e,u())}),c=t.getImage(n.transformRequest(n.normalizeSpriteURL(e,a,".png"),t.ResourceType.SpriteImage),(t,e)=>{c=null,s||(s=t,o=e,u())});function u(){if(s)i(s);else if(r&&o){const e=t.exported.getImageData(o),n={};for(const i in r){const{width:o,height:s,x:a,y:l,sdf:c,pixelRatio:u,stretchX:h,stretchY:d,content:p}=r[i],f=new t.RGBAImage({width:o,height:s});t.RGBAImage.copy(e,f,{x:a,y:l},{x:0,y:0},{width:o,height:s}),n[i]={data:f,pixelRatio:u,sdf:c,stretchX:h,stretchY:d,content:p}}i(null,n)}}return{cancel(){l&&(l.cancel(),l=null),c&&(c.cancel(),c=null)}}}(e,this.map._requestManager,(e,n)=>{if(this._spriteRequest=null,e)this.fire(new t.ErrorEvent(e));else if(n)for(const t in n)this.imageManager.addImage(t,n[t]);this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),this.dispatcher.broadcast("setImages",this._availableImages),this.dispatcher.broadcast("spriteLoaded",!0),this.fire(new t.Event("data",{dataType:"style"}))})}_validateLayer(e){const n=this.getSource(e.source);if(!n)return;const i=e.sourceLayer;i&&("geojson"===n.type||n.vectorLayerIds&&-1===n.vectorLayerIds.indexOf(i))&&this.fire(new t.ErrorEvent(new Error(`Source layer "${i}" does not exist on source "${n.id}" as specified by style layer "${e.id}"`)))}loaded(){if(!this._loaded)return!1;if(Object.keys(this._updatedSources).length)return!1;for(const t in this._sourceCaches)if(!this._sourceCaches[t].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeLayers(t){const e=[];for(const n of t){const t=this._layers[n];"custom"!==t.type&&e.push(t.serialize())}return e}hasTransitions(){if(this.light&&this.light.hasTransition())return!0;if(this.fog&&this.fog.hasTransition())return!0;for(const t in this._sourceCaches)if(this._sourceCaches[t].hasTransition())return!0;for(const t in this._layers)if(this._layers[t].hasTransition())return!0;return!1}get order(){return this.map._optimizeForTerrain&&this.terrain?this._drapedFirstOrder:this._order}isLayerDraped(t){return!!this.terrain&&Ue[t.type]}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading")}update(e){if(!this._loaded)return;const n=this._changed;if(this._changed){const t=Object.keys(this._updatedLayers),n=Object.keys(this._removedLayers);(t.length||n.length)&&this._updateWorkerLayers(t,n);for(const e in this._updatedSources){const t=this._updatedSources[e];"reload"===t?this._reloadSource(e):"clear"===t&&this._clearSource(e)}this._updateTilesForChangedImages();for(const i in this._updatedPaintProps)this._layers[i].updateTransitions(e);this.light.updateTransitions(e),this.fog&&this.fog.updateTransitions(e),this._resetUpdates()}const i={};for(const t in this._sourceCaches){const e=this._sourceCaches[t];i[t]=e.used,e.used=!1}for(const t of this._order){const n=this._layers[t];if(n.recalculate(e,this._availableImages),!n.isHidden(e.zoom)){const t=this._getLayerSourceCache(n);t&&(t.used=!0)}const i=this.map.painter;if(i){const t=n.getProgramIds();if(!t)continue;const r=n.getProgramConfiguration(e.zoom);for(const e of t)i.useProgram(e,r)}}for(const r in i){const e=this._sourceCaches[r];i[r]!==e.used&&e.getSource().fire(new t.Event("data",{sourceDataType:"visibility",dataType:"source",sourceId:e.getSource().id}))}this.light.recalculate(e),this.terrain&&this.terrain.recalculate(e),this.fog&&this.fog.recalculate(e),this.z=e.zoom,this._markersNeedUpdate&&(this._updateMarkersOpacity(),this._markersNeedUpdate=!1),n&&this.fire(new t.Event("data",{dataType:"style"}))}_updateTilesForChangedImages(){const t=Object.keys(this._changedImages);if(t.length){for(const e in this._sourceCaches)this._sourceCaches[e].reloadTilesForDependencies(["icons","patterns"],t);this._changedImages={}}}_updateWorkerLayers(t,e){this.dispatcher.broadcast("updateLayers",{layers:this._serializeLayers(t),removedIds:e})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={}}setState(e){if(this._checkLoaded(),Re(this,t.validateStyle(e)))return!1;(e=t.clone$2(e)).layers=Ft(e.layers);const n=function(t,e){if(!t)return[{command:Bt.setStyle,args:[e]}];let n=[];try{if(!r(t.version,e.version))return[{command:Bt.setStyle,args:[e]}];r(t.center,e.center)||n.push({command:Bt.setCenter,args:[e.center]}),r(t.zoom,e.zoom)||n.push({command:Bt.setZoom,args:[e.zoom]}),r(t.bearing,e.bearing)||n.push({command:Bt.setBearing,args:[e.bearing]}),r(t.pitch,e.pitch)||n.push({command:Bt.setPitch,args:[e.pitch]}),r(t.sprite,e.sprite)||n.push({command:Bt.setSprite,args:[e.sprite]}),r(t.glyphs,e.glyphs)||n.push({command:Bt.setGlyphs,args:[e.glyphs]}),r(t.transition,e.transition)||n.push({command:Bt.setTransition,args:[e.transition]}),r(t.light,e.light)||n.push({command:Bt.setLight,args:[e.light]}),r(t.fog,e.fog)||n.push({command:Bt.setFog,args:[e.fog]});const i={},o=[];!function(t,e,n,i){let o;for(o in e=e||{},t=t||{})t.hasOwnProperty(o)&&(e.hasOwnProperty(o)||Ut(o,n,i));for(o in e)e.hasOwnProperty(o)&&(t.hasOwnProperty(o)?r(t[o],e[o])||("geojson"===t[o].type&&"geojson"===e[o].type&&jt(t,e,o)?n.push({command:Bt.setGeoJSONSourceData,args:[o,e[o].data]}):Nt(o,e,n,i)):Vt(o,e,n))}(t.sources,e.sources,o,i);const s=[];t.layers&&t.layers.forEach(t=>{i[t.source]?n.push({command:Bt.removeLayer,args:[t.id]}):s.push(t)});let a=t.terrain;a&&i[a.source]&&(n.push({command:Bt.setTerrain,args:[void 0]}),a=void 0),n=n.concat(o),r(a,e.terrain)||n.push({command:Bt.setTerrain,args:[e.terrain]}),function(t,e,n){e=e||[];const i=(t=t||[]).map($t),o=e.map($t),s=t.reduce(Gt,{}),a=e.reduce(Gt,{}),l=i.slice(),c=Object.create(null);let u,h,d,p,f,m,g;for(u=0,h=0;u<i.length;u++)d=i[u],a.hasOwnProperty(d)?h++:(n.push({command:Bt.removeLayer,args:[d]}),l.splice(l.indexOf(d,h),1));for(u=0,h=0;u<o.length;u++)d=o[o.length-1-u],l[l.length-1-u]!==d&&(s.hasOwnProperty(d)?(n.push({command:Bt.removeLayer,args:[d]}),l.splice(l.lastIndexOf(d,l.length-h),1)):h++,m=l[l.length-u],n.push({command:Bt.addLayer,args:[a[d],m]}),l.splice(l.length-u,0,d),c[d]=!0);for(u=0;u<o.length;u++)if(d=o[u],p=s[d],f=a[d],!c[d]&&!r(p,f))if(r(p.source,f.source)&&r(p["source-layer"],f["source-layer"])&&r(p.type,f.type)){for(g in qt(p.layout,f.layout,n,d,null,Bt.setLayoutProperty),qt(p.paint,f.paint,n,d,null,Bt.setPaintProperty),r(p.filter,f.filter)||n.push({command:Bt.setFilter,args:[d,f.filter]}),r(p.minzoom,f.minzoom)&&r(p.maxzoom,f.maxzoom)||n.push({command:Bt.setLayerZoomRange,args:[d,f.minzoom,f.maxzoom]}),p)p.hasOwnProperty(g)&&"layout"!==g&&"paint"!==g&&"filter"!==g&&"metadata"!==g&&"minzoom"!==g&&"maxzoom"!==g&&(0===g.indexOf("paint.")?qt(p[g],f[g],n,d,g.slice(6),Bt.setPaintProperty):r(p[g],f[g])||n.push({command:Bt.setLayerProperty,args:[d,g,f[g]]}));for(g in f)f.hasOwnProperty(g)&&!p.hasOwnProperty(g)&&"layout"!==g&&"paint"!==g&&"filter"!==g&&"metadata"!==g&&"minzoom"!==g&&"maxzoom"!==g&&(0===g.indexOf("paint.")?qt(p[g],f[g],n,d,g.slice(6),Bt.setPaintProperty):r(p[g],f[g])||n.push({command:Bt.setLayerProperty,args:[d,g,f[g]]}))}else n.push({command:Bt.removeLayer,args:[d]}),m=l[l.lastIndexOf(d)+1],n.push({command:Bt.addLayer,args:[f,m]})}(s,e.layers,n)}catch(t){console.warn("Unable to compute style diff:",t),n=[{command:Bt.setStyle,args:[e]}]}return n}(this.serialize(),e).filter(t=>!(t.command in Be));if(0===n.length)return!1;const i=n.filter(t=>!(t.command in Fe));if(i.length>0)throw new Error(`Unimplemented: ${i.map(t=>t.command).join(", ")}.`);return n.forEach(t=>{"setTransition"!==t.command&&this[t.command].apply(this,t.args)}),this.stylesheet=e,!0}addImage(e,n){if(this.getImage(e))return this.fire(new t.ErrorEvent(new Error("An image with this name already exists.")));this.imageManager.addImage(e,n),this._afterImageUpdated(e)}updateImage(t,e){this.imageManager.updateImage(t,e)}getImage(t){return this.imageManager.getImage(t)}removeImage(e){if(!this.getImage(e))return this.fire(new t.ErrorEvent(new Error("No image with this name exists.")));this.imageManager.removeImage(e),this._afterImageUpdated(e)}_afterImageUpdated(e){this._availableImages=this.imageManager.listImages(),this._changedImages[e]=!0,this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new t.Event("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this.imageManager.listImages()}addSource(e,n,i={}){if(this._checkLoaded(),void 0!==this.getSource(e))throw new Error("There is already a source with this ID");if(!n.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(n).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(n.type)>=0&&this._validate(t.validateStyle.source,"sources."+e,n,null,i))return;this.map&&this.map._collectResourceTiming&&(n.collectResourceTiming=!0);const r=Et(e,n,this.dispatcher,this);r.setEventedParent(this,()=>({isSourceLoaded:this.loaded(),source:r.serialize(),sourceId:e}));const o=n=>{const i=(n?"symbol:":"other:")+e,o=this._sourceCaches[i]=new t.SourceCache(i,r,n);(n?this._symbolSourceCaches:this._otherSourceCaches)[e]=o,o.style=this,o.onAdd(this.map)};o(!1),"vector"!==n.type&&"geojson"!==n.type||o(!0),r.onAdd&&r.onAdd(this.map),this._changed=!0}removeSource(e){this._checkLoaded();const n=this.getSource(e);if(void 0===n)throw new Error("There is no source with this ID");for(const r in this._layers)if(this._layers[r].source===e)return this.fire(new t.ErrorEvent(new Error(`Source "${e}" cannot be removed while layer "${r}" is using it.`)));if(this.terrain&&this.terrain.get().source===e)return this.fire(new t.ErrorEvent(new Error(`Source "${e}" cannot be removed while terrain is using it.`)));const i=this._getSourceCaches(e);for(const r of i)delete this._sourceCaches[r.id],delete this._updatedSources[r.id],r.fire(new t.Event("data",{sourceDataType:"metadata",dataType:"source",sourceId:r.getSource().id})),r.setEventedParent(null),r.clearTiles();delete this._otherSourceCaches[e],delete this._symbolSourceCaches[e],n.setEventedParent(null),n.onRemove&&n.onRemove(this.map),this._changed=!0}setGeoJSONSourceData(t,e){this._checkLoaded(),this.getSource(t).setData(e),this._changed=!0}getSource(t){const e=this._getSourceCache(t);return e&&e.getSource()}addLayer(e,n,i={}){this._checkLoaded();const r=e.id;if(this.getLayer(r))return void this.fire(new t.ErrorEvent(new Error(`Layer with id "${r}" already exists on this map`)));let o;if("custom"===e.type){if(Re(this,t.validateCustomStyleLayer(e)))return;o=t.createStyleLayer(e)}else{if("object"==typeof e.source&&(this.addSource(r,e.source),e=t.clone$2(e),e=t.extend(e,{source:r})),this._validate(t.validateStyle.layer,"layers."+r,e,{arrayIndex:-1},i))return;o=t.createStyleLayer(e),this._validateLayer(o),o.setEventedParent(this,{layer:{id:r}}),this._serializedLayers[o.id]=o.serialize(),this._updateLayerCount(o,!0)}const s=n?this._order.indexOf(n):this._order.length;if(n&&-1===s)return void this.fire(new t.ErrorEvent(new Error(`Layer with id "${n}" does not exist on this map.`)));this._order.splice(s,0,r),this._layerOrderChanged=!0,this._layers[r]=o;const a=this._getLayerSourceCache(o);if(this._removedLayers[r]&&o.source&&a&&"custom"!==o.type){const t=this._removedLayers[r];delete this._removedLayers[r],t.type!==o.type?this._updatedSources[o.source]="clear":(this._updatedSources[o.source]="reload",a.pause())}this._updateLayer(o),o.onAdd&&o.onAdd(this.map),this._updateDrapeFirstLayers()}moveLayer(e,n){if(this._checkLoaded(),this._changed=!0,!this._layers[e])return void this.fire(new t.ErrorEvent(new Error(`The layer '${e}' does not exist in the map's style and cannot be moved.`)));if(e===n)return;const i=this._order.indexOf(e);this._order.splice(i,1);const r=n?this._order.indexOf(n):this._order.length;n&&-1===r?this.fire(new t.ErrorEvent(new Error(`Layer with id "${n}" does not exist on this map.`))):(this._order.splice(r,0,e),this._layerOrderChanged=!0,this._updateDrapeFirstLayers())}removeLayer(e){this._checkLoaded();const n=this._layers[e];if(!n)return void this.fire(new t.ErrorEvent(new Error(`The layer '${e}' does not exist in the map's style and cannot be removed.`)));n.setEventedParent(null),this._updateLayerCount(n,!1);const i=this._order.indexOf(e);this._order.splice(i,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[e]=n,delete this._layers[e],delete this._serializedLayers[e],delete this._updatedLayers[e],delete this._updatedPaintProps[e],n.onRemove&&n.onRemove(this.map),this._updateDrapeFirstLayers()}getLayer(t){return this._layers[t]}hasLayer(t){return t in this._layers}hasLayerType(t){for(const e in this._layers)if(this._layers[e].type===t)return!0;return!1}setLayerZoomRange(e,n,i){this._checkLoaded();const r=this.getLayer(e);r?r.minzoom===n&&r.maxzoom===i||(null!=n&&(r.minzoom=n),null!=i&&(r.maxzoom=i),this._updateLayer(r)):this.fire(new t.ErrorEvent(new Error(`The layer '${e}' does not exist in the map's style and cannot have zoom extent.`)))}setFilter(e,n,i={}){this._checkLoaded();const o=this.getLayer(e);if(o){if(!r(o.filter,n))return null==n?(o.filter=void 0,void this._updateLayer(o)):void(this._validate(t.validateStyle.filter,`layers.${o.id}.filter`,n,null,i)||(o.filter=t.clone$2(n),this._updateLayer(o)))}else this.fire(new t.ErrorEvent(new Error(`The layer '${e}' does not exist in the map's style and cannot be filtered.`)))}getFilter(e){return t.clone$2(this.getLayer(e).filter)}setLayoutProperty(e,n,i,o={}){this._checkLoaded();const s=this.getLayer(e);s?r(s.getLayoutProperty(n),i)||(s.setLayoutProperty(n,i,o),this._updateLayer(s)):this.fire(new t.ErrorEvent(new Error(`The layer '${e}' does not exist in the map's style and cannot be styled.`)))}getLayoutProperty(e,n){const i=this.getLayer(e);if(i)return i.getLayoutProperty(n);this.fire(new t.ErrorEvent(new Error(`The layer '${e}' does not exist in the map's style.`)))}setPaintProperty(e,n,i,o={}){this._checkLoaded();const s=this.getLayer(e);s?r(s.getPaintProperty(n),i)||(s.setPaintProperty(n,i,o)&&this._updateLayer(s),this._changed=!0,this._updatedPaintProps[e]=!0):this.fire(new t.ErrorEvent(new Error(`The layer '${e}' does not exist in the map's style and cannot be styled.`)))}getPaintProperty(t,e){return this.getLayer(t).getPaintProperty(e)}setFeatureState(e,n){this._checkLoaded();const i=e.source,r=e.sourceLayer,o=this.getSource(i);if(void 0===o)return void this.fire(new t.ErrorEvent(new Error(`The source '${i}' does not exist in the map's style.`)));const s=o.type;if("geojson"===s&&r)return void this.fire(new t.ErrorEvent(new Error("GeoJSON sources cannot have a sourceLayer parameter.")));if("vector"===s&&!r)return void this.fire(new t.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")));void 0===e.id&&this.fire(new t.ErrorEvent(new Error("The feature id parameter must be provided.")));const a=this._getSourceCaches(i);for(const t of a)t.setFeatureState(r,e.id,n)}removeFeatureState(e,n){this._checkLoaded();const i=e.source,r=this.getSource(i);if(void 0===r)return void this.fire(new t.ErrorEvent(new Error(`The source '${i}' does not exist in the map's style.`)));const o=r.type,s="vector"===o?e.sourceLayer:void 0;if("vector"===o&&!s)return void this.fire(new t.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")));if(n&&"string"!=typeof e.id&&"number"!=typeof e.id)return void this.fire(new t.ErrorEvent(new Error("A feature id is required to remove its specific state property.")));const a=this._getSourceCaches(i);for(const t of a)t.removeFeatureState(s,e.id,n)}getFeatureState(e){this._checkLoaded();const n=e.source,i=e.sourceLayer,r=this.getSource(n);if(void 0!==r){if("vector"!==r.type||i)return void 0===e.id&&this.fire(new t.ErrorEvent(new Error("The feature id parameter must be provided."))),this._getSourceCaches(n)[0].getFeatureState(i,e.id);this.fire(new t.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new t.ErrorEvent(new Error(`The source '${n}' does not exist in the map's style.`)))}getTransition(){return t.extend({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){const e={};for(const t in this._sourceCaches){const n=this._sourceCaches[t].getSource();e[n.id]||(e[n.id]=n.serialize())}return t.filterObject({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,light:this.stylesheet.light,terrain:this.stylesheet.terrain,fog:this.stylesheet.fog,center:this.stylesheet.center,zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,sources:e,layers:this._serializeLayers(this._order)},t=>void 0!==t)}_updateLayer(t){this._updatedLayers[t.id]=!0;const e=this._getLayerSourceCache(t);t.source&&!this._updatedSources[t.source]&&e&&"raster"!==e.getSource().type&&(this._updatedSources[t.source]="reload",e.pause()),this._changed=!0}_flattenAndSortRenderedFeatures(t){const e=t=>"fill-extrusion"===this._layers[t].type,n={},i=[];for(let o=this._order.length-1;o>=0;o--){const r=this._order[o];if(e(r)){n[r]=o;for(const e of t){const t=e[r];if(t)for(const e of t)i.push(e)}}}i.sort((t,e)=>e.intersectionZ-t.intersectionZ);const r=[];for(let o=this._order.length-1;o>=0;o--){const s=this._order[o];if(e(s))for(let t=i.length-1;t>=0;t--){const e=i[t].feature;if(n[e.layer.id]<o)break;r.push(e),i.pop()}else for(const e of t){const t=e[s];if(t)for(const e of t)r.push(e.feature)}}return r}queryRenderedFeatures(e,n,i){n&&n.filter&&this._validate(t.validateStyle.filter,"queryRenderedFeatures.filter",n.filter,null,n);const r={};if(n&&n.layers){if(!Array.isArray(n.layers))return this.fire(new t.ErrorEvent(new Error("parameters.layers must be an Array."))),[];for(const e of n.layers){const n=this._layers[e];if(!n)return this.fire(new t.ErrorEvent(new Error(`The layer '${e}' does not exist in the map's style and cannot be queried for features.`))),[];r[n.source]=!0}}const o=[];n.availableImages=this._availableImages;const s=n&&n.layers?n.layers.some(t=>{const e=this.getLayer(t);return e&&e.is3D()}):this.has3DLayers(),a=P.createFromScreenPoints(e,i);for(const t in this._sourceCaches){const e=this._sourceCaches[t].getSource().id;n.layers&&!r[e]||o.push(At(this._sourceCaches[t],this._layers,this._serializedLayers,a,n,i,s,!!this.map._showQueryGeometry))}return this.placement&&o.push(function(t,e,n,i,r,o,s){const a={},l=o.queryRenderedSymbols(i),c=[];for(const u of Object.keys(l).map(Number))c.push(s[u]);c.sort(Pt);for(const u of c){const n=u.featureIndex.lookupSymbolFeatures(l[u.bucketInstanceId],e,u.bucketIndex,u.sourceLayerIndex,r.filter,r.layers,r.availableImages,t);for(const t in n){const e=a[t]=a[t]||[],i=n[t];i.sort((t,e)=>{const n=u.featureSortOrder;if(n){const i=n.indexOf(t.featureIndex);return n.indexOf(e.featureIndex)-i}return e.featureIndex-t.featureIndex});for(const t of i)e.push(t)}}for(const u in a)a[u].forEach(e=>{const i=e.feature,r=n(t[u]).getFeatureState(i.layer["source-layer"],i.id);i.source=i.layer.source,i.layer["source-layer"]&&(i.sourceLayer=i.layer["source-layer"]),i.state=r});return a}(this._layers,this._serializedLayers,this._getLayerSourceCache.bind(this),a.screenGeometry,n,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(o)}querySourceFeatures(e,n){n&&n.filter&&this._validate(t.validateStyle.filter,"querySourceFeatures.filter",n.filter,null,n);const i=this._getSourceCaches(e);let r=[];for(const t of i)r=r.concat(It(t,n));return r}addSourceType(t,e,n){return Ne.getSourceType(t)?n(new Error(`A source type called "${t}" already exists.`)):(Ne.setSourceType(t,e),e.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:t,url:e.workerSourceURL},n):n(null,null))}getLight(){return this.light.getLight()}setLight(e,n={}){this._checkLoaded();const i=this.light.getLight();let o=!1;for(const t in e)if(!r(e[t],i[t])){o=!0;break}if(!o)return;const s={now:t.exported.now(),transition:t.extend({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(e,n),this.light.updateTransitions(s)}getTerrain(){return this.terrain?this.terrain.get():null}setTerrain(e){if(this._checkLoaded(),!e)return delete this.terrain,delete this.stylesheet.terrain,this.dispatcher.broadcast("enableTerrain",!1),this._force3DLayerUpdate(),void(this._markersNeedUpdate=!0);if("object"==typeof e.source){const n="terrain-dem-src";this.addSource(n,e.source),e=t.clone$2(e),e=t.extend(e,{source:n})}if(!this._validate(t.validateStyle.terrain,"terrain",e)){if(this.terrain){const n=this.terrain,i=n.get();for(const o in e)if(!r(e[o],i[o])){n.set(e),this.stylesheet.terrain=e;const i={now:t.exported.now(),transition:t.extend({duration:0},this.stylesheet.transition)};n.updateTransitions(i);break}}else this._createTerrain(e);this._updateDrapeFirstLayers(),this._markersNeedUpdate=!0}}_createFog(e){const n=this.fog=new k(e);this.stylesheet.fog=e;const i={now:t.exported.now(),transition:t.extend({duration:0},this.stylesheet.transition)};n.updateTransitions(i)}_updateMarkersOpacity(){0!==this.map._markers.length&&this.map._requestDomTask(()=>{for(const t of this.map._markers)t._evaluateOpacity()})}getFog(){return this.fog?this.fog.get():null}setFog(e){if(this._checkLoaded(),!e)return delete this.fog,delete this.stylesheet.fog,void(this._markersNeedUpdate=!0);if(this.fog){const n=this.fog,i=n.get();for(const o in e)if(!r(e[o],i[o])){n.set(e),this.stylesheet.fog=e;const i={now:t.exported.now(),transition:t.extend({duration:0},this.stylesheet.transition)};n.updateTransitions(i);break}}else this._createFog(e);this._markersNeedUpdate=!0}_updateDrapeFirstLayers(){if(!this.map._optimizeForTerrain||!this.terrain)return;const t=this._order.filter(t=>this.isLayerDraped(this._layers[t])),e=this._order.filter(t=>!this.isLayerDraped(this._layers[t]));this._drapedFirstOrder=[],this._drapedFirstOrder.push(...t),this._drapedFirstOrder.push(...e)}_createTerrain(e){const n=this.terrain=new w(e);this.stylesheet.terrain=e,this.dispatcher.broadcast("enableTerrain",!0),this._force3DLayerUpdate();const i={now:t.exported.now(),transition:t.extend({duration:0},this.stylesheet.transition)};n.updateTransitions(i)}_force3DLayerUpdate(){for(const t in this._layers){const e=this._layers[t];"fill-extrusion"===e.type&&this._updateLayer(e)}}_validate(e,n,i,r,o={}){return(!o||!1!==o.validate)&&Re(this,e.call(t.validateStyle,t.extend({key:n,style:this.serialize(),value:i,styleSpec:t.spec},r)))}_remove(){this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),t.evented.off("pluginStateChange",this._rtlTextPluginCallback);for(const t in this._layers)this._layers[t].setEventedParent(null);for(const t in this._sourceCaches)this._sourceCaches[t].clearTiles(),this._sourceCaches[t].setEventedParent(null);this.imageManager.setEventedParent(null),this.setEventedParent(null),this.dispatcher.remove()}_clearSource(t){const e=this._getSourceCaches(t);for(const n of e)n.clearTiles()}_reloadSource(t){const e=this._getSourceCaches(t);for(const n of e)n.resume(),n.reload()}_updateSources(t){for(const e in this._sourceCaches)this._sourceCaches[e].update(t)}_generateCollisionBoxes(){for(const t in this._sourceCaches){const e=this._sourceCaches[t];e.resume(),e.reload()}}_updatePlacement(e,n,i,r,o=!1){let s=!1,a=!1;const l={};for(const t of this._order){const n=this._layers[t];if("symbol"!==n.type)continue;if(!l[n.source]){const t=this._getLayerSourceCache(n);if(!t)continue;l[n.source]=t.getRenderableIds(!0).map(e=>t.getTileByID(e)).sort((t,e)=>e.tileID.overscaledZ-t.tileID.overscaledZ||(t.tileID.isLessThan(e.tileID)?-1:1))}const i=this.crossTileSymbolIndex.addLayer(n,l[n.source],e.center.lng);s=s||i}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),o=o||this._layerOrderChanged||0===i,this._layerOrderChanged&&this.fire(new t.Event("neworder")),(o||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(t.exported.now(),e.zoom))&&(this.pauseablePlacement=new Pe(e,this._order,o,n,i,r,this.placement,this.fog?this.fog.state:null),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,l),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(t.exported.now()),a=!0),s&&this.pauseablePlacement.placement.setStale()),a||s)for(const t of this._order){const e=this._layers[t];"symbol"===e.type&&this.placement.updateLayerOpacities(e,l[e.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(t.exported.now())}_releaseSymbolFadeTiles(){for(const t in this._sourceCaches)this._sourceCaches[t].releaseSymbolFadeTiles()}getImages(t,e,n){this.imageManager.getImages(e.icons,n),this._updateTilesForChangedImages();const i=t=>{t&&t.setDependencies(e.tileID.key,e.type,e.icons)};i(this._otherSourceCaches[e.source]),i(this._symbolSourceCaches[e.source])}getGlyphs(t,e,n){this.glyphManager.getGlyphs(e.stacks,n)}getResource(e,n,i){return t.makeRequest(n,i)}_getSourceCache(t){return this._otherSourceCaches[t]}_getLayerSourceCache(t){return"symbol"===t.type?this._symbolSourceCaches[t.source]:this._otherSourceCaches[t.source]}_getSourceCaches(t){const e=[];return this._otherSourceCaches[t]&&e.push(this._otherSourceCaches[t]),this._symbolSourceCaches[t]&&e.push(this._symbolSourceCaches[t]),e}has3DLayers(){return this._num3DLayers>0}hasSymbolLayers(){return this._numSymbolLayers>0}hasCircleLayers(){return this._numCircleLayers>0}}Ne.getSourceType=function(t){return St[t]},Ne.setSourceType=function(t,e){St[t]=e},Ne.registerForPluginStateChange=t.registerForPluginStateChange;var je="\n#define EPSILON 0.0000001\n#define PI 3.141592653589793\n#ifdef FOG\nuniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;varying vec3 v_fog_pos;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}\n#endif",qe="attribute highp vec3 a_pos_3f;uniform lowp mat4 u_matrix;varying highp vec3 v_uv;void main() {const mat3 half_neg_pi_around_x=mat3(1.0,0.0, 0.0,0.0,0.0,-1.0,0.0,1.0, 0.0);v_uv=half_neg_pi_around_x*a_pos_3f;vec4 pos=u_matrix*vec4(a_pos_3f,1.0);gl_Position=pos.xyww;}";let $e={},Ge={};$e=Xe("","\n#define ELEVATION_SCALE 7.0\n#define ELEVATION_OFFSET 450.0\n#ifdef TERRAIN\nuniform sampler2D u_dem;uniform sampler2D u_dem_prev;uniform vec4 u_dem_unpack;uniform vec2 u_dem_tl;uniform vec2 u_dem_tl_prev;uniform float u_dem_scale;uniform float u_dem_scale_prev;uniform float u_dem_size;uniform float u_dem_lerp;uniform float u_exaggeration;uniform float u_meter_to_dem;uniform mat4 u_label_plane_matrix_inv;uniform sampler2D u_depth;uniform vec2 u_depth_size_inv;vec4 tileUvToDemSample(vec2 uv,float dem_size,float dem_scale,vec2 dem_tl) {vec2 pos=dem_size*(uv*dem_scale+dem_tl)+1.0;vec2 f=fract(pos);return vec4((pos-f+0.5)/(dem_size+2.0),f);}float decodeElevation(vec4 v) {return dot(vec4(v.xyz*255.0,-1.0),u_dem_unpack);}float currentElevation(vec2 apos) {float dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale,u_dem_tl);vec2 pos=r.xy;vec2 f=r.zw;float tl=decodeElevation(texture2D(u_dem,pos));\n#ifdef TERRAIN_DEM_NEAREST_FILTER\nreturn u_exaggeration*tl;\n#endif\nfloat tr=decodeElevation(texture2D(u_dem,pos+vec2(dd,0.0)));float bl=decodeElevation(texture2D(u_dem,pos+vec2(0.0,dd)));float br=decodeElevation(texture2D(u_dem,pos+vec2(dd,dd)));return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);}float prevElevation(vec2 apos) {float dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale_prev,u_dem_tl_prev);vec2 pos=r.xy;vec2 f=r.zw;float tl=decodeElevation(texture2D(u_dem_prev,pos));float tr=decodeElevation(texture2D(u_dem_prev,pos+vec2(dd,0.0)));float bl=decodeElevation(texture2D(u_dem_prev,pos+vec2(0.0,dd)));float br=decodeElevation(texture2D(u_dem_prev,pos+vec2(dd,dd)));return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);}\n#ifdef TERRAIN_VERTEX_MORPHING\nfloat elevation(vec2 apos) {float nextElevation=currentElevation(apos);float prevElevation=prevElevation(apos);return mix(prevElevation,nextElevation,u_dem_lerp);}\n#else\nfloat elevation(vec2 apos) {return currentElevation(apos);}\n#endif\nfloat unpack_depth(vec4 rgba_depth)\n{const vec4 bit_shift=vec4(1.0/(256.0*256.0*256.0),1.0/(256.0*256.0),1.0/256.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}bool isOccluded(vec4 frag) {vec3 coord=frag.xyz/frag.w;float depth=unpack_depth(texture2D(u_depth,(coord.xy+1.0)*0.5));return coord.z > depth+0.0005;}float occlusionFade(vec4 frag) {vec3 coord=frag.xyz/frag.w;vec3 df=vec3(5.0*u_depth_size_inv,0.0);vec2 uv=0.5*coord.xy+0.5;vec4 depth=vec4(\nunpack_depth(texture2D(u_depth,uv-df.xz)),unpack_depth(texture2D(u_depth,uv+df.xz)),unpack_depth(texture2D(u_depth,uv-df.zy)),unpack_depth(texture2D(u_depth,uv+df.zy))\n);return dot(vec4(0.25),vec4(1.0)-clamp(300.0*(vec4(coord.z-0.001)-depth),0.0,1.0));}vec4 fourSample(vec2 pos,vec2 off) {vec4 demtl=vec4(texture2D(u_dem,pos).xyz*255.0,-1.0);float tl=dot(demtl,u_dem_unpack);vec4 demtr=vec4(texture2D(u_dem,pos+vec2(off.x,0.0)).xyz*255.0,-1.0);float tr=dot(demtr,u_dem_unpack);vec4 dembl=vec4(texture2D(u_dem,pos+vec2(0.0,off.y)).xyz*255.0,-1.0);float bl=dot(dembl,u_dem_unpack);vec4 dembr=vec4(texture2D(u_dem,pos+off).xyz*255.0,-1.0);float br=dot(dembr,u_dem_unpack);return vec4(tl,tr,bl,br);}float flatElevation(vec2 pack) {vec2 apos=floor(pack/8.0);vec2 span=10.0*(pack-apos*8.0);vec2 uvTex=(apos-vec2(1.0,1.0))/8190.0;float size=u_dem_size+2.0;float dd=1.0/size;vec2 pos=u_dem_size*(uvTex*u_dem_scale+u_dem_tl)+1.0;vec2 f=fract(pos);pos=(pos-f+0.5)*dd;vec4 h=fourSample(pos,vec2(dd));float z=mix(mix(h.x,h.y,f.x),mix(h.z,h.w,f.x),f.y);vec2 w=floor(0.5*(span*u_meter_to_dem-1.0));vec2 d=dd*w;vec4 bounds=vec4(d,vec2(1.0)-d);h=fourSample(pos-d,2.0*d+vec2(dd));vec4 diff=abs(h.xzxy-h.ywzw);vec2 slope=min(vec2(0.25),u_meter_to_dem*0.5*(diff.xz+diff.yw)/(2.0*w+vec2(1.0)));vec2 fix=slope*span;float base=z+max(fix.x,fix.y);return u_exaggeration*base;}float elevationFromUint16(float word) {return u_exaggeration*(word/ELEVATION_SCALE-ELEVATION_OFFSET);}\n#else\nfloat elevation(vec2 pos) { return 0.0; }bool isOccluded(vec4 frag) { return false; }float occlusionFade(vec4 frag) { return 1.0; }\n#endif",!0),Ge=Xe("#ifdef FOG\nuniform float u_fog_temporal_offset;float fog_opacity(vec3 pos) {float depth=length(pos);return fog_opacity(fog_range(depth));}vec3 fog_apply(vec3 color,vec3 pos) {float depth=length(pos);float opacity=fog_opacity(fog_range(depth));opacity*=fog_horizon_blending(pos/depth);return mix(color,u_fog_color.rgb,opacity);}vec3 fog_apply_from_vert(vec3 color,float fog_opac) {return mix(color,u_fog_color.rgb,fog_opac);}vec3 fog_apply_sky_gradient(vec3 camera_ray,vec3 sky_color) {float horizon_blend=fog_horizon_blending(normalize(camera_ray));return mix(sky_color,u_fog_color.rgb,horizon_blend);}vec4 fog_apply_premultiplied(vec4 color,vec3 pos) {float alpha=EPSILON+color.a;color.rgb/=alpha;color.rgb=fog_apply(color.rgb,pos);color.rgb*=alpha;return color;}vec3 fog_dither(vec3 color) {vec2 dither_seed=gl_FragCoord.xy+u_fog_temporal_offset;return dither(color,dither_seed);}vec4 fog_dither(vec4 color) {return vec4(fog_dither(color.rgb),color.a);}\n#endif","#ifdef FOG\nuniform mat4 u_fog_matrix;vec3 fog_position(vec3 pos) {return (u_fog_matrix*vec4(pos,1.0)).xyz;}vec3 fog_position(vec2 pos) {return fog_position(vec3(pos,0.0));}float fog(vec3 pos) {float depth=length(pos);float opacity=fog_opacity(fog_range(depth));return opacity*fog_horizon_blending(pos/depth);}\n#endif",!0);const Ze=Xe("#ifdef GL_ES\nprecision mediump float;\n#else\n#if !defined(lowp)\n#define lowp\n#endif\n#if !defined(mediump)\n#define mediump\n#endif\n#if !defined(highp)\n#define highp\n#endif\n#endif\nhighp vec3 hash(highp vec2 p) {highp vec3 p3=fract(p.xyx*vec3(443.8975,397.2973,491.1871));p3+=dot(p3,p3.yxz+19.19);return fract((p3.xxy+p3.yzz)*p3.zyx);}vec3 dither(vec3 color,highp vec2 seed) {vec3 rnd=hash(seed)+hash(seed+0.59374)-0.5;return color+rnd/255.0;}","#ifdef GL_ES\nprecision highp float;\n#else\n#if !defined(lowp)\n#define lowp\n#endif\n#if !defined(mediump)\n#define mediump\n#endif\n#if !defined(highp)\n#define highp\n#endif\n#endif\nvec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(\nunpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0\n);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}const vec4 AWAY=vec4(-1000.0,-1000.0,-1000.0,1);//Normalized device coordinate that is not rendered."),He=je;var We={background:Xe("uniform vec4 u_color;uniform float u_opacity;void main() {vec4 out_color=u_color;\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),backgroundPattern:Xe("uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 out_color=mix(color1,color2,u_mix);\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),circle:Xe("varying vec3 v_data;varying float v_visibility;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump float radius\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp vec4 stroke_color\n#pragma mapbox: define mediump float stroke_width\n#pragma mapbox: define lowp float stroke_opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize mediump float radius\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize highp vec4 stroke_color\n#pragma mapbox: initialize mediump float stroke_width\n#pragma mapbox: initialize lowp float stroke_opacity\nvec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(\nantialiased_blur,0.0,extrude_length-radius/(radius+stroke_width)\n);vec4 out_color=mix(color*opacity,stroke_color*stroke_opacity,color_t);\n#ifdef FOG\nout_color=fog_apply_premultiplied(out_color,v_fog_pos);\n#endif\ngl_FragColor=out_color*(v_visibility*opacity_t);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","#define NUM_VISIBILITY_RINGS 2\n#define INV_SQRT2 0.70710678\n#define ELEVATION_BIAS 0.0001\n#define NUM_SAMPLES_PER_RING 16\nuniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;varying vec3 v_data;varying float v_visibility;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump float radius\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp vec4 stroke_color\n#pragma mapbox: define mediump float stroke_width\n#pragma mapbox: define lowp float stroke_opacity\nvec2 calc_offset(vec2 extrusion,float radius,float stroke_width, float view_scale) {return extrusion*(radius+stroke_width)*u_extrude_scale*view_scale;}float cantilevered_elevation(vec2 pos,float radius,float stroke_width,float view_scale) {vec2 c1=pos+calc_offset(vec2(-1,-1),radius,stroke_width,view_scale);vec2 c2=pos+calc_offset(vec2(1,-1),radius,stroke_width,view_scale);vec2 c3=pos+calc_offset(vec2(1,1),radius,stroke_width,view_scale);vec2 c4=pos+calc_offset(vec2(-1,1),radius,stroke_width,view_scale);float h1=elevation(c1)+ELEVATION_BIAS;float h2=elevation(c2)+ELEVATION_BIAS;float h3=elevation(c3)+ELEVATION_BIAS;float h4=elevation(c4)+ELEVATION_BIAS;return max(h4,max(h3,max(h1,h2)));}float circle_elevation(vec2 pos) {\n#if defined(TERRAIN)\nreturn elevation(pos)+ELEVATION_BIAS;\n#else\nreturn 0.0;\n#endif\n}vec4 project_vertex(vec2 extrusion,vec4 world_center,vec4 projected_center,float radius,float stroke_width, float view_scale) {vec2 sample_offset=calc_offset(extrusion,radius,stroke_width,view_scale);\n#ifdef PITCH_WITH_MAP\nreturn u_matrix*( world_center+vec4(sample_offset,0,0) );\n#else\nreturn projected_center+vec4(sample_offset,0,0);\n#endif\n}float get_sample_step() {\n#ifdef PITCH_WITH_MAP\nreturn 2.0*PI/float(NUM_SAMPLES_PER_RING);\n#else\nreturn PI/float(NUM_SAMPLES_PER_RING);\n#endif\n}void main(void) {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize mediump float radius\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize highp vec4 stroke_color\n#pragma mapbox: initialize mediump float stroke_width\n#pragma mapbox: initialize lowp float stroke_opacity\nvec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);float height=circle_elevation(circle_center);vec4 world_center=vec4(circle_center,height,1);vec4 projected_center=u_matrix*world_center;float view_scale=0.0;\n#ifdef PITCH_WITH_MAP\n#ifdef SCALE_WITH_MAP\nview_scale=1.0;\n#else\nview_scale=projected_center.w/u_camera_to_center_distance;\n#endif\n#else\n#ifdef SCALE_WITH_MAP\nview_scale=u_camera_to_center_distance;\n#else\nview_scale=projected_center.w;\n#endif\n#endif\ngl_Position=project_vertex(extrude,world_center,projected_center,radius,stroke_width,view_scale);float visibility=0.0;\n#ifdef TERRAIN\nfloat step=get_sample_step();\n#ifdef PITCH_WITH_MAP\nfloat cantilevered_height=cantilevered_elevation(circle_center,radius,stroke_width,view_scale);vec4 occlusion_world_center=vec4(circle_center,cantilevered_height,1);vec4 occlusion_projected_center=u_matrix*occlusion_world_center;\n#else\nvec4 occlusion_world_center=world_center;vec4 occlusion_projected_center=projected_center;\n#endif\nfor(int ring=0; ring < NUM_VISIBILITY_RINGS; ring++) {float scale=(float(ring)+1.0)/float(NUM_VISIBILITY_RINGS);for(int i=0; i < NUM_SAMPLES_PER_RING; i++) {vec2 extrusion=vec2(cos(step*float(i)),-sin(step*float(i)))*scale;vec4 frag_pos=project_vertex(extrusion,occlusion_world_center,occlusion_projected_center,radius,stroke_width,view_scale);visibility+=float(!isOccluded(frag_pos));}}visibility/=float(NUM_VISIBILITY_RINGS)*float(NUM_SAMPLES_PER_RING);\n#else\nvisibility=1.0;\n#endif\nv_visibility=visibility;lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);\n#ifdef FOG\nv_fog_pos=fog_position(world_center.xyz);\n#endif\n}"),clippingMask:Xe("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:Xe("uniform highp float u_intensity;varying vec2 v_extrude;\n#pragma mapbox: define highp float weight\n#define GAUSS_COEF 0.3989422804014327\nvoid main() {\n#pragma mapbox: initialize highp float weight\nfloat d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);\n#ifdef FOG\ngl_FragColor.r*=pow(1.0-fog_opacity(v_fog_pos),2.0);\n#endif\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;varying vec2 v_extrude;\n#pragma mapbox: define highp float weight\n#pragma mapbox: define mediump float radius\nconst highp float ZERO=1.0/255.0/16.0;\n#define GAUSS_COEF 0.3989422804014327\nvoid main(void) {\n#pragma mapbox: initialize highp float weight\n#pragma mapbox: initialize mediump float radius\nvec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec3 pos=vec3(floor(a_pos*0.5)+extrude,elevation(floor(a_pos*0.5)));gl_Position=u_matrix*vec4(pos,1);\n#ifdef FOG\nv_fog_pos=fog_position(pos);\n#endif\n}"),heatmapTexture:Xe("uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(0.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_world;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),collisionBox:Xe("varying float v_placed;varying float v_notUsed;void main() {vec4 red =vec4(1.0,0.0,0.0,1.0);vec4 blue=vec4(0.0,0.0,1.0,0.5);gl_FragColor =mix(red,blue,step(0.5,v_placed))*0.5;gl_FragColor*=mix(1.0,0.1,step(0.5,v_notUsed));}","attribute vec2 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;attribute float a_size_scale;attribute vec2 a_padding;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_anchor_pos,elevation(a_anchor_pos),1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(\n0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,1.5);gl_Position=u_matrix*vec4(a_pos,elevation(a_pos),1.0);gl_Position.xy+=(a_extrude*a_size_scale+a_shift+a_padding)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}"),collisionCircle:Xe("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}","attribute vec2 a_pos_2f;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos_2f;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(\nmix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(\n0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),debug:Xe("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}","attribute vec2 a_pos;varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {float h=elevation(a_pos);v_uv=a_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,h,1);}"),fill:Xe("#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float opacity\nvec4 out_color=color;\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float opacity\ngl_Position=u_matrix*vec4(a_pos,0,1);\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),fillOutline:Xe("varying vec2 v_pos;\n#pragma mapbox: define highp vec4 outline_color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 outline_color\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=outline_color;\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;\n#pragma mapbox: define highp vec4 outline_color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 outline_color\n#pragma mapbox: initialize lowp float opacity\ngl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),fillOutlinePattern:Xe("uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=mix(color1,color2,u_fade);\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),fillPattern:Xe("uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 out_color=mix(color1,color2,u_fade);\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),fillExtrusion:Xe("varying vec4 v_color;void main() {vec4 color=v_color;\n#ifdef FOG\ncolor=fog_dither(fog_apply_premultiplied(color,v_fog_pos));\n#endif\ngl_FragColor=color;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;attribute vec4 a_pos_normal_ed;attribute vec2 a_centroid_pos;varying vec4 v_color;\n#pragma mapbox: define highp float base\n#pragma mapbox: define highp float height\n#pragma mapbox: define highp vec4 color\nvoid main() {\n#pragma mapbox: initialize highp float base\n#pragma mapbox: initialize highp float height\n#pragma mapbox: initialize highp vec4 color\nvec3 pos_nx=floor(a_pos_normal_ed.xyz*0.5);mediump vec3 top_up_ny=a_pos_normal_ed.xyz-2.0*pos_nx;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));base=max(0.0,base);height=max(0.0,height);float t=top_up_ny.x;\n#ifdef TERRAIN\nvec2 centroid_pos=a_centroid_pos;bool flat_roof=centroid_pos.x !=0.0;float ele=elevation(pos_nx.xy);float hidden=float(centroid_pos.x==0.0 && centroid_pos.y==1.0);float c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;float h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base==0.0 ?-5.0 : base);vec3 pos=vec3(pos_nx.xy,h);gl_Position=mix(u_matrix*vec4(pos,1),AWAY,hidden);\n#else\nvec3 pos=vec3(pos_nx.xy,t > 0.0 ? height : base);gl_Position=u_matrix*vec4(pos,1);\n#endif\nfloat colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;float directional=clamp(dot(normal,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=(\n(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.rgb+=clamp(color.rgb*directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_color*=u_opacity;\n#ifdef FOG\nv_fog_pos=fog_position(pos);\n#endif\n}"),fillExtrusionPattern:Xe("uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;\n#pragma mapbox: define lowp float base\n#pragma mapbox: define lowp float height\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float base\n#pragma mapbox: initialize lowp float height\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 out_color=mix(color1,color2,u_fade);out_color=out_color*v_lighting;\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec4 a_pos_normal_ed;attribute vec2 a_centroid_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;\n#pragma mapbox: define lowp float base\n#pragma mapbox: define lowp float height\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float base\n#pragma mapbox: initialize lowp float height\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 pos_nx=floor(a_pos_normal_ed.xyz*0.5);mediump vec3 top_up_ny=a_pos_normal_ed.xyz-2.0*pos_nx;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));float edgedistance=a_pos_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;base=max(0.0,base);height=max(0.0,height);float t=top_up_ny.x;float z=t > 0.0 ? height : base;\n#ifdef TERRAIN\nvec2 centroid_pos=a_centroid_pos;bool flat_roof=centroid_pos.x !=0.0;float ele=elevation(pos_nx.xy);float hidden=float(centroid_pos.x==0.0 && centroid_pos.y==1.0);float c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;float h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base==0.0 ?-5.0 : base);vec3 p=vec3(pos_nx.xy,h);gl_Position=mix(u_matrix*vec4(p,1),AWAY,hidden);\n#else\nvec3 p=vec3(pos_nx.xy,z);gl_Position=u_matrix*vec4(p,1);\n#endif\nvec2 pos=normal.z==1.0\n? pos_nx.xy\n: vec2(edgedistance,z*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=(\n(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;\n#ifdef FOG\nv_fog_pos=fog_position(p);\n#endif\n}"),hillshadePrepare:Xe("#ifdef GL_ES\nprecision highp float;\n#endif\nuniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2(\n(c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c)\n)/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(\nderiv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:Xe("uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;void main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;\n#ifdef FOG\ngl_FragColor=fog_dither(fog_apply_premultiplied(gl_FragColor,v_fog_pos));\n#endif\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),line:Xe("uniform lowp float u_device_pixel_ratio;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 out_color=color;\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\nattribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float width\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;\n#ifndef RENDER_TO_TEXTURE\nfloat extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;\n#else\nv_gamma_scale=1.0;\n#endif\nv_width2=vec2(outset,inset);\n#ifdef FOG\nv_fog_pos=fog_position(pos);\n#endif\n}"),lineGradient:Xe("uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec2 v_uv;\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture2D(u_image,v_uv);\n#ifdef FOG\ncolor=fog_dither(fog_apply_premultiplied(color,v_fog_pos));\n#endif\ngl_FragColor=color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\nattribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_uv_x;attribute float a_split_index;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec2 v_uv;\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\nvoid main() {\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float width\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;\n#ifndef RENDER_TO_TEXTURE\nfloat extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;\n#else\nv_gamma_scale=1.0;\n#endif\nv_width2=vec2(outset,inset);\n#ifdef FOG\nv_fog_pos=fog_position(pos);\n#endif\n}"),linePattern:Xe("uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture2D(u_image,pos_a),texture2D(u_image,pos_b),u_fade);\n#ifdef FOG\ncolor=fog_dither(fog_apply_premultiplied(color,v_fog_pos));\n#endif\ngl_FragColor=color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\nattribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_linesofar;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float floorwidth\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;\n#ifndef RENDER_TO_TEXTURE\nfloat extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;\n#else\nv_gamma_scale=1.0;\n#endif\nv_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;\n#ifdef FOG\nv_fog_pos=fog_position(pos);\n#endif\n}"),lineSDF:Xe("uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_mix;uniform vec3 u_scale;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\n#pragma mapbox: define lowp vec4 dash_from\n#pragma mapbox: define lowp vec4 dash_to\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float floorwidth\n#pragma mapbox: initialize mediump vec4 dash_from\n#pragma mapbox: initialize mediump vec4 dash_to\nfloat dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture2D(u_image,v_tex_a).a;float sdfdist_b=texture2D(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);float sdfwidth=min(dash_from.z*u_scale.y,dash_to.z*u_scale.z);float sdfgamma=1.0/(2.0*u_device_pixel_ratio)/sdfwidth;alpha*=smoothstep(0.5-sdfgamma/floorwidth,0.5+sdfgamma/floorwidth,sdfdist);vec4 out_color=color;\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define EXTRUDE_SCALE 0.015873016\nattribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_linesofar;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform vec2 u_texsize;uniform mediump vec3 u_scale;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\n#pragma mapbox: define lowp vec4 dash_from\n#pragma mapbox: define lowp vec4 dash_to\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float floorwidth\n#pragma mapbox: initialize mediump vec4 dash_from\n#pragma mapbox: initialize mediump vec4 dash_to\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*EXTRUDE_SCALE;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*EXTRUDE_SCALE*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;\n#ifndef RENDER_TO_TEXTURE\nfloat extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;\n#else\nv_gamma_scale=1.0;\n#endif\nfloat tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;float widthA=dash_from.z*fromScale;float widthB=dash_to.z*toScale;float heightA=dash_from.y;float heightB=dash_to.y;v_tex_a=vec2(a_linesofar*(tileZoomRatio/widthA)/floorwidth,(-normal.y*heightA+dash_from.x+0.5)/u_texsize.y);v_tex_b=vec2(a_linesofar*(tileZoomRatio/widthB)/floorwidth,(-normal.y*heightB+dash_to.x+0.5)/u_texsize.y);v_width2=vec2(outset,inset);\n#ifdef FOG\nv_fog_pos=fog_position(pos);\n#endif\n}"),raster:Xe("uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(\ndot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);vec3 out_color=mix(u_high_vec,u_low_vec,rgb);\n#ifdef FOG\nout_color=fog_dither(fog_apply(out_color,v_fog_pos));\n#endif\ngl_FragColor=vec4(out_color*color.a,color.a);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos0=(((a_texture_pos/8192.0)-0.5)/u_buffer_scale )+0.5;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),symbolIcon:Xe("uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\nlowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;varying vec2 v_tex;varying float v_fade_opacity;\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}float h=elevation(a_pos);vec4 projectedPoint=u_matrix*vec4(a_pos,h,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(\n0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),h,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h,1.0);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0);\n#ifdef PITCH_WITH_MAP_TERRAIN\nvec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);\n#endif\nfloat occlusion_fade=occlusionFade(projectedPoint);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projectedPoint.w <=0.0 || occlusion_fade==0.0));v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;v_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));}"),symbolSDF:Xe("#define SDF_PX 8.0\nuniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nfloat EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;varying vec2 v_data0;varying vec3 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}float h=elevation(a_pos);vec4 projectedPoint=u_matrix*vec4(a_pos,h,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(\n0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),h,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h,1.0);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset);\n#ifdef PITCH_WITH_MAP_TERRAIN\nvec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);\n#endif\nfloat occlusion_fade=occlusionFade(projectedPoint);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projectedPoint.w <=0.0 || occlusion_fade==0.0));float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}"),symbolTextAndIcon:Xe("#define SDF_PX 8.0\n#define SDF 1.0\n#define ICON 0.0\nuniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nfloat fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\nreturn;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;varying vec4 v_data0;varying vec4 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}float h=elevation(a_pos);vec4 projectedPoint=u_matrix*vec4(a_pos,h,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(\n0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),h,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h,1.0);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*fontScale);\n#ifdef PITCH_WITH_MAP_TERRAIN\nvec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);\n#endif\nfloat occlusion_fade=occlusionFade(projectedPoint);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projectedPoint.w <=0.0 || occlusion_fade==0.0));float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}"),terrainRaster:Xe("uniform sampler2D u_image0;varying vec2 v_pos0;\n#ifdef FOG\nvarying float v_fog_opacity;\n#endif\nvoid main() {vec4 color=texture2D(u_image0,v_pos0);\n#ifdef FOG\ncolor.rgb=fog_dither(fog_apply_from_vert(color.rgb,v_fog_opacity));\n#endif\ngl_FragColor=color;\n#ifdef TERRAIN_WIREFRAME\ngl_FragColor=vec4(1.0,0.0,0.0,0.8);\n#endif\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform float u_skirt_height;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;\n#ifdef FOG\nvarying float v_fog_opacity;\n#endif\nconst float skirtOffset=24575.0;const float wireframeOffset=0.00015;void main() {v_pos0=a_texture_pos/8192.0;float skirt=float(a_pos.x >=skirtOffset);float elevation=elevation(a_texture_pos)-skirt*u_skirt_height;\n#ifdef TERRAIN_WIREFRAME\nelevation+=u_skirt_height*u_skirt_height*wireframeOffset;\n#endif\nvec2 decodedPos=a_pos-vec2(skirt*skirtOffset,0.0);gl_Position=u_matrix*vec4(decodedPos,elevation,1.0);\n#ifdef FOG\nv_fog_opacity=fog(fog_position(vec3(decodedPos,elevation)));\n#endif\n}"),terrainDepth:Xe("#ifdef GL_ES\nprecision highp float;\n#endif\nvec4 pack_depth(float ndc_z) {float depth=ndc_z*0.5+0.5;const vec4 bit_shift=vec4(256.0*256.0*256.0,256.0*256.0,256.0,1.0);const vec4 bit_mask =vec4(0.0,1.0/256.0,1.0/256.0,1.0/256.0);vec4 res=fract(depth*bit_shift);res-=res.xxyz*bit_mask;return res;}varying float v_depth;void main() {gl_FragColor=pack_depth(v_depth);}","uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying float v_depth;void main() {float elevation=elevation(a_texture_pos);gl_Position=u_matrix*vec4(a_pos,elevation,1.0);v_depth=gl_Position.z/gl_Position.w;}"),skybox:Xe("\nvarying lowp vec3 v_uv;uniform lowp samplerCube u_cubemap;uniform lowp float u_opacity;uniform highp float u_temporal_offset;uniform highp vec3 u_sun_direction;float sun_disk(highp vec3 ray_direction,highp vec3 sun_direction) {highp float cos_angle=dot(normalize(ray_direction),sun_direction);const highp float cos_sun_angular_diameter=0.99996192306;const highp float smoothstep_delta=1e-5;return smoothstep(\ncos_sun_angular_diameter-smoothstep_delta,cos_sun_angular_diameter+smoothstep_delta,cos_angle);}float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec3 uv=v_uv;const float y_bias=0.015;uv.y+=y_bias;uv.y=pow(abs(uv.y),1.0/5.0);uv.y=map(uv.y,0.0,1.0,-1.0,1.0);vec3 sky_color=textureCube(u_cubemap,uv).rgb;\n#ifdef FOG\nsky_color=fog_apply_sky_gradient(v_uv.xzy,sky_color);\n#endif\nsky_color.rgb=dither(sky_color.rgb,gl_FragCoord.xy+u_temporal_offset);sky_color+=0.1*sun_disk(v_uv,u_sun_direction);gl_FragColor=vec4(sky_color*u_opacity,u_opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}",qe),skyboxGradient:Xe("varying highp vec3 v_uv;uniform lowp sampler2D u_color_ramp;uniform lowp vec3 u_center_direction;uniform lowp float u_radius;uniform lowp float u_opacity;uniform highp float u_temporal_offset;void main() {float progress=acos(dot(normalize(v_uv),u_center_direction))/u_radius;vec4 color=texture2D(u_color_ramp,vec2(progress,0.5));\n#ifdef FOG\ncolor.rgb=fog_apply_sky_gradient(v_uv.xzy,color.rgb/color.a)*color.a;\n#endif\ncolor*=u_opacity;color.rgb=dither(color.rgb,gl_FragCoord.xy+u_temporal_offset);gl_FragColor=color;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}",qe),skyboxCapture:Xe("\nvarying highp vec3 v_position;uniform highp float u_sun_intensity;uniform highp float u_luminance;uniform lowp vec3 u_sun_direction;uniform highp vec4 u_color_tint_r;uniform highp vec4 u_color_tint_m;\n#ifdef GL_ES\nprecision highp float;\n#endif\n#define BETA_R                  vec3(5.5e-6,13.0e-6,22.4e-6)\n#define BETA_M                  vec3(21e-6,21e-6,21e-6)\n#define MIE_G                   0.76\n#define DENSITY_HEIGHT_SCALE_R  8000.0\n#define DENSITY_HEIGHT_SCALE_M  1200.0\n#define PLANET_RADIUS           6360e3\n#define ATMOSPHERE_RADIUS       6420e3\n#define SAMPLE_STEPS            10\n#define DENSITY_STEPS           4\nfloat ray_sphere_exit(vec3 orig,vec3 dir,float radius) {float a=dot(dir,dir);float b=2.0*dot(dir,orig);float c=dot(orig,orig)-radius*radius;float d=sqrt(b*b-4.0*a*c);return (-b+d)/(2.0*a);}vec3 extinction(vec2 density) {return exp(-vec3(BETA_R*u_color_tint_r.a*density.x+BETA_M*u_color_tint_m.a*density.y));}vec2 local_density(vec3 point) {float height=max(length(point)-PLANET_RADIUS,0.0);float exp_r=exp(-height/DENSITY_HEIGHT_SCALE_R);float exp_m=exp(-height/DENSITY_HEIGHT_SCALE_M);return vec2(exp_r,exp_m);}float phase_ray(float cos_angle) {return (3.0/(16.0*PI))*(1.0+cos_angle*cos_angle);}float phase_mie(float cos_angle) {return (3.0/(8.0*PI))*((1.0-MIE_G*MIE_G)*(1.0+cos_angle*cos_angle))/((2.0+MIE_G*MIE_G)*pow(1.0+MIE_G*MIE_G-2.0*MIE_G*cos_angle,1.5));}vec2 density_to_atmosphere(vec3 point,vec3 light_dir) {float ray_len=ray_sphere_exit(point,light_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(DENSITY_STEPS);vec2 density_point_to_atmosphere=vec2(0.0);for (int i=0; i < DENSITY_STEPS;++i) {vec3 point_on_ray=point+light_dir*((float(i)+0.5)*step_len);density_point_to_atmosphere+=local_density(point_on_ray)*step_len;;}return density_point_to_atmosphere;}vec3 atmosphere(vec3 ray_dir,vec3 sun_direction,float sun_intensity) {vec2 density_orig_to_point=vec2(0.0);vec3 scatter_r=vec3(0.0);vec3 scatter_m=vec3(0.0);vec3 origin=vec3(0.0,PLANET_RADIUS,0.0);float ray_len=ray_sphere_exit(origin,ray_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(SAMPLE_STEPS);for (int i=0; i < SAMPLE_STEPS;++i) {vec3 point_on_ray=origin+ray_dir*((float(i)+0.5)*step_len);vec2 density=local_density(point_on_ray)*step_len;density_orig_to_point+=density;vec2 density_point_to_atmosphere=density_to_atmosphere(point_on_ray,sun_direction);vec2 density_orig_to_atmosphere=density_orig_to_point+density_point_to_atmosphere;vec3 extinction=extinction(density_orig_to_atmosphere);scatter_r+=density.x*extinction;scatter_m+=density.y*extinction;}float cos_angle=dot(ray_dir,sun_direction);float phase_r=phase_ray(cos_angle);float phase_m=phase_mie(cos_angle);vec3 beta_r=BETA_R*u_color_tint_r.rgb*u_color_tint_r.a;vec3 beta_m=BETA_M*u_color_tint_m.rgb*u_color_tint_m.a;return (scatter_r*phase_r*beta_r+scatter_m*phase_m*beta_m)*sun_intensity;}const float A=0.15;const float B=0.50;const float C=0.10;const float D=0.20;const float E=0.02;const float F=0.30;vec3 uncharted2_tonemap(vec3 x) {return ((x*(A*x+C*B)+D*E)/(x*(A*x+B)+D*F))-E/F;}void main() {vec3 ray_direction=v_position;ray_direction.y=pow(ray_direction.y,5.0);const float y_bias=0.015;ray_direction.y+=y_bias;vec3 color=atmosphere(normalize(ray_direction),u_sun_direction,u_sun_intensity);float white_scale=1.0748724675633854;color=uncharted2_tonemap((log2(2.0/pow(u_luminance,4.0)))*color)*white_scale;gl_FragColor=vec4(color,1.0);}","attribute highp vec3 a_pos_3f;uniform mat3 u_matrix_3f;varying highp vec3 v_position;float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec4 pos=vec4(u_matrix_3f*a_pos_3f,1.0);v_position=pos.xyz;v_position.y*=-1.0;v_position.y=map(v_position.y,-1.0,1.0,0.0,1.0);gl_Position=vec4(a_pos_3f.xy,0.0,1.0);}")};function Xe(t,e,n){const i=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,r=/uniform (highp |mediump |lowp )?([\w]+) ([\w]+)([\s]*)([\w]*)/g,o=e.match(/attribute (highp |mediump |lowp )?([\w]+) ([\w]+)/g),s=t.match(r),a=e.match(r),l=je.match(r);let c=a?a.concat(s):s;n||($e.staticUniforms&&(c=$e.staticUniforms.concat(c)),Ge.staticUniforms&&(c=Ge.staticUniforms.concat(c))),c&&(c=c.concat(l));const u={};return{fragmentSource:t=t.replace(i,(t,e,n,i,r)=>(u[r]=!0,"define"===e?`\n#ifndef HAS_UNIFORM_u_${r}\nvarying ${n} ${i} ${r};\n#else\nuniform ${n} ${i} u_${r};\n#endif\n`:`\n#ifdef HAS_UNIFORM_u_${r}\n    ${n} ${i} ${r} = u_${r};\n#endif\n`)),vertexSource:e=e.replace(i,(t,e,n,i,r)=>{const o="float"===i?"vec2":"vec4",s=r.match(/color/)?"color":o;return u[r]?"define"===e?`\n#ifndef HAS_UNIFORM_u_${r}\nuniform lowp float u_${r}_t;\nattribute ${n} ${o} a_${r};\nvarying ${n} ${i} ${r};\n#else\nuniform ${n} ${i} u_${r};\n#endif\n`:"vec4"===s?`\n#ifndef HAS_UNIFORM_u_${r}\n    ${r} = a_${r};\n#else\n    ${n} ${i} ${r} = u_${r};\n#endif\n`:`\n#ifndef HAS_UNIFORM_u_${r}\n    ${r} = unpack_mix_${s}(a_${r}, u_${r}_t);\n#else\n    ${n} ${i} ${r} = u_${r};\n#endif\n`:"define"===e?`\n#ifndef HAS_UNIFORM_u_${r}\nuniform lowp float u_${r}_t;\nattribute ${n} ${o} a_${r};\n#else\nuniform ${n} ${i} u_${r};\n#endif\n`:"vec4"===s?`\n#ifndef HAS_UNIFORM_u_${r}\n    ${n} ${i} ${r} = a_${r};\n#else\n    ${n} ${i} ${r} = u_${r};\n#endif\n`:`\n#ifndef HAS_UNIFORM_u_${r}\n    ${n} ${i} ${r} = unpack_mix_${s}(a_${r}, u_${r}_t);\n#else\n    ${n} ${i} ${r} = u_${r};\n#endif\n`}),staticAttributes:o,staticUniforms:c}}class Ke{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null}bind(t,e,n,i,r,o,s,a){this.context=t;let l=this.boundPaintVertexBuffers.length!==i.length;for(let c=0;!l&&c<i.length;c++)this.boundPaintVertexBuffers[c]!==i[c]&&(l=!0);t.extVertexArrayObject&&this.vao&&this.boundProgram===e&&this.boundLayoutVertexBuffer===n&&!l&&this.boundIndexBuffer===r&&this.boundVertexOffset===o&&this.boundDynamicVertexBuffer===s&&this.boundDynamicVertexBuffer2===a?(t.bindVertexArrayOES.set(this.vao),s&&s.bind(),r&&r.dynamicDraw&&r.bind(),a&&a.bind()):this.freshBind(e,n,i,r,o,s,a)}freshBind(t,e,n,i,r,o,s){let a;const l=t.numAttributes,c=this.context,u=c.gl;if(c.extVertexArrayObject)this.vao&&this.destroy(),this.vao=c.extVertexArrayObject.createVertexArrayOES(),c.bindVertexArrayOES.set(this.vao),a=0,this.boundProgram=t,this.boundLayoutVertexBuffer=e,this.boundPaintVertexBuffers=n,this.boundIndexBuffer=i,this.boundVertexOffset=r,this.boundDynamicVertexBuffer=o,this.boundDynamicVertexBuffer2=s;else{a=c.currentNumAttributes||0;for(let t=l;t<a;t++)u.disableVertexAttribArray(t)}e.enableAttributes(u,t);for(const h of n)h.enableAttributes(u,t);o&&o.enableAttributes(u,t),s&&s.enableAttributes(u,t),e.bind(),e.setVertexAttribPointers(u,t,r);for(const h of n)h.bind(),h.setVertexAttribPointers(u,t,r);o&&(o.bind(),o.setVertexAttribPointers(u,t,r)),i&&i.bind(),s&&(s.bind(),s.setVertexAttribPointers(u,t,r)),c.currentNumAttributes=l}destroy(){this.vao&&(this.context.extVertexArrayObject.deleteVertexArrayOES(this.vao),this.vao=null)}}function Ye(e,n){const i=Math.pow(2,n.canonical.z),r=n.canonical.y;return[new t.MercatorCoordinate(0,r/i).toLngLat().lat,new t.MercatorCoordinate(0,(r+1)/i).toLngLat().lat]}function Je(e,n,i,r,o,s,a){const l=e.context,c=l.gl,u=i.fbo;if(!u)return;e.prepareDrawTile(n);const h=e.useProgram("hillshade");l.activeTexture.set(c.TEXTURE0),c.bindTexture(c.TEXTURE_2D,u.colorAttachment.get());const d=((t,e,n,i)=>{const r=n.paint.get("hillshade-shadow-color"),o=n.paint.get("hillshade-highlight-color"),s=n.paint.get("hillshade-accent-color");let a=n.paint.get("hillshade-illumination-direction")*(Math.PI/180);"viewport"===n.paint.get("hillshade-illumination-anchor")&&(a-=t.transform.angle);const l=!t.options.moving;return{u_matrix:i||t.transform.calculateProjMatrix(e.tileID.toUnwrapped(),l),u_image:0,u_latrange:Ye(0,e.tileID),u_light:[n.paint.get("hillshade-exaggeration"),a],u_shadow:r,u_highlight:o,u_accent:s}})(e,i,r,e.terrain?n.projMatrix:null);e.prepareDrawProgram(l,h,n.toUnwrapped()),h.draw(l,c.TRIANGLES,o,s,a,t.CullFaceMode.disabled,d,r.id,e.rasterBoundsBuffer,e.quadTriangleIndexBuffer,e.rasterBoundsSegments)}function Qe(e,n,i){if(!n.needsDEMTextureUpload)return;const r=e.context,o=r.gl;r.pixelStoreUnpackPremultiplyAlpha.set(!1),n.demTexture=n.demTexture||e.getTileTexture(i.stride);const s=i.getPixels();n.demTexture?n.demTexture.update(s,{premultiply:!1}):n.demTexture=new t.Texture(r,s,o.RGBA,{premultiply:!1}),n.needsDEMTextureUpload=!1}function tn(e,n,i,r,o,s){const a=e.context,l=a.gl;if(!n.dem)return;const c=n.dem;if(a.activeTexture.set(l.TEXTURE1),Qe(e,n,c),!n.demTexture)return;n.demTexture.bind(l.NEAREST,l.CLAMP_TO_EDGE);const u=c.dim;a.activeTexture.set(l.TEXTURE0);let h=n.fbo;if(!h){const e=new t.Texture(a,{width:u,height:u,data:null},l.RGBA);e.bind(l.LINEAR,l.CLAMP_TO_EDGE),h=n.fbo=a.createFramebuffer(u,u,!0),h.colorAttachment.set(e.texture)}a.bindFramebuffer.set(h.framebuffer),a.viewport.set([0,0,u,u]),e.useProgram("hillshadePrepare").draw(a,l.TRIANGLES,r,o,s,t.CullFaceMode.disabled,((e,n)=>{const i=n.stride,r=t.create$1();return t.ortho(r,0,t.EXTENT,-t.EXTENT,0,0,1),t.translate(r,r,[0,-t.EXTENT,0]),{u_matrix:r,u_image:1,u_dimension:[i,i],u_zoom:e.overscaledZ,u_unpack:n.unpackVector}})(n.tileID,c),i.id,e.rasterBoundsBuffer,e.quadTriangleIndexBuffer,e.rasterBoundsSegments),n.needsHillshadePrepare=!1}const en=(e,n)=>({u_matrix:new t.UniformMatrix4f(e,n.u_matrix),u_image0:new t.Uniform1i(e,n.u_image0),u_skirt_height:new t.Uniform1f(e,n.u_skirt_height)}),nn=(t,e)=>({u_matrix:t,u_image0:0,u_skirt_height:e}),rn=new class{constructor(){this.operations={}}newMorphing(t,e,n,i,r){if(t in this.operations){const e=this.operations[t];e.to.tileID.key!==n.tileID.key&&(e.queued=n)}else this.operations[t]={startTime:i,phase:0,duration:r,from:e,to:n,queued:null}}getMorphValuesForProxy(t){if(!(t in this.operations))return null;const e=this.operations[t];return{from:e.from,to:e.to,phase:e.phase}}update(t){for(const e in this.operations){const n=this.operations[e];for(n.phase=(t-n.startTime)/n.duration;n.phase>=1||!this._validOp(n);)if(!this._nextOp(n,t)){delete this.operations[e];break}}}_nextOp(t,e){return!!t.queued&&(t.from=t.to,t.to=t.queued,t.queued=null,t.phase=0,t.startTime=e,!0)}_validOp(t){return t.from.hasData()&&t.to.hasData()}},on={0:null,1:"TERRAIN_VERTEX_MORPHING",2:"TERRAIN_WIREFRAME"};function sn(e,n,i,r,o){const s=e.context,a=s.gl;let l,c;const u=e.options.showTerrainWireframe?2:0,h=(t,n)=>{if(c===t)return;const i=[on[t]];n&&i.push(on[u]),l=e.useProgram("terrainRaster",null,i),c=t},d=e.colorModeForRenderPass(),p=new t.DepthMode(a.LEQUAL,t.DepthMode.ReadWrite,e.depthRangeFor3D);rn.update(o);const f=e.transform,m=6*Math.pow(1.5,22-f.zoom)*n.exaggeration();(u?[!1,!0]:[!1]).forEach(u=>{c=-1;const g=u?a.LINES:a.TRIANGLES,[_,y]=u?n.getWirefameBuffer():[n.gridIndexBuffer,n.gridSegments];for(const c of r){const r=i.getTile(c),b=t.StencilMode.disabled,w=n.prevTerrainTileForTile[c.key],C=n.terrainTileForTile[c.key];x=C,null!=(v=w)&&null!=x&&v.hasData()&&x.hasData()&&null!=v.demTexture&&null!=x.demTexture&&v.tileID.key!==x.tileID.key&&rn.newMorphing(c.key,w,C,o,250),s.activeTexture.set(a.TEXTURE0),r.texture.bind(a.LINEAR,a.CLAMP_TO_EDGE,a.LINEAR_MIPMAP_NEAREST);const T=rn.getMorphValuesForProxy(c.key),S=T?1:0;let E;T&&(E={morphing:{srcDemTile:T.from,dstDemTile:T.to,phase:t.easeCubicInOut(T.phase)}});const k=nn(c.projMatrix,an(c.canonical,f.renderWorldCopies)?m/10:m);h(S,u),n.setupElevationDraw(r,l,E),e.prepareDrawProgram(s,l,c.toUnwrapped()),l.draw(s,g,p,b,d,t.CullFaceMode.backCCW,k,"terrain_raster",n.gridBuffer,_,y)}var v,x})}function an(t,e){const n=1<<t.z;return!e&&(0===t.x||t.x===n-1)||0===t.y||t.y===n-1}const ln=t=>({u_matrix:t});function cn(e,n,i,r,o){if(o>0){const s=t.exported.now(),a=(s-e.timeAdded)/o,l=n?(s-n.timeAdded)/o:-1,c=i.getSource(),u=r.coveringZoomLevel({tileSize:c.tileSize,roundZoom:c.roundZoom}),h=!n||Math.abs(n.tileID.overscaledZ-u)>Math.abs(e.tileID.overscaledZ-u),d=h&&e.refreshedUponExpiration?1:t.clamp(h?a:1-l,0,1);return e.refreshedUponExpiration&&a>=1&&(e.refreshedUponExpiration=!1),n?{opacity:1,mix:1-d}:{opacity:d,mix:0}}return{opacity:1,mix:0}}class un extends t.SourceCache{constructor(t){const e=Et("proxy",{type:"geojson",maxzoom:t.transform.maxZoom},new A(Lt(),null),t.style);super("proxy",e,!1),e.setEventedParent(this),this.map=this.getSource().map=t,this.used=this._sourceLoaded=!0,this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}update(e,n,i){if(e.freezeTileCoverage)return;this.transform=e;const r=e.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}).reduce((n,i)=>{if(n[i.key]="",!this._tiles[i.key]){const n=new t.Tile(i,this._source.tileSize*i.overscaleFactor(),e.tileZoom);n.state="loaded",this._tiles[i.key]=n}return n},{});for(const t in this._tiles)t in r||(this.freeFBO(t),this._tiles[t].state="unloaded",delete this._tiles[t])}freeFBO(t){const e=this.proxyCachedFBO[t];if(void 0!==e){const n=Object.values(e);this.renderCachePool.push(...n),delete this.proxyCachedFBO[t]}}deallocRenderCache(){this.renderCache.forEach(t=>t.fb.destroy()),this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}}class hn extends t.OverscaledTileID{constructor(t,e,n){super(t.overscaledZ,t.wrap,t.canonical.z,t.canonical.x,t.canonical.y),this.proxyTileKey=e,this.projMatrix=n}}class dn extends t.Elevation{constructor(e,n){super(),this.painter=e,this.terrainTileForTile={},this.prevTerrainTileForTile={};const[i,r,o]=function(e){const n=new t.StructArrayLayout4i8,i=new t.StructArrayLayout3ui6,r=131;n.reserve(17161),i.reserve(33800);const o=t.EXTENT/128,s=t.EXTENT+o/2,a=s+o;for(let c=-o;c<a;c+=o)for(let e=-o;e<a;e+=o){const i=e<0||e>s||c<0||c>s?24575:0,r=t.clamp(Math.round(e),0,t.EXTENT),o=t.clamp(Math.round(c),0,t.EXTENT);n.emplaceBack(r+i,o,r,o)}const l=(t,e)=>{const n=e*r+t;i.emplaceBack(n+1,n,n+r),i.emplaceBack(n+r,n+r+1,n+1)};for(let t=1;t<129;t++)for(let e=1;e<129;e++)l(e,t);return[0,129].forEach(t=>{for(let e=0;e<130;e++)l(e,t),l(t,e)}),[n,i,32768]}(),s=e.context;this.gridBuffer=s.createVertexBuffer(i,Ct.members),this.gridIndexBuffer=s.createIndexBuffer(r),this.gridSegments=t.SegmentVector.simpleSegment(0,0,i.length,r.length),this.gridNoSkirtSegments=t.SegmentVector.simpleSegment(0,0,i.length,o),this.proxyCoords=[],this.proxiedCoords={},this._visibleDemTiles=[],this._drapedRenderBatches=[],this._sourceTilesOverlap={},this.proxySourceCache=new un(n.map),this.orthoMatrix=t.create$1(),t.ortho(this.orthoMatrix,0,t.EXTENT,0,t.EXTENT,0,1);const a=s.gl;this._overlapStencilMode=new t.StencilMode({func:a.GEQUAL,mask:255},0,255,a.KEEP,a.KEEP,a.REPLACE),this._previousZoom=e.transform.zoom,this.pool=[],this._findCoveringTileCache={},this._tilesDirty={},this.style=n,this._useVertexMorphing=!0,this._exaggeration=1}set style(t){t.on("data",this._onStyleDataEvent.bind(this)),t.on("neworder",this._checkRenderCacheEfficiency.bind(this)),this._style=t,this._checkRenderCacheEfficiency()}update(e,n,i){if(e&&e.terrain){this._style!==e&&(this.style=e),this.enabled=!0;const r=e.terrain.properties;this.sourceCache=e._getSourceCache(r.get("source")),this._exaggeration=r.get("exaggeration");const o=()=>{this.sourceCache.used&&t.warnOnce(`Raster DEM source '${this.sourceCache.id}' is used both for terrain and as layer source.\nThis leads to lower resolution of hillshade. For full hillshade resolution but higher memory consumption, define another raster DEM source.`);const e=this.sourceCache.getSource().tileSize/128,i=this.proxySourceCache.getSource().tileSize;this.sourceCache.update(n,e*i,!0),this._findCoveringTileCache[this.sourceCache.id]={}};this.sourceCache.usedForTerrain||(this._findCoveringTileCache[this.sourceCache.id]={},this.sourceCache.usedForTerrain=!0,o(),this._initializing=!0),o(),n.updateElevation(!i),this._findCoveringTileCache[this.proxySourceCache.id]={},this.proxySourceCache.update(n),this._emptyDEMTextureDirty=!0}else this._disable()}_checkRenderCacheEfficiency(){const e=this.renderCacheEfficiency(this._style);this._style.map._optimizeForTerrain||100!==e.efficiency&&t.warnOnce(`Terrain render cache efficiency is not optimal (${e.efficiency}%) and performance\n                may be affected negatively, consider placing all background, fill and line layers before layer\n                with id '${e.firstUndrapedLayer}' or create a map using optimizeForTerrain: true option.`)}_onStyleDataEvent(t){t.coord&&"source"===t.dataType?this._clearRenderCacheForTile(t.sourceCacheId,t.coord):"style"===t.dataType&&(this._invalidateRenderCache=!0)}_disable(){if(this.enabled&&(this.enabled=!1,this._sharedDepthStencil=void 0,this.proxySourceCache.deallocRenderCache(),this._style))for(const t in this._style._sourceCaches)this._style._sourceCaches[t].usedForTerrain=!1}destroy(){this._disable(),this._emptyDEMTexture&&this._emptyDEMTexture.destroy(),this.pool.forEach(t=>t.fb.destroy()),this.pool=[],this._depthFBO&&(this._depthFBO.destroy(),delete this._depthFBO,delete this._depthTexture)}_source(){return this.enabled?this.sourceCache:null}exaggeration(){return this._exaggeration}get visibleDemTiles(){return this._visibleDemTiles}get drapeBufferSize(){const t=2*this.proxySourceCache.getSource().tileSize;return[t,t]}set useVertexMorphing(t){this._useVertexMorphing=t}updateTileBinding(e){if(!this.enabled)return;this.prevTerrainTileForTile=this.terrainTileForTile;const n=this.proxySourceCache,i=this.painter.transform;this._initializing&&(this._initializing=0===i._centerAltitude&&-1===this.getAtPointOrZero(t.MercatorCoordinate.fromLngLat(i.center),-1),this._emptyDEMTextureDirty=!this._initializing);const r=this.painter.options;this.renderCached=(r.zooming||r.moving||r.rotating||!!this.forceRenderCached)&&!this._invalidateRenderCache,this._invalidateRenderCache=!1;const o=this.proxyCoords=n.getIds().map(t=>{const e=n.getTileByID(t).tileID;return e.projMatrix=i.calculateProjMatrix(e.toUnwrapped()),e});!function(e,n){const i=n.transform.pointCoordinate(n.transform.getCameraPoint()),r=new t.pointGeometry(i.x,i.y);e.sort((e,n)=>{if(n.overscaledZ-e.overscaledZ)return n.overscaledZ-e.overscaledZ;const i=new t.pointGeometry(e.canonical.x+(1<<e.canonical.z)*e.wrap,e.canonical.y),o=new t.pointGeometry(n.canonical.x+(1<<n.canonical.z)*n.wrap,n.canonical.y),s=r.mult(1<<e.canonical.z);return s.x-=.5,s.y-=.5,s.distSqr(i)-s.distSqr(o)})}(o,this.painter),this._previousZoom=i.zoom;const s=this.proxyToSource||{};this.proxyToSource={},o.forEach(t=>{this.proxyToSource[t.key]={}}),this.terrainTileForTile={};const a=this._style._sourceCaches;for(const t in a){const n=a[t];if(!n.used)continue;if(n!==this.sourceCache&&(this._findCoveringTileCache[n.id]={}),this._setupProxiedCoordsForOrtho(n,e[t],s),n.usedForTerrain)continue;const i=e[t];n.getSource().reparseOverscaled&&this._assignTerrainTiles(i)}this.proxiedCoords[n.id]=o.map(t=>new hn(t,t.key,this.orthoMatrix)),this._assignTerrainTiles(o),this._prepareDEMTextures(),this._setupDrapedRenderBatches(),this._initFBOPool(),this._setupRenderCache(s),this.renderingToTexture=!1,this._updateTimestamp=t.exported.now();const l={};this._visibleDemTiles=[];for(const t of this.proxyCoords){const e=this.terrainTileForTile[t.key];if(!e)continue;const n=e.tileID.key;n in l||(this._visibleDemTiles.push(e),l[n]=n)}}_assignTerrainTiles(t){this._initializing||t.forEach(t=>{if(this.terrainTileForTile[t.key])return;const e=this._findTileCoveringTileID(t,this.sourceCache);e&&(this.terrainTileForTile[t.key]=e)})}_prepareDEMTextures(){const t=this.painter.context,e=t.gl;for(const n in this.terrainTileForTile){const i=this.terrainTileForTile[n],r=i.dem;!r||i.demTexture&&!i.needsDEMTextureUpload||(t.activeTexture.set(e.TEXTURE1),Qe(this.painter,i,r))}}_prepareDemTileUniforms(t,e,n,i){if(!e||null==e.demTexture)return!1;const r=t.tileID.canonical,o=Math.pow(2,e.tileID.canonical.z-r.z),s=i||"";return n["u_dem_tl"+s]=[r.x*o%1,r.y*o%1],n["u_dem_scale"+s]=o,!0}get emptyDEMTexture(){return!this._emptyDEMTextureDirty&&this._emptyDEMTexture?this._emptyDEMTexture:this._updateEmptyDEMTexture()}_getLoadedAreaMinimum(){let t=0;const e=this._visibleDemTiles.reduce((e,n)=>{if(!n.dem)return e;const i=n.dem.tree.minimums[0];return i>0&&t++,e+i},0);return t?e/t:0}_updateEmptyDEMTexture(){const e=this.painter.context,n=e.gl;e.activeTexture.set(n.TEXTURE2);const i=this._getLoadedAreaMinimum(),r={width:1,height:1,data:new Uint8Array(t.DEMData.pack(i,this.sourceCache.getSource().encoding))};this._emptyDEMTextureDirty=!1;let o=this._emptyDEMTexture;return o?o.update(r,{premultiply:!1}):o=this._emptyDEMTexture=new t.Texture(e,r,n.RGBA,{premultiply:!1}),o}setupElevationDraw(e,n,i){const r=this.painter.context,o=r.gl,s=(a=this.sourceCache.getSource().encoding,{u_dem:2,u_dem_prev:4,u_dem_unpack:t.DEMData.getUnpackVector(a),u_dem_tl:[0,0],u_dem_tl_prev:[0,0],u_dem_scale:0,u_dem_scale_prev:0,u_dem_size:0,u_dem_lerp:1,u_depth:3,u_depth_size_inv:[0,0],u_exaggeration:0});var a;s.u_dem_size=this.sourceCache.getSource().tileSize,s.u_exaggeration=this.exaggeration();let l=null,c=null,u=1;if(i&&i.morphing&&this._useVertexMorphing){const t=i.morphing.srcDemTile,n=i.morphing.dstDemTile;u=i.morphing.phase,t&&n&&(this._prepareDemTileUniforms(e,t,s,"_prev")&&(c=t),this._prepareDemTileUniforms(e,n,s)&&(l=n))}if(c&&l?(r.activeTexture.set(o.TEXTURE2),l.demTexture.bind(o.NEAREST,o.CLAMP_TO_EDGE,o.NEAREST),r.activeTexture.set(o.TEXTURE4),c.demTexture.bind(o.NEAREST,o.CLAMP_TO_EDGE,o.NEAREST),s.u_dem_lerp=u):(l=this.terrainTileForTile[e.tileID.key],r.activeTexture.set(o.TEXTURE2),(this._prepareDemTileUniforms(e,l,s)?l.demTexture:this.emptyDEMTexture).bind(o.NEAREST,o.CLAMP_TO_EDGE,o.NEAREST)),i&&i.useDepthForOcclusion&&(r.activeTexture.set(o.TEXTURE3),this._depthTexture.bind(o.NEAREST,o.CLAMP_TO_EDGE,o.NEAREST),s.u_depth_size_inv=[1/this._depthFBO.width,1/this._depthFBO.height]),i&&i.useMeterToDem&&l){const e=(1<<l.tileID.canonical.z)*t.mercatorZfromAltitude(1,this.painter.transform.center.lat)*this.sourceCache.getSource().tileSize;s.u_meter_to_dem=e}i&&i.labelPlaneMatrixInv&&(s.u_label_plane_matrix_inv=i.labelPlaneMatrixInv),n.setTerrainUniformValues(r,s)}renderBatch(e){if(0===this._drapedRenderBatches.length)return e+1;this.renderingToTexture=!0;const n=this.painter,i=this.painter.context,r=this.proxySourceCache,o=this.proxiedCoords[r.id],s=()=>{i.bindFramebuffer.set(null),i.viewport.set([0,0,n.width,n.height]),this.renderingToTexture=!1},a=this._drapedRenderBatches.shift();let l=[];const c=n.style.order;let u=0;for(let h=0;h<o.length;h++){const d=o[h],p=r.getTileByID(d.proxyTileKey),f=r.proxyCachedFBO[d.key]?r.proxyCachedFBO[d.key][e]:void 0;let m,g;if(m=this.currentFBO=void 0!==f?r.renderCache[f]:this.pool[u++],p.texture=m.tex,void 0===f||m.dirty){i.bindFramebuffer.set(m.fb.framebuffer),this.renderedToTile=!1,m.dirty&&(i.clear({color:t.Color.transparent}),m.dirty=!1);for(let t=a.start;t<=a.end;++t){const e=n.style._layers[c[t]];if(e.isHidden(n.transform.zoom))continue;const r=n.style._getLayerSourceCache(e),o=r?this.proxyToSource[d.key][r.id]:[d];if(!o)continue;const s=o;i.viewport.set([0,0,m.fb.width,m.fb.height]),g!==(r?r.id:null)&&(this._setupStencil(o,e,r),g=r?r.id:null),n.renderLayer(n,r,e,s)}m.dirty=this.renderedToTile,this.renderedToTile&&l.push(p.tileID),5===u&&(u=0,l.length>0&&(s(),sn(n,this,r,l,this._updateTimestamp),this.renderingToTexture=!0,l=[]))}else l.push(p.tileID)}return s(),l.length>0&&sn(n,this,r,l,this._updateTimestamp),a.end+1}postRender(){}renderCacheEfficiency(t){const e=t.order.length;if(0===e)return{efficiency:100};let n,i=0,r=0,o=!1;for(let s=0;s<e;++s){const e=t._layers[t.order[s]];this._style.isLayerDraped(e)?(o&&++i,++r):o||(o=!0,n=e.id)}return 0===r?{efficiency:100}:{efficiency:100*(1-i/r),firstUndrapedLayer:n}}getMinElevationBelowMSL(){let t=0;return this._visibleDemTiles.filter(t=>t.dem).forEach(e=>{t=Math.min(t,e.dem.tree.minimums[0])}),0===t?t:(t-30)*this._exaggeration}raycast(t,e,n){if(!this._visibleDemTiles)return null;const i=this._visibleDemTiles.filter(t=>t.dem).map(i=>{const r=i.tileID,o=Math.pow(2,r.overscaledZ),{x:s,y:a}=r.canonical,l=s/o,c=(s+1)/o,u=a/o,h=(a+1)/o;return{minx:l,miny:u,maxx:c,maxy:h,t:i.dem.tree.raycastRoot(l,u,c,h,t,e,n),tile:i}});i.sort((t,e)=>(null!==t.t?t.t:Number.MAX_VALUE)-(null!==e.t?e.t:Number.MAX_VALUE));for(const r of i){if(null==r.t)return null;const i=r.tile.dem.tree.raycast(r.minx,r.miny,r.maxx,r.maxy,t,e,n);if(null!=i)return i}return null}_createFBO(){const e=this.painter.context,n=e.gl,i=this.drapeBufferSize;e.activeTexture.set(n.TEXTURE0);const r=new t.Texture(e,{width:i[0],height:i[1],data:null},n.RGBA);r.bind(n.LINEAR,n.CLAMP_TO_EDGE);const o=e.createFramebuffer(i[0],i[1],!1);return o.colorAttachment.set(r.texture),o.depthAttachment=new yt(e,o.framebuffer),void 0===this._sharedDepthStencil?(this._sharedDepthStencil=e.createRenderbuffer(e.gl.DEPTH_STENCIL,i[0],i[1]),this._stencilRef=0,o.depthAttachment.set(this._sharedDepthStencil),e.clear({stencil:0})):o.depthAttachment.set(this._sharedDepthStencil),e.extTextureFilterAnisotropic&&!e.extTextureFilterAnisotropicForceOff&&n.texParameterf(n.TEXTURE_2D,e.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,e.extTextureFilterAnisotropicMax),{fb:o,tex:r,dirty:!1}}_initFBOPool(){for(;this.pool.length<Math.min(5,this.proxyCoords.length);)this.pool.push(this._createFBO())}_shouldDisableRenderCache(){if(!this.renderCached)return!0;if(this._style.light&&this._style.light.hasTransition())return!0;for(const t in this._style._sourceCaches)if(this._style._sourceCaches[t].hasTransition())return!0;return this._style.order.some(t=>{const e=this._style._layers[t],n=e.isHidden(this.painter.transform.zoom),i=e.getCrossfadeParameters(),r=!!i&&1!==i.t,o=e.hasTransition();return"custom"!==e.type&&!n&&(r||o)})}_clearRasterFadeFromRenderCache(){let t=!1;for(const e in this._style._sourceCaches)if(this._style._sourceCaches[e]._source instanceof bt){t=!0;break}if(t)for(let e=0;e<this._style.order.length;++e){const t=this._style._layers[this._style.order[e]],n=t.isHidden(this.painter.transform.zoom),i=this._style._getLayerSourceCache(t);if("raster"!==t.type||n||!i)continue;const r=t.paint.get("raster-fade-duration");for(const e of this.proxyCoords){const t=this.proxyToSource[e.key][i.id];if(t)for(const e of t){const t=cn(i.getTile(e),i.findLoadedParent(e,0),i,this.painter.transform,r);(1!==t.opacity||0!==t.mix)&&this._clearRenderCacheForTile(i.id,e)}}}}_setupDrapedRenderBatches(){const t=this._style.order,e=t.length;if(0===e)return;const n=[];let i,r=0,o=this._style._layers[t[r]];for(;!this._style.isLayerDraped(o)&&o.isHidden(this.painter.transform.zoom)&&++r<e;)o=this._style._layers[t[r]];for(;r<e;++r){const e=this._style._layers[t[r]];e.isHidden(this.painter.transform.zoom)||(this._style.isLayerDraped(e)?void 0===i&&(i=r):void 0!==i&&(n.push({start:i,end:r-1}),i=void 0))}void 0!==i&&n.push({start:i,end:r-1}),this._drapedRenderBatches=n}_setupRenderCache(t){const e=this.proxySourceCache;if(this._shouldDisableRenderCache()){if(e.renderCache.length>e.renderCachePool.length){const t=Object.values(e.proxyCachedFBO);e.proxyCachedFBO={};for(let n=0;n<t.length;++n){const i=Object.values(t[n]);e.renderCachePool.push(...i)}}return}this._clearRasterFadeFromRenderCache();const n=this.proxyCoords,i=this._tilesDirty;for(let r=n.length-1;r>=0;r--){const o=n[r];if(e.getTileByID(o.key),void 0!==e.proxyCachedFBO[o.key]){const n=t[o.key],r=this.proxyToSource[o.key];let s=0;for(const t in r){const e=r[t],o=n[t];if(!o||o.length!==e.length||e.some((e,n)=>e!==o[n]||i[t]&&i[t].hasOwnProperty(e.key))){s=-1;break}++s}for(const t in e.proxyCachedFBO[o.key])e.renderCache[e.proxyCachedFBO[o.key][t]].dirty=s<0||s!==Object.values(n).length}else for(let t=0;t<this._drapedRenderBatches.length;++t){const n=this._drapedRenderBatches[t];let i=e.renderCachePool.pop();void 0===i&&e.renderCache.length<50&&(i=e.renderCache.length,e.renderCache.push(this._createFBO())),void 0!==i&&(void 0===e.proxyCachedFBO[o.key]&&(e.proxyCachedFBO[o.key]={}),e.proxyCachedFBO[o.key][n.start]=i,e.renderCache[i].dirty=!0)}}this._tilesDirty={}}_setupStencil(t,e,n){if(!n||!this._sourceTilesOverlap[n.id])return void(this._overlapStencilType&&(this._overlapStencilType=!1));const i=this.painter.context,r=i.gl;if(t.length<=1)return void(this._overlapStencilType=!1);let o;if(e.isTileClipped())o=t.length,this._overlapStencilMode.test={func:r.EQUAL,mask:255},this._overlapStencilType="Clip";else{if(!(t[0].overscaledZ>t[t.length-1].overscaledZ))return void(this._overlapStencilType=!1);o=1,this._overlapStencilMode.test={func:r.GREATER,mask:255},this._overlapStencilType="Mask"}this._stencilRef+o>255&&(i.clear({stencil:0}),this._stencilRef=0),this._stencilRef+=o,this._overlapStencilMode.ref=this._stencilRef,e.isTileClipped()&&this._renderTileClippingMasks(t,this._overlapStencilMode.ref)}stencilModeForRTTOverlap(e){return this.renderingToTexture&&this._overlapStencilType?("Clip"===this._overlapStencilType&&(this._overlapStencilMode.ref=this.painter._tileClippingMaskIDs[e.key]),this._overlapStencilMode):t.StencilMode.disabled}_renderTileClippingMasks(e,n){const i=this.painter,r=this.painter.context,o=r.gl;i._tileClippingMaskIDs={},r.setColorMode(t.ColorMode.disabled),r.setDepthMode(t.DepthMode.disabled);const s=i.useProgram("clippingMask");for(const a of e){const e=i._tileClippingMaskIDs[a.key]=--n;s.draw(r,o.TRIANGLES,t.DepthMode.disabled,new t.StencilMode({func:o.ALWAYS,mask:0},e,255,o.KEEP,o.KEEP,o.REPLACE),t.ColorMode.disabled,t.CullFaceMode.disabled,ln(a.projMatrix),"$clipping",i.tileExtentBuffer,i.quadTriangleIndexBuffer,i.tileExtentSegments)}}pointCoordinate(e){const n=this.painter.transform;if(e.x<0||e.x>n.width||e.y<0||e.y>n.height)return null;const i=[e.x,e.y,1,1];t.transformMat4(i,i,n.pixelMatrixInverse),t.scale$2(i,i,1/i[3]),i[0]/=n.worldSize,i[1]/=n.worldSize;const r=n._camera.position,o=t.mercatorZfromAltitude(1,n.center.lat),s=[r[0],r[1],r[2]/o,0],a=t.subtract([],i.slice(0,3),s);t.normalize(a,a);const l=this.raycast(s,a,this._exaggeration);return null!==l&&l?(t.scaleAndAdd(s,s,a,l),s[3]=s[2],s[2]*=o,s):null}drawDepth(){const e=this.painter,n=e.context,i=this.proxySourceCache,r=Math.ceil(e.width),o=Math.ceil(e.height);if(!this._depthFBO||this._depthFBO.width===r&&this._depthFBO.height===o||(this._depthFBO.destroy(),delete this._depthFBO,delete this._depthTexture),!this._depthFBO){const e=n.gl,i=n.createFramebuffer(r,o,!0);n.activeTexture.set(e.TEXTURE0);const s=new t.Texture(n,{width:r,height:o,data:null},e.RGBA);s.bind(e.NEAREST,e.CLAMP_TO_EDGE),i.colorAttachment.set(s.texture);const a=n.createRenderbuffer(n.gl.DEPTH_COMPONENT16,r,o);i.depthAttachment.set(a),this._depthFBO=i,this._depthTexture=s}n.bindFramebuffer.set(this._depthFBO.framebuffer),n.viewport.set([0,0,r,o]),function(e,n,i,r){const o=e.context,s=o.gl;o.clear({depth:1});const a=e.useProgram("terrainDepth"),l=new t.DepthMode(s.LESS,t.DepthMode.ReadWrite,e.depthRangeFor3D);for(const c of r){const e=i.getTile(c),r=nn(c.projMatrix,0);n.setupElevationDraw(e,a),a.draw(o,s.TRIANGLES,l,t.StencilMode.disabled,t.ColorMode.unblended,t.CullFaceMode.backCCW,r,"terrain_depth",n.gridBuffer,n.gridIndexBuffer,n.gridNoSkirtSegments)}}(e,this,i,this.proxyCoords)}_setupProxiedCoordsForOrtho(t,e,n){if(t.getSource()instanceof Tt)return this._setupProxiedCoordsForImageSource(t,e,n);this._findCoveringTileCache[t.id]=this._findCoveringTileCache[t.id]||{};const i=this.proxiedCoords[t.id]=[],r=this.proxyCoords;for(let s=0;s<r.length;s++){const e=r[s],o=this._findTileCoveringTileID(e,t);if(o){const r=this._createProxiedId(e,o,n[e.key]&&n[e.key][t.id]);i.push(r),this.proxyToSource[e.key][t.id]=[r]}}let o=!1;for(let s=0;s<e.length;s++){const r=t.getTile(e[s]);if(!r||!r.hasData())continue;const a=this._findTileCoveringTileID(r.tileID,this.proxySourceCache);if(a&&a.tileID.canonical.z!==r.tileID.canonical.z){const e=this.proxyToSource[a.tileID.key][t.id],s=this._createProxiedId(a.tileID,r,n[a.tileID.key]&&n[a.tileID.key][t.id]);e?e.splice(e.length-1,0,s):this.proxyToSource[a.tileID.key][t.id]=[s],i.push(s),o=!0}}this._sourceTilesOverlap[t.id]=o}_setupProxiedCoordsForImageSource(e,n,i){if(!e.getSource().loaded())return;const r=this.proxiedCoords[e.id]=[],o=this.proxyCoords,s=e.getSource(),a=new t.pointGeometry(s.tileID.x,s.tileID.y)._div(1<<s.tileID.z),l=s.coordinates.map(t.MercatorCoordinate.fromLngLat).reduce((t,e)=>(t.min.x=Math.min(t.min.x,e.x-a.x),t.min.y=Math.min(t.min.y,e.y-a.y),t.max.x=Math.max(t.max.x,e.x-a.x),t.max.y=Math.max(t.max.y,e.y-a.y),t),{min:new t.pointGeometry(Number.MAX_VALUE,Number.MAX_VALUE),max:new t.pointGeometry(-Number.MAX_VALUE,-Number.MAX_VALUE)}),c=(e,n)=>{const i=e.wrap+e.canonical.x/(1<<e.canonical.z),r=e.canonical.y/(1<<e.canonical.z),o=t.EXTENT/(1<<e.canonical.z),s=n.wrap+n.canonical.x/(1<<n.canonical.z),a=n.canonical.y/(1<<n.canonical.z);return i+o<s+l.min.x||i>s+l.max.x||r+o<a+l.min.y||r>a+l.max.y};for(let t=0;t<o.length;t++){const s=o[t];for(let t=0;t<n.length;t++){const o=e.getTile(n[t]);if(!o||!o.hasData())continue;if(c(s,o.tileID))continue;const a=this._createProxiedId(s,o,i[s.key]&&i[s.key][e.id]),l=this.proxyToSource[s.key][e.id];l?l.push(a):this.proxyToSource[s.key][e.id]=[a],r.push(a)}}}_createProxiedId(e,n,i){let r=this.orthoMatrix;if(i){const t=i.find(t=>t.key===n.tileID.key);if(t)return t}if(n.tileID.key!==e.key){const i=e.canonical.z-n.tileID.canonical.z;let o,s,a;r=t.create$1();const l=n.tileID.wrap-e.wrap<<e.overscaledZ;i>0?(o=t.EXTENT>>i,s=o*((n.tileID.canonical.x<<i)-e.canonical.x+l),a=o*((n.tileID.canonical.y<<i)-e.canonical.y)):(o=t.EXTENT<<-i,s=t.EXTENT*(n.tileID.canonical.x-(e.canonical.x+l<<-i)),a=t.EXTENT*(n.tileID.canonical.y-(e.canonical.y<<-i))),t.ortho(r,0,o,0,o,0,1),t.translate(r,r,[s,a,0])}return new hn(n.tileID,e.key,r)}_findTileCoveringTileID(e,n){let i=n.getTile(e);if(i&&i.hasData())return i;const r=this._findCoveringTileCache[n.id],o=r[e.key];if(i=o?n.getTileByID(o):null,i&&i.hasData()||null===o)return i;let s=i?i.tileID:e,a=s.overscaledZ;const l=n.getSource().minzoom,c=[];if(!o){const r=n.getSource().maxzoom;if(e.canonical.z>=r){const i=e.canonical.z-r;n.getSource().reparseOverscaled?(a=Math.max(e.canonical.z+2,n.transform.tileZoom),s=new t.OverscaledTileID(a,e.wrap,r,e.canonical.x>>i,e.canonical.y>>i)):0!==i&&(a=r,s=new t.OverscaledTileID(a,e.wrap,r,e.canonical.x>>i,e.canonical.y>>i))}s.key!==e.key&&(c.push(s.key),i=n.getTile(s))}const u=t=>{c.forEach(e=>{r[e]=t}),c.length=0};for(a-=1;a>=l&&(!i||!i.hasData());a--){i&&u(i.tileID.key);const t=s.calculateScaledKey(a);if(i=n.getTileByID(t),i&&i.hasData())break;const e=r[t];if(null===e)break;void 0===e?c.push(t):i=n.getTileByID(e)}return u(i?i.tileID.key:null),i&&i.hasData()?i:null}findDEMTileFor(t){return this.enabled?this._findTileCoveringTileID(t,this.sourceCache):null}prepareDrawTile(t){this.renderedToTile||(this.renderedToTile=!0)}_clearRenderCacheForTile(t,e){let n=this._tilesDirty[t];n||(n=this._tilesDirty[t]={}),n[e.key]=!0}getWirefameBuffer(){if(!this.wireframeSegments){const e=function(e){let n,i,r;const o=new t.StructArrayLayout2ui4,s=131;for(i=1;i<129;i++){for(n=1;n<129;n++)r=i*s+n,o.emplaceBack(r,r+1),o.emplaceBack(r,r+s),o.emplaceBack(r+1,r+s),128===i&&o.emplaceBack(r+s,r+s+1);o.emplaceBack(r+1,r+1+s)}return o}();this.wireframeIndexBuffer=this.painter.context.createIndexBuffer(e),this.wireframeSegments=t.SegmentVector.simpleSegment(0,0,this.gridBuffer.length,e.length)}return[this.wireframeIndexBuffer,this.wireframeSegments]}}function pn(t){const e=[];for(let n=0;n<t.length;n++){if(null===t[n])continue;const i=t[n].split(" ");e.push(i.pop())}return e}class fn{static cacheKey(t,e,n){let i=`${t}${n?n.cacheKey:""}`;for(const r of e)i+="/"+r;return i}constructor(e,n,i,r,o,s){const a=e.gl;this.program=a.createProgram();const l=pn(i.staticAttributes),c=r?r.getBinderAttributes():[],u=l.concat(c),h=i.staticUniforms?pn(i.staticUniforms):[],d=r?r.getBinderUniforms():[],p=h.concat(d),f=[];for(const t of p)f.indexOf(t)<0&&f.push(t);let m=r?r.defines():[];m=m.concat(s.map(t=>"#define "+t));const g=m.concat(Ze.fragmentSource,He,Ge.fragmentSource,i.fragmentSource).join("\n"),_=m.concat(Ze.vertexSource,He,Ge.vertexSource,$e.vertexSource,i.vertexSource).join("\n"),y=a.createShader(a.FRAGMENT_SHADER);if(a.isContextLost())return void(this.failedToCreate=!0);a.shaderSource(y,g),a.compileShader(y),a.attachShader(this.program,y);const v=a.createShader(a.VERTEX_SHADER);if(a.isContextLost())return void(this.failedToCreate=!0);a.shaderSource(v,_),a.compileShader(v),a.attachShader(this.program,v),this.attributes={};const x={};this.numAttributes=u.length;for(let t=0;t<this.numAttributes;t++)u[t]&&(a.bindAttribLocation(this.program,t,u[t]),this.attributes[u[t]]=t);a.linkProgram(this.program),a.deleteShader(v),a.deleteShader(y);for(let t=0;t<f.length;t++){const e=f[t];if(e&&!x[e]){const t=a.getUniformLocation(this.program,e);t&&(x[e]=t)}}this.fixedUniforms=o(e,x),this.binderUniforms=r?r.getUniforms(e,x):[],-1!==s.indexOf("TERRAIN")&&(this.terrainUniforms=((e,n)=>({u_dem:new t.Uniform1i(e,n.u_dem),u_dem_prev:new t.Uniform1i(e,n.u_dem_prev),u_dem_unpack:new t.Uniform4f(e,n.u_dem_unpack),u_dem_tl:new t.Uniform2f(e,n.u_dem_tl),u_dem_scale:new t.Uniform1f(e,n.u_dem_scale),u_dem_tl_prev:new t.Uniform2f(e,n.u_dem_tl_prev),u_dem_scale_prev:new t.Uniform1f(e,n.u_dem_scale_prev),u_dem_size:new t.Uniform1f(e,n.u_dem_size),u_dem_lerp:new t.Uniform1f(e,n.u_dem_lerp),u_exaggeration:new t.Uniform1f(e,n.u_exaggeration),u_depth:new t.Uniform1i(e,n.u_depth),u_depth_size_inv:new t.Uniform2f(e,n.u_depth_size_inv),u_meter_to_dem:new t.Uniform1f(e,n.u_meter_to_dem),u_label_plane_matrix_inv:new t.UniformMatrix4f(e,n.u_label_plane_matrix_inv)}))(e,x)),-1!==s.indexOf("FOG")&&(this.fogUniforms=((e,n)=>({u_fog_matrix:new t.UniformMatrix4f(e,n.u_fog_matrix),u_fog_range:new t.Uniform2f(e,n.u_fog_range),u_fog_color:new t.Uniform4f(e,n.u_fog_color),u_fog_horizon_blend:new t.Uniform1f(e,n.u_fog_horizon_blend),u_fog_temporal_offset:new t.Uniform1f(e,n.u_fog_temporal_offset)}))(e,x))}setTerrainUniformValues(t,e){if(!this.terrainUniforms)return;const n=this.terrainUniforms;if(!this.failedToCreate){t.program.set(this.program);for(const t in e)n[t].set(e[t])}}setFogUniformValues(t,e){if(!this.fogUniforms)return;const n=this.fogUniforms;if(!this.failedToCreate){t.program.set(this.program);for(const t in e)n[t].location&&n[t].set(e[t])}}draw(t,e,n,i,r,o,s,a,l,c,u,h,d,p,f,m){const g=t.gl;if(this.failedToCreate)return;t.program.set(this.program),t.setDepthMode(n),t.setStencilMode(i),t.setColorMode(r),t.setCullFace(o);for(const y in this.fixedUniforms)this.fixedUniforms[y].set(s[y]);p&&p.setUniforms(t,this.binderUniforms,h,{zoom:d});const _={[g.LINES]:2,[g.TRIANGLES]:3,[g.LINE_STRIP]:1}[e];for(const y of u.get()){const n=y.vaos||(y.vaos={});(n[a]||(n[a]=new Ke)).bind(t,this,l,p?p.getPaintVertexBuffers():[],c,y.vertexOffset,f,m),g.drawElements(e,y.primitiveLength*_,g.UNSIGNED_SHORT,y.primitiveOffset*_*2)}}}function mn(t,e,n){const i=1/I(n,1,e.transform.tileZoom),r=Math.pow(2,n.tileID.overscaledZ),o=n.tileSize*Math.pow(2,e.transform.tileZoom)/r,s=o*(n.tileID.canonical.x+n.tileID.wrap*r),a=o*n.tileID.canonical.y;return{u_image:0,u_texsize:n.imageAtlasTexture.size,u_scale:[i,t.fromScale,t.toScale],u_fade:t.t,u_pixel_coord_upper:[s>>16,a>>16],u_pixel_coord_lower:[65535&s,65535&a]}}const gn=(e,n,i,r)=>{const o=n.style.light,s=o.properties.get("position"),a=[s.x,s.y,s.z],l=t.create$2();"viewport"===o.properties.get("anchor")&&(t.fromRotation(l,-n.transform.angle),t.transformMat3(a,a,l));const c=o.properties.get("color");return{u_matrix:e,u_lightpos:a,u_lightintensity:o.properties.get("intensity"),u_lightcolor:[c.r,c.g,c.b],u_vertical_gradient:+i,u_opacity:r}},_n=(e,n,i,r,o,s,a)=>t.extend(gn(e,n,i,r),mn(s,n,a),{u_height_factor:-Math.pow(2,o.overscaledZ)/a.tileSize/8}),yn=t=>({u_matrix:t}),vn=(e,n,i,r)=>t.extend(yn(e),mn(i,n,r)),xn=(t,e)=>({u_matrix:t,u_world:e}),bn=(e,n,i,r,o)=>t.extend(vn(e,n,i,r),{u_world:o}),wn=(e,n,i,r)=>{const o=e.transform;let s;if("map"===r.paint.get("circle-pitch-alignment")){const t=I(i,1,o.zoom);s=[t,t]}else s=o.pixelsToGLUnits;return{u_camera_to_center_distance:o.cameraToCenterDistance,u_matrix:e.translatePosMatrix(n.projMatrix,i,r.paint.get("circle-translate"),r.paint.get("circle-translate-anchor")),u_device_pixel_ratio:t.exported.devicePixelRatio,u_extrude_scale:s}},Cn=t=>{const e=[];return"map"===t.paint.get("circle-pitch-alignment")&&e.push("PITCH_WITH_MAP"),"map"===t.paint.get("circle-pitch-scale")&&e.push("SCALE_WITH_MAP"),e},Tn=(e,n,i)=>{const r=t.EXTENT/i.tileSize;return{u_matrix:e,u_camera_to_center_distance:n.cameraToCenterDistance,u_extrude_scale:[n.pixelsToGLUnits[0]/r,n.pixelsToGLUnits[1]/r]}},Sn=(t,e,n=1)=>({u_matrix:t,u_color:e,u_overlay:0,u_overlay_scale:n}),En=(t,e,n,i)=>({u_matrix:t,u_extrude_scale:I(e,1,n),u_intensity:i}),kn=(e,n,i,r)=>{const o=e.transform;return{u_matrix:On(e,n,i,r),u_ratio:1/I(n,1,o.zoom),u_device_pixel_ratio:t.exported.devicePixelRatio,u_units_to_pixels:[1/o.pixelsToGLUnits[0],1/o.pixelsToGLUnits[1]]}},An=(e,n,i,r,o)=>t.extend(kn(e,n,i,r),{u_image:0,u_image_height:o}),In=(e,n,i,r,o)=>{const s=e.transform,a=Mn(n,s);return{u_matrix:On(e,n,i,o),u_texsize:n.imageAtlasTexture.size,u_ratio:1/I(n,1,s.zoom),u_device_pixel_ratio:t.exported.devicePixelRatio,u_image:0,u_scale:[a,r.fromScale,r.toScale],u_fade:r.t,u_units_to_pixels:[1/s.pixelsToGLUnits[0],1/s.pixelsToGLUnits[1]]}},Pn=(e,n,i,r,o)=>{const s=Mn(n,e.transform);return t.extend(kn(e,n,i,o),{u_texsize:n.lineAtlasTexture.size,u_scale:[s,r.fromScale,r.toScale],u_image:0,u_mix:r.t})};function Mn(t,e){return 1/I(t,1,e.tileZoom)}function On(t,e,n,i){return t.translatePosMatrix(i||e.tileID.projMatrix,e,n.paint.get("line-translate"),n.paint.get("line-translate-anchor"))}const zn=(t,e,n,i,r)=>{return{u_matrix:t,u_tl_parent:e,u_scale_parent:n,u_buffer_scale:1,u_fade_t:i.mix,u_opacity:i.opacity*r.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:r.paint.get("raster-brightness-min"),u_brightness_high:r.paint.get("raster-brightness-max"),u_saturation_factor:(s=r.paint.get("raster-saturation"),s>0?1-1/(1.001-s):-s),u_contrast_factor:(o=r.paint.get("raster-contrast"),o>0?1/(1-o):1+o),u_spin_weights:Dn(r.paint.get("raster-hue-rotate"))};var o,s};function Dn(t){t*=Math.PI/180;const e=Math.sin(t),n=Math.cos(t);return[(2*n+1)/3,(-Math.sqrt(3)*e-n+1)/3,(Math.sqrt(3)*e-n+1)/3]}const Ln=(t,e,n,i,r,o,s,a,l,c)=>{const u=r.transform;return{u_is_size_zoom_constant:+("constant"===t||"source"===t),u_is_size_feature_constant:+("constant"===t||"camera"===t),u_size_t:e?e.uSizeT:0,u_size:e?e.uSize:0,u_camera_to_center_distance:u.cameraToCenterDistance,u_pitch:u.pitch/360*2*Math.PI,u_rotate_symbol:+n,u_aspect_ratio:u.width/u.height,u_fade_change:r.options.fadeDuration?r.symbolFadeChange:1,u_matrix:o,u_label_plane_matrix:s,u_coord_matrix:a,u_is_text:+l,u_pitch_with_map:+i,u_texsize:c,u_texture:0}},Rn=(e,n,i,r,o,s,a,l,c,u,h)=>{const{cameraToCenterDistance:d,_pitch:p}=o.transform;return t.extend(Ln(e,n,i,r,o,s,a,l,c,u),{u_gamma_scale:r?d*Math.cos(o.terrain?0:p):1,u_device_pixel_ratio:t.exported.devicePixelRatio,u_is_halo:+h})},Fn=(e,n,i,r,o,s,a,l,c,u)=>t.extend(Rn(e,n,i,r,o,s,a,l,!0,c,!0),{u_texsize_icon:u,u_texture_icon:1}),Bn=(t,e,n)=>({u_matrix:t,u_opacity:e,u_color:n}),Vn=(e,n,i,r,o,s)=>t.extend(function(t,e,n,i){const r=n.imageManager.getPattern(t.from.toString()),o=n.imageManager.getPattern(t.to.toString()),{width:s,height:a}=n.imageManager.getPixelSize(),l=Math.pow(2,i.tileID.overscaledZ),c=i.tileSize*Math.pow(2,n.transform.tileZoom)/l,u=c*(i.tileID.canonical.x+i.tileID.wrap*l),h=c*i.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:r.tl,u_pattern_br_a:r.br,u_pattern_tl_b:o.tl,u_pattern_br_b:o.br,u_texsize:[s,a],u_mix:e.t,u_pattern_size_a:r.displaySize,u_pattern_size_b:o.displaySize,u_scale_a:e.fromScale,u_scale_b:e.toScale,u_tile_units_to_pixels:1/I(i,1,n.transform.tileZoom),u_pixel_coord_upper:[u>>16,h>>16],u_pixel_coord_lower:[65535&u,65535&h]}}(r,s,i,o),{u_matrix:e,u_opacity:n}),Un={fillExtrusion:(e,n)=>({u_matrix:new t.UniformMatrix4f(e,n.u_matrix),u_lightpos:new t.Uniform3f(e,n.u_lightpos),u_lightintensity:new t.Uniform1f(e,n.u_lightintensity),u_lightcolor:new t.Uniform3f(e,n.u_lightcolor),u_vertical_gradient:new t.Uniform1f(e,n.u_vertical_gradient),u_opacity:new t.Uniform1f(e,n.u_opacity)}),fillExtrusionPattern:(e,n)=>({u_matrix:new t.UniformMatrix4f(e,n.u_matrix),u_lightpos:new t.Uniform3f(e,n.u_lightpos),u_lightintensity:new t.Uniform1f(e,n.u_lightintensity),u_lightcolor:new t.Uniform3f(e,n.u_lightcolor),u_vertical_gradient:new t.Uniform1f(e,n.u_vertical_gradient),u_height_factor:new t.Uniform1f(e,n.u_height_factor),u_image:new t.Uniform1i(e,n.u_image),u_texsize:new t.Uniform2f(e,n.u_texsize),u_pixel_coord_upper:new t.Uniform2f(e,n.u_pixel_coord_upper),u_pixel_coord_lower:new t.Uniform2f(e,n.u_pixel_coord_lower),u_scale:new t.Uniform3f(e,n.u_scale),u_fade:new t.Uniform1f(e,n.u_fade),u_opacity:new t.Uniform1f(e,n.u_opacity)}),fill:(e,n)=>({u_matrix:new t.UniformMatrix4f(e,n.u_matrix)}),fillPattern:(e,n)=>({u_matrix:new t.UniformMatrix4f(e,n.u_matrix),u_image:new t.Uniform1i(e,n.u_image),u_texsize:new t.Uniform2f(e,n.u_texsize),u_pixel_coord_upper:new t.Uniform2f(e,n.u_pixel_coord_upper),u_pixel_coord_lower:new t.Uniform2f(e,n.u_pixel_coord_lower),u_scale:new t.Uniform3f(e,n.u_scale),u_fade:new t.Uniform1f(e,n.u_fade)}),fillOutline:(e,n)=>({u_matrix:new t.UniformMatrix4f(e,n.u_matrix),u_world:new t.Uniform2f(e,n.u_world)}),fillOutlinePattern:(e,n)=>({u_matrix:new t.UniformMatrix4f(e,n.u_matrix),u_world:new t.Uniform2f(e,n.u_world),u_image:new t.Uniform1i(e,n.u_image),u_texsize:new t.Uniform2f(e,n.u_texsize),u_pixel_coord_upper:new t.Uniform2f(e,n.u_pixel_coord_upper),u_pixel_coord_lower:new t.Uniform2f(e,n.u_pixel_coord_lower),u_scale:new t.Uniform3f(e,n.u_scale),u_fade:new t.Uniform1f(e,n.u_fade)}),circle:(e,n)=>({u_camera_to_center_distance:new t.Uniform1f(e,n.u_camera_to_center_distance),u_extrude_scale:new t.Uniform2f(e,n.u_extrude_scale),u_device_pixel_ratio:new t.Uniform1f(e,n.u_device_pixel_ratio),u_matrix:new t.UniformMatrix4f(e,n.u_matrix)}),collisionBox:(e,n)=>({u_matrix:new t.UniformMatrix4f(e,n.u_matrix),u_camera_to_center_distance:new t.Uniform1f(e,n.u_camera_to_center_distance),u_extrude_scale:new t.Uniform2f(e,n.u_extrude_scale)}),collisionCircle:(e,n)=>({u_matrix:new t.UniformMatrix4f(e,n.u_matrix),u_inv_matrix:new t.UniformMatrix4f(e,n.u_inv_matrix),u_camera_to_center_distance:new t.Uniform1f(e,n.u_camera_to_center_distance),u_viewport_size:new t.Uniform2f(e,n.u_viewport_size)}),debug:(e,n)=>({u_color:new t.UniformColor(e,n.u_color),u_matrix:new t.UniformMatrix4f(e,n.u_matrix),u_overlay:new t.Uniform1i(e,n.u_overlay),u_overlay_scale:new t.Uniform1f(e,n.u_overlay_scale)}),clippingMask:(e,n)=>({u_matrix:new t.UniformMatrix4f(e,n.u_matrix)}),heatmap:(e,n)=>({u_extrude_scale:new t.Uniform1f(e,n.u_extrude_scale),u_intensity:new t.Uniform1f(e,n.u_intensity),u_matrix:new t.UniformMatrix4f(e,n.u_matrix)}),heatmapTexture:(e,n)=>({u_matrix:new t.UniformMatrix4f(e,n.u_matrix),u_world:new t.Uniform2f(e,n.u_world),u_image:new t.Uniform1i(e,n.u_image),u_color_ramp:new t.Uniform1i(e,n.u_color_ramp),u_opacity:new t.Uniform1f(e,n.u_opacity)}),hillshade:(e,n)=>({u_matrix:new t.UniformMatrix4f(e,n.u_matrix),u_image:new t.Uniform1i(e,n.u_image),u_latrange:new t.Uniform2f(e,n.u_latrange),u_light:new t.Uniform2f(e,n.u_light),u_shadow:new t.UniformColor(e,n.u_shadow),u_highlight:new t.UniformColor(e,n.u_highlight),u_accent:new t.UniformColor(e,n.u_accent)}),hillshadePrepare:(e,n)=>({u_matrix:new t.UniformMatrix4f(e,n.u_matrix),u_image:new t.Uniform1i(e,n.u_image),u_dimension:new t.Uniform2f(e,n.u_dimension),u_zoom:new t.Uniform1f(e,n.u_zoom),u_unpack:new t.Uniform4f(e,n.u_unpack)}),line:(e,n)=>({u_matrix:new t.UniformMatrix4f(e,n.u_matrix),u_ratio:new t.Uniform1f(e,n.u_ratio),u_device_pixel_ratio:new t.Uniform1f(e,n.u_device_pixel_ratio),u_units_to_pixels:new t.Uniform2f(e,n.u_units_to_pixels)}),lineGradient:(e,n)=>({u_matrix:new t.UniformMatrix4f(e,n.u_matrix),u_ratio:new t.Uniform1f(e,n.u_ratio),u_device_pixel_ratio:new t.Uniform1f(e,n.u_device_pixel_ratio),u_units_to_pixels:new t.Uniform2f(e,n.u_units_to_pixels),u_image:new t.Uniform1i(e,n.u_image),u_image_height:new t.Uniform1f(e,n.u_image_height)}),linePattern:(e,n)=>({u_matrix:new t.UniformMatrix4f(e,n.u_matrix),u_texsize:new t.Uniform2f(e,n.u_texsize),u_ratio:new t.Uniform1f(e,n.u_ratio),u_device_pixel_ratio:new t.Uniform1f(e,n.u_device_pixel_ratio),u_image:new t.Uniform1i(e,n.u_image),u_units_to_pixels:new t.Uniform2f(e,n.u_units_to_pixels),u_scale:new t.Uniform3f(e,n.u_scale),u_fade:new t.Uniform1f(e,n.u_fade)}),lineSDF:(e,n)=>({u_matrix:new t.UniformMatrix4f(e,n.u_matrix),u_texsize:new t.Uniform2f(e,n.u_texsize),u_ratio:new t.Uniform1f(e,n.u_ratio),u_device_pixel_ratio:new t.Uniform1f(e,n.u_device_pixel_ratio),u_units_to_pixels:new t.Uniform2f(e,n.u_units_to_pixels),u_image:new t.Uniform1i(e,n.u_image),u_scale:new t.Uniform3f(e,n.u_scale),u_mix:new t.Uniform1f(e,n.u_mix)}),raster:(e,n)=>({u_matrix:new t.UniformMatrix4f(e,n.u_matrix),u_tl_parent:new t.Uniform2f(e,n.u_tl_parent),u_scale_parent:new t.Uniform1f(e,n.u_scale_parent),u_buffer_scale:new t.Uniform1f(e,n.u_buffer_scale),u_fade_t:new t.Uniform1f(e,n.u_fade_t),u_opacity:new t.Uniform1f(e,n.u_opacity),u_image0:new t.Uniform1i(e,n.u_image0),u_image1:new t.Uniform1i(e,n.u_image1),u_brightness_low:new t.Uniform1f(e,n.u_brightness_low),u_brightness_high:new t.Uniform1f(e,n.u_brightness_high),u_saturation_factor:new t.Uniform1f(e,n.u_saturation_factor),u_contrast_factor:new t.Uniform1f(e,n.u_contrast_factor),u_spin_weights:new t.Uniform3f(e,n.u_spin_weights)}),symbolIcon:(e,n)=>({u_is_size_zoom_constant:new t.Uniform1i(e,n.u_is_size_zoom_constant),u_is_size_feature_constant:new t.Uniform1i(e,n.u_is_size_feature_constant),u_size_t:new t.Uniform1f(e,n.u_size_t),u_size:new t.Uniform1f(e,n.u_size),u_camera_to_center_distance:new t.Uniform1f(e,n.u_camera_to_center_distance),u_pitch:new t.Uniform1f(e,n.u_pitch),u_rotate_symbol:new t.Uniform1i(e,n.u_rotate_symbol),u_aspect_ratio:new t.Uniform1f(e,n.u_aspect_ratio),u_fade_change:new t.Uniform1f(e,n.u_fade_change),u_matrix:new t.UniformMatrix4f(e,n.u_matrix),u_label_plane_matrix:new t.UniformMatrix4f(e,n.u_label_plane_matrix),u_coord_matrix:new t.UniformMatrix4f(e,n.u_coord_matrix),u_is_text:new t.Uniform1i(e,n.u_is_text),u_pitch_with_map:new t.Uniform1i(e,n.u_pitch_with_map),u_texsize:new t.Uniform2f(e,n.u_texsize),u_texture:new t.Uniform1i(e,n.u_texture)}),symbolSDF:(e,n)=>({u_is_size_zoom_constant:new t.Uniform1i(e,n.u_is_size_zoom_constant),u_is_size_feature_constant:new t.Uniform1i(e,n.u_is_size_feature_constant),u_size_t:new t.Uniform1f(e,n.u_size_t),u_size:new t.Uniform1f(e,n.u_size),u_camera_to_center_distance:new t.Uniform1f(e,n.u_camera_to_center_distance),u_pitch:new t.Uniform1f(e,n.u_pitch),u_rotate_symbol:new t.Uniform1i(e,n.u_rotate_symbol),u_aspect_ratio:new t.Uniform1f(e,n.u_aspect_ratio),u_fade_change:new t.Uniform1f(e,n.u_fade_change),u_matrix:new t.UniformMatrix4f(e,n.u_matrix),u_label_plane_matrix:new t.UniformMatrix4f(e,n.u_label_plane_matrix),u_coord_matrix:new t.UniformMatrix4f(e,n.u_coord_matrix),u_is_text:new t.Uniform1i(e,n.u_is_text),u_pitch_with_map:new t.Uniform1i(e,n.u_pitch_with_map),u_texsize:new t.Uniform2f(e,n.u_texsize),u_texture:new t.Uniform1i(e,n.u_texture),u_gamma_scale:new t.Uniform1f(e,n.u_gamma_scale),u_device_pixel_ratio:new t.Uniform1f(e,n.u_device_pixel_ratio),u_is_halo:new t.Uniform1i(e,n.u_is_halo)}),symbolTextAndIcon:(e,n)=>({u_is_size_zoom_constant:new t.Uniform1i(e,n.u_is_size_zoom_constant),u_is_size_feature_constant:new t.Uniform1i(e,n.u_is_size_feature_constant),u_size_t:new t.Uniform1f(e,n.u_size_t),u_size:new t.Uniform1f(e,n.u_size),u_camera_to_center_distance:new t.Uniform1f(e,n.u_camera_to_center_distance),u_pitch:new t.Uniform1f(e,n.u_pitch),u_rotate_symbol:new t.Uniform1i(e,n.u_rotate_symbol),u_aspect_ratio:new t.Uniform1f(e,n.u_aspect_ratio),u_fade_change:new t.Uniform1f(e,n.u_fade_change),u_matrix:new t.UniformMatrix4f(e,n.u_matrix),u_label_plane_matrix:new t.UniformMatrix4f(e,n.u_label_plane_matrix),u_coord_matrix:new t.UniformMatrix4f(e,n.u_coord_matrix),u_is_text:new t.Uniform1i(e,n.u_is_text),u_pitch_with_map:new t.Uniform1i(e,n.u_pitch_with_map),u_texsize:new t.Uniform2f(e,n.u_texsize),u_texsize_icon:new t.Uniform2f(e,n.u_texsize_icon),u_texture:new t.Uniform1i(e,n.u_texture),u_texture_icon:new t.Uniform1i(e,n.u_texture_icon),u_gamma_scale:new t.Uniform1f(e,n.u_gamma_scale),u_device_pixel_ratio:new t.Uniform1f(e,n.u_device_pixel_ratio),u_is_halo:new t.Uniform1i(e,n.u_is_halo)}),background:(e,n)=>({u_matrix:new t.UniformMatrix4f(e,n.u_matrix),u_opacity:new t.Uniform1f(e,n.u_opacity),u_color:new t.UniformColor(e,n.u_color)}),backgroundPattern:(e,n)=>({u_matrix:new t.UniformMatrix4f(e,n.u_matrix),u_opacity:new t.Uniform1f(e,n.u_opacity),u_image:new t.Uniform1i(e,n.u_image),u_pattern_tl_a:new t.Uniform2f(e,n.u_pattern_tl_a),u_pattern_br_a:new t.Uniform2f(e,n.u_pattern_br_a),u_pattern_tl_b:new t.Uniform2f(e,n.u_pattern_tl_b),u_pattern_br_b:new t.Uniform2f(e,n.u_pattern_br_b),u_texsize:new t.Uniform2f(e,n.u_texsize),u_mix:new t.Uniform1f(e,n.u_mix),u_pattern_size_a:new t.Uniform2f(e,n.u_pattern_size_a),u_pattern_size_b:new t.Uniform2f(e,n.u_pattern_size_b),u_scale_a:new t.Uniform1f(e,n.u_scale_a),u_scale_b:new t.Uniform1f(e,n.u_scale_b),u_pixel_coord_upper:new t.Uniform2f(e,n.u_pixel_coord_upper),u_pixel_coord_lower:new t.Uniform2f(e,n.u_pixel_coord_lower),u_tile_units_to_pixels:new t.Uniform1f(e,n.u_tile_units_to_pixels)}),terrainRaster:en,terrainDepth:en,skybox:(e,n)=>({u_matrix:new t.UniformMatrix4f(e,n.u_matrix),u_sun_direction:new t.Uniform3f(e,n.u_sun_direction),u_cubemap:new t.Uniform1i(e,n.u_cubemap),u_opacity:new t.Uniform1f(e,n.u_opacity),u_temporal_offset:new t.Uniform1f(e,n.u_temporal_offset)}),skyboxGradient:(e,n)=>({u_matrix:new t.UniformMatrix4f(e,n.u_matrix),u_color_ramp:new t.Uniform1i(e,n.u_color_ramp),u_center_direction:new t.Uniform3f(e,n.u_center_direction),u_radius:new t.Uniform1f(e,n.u_radius),u_opacity:new t.Uniform1f(e,n.u_opacity),u_temporal_offset:new t.Uniform1f(e,n.u_temporal_offset)}),skyboxCapture:(e,n)=>({u_matrix_3f:new t.UniformMatrix3f(e,n.u_matrix_3f),u_sun_direction:new t.Uniform3f(e,n.u_sun_direction),u_sun_intensity:new t.Uniform1f(e,n.u_sun_intensity),u_color_tint_r:new t.Uniform4f(e,n.u_color_tint_r),u_color_tint_m:new t.Uniform4f(e,n.u_color_tint_m),u_luminance:new t.Uniform1f(e,n.u_luminance)})};let Nn;function jn(e,n,i,r,o,s,a){const l=e.context,c=l.gl,u=e.useProgram("collisionBox"),h=[];let d=0,p=0;for(let x=0;x<r.length;x++){const f=r[x],m=n.getTile(f),g=m.getBucket(i);if(!g)continue;let _=f.projMatrix;0===o[0]&&0===o[1]||(_=e.translatePosMatrix(f.projMatrix,m,o,s));const y=a?g.textCollisionBox:g.iconCollisionBox,v=g.collisionCircleArray;if(v.length>0){const n=t.create$1(),i=_;t.mul$1(n,g.placementInvProjMatrix,e.transform.glCoordMatrix),t.mul$1(n,n,g.placementViewportMatrix),h.push({circleArray:v,circleOffset:p,transform:i,invTransform:n}),d+=v.length/4,p=d}y&&(e.terrain&&e.terrain.setupElevationDraw(m,u),u.draw(l,c.LINES,t.DepthMode.disabled,t.StencilMode.disabled,e.colorModeForRenderPass(),t.CullFaceMode.disabled,Tn(_,e.transform,m),i.id,y.layoutVertexBuffer,y.indexBuffer,y.segments,null,e.transform.zoom,null,y.collisionVertexBuffer,y.collisionVertexBufferExt))}if(!a||!h.length)return;const f=e.useProgram("collisionCircle"),m=new t.StructArrayLayout2f1f2i16;m.resize(4*d),m._trim();let g=0;for(const t of h)for(let e=0;e<t.circleArray.length/4;e++){const n=4*e,i=t.circleArray[n+0],r=t.circleArray[n+1],o=t.circleArray[n+2],s=t.circleArray[n+3];m.emplace(g++,i,r,o,s,0),m.emplace(g++,i,r,o,s,1),m.emplace(g++,i,r,o,s,2),m.emplace(g++,i,r,o,s,3)}(!Nn||Nn.length<2*d)&&(Nn=function(e){const n=2*e,i=new t.StructArrayLayout3ui6;i.resize(n),i._trim();for(let t=0;t<n;t++){const e=6*t;i.uint16[e+0]=4*t+0,i.uint16[e+1]=4*t+1,i.uint16[e+2]=4*t+2,i.uint16[e+3]=4*t+2,i.uint16[e+4]=4*t+3,i.uint16[e+5]=4*t+0}return i}(d));const _=l.createIndexBuffer(Nn,!0),y=l.createVertexBuffer(m,t.collisionCircleLayout.members,!0);for(const x of h){const n={u_matrix:x.transform,u_inv_matrix:x.invTransform,u_camera_to_center_distance:(v=e.transform).cameraToCenterDistance,u_viewport_size:[v.width,v.height]};f.draw(l,c.TRIANGLES,t.DepthMode.disabled,t.StencilMode.disabled,e.colorModeForRenderPass(),t.CullFaceMode.disabled,n,i.id,y,_,t.SegmentVector.simpleSegment(0,2*x.circleOffset,x.circleArray.length,x.circleArray.length/2),null,e.transform.zoom,null,null,null)}var v;y.destroy(),_.destroy()}const qn=t.identity(new Float32Array(16));function $n(e,n,i,r,o,s){const{horizontalAlign:a,verticalAlign:l}=t.getAnchorAlignment(e),c=-(a-.5)*n,u=-(l-.5)*i,h=t.evaluateVariableOffset(e,r);return new t.pointGeometry((c/o+h[0])*s,(u/o+h[1])*s)}function Gn(e,n,i,r,o,s,a,l,c,u,h,d){const p=e.text.placedSymbolArray,f=e.text.dynamicLayoutVertexArray,m=e.icon.dynamicLayoutVertexArray,g={};f.clear();for(let _=0;_<p.length;_++){const m=p.get(_),y=e.allowVerticalPlacement&&!m.placedOrientation,v=m.hidden||!m.crossTileID||y?null:r[m.crossTileID];if(v){const r=new t.pointGeometry(m.anchorX,m.anchorY),p=d(r),_=Kt(r,i?l:a,p),y=Yt(s.cameraToCenterDistance,_.signedDistanceFromCamera);let x=o.evaluateSizeForFeature(e.textSizeData,u,m)*y/t.ONE_EM;i&&(x*=e.tilePixelRatio/c);const{width:b,height:w,anchor:C,textOffset:T,textBoxScale:S}=v,E=$n(C,b,w,T,S,x),k=i?Kt(r.add(E),a,p).point:_.point.add(n?E.rotate(-s.angle):E),A=e.allowVerticalPlacement&&m.placedOrientation===t.WritingMode.vertical?Math.PI/2:0;for(let e=0;e<m.numGlyphs;e++)t.addDynamicAttributes(f,k,A);h&&m.associatedIconIndex>=0&&(g[m.associatedIconIndex]={shiftedAnchor:k,angle:A})}else se(m.numGlyphs,f)}if(h){m.clear();const n=e.icon.placedSymbolArray;for(let e=0;e<n.length;e++){const i=n.get(e);if(i.hidden)se(i.numGlyphs,m);else{const n=g[e];if(n)for(let e=0;e<i.numGlyphs;e++)t.addDynamicAttributes(m,n.shiftedAnchor,n.angle);else se(i.numGlyphs,m)}}e.icon.dynamicLayoutVertexBuffer.updateData(m)}e.text.dynamicLayoutVertexBuffer.updateData(f)}function Zn(t,e,n){return n.iconsInText&&e?"symbolTextAndIcon":t?"symbolSDF":"symbolIcon"}function Hn(e,n,i,r,o,s,a,l,c,u,h,d){const p=e.context,f=p.gl,m=e.transform,g="map"===l,_="map"===c,y=g&&"point"!==i.layout.get("symbol-placement"),v=g&&!_&&!y,x=void 0!==i.layout.get("symbol-sort-key").constantOr(1);let b=!1;const w=e.depthModeForSublayer(0,t.DepthMode.ReadOnly),C=i.layout.get("text-variable-anchor"),T=[],S=e.terrain&&_?["PITCH_WITH_MAP_TERRAIN"]:null;for(const E of r){const r=n.getTile(E),l=r.getBucket(i);if(!l)continue;const c=o?l.text:l.icon;if(!c||!c.segments.get().length)continue;const h=c.programConfigurations.get(i.id),d=o||l.sdfIcons,p=o?l.textSizeData:l.iconSizeData,w=_||0!==m.pitch,k=e.useProgram(Zn(d,o,l),h,S),A=t.evaluateSizeForZoom(p,m.zoom);let P,M,O,z,D=[0,0],L=null;if(o){if(M=r.glyphAtlasTexture,O=f.LINEAR,P=r.glyphAtlasTexture.size,l.iconsInText){D=r.imageAtlasTexture.size,L=r.imageAtlasTexture;const t="composite"===p.kind||"camera"===p.kind;z=w||e.options.rotating||e.options.zooming||t?f.LINEAR:f.NEAREST}}else{const t=1!==i.layout.get("icon-size").constantOr(0)||l.iconsNeedLinear;M=r.imageAtlasTexture,O=d||e.options.rotating||e.options.zooming||t||w?f.LINEAR:f.NEAREST,P=r.imageAtlasTexture.size}const R=I(r,1,e.transform.zoom),F=Wt(E.projMatrix,_,g,e.transform,R),B=e.terrain&&_&&y?t.invert(new Float32Array(16),F):qn,V=Xt(E.projMatrix,_,g,e.transform,R),U=C&&l.hasTextData(),N="none"!==i.layout.get("icon-text-fit")&&U&&l.hasIconData();if(y){const t=m.elevation;Qt(l,E.projMatrix,e,o,F,V,_,u,t?e=>t.getAtTileOffset(E,e.x,e.y):null)}const j=e.translatePosMatrix(E.projMatrix,r,s,a),q=y||o&&C||N?qn:F,$=e.translatePosMatrix(V,r,s,a,!0),G=d&&0!==i.paint.get(o?"text-halo-width":"icon-halo-width").constantOr(1);let Z;Z=d?l.iconsInText?Fn(p.kind,A,v,_,e,j,q,$,P,D):Rn(p.kind,A,v,_,e,j,q,$,o,P,!0):Ln(p.kind,A,v,_,e,j,q,$,o,P);const H={program:k,buffers:c,uniformValues:Z,atlasTexture:M,atlasTextureIcon:L,atlasInterpolation:O,atlasInterpolationIcon:z,isSDF:d,hasHalo:G,tile:r,labelPlaneMatrixInv:B};if(x&&l.canOverlap){b=!0;const e=c.segments.get();for(const n of e)T.push({segments:new t.SegmentVector([n]),sortKey:n.sortKey,state:H})}else T.push({segments:c.segments,sortKey:0,state:H})}b&&T.sort((t,e)=>t.sortKey-e.sortKey);for(const t of T){const n=t.state;if(e.terrain&&e.terrain.setupElevationDraw(n.tile,n.program,{useDepthForOcclusion:!0,labelPlaneMatrixInv:n.labelPlaneMatrixInv}),p.activeTexture.set(f.TEXTURE0),n.atlasTexture.bind(n.atlasInterpolation,f.CLAMP_TO_EDGE),n.atlasTextureIcon&&(p.activeTexture.set(f.TEXTURE1),n.atlasTextureIcon&&n.atlasTextureIcon.bind(n.atlasInterpolationIcon,f.CLAMP_TO_EDGE)),n.isSDF){const r=n.uniformValues;n.hasHalo&&(r.u_is_halo=1,Wn(n.buffers,t.segments,i,e,n.program,w,h,d,r)),r.u_is_halo=0}Wn(n.buffers,t.segments,i,e,n.program,w,h,d,n.uniformValues)}}function Wn(e,n,i,r,o,s,a,l,c){const u=r.context;o.draw(u,u.gl.TRIANGLES,s,a,l,t.CullFaceMode.disabled,c,i.id,e.layoutVertexBuffer,e.indexBuffer,n,i.paint,r.transform.zoom,e.programConfigurations.get(i.id),e.dynamicLayoutVertexBuffer,e.opacityVertexBuffer)}function Xn(e,n,i,r,o,s,a){const l=e.context.gl,c=i.paint.get("fill-pattern"),u=c&&c.constantOr(1),h=i.getCrossfadeParameters();let d,p,f,m,g;a?(p=u&&!i.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",d=l.LINES):(p=u?"fillPattern":"fill",d=l.TRIANGLES);for(const _ of r){const r=n.getTile(_);if(u&&!r.patternsLoaded())continue;const y=r.getBucket(i);if(!y)continue;e.prepareDrawTile(_);const v=y.programConfigurations.get(i.id),x=e.useProgram(p,v);u&&(e.context.activeTexture.set(l.TEXTURE0),r.imageAtlasTexture.bind(l.LINEAR,l.CLAMP_TO_EDGE),v.updatePaintBuffers(h));const b=c.constantOr(null);if(b&&r.imageAtlas){const t=r.imageAtlas,e=t.patternPositions[b.to.toString()],n=t.patternPositions[b.from.toString()];e&&n&&v.setConstantPatternPositions(e,n)}const w=e.translatePosMatrix(_.projMatrix,r,i.paint.get("fill-translate"),i.paint.get("fill-translate-anchor"));if(a){m=y.indexBuffer2,g=y.segments2;const t=e.terrain&&e.terrain.renderingToTexture?e.terrain.drapeBufferSize:[l.drawingBufferWidth,l.drawingBufferHeight];f="fillOutlinePattern"===p&&u?bn(w,e,h,r,t):xn(w,t)}else m=y.indexBuffer,g=y.segments,f=u?vn(w,e,h,r):yn(w);e.prepareDrawProgram(e.context,x,_.toUnwrapped()),x.draw(e.context,d,o,e.stencilModeForClipping(_),s,t.CullFaceMode.disabled,f,i.id,y.layoutVertexBuffer,m,g,i.paint,e.transform.zoom,v)}}function Kn(e,n,i,r,o,s,a){const l=e.context,c=l.gl,u=i.paint.get("fill-extrusion-pattern"),h=u.constantOr(1),d=i.getCrossfadeParameters(),p=i.paint.get("fill-extrusion-opacity");for(const f of r){const r=n.getTile(f),m=r.getBucket(i);if(!m)continue;const g=m.programConfigurations.get(i.id),_=e.useProgram(h?"fillExtrusionPattern":"fillExtrusion",g);if(e.terrain){const t=e.terrain;if(!m.enableTerrain)continue;if(t.setupElevationDraw(r,_,{useMeterToDem:!0}),Yn(l,n,f,m,i,t),!m.centroidVertexBuffer){const t=_.attributes.a_centroid_pos;void 0!==t&&c.vertexAttrib2f(t,0,0)}}h&&(e.context.activeTexture.set(c.TEXTURE0),r.imageAtlasTexture.bind(c.LINEAR,c.CLAMP_TO_EDGE),g.updatePaintBuffers(d));const y=u.constantOr(null);if(y&&r.imageAtlas){const t=r.imageAtlas,e=t.patternPositions[y.to.toString()],n=t.patternPositions[y.from.toString()];e&&n&&g.setConstantPatternPositions(e,n)}const v=e.translatePosMatrix(f.projMatrix,r,i.paint.get("fill-extrusion-translate"),i.paint.get("fill-extrusion-translate-anchor")),x=i.paint.get("fill-extrusion-vertical-gradient"),b=h?_n(v,e,x,p,f,d,r):gn(v,e,x,p);e.prepareDrawProgram(l,_,f.toUnwrapped()),_.draw(l,l.gl.TRIANGLES,o,s,a,t.CullFaceMode.backCCW,b,i.id,m.layoutVertexBuffer,m.indexBuffer,m.segments,i.paint,e.transform.zoom,g,e.terrain?m.centroidVertexBuffer:null)}}function Yn(e,n,i,r,o,s){const a=[e=>{let n=e.canonical.x-1,i=e.wrap;return n<0&&(n=(1<<e.canonical.z)-1,i--),new t.OverscaledTileID(e.overscaledZ,i,e.canonical.z,n,e.canonical.y)},e=>{let n=e.canonical.x+1,i=e.wrap;return n===1<<e.canonical.z&&(n=0,i++),new t.OverscaledTileID(e.overscaledZ,i,e.canonical.z,n,e.canonical.y)},e=>new t.OverscaledTileID(e.overscaledZ,e.wrap,e.canonical.z,e.canonical.x,(0===e.canonical.y?1<<e.canonical.z:e.canonical.y)-1),e=>new t.OverscaledTileID(e.overscaledZ,e.wrap,e.canonical.z,e.canonical.x,e.canonical.y===(1<<e.canonical.z)-1?0:e.canonical.y+1)],l=t=>{const e=n.getSource().maxzoom,i=t=>{const e=n.getTileByID(t);if(e&&e.hasData())return e.getBucket(o)};let r,s,a;return(t.overscaledZ===t.canonical.z||t.overscaledZ>=e)&&(r=i(t.key)),t.overscaledZ>=e&&(s=i(t.calculateScaledKey(t.overscaledZ+1))),t.overscaledZ>e&&(a=i(t.calculateScaledKey(t.overscaledZ-1))),r||s||a},c=[0,0,0],u=(e,n)=>(c[0]=Math.min(e.min.y,n.min.y),c[1]=Math.max(e.max.y,n.max.y),c[2]=t.EXTENT-n.min.x>e.max.x?n.min.x-t.EXTENT:e.max.x,c),h=(e,n)=>(c[0]=Math.min(e.min.x,n.min.x),c[1]=Math.max(e.max.x,n.max.x),c[2]=t.EXTENT-n.min.y>e.max.y?n.min.y-t.EXTENT:e.max.y,c),d=[(t,e)=>u(t,e),(t,e)=>u(e,t),(t,e)=>h(t,e),(t,e)=>h(e,t)],p=new t.pointGeometry(0,0);let f,m,g;const _=(e,n,r,o,a)=>{const l=[[o?r:e,o?e:r,0],[o?r:n,o?n:r,0]],c=a<0?t.EXTENT+a:a,u=[o?c:(e+n)/2,o?(e+n)/2:c,0];return 0===r&&a<0||0!==r&&a>0?s.getForTilePoints(g,[u],!0,m):l.push(u),s.getForTilePoints(i,l,!0,f),Math.max(l[0][2],l[1][2],u[2])/s.exaggeration()};for(let y=0;y<4;y++){const e=r.borders[y];if(0===e.length&&(r.borderDone[y]=!0),r.borderDone[y])continue;const n=g=a[y](i),o=l(n);if(!o||!o.enableTerrain)continue;if(m=s.findDEMTileFor(n),!m||!m.dem)continue;if(!f){const t=s.findDEMTileFor(i);if(!t||!t.dem)return;f=t}const c=(y<2?1:5)-y,u=o.borders[c];let h=0;for(let i=0;i<e.length;i++){const n=r.featuresOnBorder[e[i]],s=n.borders[y];let a;for(;h<u.length&&(a=o.featuresOnBorder[u[h]],!(a.borders[c][1]>s[0]+3));)o.borderDone[c]||o.encodeCentroid(void 0,a,!1),h++;if(a&&h<u.length){const e=h;let i=0;for(;!(a.borders[c][0]>s[1]-3)&&(i++,++h!==u.length);)a=o.featuresOnBorder[u[h]];if(a=o.featuresOnBorder[u[e]],n.intersectsCount()>1||a.intersectsCount()>1||1!==i){1!==i&&(h=e),r.encodeCentroid(void 0,n,!1),o.borderDone[c]||o.encodeCentroid(void 0,a,!1);continue}const l=d[y](n,a),f=y%2?t.EXTENT-1:0;p.x=_(l[0],Math.min(t.EXTENT-1,l[1]),f,y<2,l[2]),p.y=0,r.encodeCentroid(p,n,!1),o.borderDone[c]||o.encodeCentroid(p,a,!1)}else r.encodeCentroid(void 0,n,!1)}r.borderDone[y]=r.needsCentroidUpdate=!0,o.borderDone[c]||(o.borderDone[c]=o.needsCentroidUpdate=!0)}(r.needsCentroidUpdate||!r.centroidVertexBuffer&&0!==r.centroidVertexArray.length)&&r.uploadCentroid(e)}const Jn=new t.Color(1,0,0,1),Qn=new t.Color(0,1,0,1),ti=new t.Color(0,0,1,1),ei=new t.Color(1,0,1,1),ni=new t.Color(0,1,1,1);function ii(t,e,n,i){oi(t,0,e+n/2,t.transform.width,n,i)}function ri(t,e,n,i){oi(t,e-n/2,0,n,t.transform.height,i)}function oi(e,n,i,r,o,s){const a=e.context,l=a.gl;l.enable(l.SCISSOR_TEST),l.scissor(n*t.exported.devicePixelRatio,i*t.exported.devicePixelRatio,r*t.exported.devicePixelRatio,o*t.exported.devicePixelRatio),a.clear({color:s}),l.disable(l.SCISSOR_TEST)}function si(e,n,i){const r=e.context,o=r.gl,s=i.projMatrix,a=e.useProgram("debug"),l=n.getTileByID(i.key);e.terrain&&e.terrain.setupElevationDraw(l,a);const c=t.DepthMode.disabled,u=t.StencilMode.disabled,h=e.colorModeForRenderPass(),d="$debug";r.activeTexture.set(o.TEXTURE0),e.emptyTexture.bind(o.LINEAR,o.CLAMP_TO_EDGE),a.draw(r,o.LINE_STRIP,c,u,h,t.CullFaceMode.disabled,Sn(s,t.Color.red),d,e.debugBuffer,e.tileBorderIndexBuffer,e.debugSegments);const p=l.latestRawTileData,f=Math.floor((p&&p.byteLength||0)/1024),m=n.getTile(i).tileSize,g=512/Math.min(m,512)*(i.overscaledZ/e.transform.zoom)*.5;let _=i.canonical.toString();i.overscaledZ!==i.canonical.z&&(_+=" => "+i.overscaledZ),function(t,e){t.initDebugOverlayCanvas();const n=t.debugOverlayCanvas,i=t.context.gl,r=t.debugOverlayCanvas.getContext("2d");r.clearRect(0,0,n.width,n.height),r.shadowColor="white",r.shadowBlur=2,r.lineWidth=1.5,r.strokeStyle="white",r.textBaseline="top",r.font="bold 36px Open Sans, sans-serif",r.fillText(e,5,5),r.strokeText(e,5,5),t.debugOverlayTexture.update(n),t.debugOverlayTexture.bind(i.LINEAR,i.CLAMP_TO_EDGE)}(e,`${_} ${f}kb`),a.draw(r,o.TRIANGLES,c,u,t.ColorMode.alphaBlended,t.CullFaceMode.disabled,Sn(s,t.Color.transparent,g),d,e.debugBuffer,e.quadTriangleIndexBuffer,e.debugSegments)}const ai=t.createLayout([{name:"a_pos_3f",components:3,type:"Float32"}]),{members:li}=ai;function ci(t,e,n,i){t.emplaceBack(e,n,i)}class ui{constructor(e){this.vertexArray=new t.StructArrayLayout3f12,this.indices=new t.StructArrayLayout3ui6,ci(this.vertexArray,-1,-1,1),ci(this.vertexArray,1,-1,1),ci(this.vertexArray,-1,1,1),ci(this.vertexArray,1,1,1),ci(this.vertexArray,-1,-1,-1),ci(this.vertexArray,1,-1,-1),ci(this.vertexArray,-1,1,-1),ci(this.vertexArray,1,1,-1),this.indices.emplaceBack(5,1,3),this.indices.emplaceBack(3,7,5),this.indices.emplaceBack(6,2,0),this.indices.emplaceBack(0,4,6),this.indices.emplaceBack(2,6,7),this.indices.emplaceBack(7,3,2),this.indices.emplaceBack(5,4,0),this.indices.emplaceBack(0,1,5),this.indices.emplaceBack(0,2,3),this.indices.emplaceBack(3,1,0),this.indices.emplaceBack(7,6,4),this.indices.emplaceBack(4,5,7),this.vertexBuffer=e.createVertexBuffer(this.vertexArray,li),this.indexBuffer=e.createIndexBuffer(this.indices),this.segment=t.SegmentVector.simpleSegment(0,0,36,12)}}function hi(e,n,i,r,o,s){const a=e.gl,l=n.paint.get("sky-atmosphere-color"),c=n.paint.get("sky-atmosphere-halo-color"),u=n.paint.get("sky-atmosphere-sun-intensity"),h=((t,e,n,i,r)=>({u_matrix_3f:t,u_sun_direction:e,u_sun_intensity:n,u_color_tint_r:[i.r,i.g,i.b,i.a],u_color_tint_m:[r.r,r.g,r.b,r.a],u_luminance:5e-5}))(t.fromMat4([],r),o,u,l,c);a.framebufferTexture2D(a.FRAMEBUFFER,a.COLOR_ATTACHMENT0,a.TEXTURE_CUBE_MAP_POSITIVE_X+s,n.skyboxTexture,0),i.draw(e,a.TRIANGLES,t.DepthMode.disabled,t.StencilMode.disabled,t.ColorMode.unblended,t.CullFaceMode.frontCW,h,"skyboxCapture",n.skyboxGeometry.vertexBuffer,n.skyboxGeometry.indexBuffer,n.skyboxGeometry.segment)}const di={symbol:function(e,n,i,r,o){if("translucent"!==e.renderPass)return;const s=t.StencilMode.disabled,a=e.colorModeForRenderPass();i.layout.get("text-variable-anchor")&&function(e,n,i,r,o,s,a){const l=n.transform,c="map"===o,u="map"===s;for(const h of e){const e=r.getTile(h),o=e.getBucket(i);if(!o||!o.text||!o.text.segments.get().length)continue;const s=t.evaluateSizeForZoom(o.textSizeData,l.zoom),d=I(e,1,n.transform.zoom),p=Wt(h.projMatrix,u,c,n.transform,d),f="none"!==i.layout.get("icon-text-fit")&&o.hasIconData();if(s){const n=Math.pow(2,l.zoom-e.tileID.overscaledZ),i=l.elevation;Gn(o,c,u,a,t.symbolSize,l,p,h.projMatrix,n,s,f,i?t=>i.getAtTileOffset(h,t.x,t.y):t=>0)}}}(r,e,i,n,i.layout.get("text-rotation-alignment"),i.layout.get("text-pitch-alignment"),o),0!==i.paint.get("icon-opacity").constantOr(1)&&Hn(e,n,i,r,!1,i.paint.get("icon-translate"),i.paint.get("icon-translate-anchor"),i.layout.get("icon-rotation-alignment"),i.layout.get("icon-pitch-alignment"),i.layout.get("icon-keep-upright"),s,a),0!==i.paint.get("text-opacity").constantOr(1)&&Hn(e,n,i,r,!0,i.paint.get("text-translate"),i.paint.get("text-translate-anchor"),i.layout.get("text-rotation-alignment"),i.layout.get("text-pitch-alignment"),i.layout.get("text-keep-upright"),s,a),n.map.showCollisionBoxes&&(jn(e,n,i,r,i.paint.get("text-translate"),i.paint.get("text-translate-anchor"),!0),jn(e,n,i,r,i.paint.get("icon-translate"),i.paint.get("icon-translate-anchor"),!1))},circle:function(e,n,i,r){if("translucent"!==e.renderPass)return;const o=i.paint.get("circle-opacity"),s=i.paint.get("circle-stroke-width"),a=i.paint.get("circle-stroke-opacity"),l=void 0!==i.layout.get("circle-sort-key").constantOr(1);if(0===o.constantOr(1)&&(0===s.constantOr(1)||0===a.constantOr(1)))return;const c=e.context,u=c.gl,h=e.depthModeForSublayer(0,t.DepthMode.ReadOnly),d=t.StencilMode.disabled,p=e.colorModeForRenderPass(),f=[];for(let m=0;m<r.length;m++){const o=r[m],s=n.getTile(o),a=s.getBucket(i);if(!a)continue;const c=a.programConfigurations.get(i.id),u=Cn(i),h={programConfiguration:c,program:e.useProgram("circle",c,u),layoutVertexBuffer:a.layoutVertexBuffer,indexBuffer:a.indexBuffer,uniformValues:wn(e,o,s,i),tile:s};if(l){const e=a.segments.get();for(const n of e)f.push({segments:new t.SegmentVector([n]),sortKey:n.sortKey,state:h})}else f.push({segments:a.segments,sortKey:0,state:h})}l&&f.sort((t,e)=>t.sortKey-e.sortKey);for(const m of f){const{programConfiguration:n,program:r,layoutVertexBuffer:o,indexBuffer:s,uniformValues:a,tile:l}=m.state,f=m.segments;e.terrain&&e.terrain.setupElevationDraw(l,r,{useDepthForOcclusion:!0}),e.prepareDrawProgram(c,r,l.tileID.toUnwrapped()),r.draw(c,u.TRIANGLES,h,d,p,t.CullFaceMode.disabled,a,i.id,o,s,f,i.paint,e.transform.zoom,n)}},heatmap:function(e,n,i,r){if(0!==i.paint.get("heatmap-opacity"))if("offscreen"===e.renderPass){const o=e.context,s=o.gl,a=t.StencilMode.disabled,l=new t.ColorMode([s.ONE,s.ONE],t.Color.transparent,[!0,!0,!0,!0]);!function(t,e,n){const i=t.gl;t.activeTexture.set(i.TEXTURE1),t.viewport.set([0,0,e.width/4,e.height/4]);let r=n.heatmapFbo;if(r)i.bindTexture(i.TEXTURE_2D,r.colorAttachment.get()),t.bindFramebuffer.set(r.framebuffer);else{const o=i.createTexture();i.bindTexture(i.TEXTURE_2D,o),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_S,i.CLAMP_TO_EDGE),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_T,i.CLAMP_TO_EDGE),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MIN_FILTER,i.LINEAR),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MAG_FILTER,i.LINEAR),r=n.heatmapFbo=t.createFramebuffer(e.width/4,e.height/4,!1),function(t,e,n,i){const r=t.gl;r.texImage2D(r.TEXTURE_2D,0,r.RGBA,e.width/4,e.height/4,0,r.RGBA,t.extRenderToTextureHalfFloat?t.extTextureHalfFloat.HALF_FLOAT_OES:r.UNSIGNED_BYTE,null),i.colorAttachment.set(n)}(t,e,o,r)}}(o,e,i),o.clear({color:t.Color.transparent});for(let c=0;c<r.length;c++){const u=r[c];if(n.hasRenderableParent(u))continue;const h=n.getTile(u),d=h.getBucket(i);if(!d)continue;const p=d.programConfigurations.get(i.id),f=e.useProgram("heatmap",p),{zoom:m}=e.transform;e.terrain&&e.terrain.setupElevationDraw(h,f),e.prepareDrawProgram(o,f,u.toUnwrapped()),f.draw(o,s.TRIANGLES,t.DepthMode.disabled,a,l,t.CullFaceMode.disabled,En(u.projMatrix,h,m,i.paint.get("heatmap-intensity")),i.id,d.layoutVertexBuffer,d.indexBuffer,d.segments,i.paint,e.transform.zoom,p)}o.viewport.set([0,0,e.width,e.height])}else"translucent"===e.renderPass&&(e.context.setColorMode(e.colorModeForRenderPass()),function(e,n){const i=e.context,r=i.gl,o=n.heatmapFbo;if(!o)return;i.activeTexture.set(r.TEXTURE0),r.bindTexture(r.TEXTURE_2D,o.colorAttachment.get()),i.activeTexture.set(r.TEXTURE1);let s=n.colorRampTexture;s||(s=n.colorRampTexture=new t.Texture(i,n.colorRamp,r.RGBA)),s.bind(r.LINEAR,r.CLAMP_TO_EDGE),e.useProgram("heatmapTexture").draw(i,r.TRIANGLES,t.DepthMode.disabled,t.StencilMode.disabled,e.colorModeForRenderPass(),t.CullFaceMode.disabled,((e,n,i,r)=>{const o=t.create$1();t.ortho(o,0,e.width,e.height,0,0,1);const s=e.context.gl;return{u_matrix:o,u_world:[s.drawingBufferWidth,s.drawingBufferHeight],u_image:0,u_color_ramp:1,u_opacity:n.paint.get("heatmap-opacity")}})(e,n),n.id,e.viewportBuffer,e.quadTriangleIndexBuffer,e.viewportSegments,n.paint,e.transform.zoom)}(e,i))},line:function(e,n,i,r){if("translucent"!==e.renderPass)return;const o=i.paint.get("line-opacity"),s=i.paint.get("line-width");if(0===o.constantOr(1)||0===s.constantOr(1))return;const a=e.depthModeForSublayer(0,t.DepthMode.ReadOnly),l=e.colorModeForRenderPass(),c=i.paint.get("line-dasharray"),u=c.constantOr(1),h=i.layout.get("line-cap"),d=i.paint.get("line-pattern"),p=d.constantOr(1),f=i.paint.get("line-gradient"),m=i.getCrossfadeParameters(),g=p?"linePattern":u?"lineSDF":f?"lineGradient":"line",_=e.context,y=_.gl;for(const v of r){const r=n.getTile(v);if(p&&!r.patternsLoaded())continue;const o=r.getBucket(i);if(!o)continue;e.prepareDrawTile(v);const s=o.programConfigurations.get(i.id),x=e.useProgram(g,s),b=d.constantOr(null);if(b&&r.imageAtlas){const t=r.imageAtlas,e=t.patternPositions[b.to.toString()],n=t.patternPositions[b.from.toString()];e&&n&&s.setConstantPatternPositions(e,n)}const w=c.constantOr(null),C=h.constantOr(null);if(!p&&w&&C&&r.lineAtlas){const t=r.lineAtlas,e=t.getDash(w.to,C),n=t.getDash(w.from,C);e&&n&&s.setConstantPatternPositions(e,n)}const T=e.terrain?v.projMatrix:null,S=p?In(e,r,i,m,T):u?Pn(e,r,i,m,T):f?An(e,r,i,T,o.lineClipsArray.length):kn(e,r,i,T);if(p)_.activeTexture.set(y.TEXTURE0),r.imageAtlasTexture.bind(y.LINEAR,y.CLAMP_TO_EDGE),s.updatePaintBuffers(m);else if(u)_.activeTexture.set(y.TEXTURE0),r.lineAtlasTexture.bind(y.LINEAR,y.REPEAT),s.updatePaintBuffers(m);else if(f){const r=o.gradients[i.id];let s=r.texture;if(i.gradientVersion!==r.version){let a=256;if(i.stepInterpolant){const i=n.getSource().maxzoom,r=v.canonical.z===i?Math.ceil(1<<e.transform.maxZoom-v.canonical.z):1;a=t.clamp(t.nextPowerOfTwo(o.maxLineLength/t.EXTENT*1024*r),256,_.maxTextureSize)}r.gradient=t.renderColorRamp({expression:i.gradientExpression(),evaluationKey:"lineProgress",resolution:a,image:r.gradient||void 0,clips:o.lineClipsArray}),r.texture?r.texture.update(r.gradient):r.texture=new t.Texture(_,r.gradient,y.RGBA),r.version=i.gradientVersion,s=r.texture}_.activeTexture.set(y.TEXTURE0),s.bind(i.stepInterpolant?y.NEAREST:y.LINEAR,y.CLAMP_TO_EDGE)}e.prepareDrawProgram(_,x,v.toUnwrapped()),x.draw(_,y.TRIANGLES,a,e.stencilModeForClipping(v),l,t.CullFaceMode.disabled,S,i.id,o.layoutVertexBuffer,o.indexBuffer,o.segments,i.paint,e.transform.zoom,s,o.layoutVertexBuffer2)}},fill:function(e,n,i,r){const o=i.paint.get("fill-color"),s=i.paint.get("fill-opacity");if(0===s.constantOr(1))return;const a=e.colorModeForRenderPass(),l=i.paint.get("fill-pattern"),c=e.opaquePassEnabledForLayer()&&!l.constantOr(1)&&1===o.constantOr(t.Color.transparent).a&&1===s.constantOr(0)?"opaque":"translucent";if(e.renderPass===c){const o=e.depthModeForSublayer(1,"opaque"===e.renderPass?t.DepthMode.ReadWrite:t.DepthMode.ReadOnly);Xn(e,n,i,r,o,a,!1)}if("translucent"===e.renderPass&&i.paint.get("fill-antialias")){const o=e.depthModeForSublayer(i.getPaintProperty("fill-outline-color")?2:0,t.DepthMode.ReadOnly);Xn(e,n,i,r,o,a,!0)}},"fill-extrusion":function(e,n,i,r){const o=i.paint.get("fill-extrusion-opacity");if(0!==o&&"translucent"===e.renderPass){const s=new t.DepthMode(e.context.gl.LEQUAL,t.DepthMode.ReadWrite,e.depthRangeFor3D);if(1!==o||i.paint.get("fill-extrusion-pattern").constantOr(1))Kn(e,n,i,r,s,t.StencilMode.disabled,t.ColorMode.disabled),Kn(e,n,i,r,s,e.stencilModeFor3D(),e.colorModeForRenderPass());else{const o=e.colorModeForRenderPass();Kn(e,n,i,r,s,t.StencilMode.disabled,o)}}},hillshade:function(e,n,i,r){if("offscreen"!==e.renderPass&&"translucent"!==e.renderPass)return;const o=e.context,s=e.depthModeForSublayer(0,t.DepthMode.ReadOnly),a=e.colorModeForRenderPass(),l=e.terrain&&e.terrain.renderingToTexture,[c,u]="translucent"!==e.renderPass||l?[{},r]:e.stencilConfigForOverlap(r);for(const h of u){const r=n.getTile(h);if(r.needsHillshadePrepare&&"offscreen"===e.renderPass)tn(e,r,i,s,t.StencilMode.disabled,a);else if("translucent"===e.renderPass){const t=l&&e.terrain?e.terrain.stencilModeForRTTOverlap(h):c[h.overscaledZ];Je(e,h,r,i,s,t,a)}}o.viewport.set([0,0,e.width,e.height])},raster:function(e,n,i,r,o,s){if("translucent"!==e.renderPass)return;if(0===i.paint.get("raster-opacity"))return;if(!r.length)return;const a=e.context,l=a.gl,c=n.getSource(),u=e.useProgram("raster"),h=e.colorModeForRenderPass(),d=e.terrain&&e.terrain.renderingToTexture,[p,f]=c instanceof Tt||d?[{},r]:e.stencilConfigForOverlap(r),m=f[f.length-1].overscaledZ,g=!e.options.moving;for(const _ of f){const r=d?t.DepthMode.disabled:e.depthModeForSublayer(_.overscaledZ-m,1===i.paint.get("raster-opacity")?t.DepthMode.ReadWrite:t.DepthMode.ReadOnly,l.LESS),o=_.toUnwrapped(),f=n.getTile(_);if(d&&(!f||!f.hasData()))continue;const y=d?_.projMatrix:e.transform.calculateProjMatrix(o,g),v=e.terrain&&d?e.terrain.stencilModeForRTTOverlap(_):p[_.overscaledZ],x=s?0:i.paint.get("raster-fade-duration");f.registerFadeDuration(x);const b=n.findLoadedParent(_,0),w=cn(f,b,n,e.transform,x);let C,T;e.terrain&&e.terrain.prepareDrawTile(_);const S="nearest"===i.paint.get("raster-resampling")?l.NEAREST:l.LINEAR;a.activeTexture.set(l.TEXTURE0),f.texture.bind(S,l.CLAMP_TO_EDGE,l.LINEAR_MIPMAP_NEAREST),a.activeTexture.set(l.TEXTURE1),b?(b.texture.bind(S,l.CLAMP_TO_EDGE,l.LINEAR_MIPMAP_NEAREST),C=Math.pow(2,b.tileID.overscaledZ-f.tileID.overscaledZ),T=[f.tileID.canonical.x*C%1,f.tileID.canonical.y*C%1]):f.texture.bind(S,l.CLAMP_TO_EDGE,l.LINEAR_MIPMAP_NEAREST);const E=zn(y,T||[0,0],C||1,w,i);e.prepareDrawProgram(a,u,o),c instanceof Tt?u.draw(a,l.TRIANGLES,r,t.StencilMode.disabled,h,t.CullFaceMode.disabled,E,i.id,c.boundsBuffer,e.quadTriangleIndexBuffer,c.boundsSegments):u.draw(a,l.TRIANGLES,r,v,h,t.CullFaceMode.disabled,E,i.id,e.rasterBoundsBuffer,e.quadTriangleIndexBuffer,e.rasterBoundsSegments)}},background:function(e,n,i,r){const o=i.paint.get("background-color"),s=i.paint.get("background-opacity");if(0===s)return;const a=e.context,l=a.gl,c=e.transform,u=c.tileSize,h=i.paint.get("background-pattern");if(e.isPatternMissing(h))return;const d=!h&&1===o.a&&1===s&&e.opaquePassEnabledForLayer()?"opaque":"translucent";if(e.renderPass!==d)return;const p=t.StencilMode.disabled,f=e.depthModeForSublayer(0,"opaque"===d?t.DepthMode.ReadWrite:t.DepthMode.ReadOnly),m=e.colorModeForRenderPass(),g=e.useProgram(h?"backgroundPattern":"background"),_=r||c.coveringTiles({tileSize:u});h&&(a.activeTexture.set(l.TEXTURE0),e.imageManager.bind(e.context));const y=i.getCrossfadeParameters();for(const v of _){const n=v.toUnwrapped(),c=r?v.projMatrix:e.transform.calculateProjMatrix(n);e.prepareDrawTile(v);const d=h?Vn(c,s,e,h,{tileID:v,tileSize:u},y):Bn(c,s,o);e.prepareDrawProgram(a,g,n),g.draw(a,l.TRIANGLES,f,p,m,t.CullFaceMode.disabled,d,i.id,e.tileExtentBuffer,e.quadTriangleIndexBuffer,e.tileExtentSegments)}},sky:function(e,n,i){const r=i.paint.get("sky-opacity");if(0===r)return;const o=e.context,s=i.paint.get("sky-type"),a=new t.DepthMode(o.gl.LEQUAL,t.DepthMode.ReadOnly,[0,1]),l=e.frameCounter/1e3%1;"atmosphere"===s?"offscreen"===e.renderPass?i.needsSkyboxCapture(e)&&(function(e,n,i,r){const o=e.context,s=o.gl;let a=n.skyboxFbo;if(!a){a=n.skyboxFbo=o.createFramebuffer(32,32,!1),n.skyboxGeometry=new ui(o),n.skyboxTexture=o.gl.createTexture(),s.bindTexture(s.TEXTURE_CUBE_MAP,n.skyboxTexture),s.texParameteri(s.TEXTURE_CUBE_MAP,s.TEXTURE_WRAP_S,s.CLAMP_TO_EDGE),s.texParameteri(s.TEXTURE_CUBE_MAP,s.TEXTURE_WRAP_T,s.CLAMP_TO_EDGE),s.texParameteri(s.TEXTURE_CUBE_MAP,s.TEXTURE_MIN_FILTER,s.LINEAR),s.texParameteri(s.TEXTURE_CUBE_MAP,s.TEXTURE_MAG_FILTER,s.LINEAR);for(let t=0;t<6;++t)s.texImage2D(s.TEXTURE_CUBE_MAP_POSITIVE_X+t,0,s.RGBA,32,32,0,s.RGBA,s.UNSIGNED_BYTE,null)}o.bindFramebuffer.set(a.framebuffer),o.viewport.set([0,0,32,32]);const l=n.getCenter(e,!0),c=e.useProgram("skyboxCapture"),u=new Float64Array(16);t.identity(u),t.rotateY(u,u,.5*-Math.PI),hi(o,n,c,u,l,0),t.identity(u),t.rotateY(u,u,.5*Math.PI),hi(o,n,c,u,l,1),t.identity(u),t.rotateX(u,u,.5*-Math.PI),hi(o,n,c,u,l,2),t.identity(u),t.rotateX(u,u,.5*Math.PI),hi(o,n,c,u,l,3),t.identity(u),hi(o,n,c,u,l,4),t.identity(u),t.rotateY(u,u,Math.PI),hi(o,n,c,u,l,5),o.viewport.set([0,0,e.width,e.height])}(e,i),i.markSkyboxValid(e)):"sky"===e.renderPass&&function(e,n,i,r,o){const s=e.context,a=s.gl,l=e.transform,c=e.useProgram("skybox");s.activeTexture.set(a.TEXTURE0),a.bindTexture(a.TEXTURE_CUBE_MAP,n.skyboxTexture);const u=((t,e,n,i,r)=>({u_matrix:t,u_sun_direction:e,u_cubemap:0,u_opacity:i,u_temporal_offset:r}))(l.skyboxMatrix,n.getCenter(e,!1),0,r,o);e.prepareDrawProgram(s,c),c.draw(s,a.TRIANGLES,i,t.StencilMode.disabled,e.colorModeForRenderPass(),t.CullFaceMode.backCW,u,"skybox",n.skyboxGeometry.vertexBuffer,n.skyboxGeometry.indexBuffer,n.skyboxGeometry.segment)}(e,i,a,r,l):"gradient"===s&&"sky"===e.renderPass&&function(e,n,i,r,o){const s=e.context,a=s.gl,l=e.transform,c=e.useProgram("skyboxGradient");n.skyboxGeometry||(n.skyboxGeometry=new ui(s)),s.activeTexture.set(a.TEXTURE0);let u=n.colorRampTexture;u||(u=n.colorRampTexture=new t.Texture(s,n.colorRamp,a.RGBA)),u.bind(a.LINEAR,a.CLAMP_TO_EDGE);const h=((e,n,i,r,o)=>({u_matrix:e,u_color_ramp:0,u_center_direction:n,u_radius:t.degToRad(i),u_opacity:r,u_temporal_offset:o}))(l.skyboxMatrix,n.getCenter(e,!1),n.paint.get("sky-gradient-radius"),r,o);e.prepareDrawProgram(s,c),c.draw(s,a.TRIANGLES,i,t.StencilMode.disabled,e.colorModeForRenderPass(),t.CullFaceMode.backCW,h,"skyboxGradient",n.skyboxGeometry.vertexBuffer,n.skyboxGeometry.indexBuffer,n.skyboxGeometry.segment)}(e,i,a,r,l)},debug:function(t,e,n){for(let i=0;i<n.length;i++)si(t,e,n[i])},custom:function(e,n,i){const r=e.context,o=i.implementation;if("offscreen"===e.renderPass){const t=o.prerender;t&&(e.setCustomLayerDefaults(),r.setColorMode(e.colorModeForRenderPass()),t.call(o,r.gl,e.transform.customLayerMatrix()),r.setDirty(),e.setBaseState())}else if("translucent"===e.renderPass){e.setCustomLayerDefaults(),r.setColorMode(e.colorModeForRenderPass()),r.setStencilMode(t.StencilMode.disabled);const n="3d"===o.renderingMode?new t.DepthMode(e.context.gl.LEQUAL,t.DepthMode.ReadWrite,e.depthRangeFor3D):e.depthModeForSublayer(0,t.DepthMode.ReadOnly);r.setDepthMode(n),o.render(r.gl,e.transform.customLayerMatrix()),r.setDirty(),e.setBaseState(),r.bindFramebuffer.set(null)}}};class pi{constructor(e,n){this.context=new xt(e),this.transform=n,this._tileTextures={},this.frameCopies=[],this.loadTimeStamps=[],this.setup(),this.numSublayers=t.SourceCache.maxUnderzooming+t.SourceCache.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new Le,this.gpuTimers={},this.frameCounter=0}updateTerrain(t,e){const n=!!t&&!!t.terrain;if(!(n||this._terrain&&this._terrain.enabled))return;this._terrain||(this._terrain=new dn(this,t));const i=this._terrain;this.transform.elevation=n?i:null,i.update(t,this.transform,e)}_updateFog(t){const e=t.fog;if(!e||e.getOpacity(this.transform.pitch)<1||e.properties.get("horizon-blend")<.03)return void(this.transform.fogCullDistSq=null);const[n,i]=e.getFovAdjustedRange(this.transform._fov),r=n+.78*(i-n);this.transform.fogCullDistSq=r*r}get terrain(){return this._terrain&&this._terrain.enabled?this._terrain:null}resize(e,n){if(this.width=e*t.exported.devicePixelRatio,this.height=n*t.exported.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const t of this.style.order)this.style._layers[t].resize()}setup(){const e=this.context,n=new t.StructArrayLayout2i4;n.emplaceBack(0,0),n.emplaceBack(t.EXTENT,0),n.emplaceBack(0,t.EXTENT),n.emplaceBack(t.EXTENT,t.EXTENT),this.tileExtentBuffer=e.createVertexBuffer(n,t.posAttributes.members),this.tileExtentSegments=t.SegmentVector.simpleSegment(0,0,4,2);const i=new t.StructArrayLayout2i4;i.emplaceBack(0,0),i.emplaceBack(t.EXTENT,0),i.emplaceBack(0,t.EXTENT),i.emplaceBack(t.EXTENT,t.EXTENT),this.debugBuffer=e.createVertexBuffer(i,t.posAttributes.members),this.debugSegments=t.SegmentVector.simpleSegment(0,0,4,5);const r=new t.StructArrayLayout4i8;r.emplaceBack(0,0,0,0),r.emplaceBack(t.EXTENT,0,t.EXTENT,0),r.emplaceBack(0,t.EXTENT,0,t.EXTENT),r.emplaceBack(t.EXTENT,t.EXTENT,t.EXTENT,t.EXTENT),this.rasterBoundsBuffer=e.createVertexBuffer(r,Ct.members),this.rasterBoundsSegments=t.SegmentVector.simpleSegment(0,0,4,2);const o=new t.StructArrayLayout2i4;o.emplaceBack(0,0),o.emplaceBack(1,0),o.emplaceBack(0,1),o.emplaceBack(1,1),this.viewportBuffer=e.createVertexBuffer(o,t.posAttributes.members),this.viewportSegments=t.SegmentVector.simpleSegment(0,0,4,2);const s=new t.StructArrayLayout1ui2;s.emplaceBack(0),s.emplaceBack(1),s.emplaceBack(3),s.emplaceBack(2),s.emplaceBack(0),this.tileBorderIndexBuffer=e.createIndexBuffer(s);const a=new t.StructArrayLayout3ui6;a.emplaceBack(0,1,2),a.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=e.createIndexBuffer(a),this.emptyTexture=new t.Texture(e,{width:1,height:1,data:new Uint8Array([0,0,0,0])},e.gl.RGBA),this.identityMat=t.create$1();const l=this.context.gl;this.stencilClearMode=new t.StencilMode({func:l.ALWAYS,mask:0},0,255,l.ZERO,l.ZERO,l.ZERO),this.loadTimeStamps.push(t.window.performance.now())}clearStencil(){const e=this.context,n=e.gl;this.nextStencilID=1,this.currentStencilSource=void 0;const i=t.create$1();t.ortho(i,0,this.width,this.height,0,0,1),t.scale$1(i,i,[n.drawingBufferWidth,n.drawingBufferHeight,0]),this.useProgram("clippingMask").draw(e,n.TRIANGLES,t.DepthMode.disabled,this.stencilClearMode,t.ColorMode.disabled,t.CullFaceMode.disabled,ln(i),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}_renderTileClippingMasks(e,n,i){if(!(n&&this.currentStencilSource!==n.id&&e.isTileClipped()&&i&&i.length))return;this.currentStencilSource=n.id;const r=this.context,o=r.gl;this.nextStencilID+i.length>256&&this.clearStencil(),r.setColorMode(t.ColorMode.disabled),r.setDepthMode(t.DepthMode.disabled);const s=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(const a of i){const e=this._tileClippingMaskIDs[a.key]=this.nextStencilID++;s.draw(r,o.TRIANGLES,t.DepthMode.disabled,new t.StencilMode({func:o.ALWAYS,mask:0},e,255,o.KEEP,o.KEEP,o.REPLACE),t.ColorMode.disabled,t.CullFaceMode.disabled,ln(a.projMatrix),"$clipping",this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const e=this.nextStencilID++,n=this.context.gl;return new t.StencilMode({func:n.NOTEQUAL,mask:255},e,255,n.KEEP,n.KEEP,n.REPLACE)}stencilModeForClipping(e){if(this.terrain)return this.terrain.stencilModeForRTTOverlap(e);const n=this.context.gl;return new t.StencilMode({func:n.EQUAL,mask:255},this._tileClippingMaskIDs[e.key],0,n.KEEP,n.KEEP,n.REPLACE)}stencilConfigForOverlap(e){const n=this.context.gl,i=e.sort((t,e)=>e.overscaledZ-t.overscaledZ),r=i[i.length-1].overscaledZ,o=i[0].overscaledZ-r+1;if(o>1){this.currentStencilSource=void 0,this.nextStencilID+o>256&&this.clearStencil();const e={};for(let i=0;i<o;i++)e[i+r]=new t.StencilMode({func:n.GEQUAL,mask:255},i+this.nextStencilID,255,n.KEEP,n.KEEP,n.REPLACE);return this.nextStencilID+=o,[e,i]}return[{[r]:t.StencilMode.disabled},i]}colorModeForRenderPass(){const e=this.context.gl;if(this._showOverdrawInspector){const n=1/8;return new t.ColorMode([e.CONSTANT_COLOR,e.ONE],new t.Color(n,n,n,0),[!0,!0,!0,!0])}return"opaque"===this.renderPass?t.ColorMode.unblended:t.ColorMode.alphaBlended}depthModeForSublayer(e,n,i){if(!this.opaquePassEnabledForLayer())return t.DepthMode.disabled;const r=1-((1+this.currentLayer)*this.numSublayers+e)*this.depthEpsilon;return new t.DepthMode(i||this.context.gl.LEQUAL,n,[r,r])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(e,n){this.style=e,this.options=n,this.lineAtlas=e.lineAtlas,this.imageManager=e.imageManager,this.glyphManager=e.glyphManager,this.symbolFadeChange=e.placement.symbolFadeChange(t.exported.now()),this.imageManager.beginFrame();const i=this.style.order,r=this.style._sourceCaches;for(const t in r){const e=r[t];e.used&&e.prepare(this.context)}const o={},s={},a={};for(const t in r){const e=r[t];o[t]=e.getVisibleCoordinates(),s[t]=o[t].slice().reverse(),a[t]=e.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let t=0;t<i.length;t++)if(this.style._layers[i[t]].is3D()){this.opaquePassCutoff=t;break}if(this.terrain&&(this.terrain.updateTileBinding(a),this.opaquePassCutoff=0),!t.isMapAuthenticated(this.context.gl))return;this.renderPass="offscreen";for(const t of i){const n=this.style._layers[t],i=e._getLayerSourceCache(n);if(!n.hasOffscreenPass()||n.isHidden(this.transform.zoom))continue;const r=i?s[i.id]:void 0;("custom"===n.type||n.isSky()||r&&r.length)&&this.renderLayer(this,i,n,r)}this.depthRangeFor3D=[0,1-(e.order.length+2)*this.numSublayers*this.depthEpsilon],this.terrain&&(this.style.hasSymbolLayers()||this.style.hasCircleLayers())&&this.terrain.drawDepth(),this.context.bindFramebuffer.set(null),this.context.viewport.set([0,0,this.width,this.height]);let l=t.Color.transparent;if(this.style.fog&&(l=this.style.fog.properties.get("color")),this.context.clear({color:n.showOverdrawInspector?t.Color.black:l,depth:1}),this.clearStencil(),this._showOverdrawInspector=n.showOverdrawInspector,this.renderPass="opaque",!this.terrain)for(this.currentLayer=i.length-1;this.currentLayer>=0;this.currentLayer--){const t=this.style._layers[i[this.currentLayer]],n=e._getLayerSourceCache(t);if(t.isSky())continue;const r=n?s[n.id]:void 0;this._renderTileClippingMasks(t,n,r),this.renderLayer(this,n,t,r)}if(this.renderPass="sky",this.transform.isHorizonVisible())for(this.currentLayer=0;this.currentLayer<i.length;this.currentLayer++){const t=this.style._layers[i[this.currentLayer]],n=e._getLayerSourceCache(t);t.isSky()&&this.renderLayer(this,n,t,n?s[n.id]:void 0)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<i.length;){const t=this.style._layers[i[this.currentLayer]],n=e._getLayerSourceCache(t);if(t.isSky()){++this.currentLayer;continue}if(this.terrain&&this.style.isLayerDraped(t)){if(t.isHidden(this.transform.zoom)){++this.currentLayer;continue}this.currentLayer=this.terrain.renderBatch(this.currentLayer);continue}const r=n?("symbol"===t.type?a:s)[n.id]:void 0;this._renderTileClippingMasks(t,n,n?o[n.id]:void 0),this.renderLayer(this,n,t,r),++this.currentLayer}if(this.terrain&&this.terrain.postRender(),this.options.showTileBoundaries||this.options.showQueryGeometry){let n=null;t.values(this.style._layers).forEach(t=>{const i=e._getLayerSourceCache(t);i&&!t.isHidden(this.transform.zoom)&&(!n||n.getSource().maxzoom<i.getSource().maxzoom)&&(n=i)}),n&&this.options.showTileBoundaries&&di.debug(this,n,n.getVisibleCoordinates())}this.options.showPadding&&function(t){const e=t.transform.padding;ii(t,t.transform.height-(e.top||0),3,Jn),ii(t,e.bottom||0,3,Qn),ri(t,e.left||0,3,ti),ri(t,t.transform.width-(e.right||0),3,ei);const n=t.transform.centerPoint;!function(t,e,n,i){oi(t,e-1,n-10,2,20,i),oi(t,e-10,n-1,20,2,i)}(t,n.x,t.transform.height-n.y,ni)}(this),this.context.setDefault(),this.frameCounter=(this.frameCounter+1)%t.MAX_SAFE_INTEGER,this.tileLoaded&&this.options.speedIndexTiming&&(this.loadTimeStamps.push(t.window.performance.now()),this.saveCanvasCopy())}renderLayer(t,e,n,i){n.isHidden(this.transform.zoom)||("background"===n.type||"sky"===n.type||"custom"===n.type||i&&i.length)&&(this.id=n.id,this.gpuTimingStart(n),di[n.type](t,e,n,i,this.style.placement.variableOffsets,this.options.isInitialLoad),this.gpuTimingEnd())}gpuTimingStart(t){if(!this.options.gpuTiming)return;const e=this.context.extTimerQuery;let n=this.gpuTimers[t.id];n||(n=this.gpuTimers[t.id]={calls:0,cpuTime:0,query:e.createQueryEXT()}),n.calls++,e.beginQueryEXT(e.TIME_ELAPSED_EXT,n.query)}gpuTimingEnd(){if(!this.options.gpuTiming)return;const t=this.context.extTimerQuery;t.endQueryEXT(t.TIME_ELAPSED_EXT)}collectGpuTimers(){const t=this.gpuTimers;return this.gpuTimers={},t}queryGpuTimers(t){const e={};for(const n in t){const i=t[n],r=this.context.extTimerQuery,o=r.getQueryObjectEXT(i.query,r.QUERY_RESULT_EXT)/1e6;r.deleteQueryEXT(i.query),e[n]=o}return e}translatePosMatrix(e,n,i,r,o){if(!i[0]&&!i[1])return e;const s=o?"map"===r?this.transform.angle:0:"viewport"===r?-this.transform.angle:0;if(s){const t=Math.sin(s),e=Math.cos(s);i=[i[0]*e-i[1]*t,i[0]*t+i[1]*e]}const a=[o?i[0]:I(n,i[0],this.transform.zoom),o?i[1]:I(n,i[1],this.transform.zoom),0],l=new Float32Array(16);return t.translate(l,e,a),l}saveTileTexture(t){const e=this._tileTextures[t.size[0]];e?e.push(t):this._tileTextures[t.size[0]]=[t]}getTileTexture(t){const e=this._tileTextures[t];return e&&e.length>0?e.pop():null}isPatternMissing(t){if(!t)return!1;if(!t.from||!t.to)return!0;const e=this.imageManager.getPattern(t.from.toString()),n=this.imageManager.getPattern(t.to.toString());return!e||!n}currentGlobalDefines(){const t=this.terrain&&this.terrain.renderingToTexture,e=this.style&&this.style.fog,n=[];return this.terrain&&!this.terrain.renderingToTexture&&n.push("TERRAIN"),e&&!t&&0!==e.getOpacity(this.transform.pitch)&&n.push("FOG"),t&&n.push("RENDER_TO_TEXTURE"),this._showOverdrawInspector&&n.push("OVERDRAW_INSPECTOR"),n}useProgram(t,e,n){this.cache=this.cache||{};const i=n||[],r=this.currentGlobalDefines().concat(i),o=fn.cacheKey(t,r,e);return this.cache[o]||(this.cache[o]=new fn(this.context,t,We[t],e,Un[t],r)),this.cache[o]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.frontFace.setDefault(),this.context.cullFaceSide.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const t=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(t.FUNC_ADD)}initDebugOverlayCanvas(){null==this.debugOverlayCanvas&&(this.debugOverlayCanvas=t.window.document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new t.Texture(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this._terrain&&this._terrain.destroy(),this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy()}prepareDrawTile(t){this.terrain&&this.terrain.prepareDrawTile(t)}prepareDrawProgram(t,e,n){if(this.terrain&&this.terrain.renderingToTexture)return;const i=this.style.fog;if(i){const r=i.getOpacity(this.transform.pitch);0!==r&&e.setFogUniformValues(t,((t,e,n,i)=>{const r=e.properties.get("color"),o=t.frameCounter/1e3%1,s=[r.r/r.a,r.g/r.a,r.b/r.a,i];return{u_fog_matrix:n?t.transform.calculateFogTileMatrix(n):t.identityMat,u_fog_range:e.getFovAdjustedRange(t.transform._fov),u_fog_color:s,u_fog_horizon_blend:e.properties.get("horizon-blend"),u_fog_temporal_offset:o}})(this,i,n,r))}}setTileLoadedFlag(t){this.tileLoaded=t}saveCanvasCopy(){this.frameCopies.push(this.canvasCopy()),this.tileLoaded=!1}canvasCopy(){const t=this.context.gl,e=t.createTexture();return t.bindTexture(t.TEXTURE_2D,e),t.copyTexImage2D(t.TEXTURE_2D,0,t.RGBA,0,0,t.drawingBufferWidth,t.drawingBufferHeight,0),e}getCanvasCopiesAndTimestamps(){return{canvasCopies:this.frameCopies,timeStamps:this.loadTimeStamps}}averageElevationNeedsEasing(){if(!this.transform._elevation)return!1;const t=this.style&&this.style.fog;return!!t&&0!==t.getOpacity(this.transform.pitch)}}class fi{constructor(t=0,e=0,n=0,i=0){if(isNaN(t)||t<0||isNaN(e)||e<0||isNaN(n)||n<0||isNaN(i)||i<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=t,this.bottom=e,this.left=n,this.right=i}interpolate(e,n,i){return null!=n.top&&null!=e.top&&(this.top=t.number(e.top,n.top,i)),null!=n.bottom&&null!=e.bottom&&(this.bottom=t.number(e.bottom,n.bottom,i)),null!=n.left&&null!=e.left&&(this.left=t.number(e.left,n.left,i)),null!=n.right&&null!=e.right&&(this.right=t.number(e.right,n.right,i)),this}getCenter(e,n){const i=t.clamp((this.left+e-this.right)/2,0,e),r=t.clamp((this.top+n-this.bottom)/2,0,n);return new t.pointGeometry(i,r)}equals(t){return this.top===t.top&&this.bottom===t.bottom&&this.left===t.left&&this.right===t.right}clone(){return new fi(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}function mi(t,e){return[t[4*e],t[4*e+1],t[4*e+2],t[4*e+3]]}function gi(t,e,n){t[4*e+0]=n[0],t[4*e+1]=n[1],t[4*e+2]=n[2],t[4*e+3]=n[3]}function _i(e,n){const i=mi(e,3);t.fromQuat(e,n),gi(e,3,i)}function yi(t,e){gi(t,3,[e[0],e[1],e[2],1])}function vi(e,n){const i=t.identity$1([]);return t.rotateZ$1(i,i,-n),t.rotateX$1(i,i,-e),i}function xi(e,n){const i=[e[0],e[1],0],r=[n[0],n[1],0];if(t.length(i)>=1e-15){const e=t.normalize([],i);t.scale(r,e,t.dot(r,e)),n[0]=r[0],n[1]=r[1]}const o=t.cross([],n,e);if(t.len(o)<1e-15)return null;const s=Math.atan2(-o[1],o[0]);return vi(Math.atan2(Math.sqrt(e[0]*e[0]+e[1]*e[1]),-e[2]),s)}class bi{constructor(t,e){this.position=t,this.orientation=e}get position(){return this._position}set position(e){this._position=this._renderWorldCopies?function(e){if(!e)return;const n=Array.isArray(e)?new t.MercatorCoordinate(e[0],e[1],e[2]):e;return n.x=t.wrap(n.x,0,1),n}(e):e}lookAtPoint(e,n){if(this.orientation=null,!this.position)return;const i=this._elevation?this._elevation.getAtPointOrZero(t.MercatorCoordinate.fromLngLat(e)):0,r=this.position,o=t.MercatorCoordinate.fromLngLat(e,i),s=[o.x-r.x,o.y-r.y,o.z-r.z];n||(n=[0,0,1]),n[2]=Math.abs(n[2]),this.orientation=xi(s,n)}setPitchBearing(e,n){this.orientation=vi(t.degToRad(e),t.degToRad(-n))}}class wi{constructor(e,n){this._transform=t.identity([]),this._orientation=t.identity$1([]),n&&(this._orientation=n,_i(this._transform,this._orientation)),e&&yi(this._transform,e)}get mercatorPosition(){const e=this.position;return new t.MercatorCoordinate(e[0],e[1],e[2])}get position(){const t=mi(this._transform,3);return[t[0],t[1],t[2]]}set position(t){yi(this._transform,t)}get orientation(){return this._orientation}set orientation(t){this._orientation=t,_i(this._transform,this._orientation)}getPitchBearing(){const t=this.forward(),e=this.right();return{bearing:Math.atan2(-e[1],e[0]),pitch:Math.atan2(Math.sqrt(t[0]*t[0]+t[1]*t[1]),-t[2])}}setPitchBearing(t,e){this._orientation=vi(t,e),_i(this._transform,this._orientation)}forward(){const t=mi(this._transform,2);return[-t[0],-t[1],-t[2]]}up(){const t=mi(this._transform,1);return[-t[0],-t[1],-t[2]]}right(){const t=mi(this._transform,0);return[t[0],t[1],t[2]]}getCameraToWorld(e,n){const i=new Float64Array(16);return t.invert(i,this.getWorldToCamera(e,n)),i}getWorldToCameraPosition(e,n,i){const r=this.position;t.scale(r,r,-e);const o=new Float64Array(16);return t.fromScaling(o,[i,i,i]),t.translate(o,o,r),o[10]*=n,o}getWorldToCamera(e,n){const i=new Float64Array(16),r=new Float64Array(4),o=this.position;return t.conjugate(r,this._orientation),t.scale(o,o,-e),t.fromQuat(i,r),t.translate(i,i,o),i[1]*=-1,i[5]*=-1,i[9]*=-1,i[13]*=-1,i[8]*=n,i[9]*=n,i[10]*=n,i[11]*=n,i}getCameraToClipPerspective(e,n,i,r){const o=new Float64Array(16);return t.perspective(o,e,n,i,r),o}getDistanceToElevation(e){const n=0===e?0:t.mercatorZfromAltitude(e,this.position[1]),i=this.forward();return(n-this.position[2])/i[2]}clone(){return new wi([...this.position],[...this.orientation])}}class Ci{constructor(e,n,i,r,o){this.tileSize=512,this.maxValidLatitude=85.051129,this._renderWorldCopies=void 0===o||o,this._minZoom=e||0,this._maxZoom=n||22,this._minPitch=null==i?0:i,this._maxPitch=null==r?60:r,this.setMaxBounds(),this.width=0,this.height=0,this._center=new t.LngLat(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._unmodified=!0,this._edgeInsets=new fi,this._projMatrixCache={},this._alignedProjMatrixCache={},this._fogTileMatrixCache={},this._camera=new wi,this._centerAltitude=0,this._averageElevation=0,this.cameraElevationReference="ground",this._horizonShift=.1}clone(){const t=new Ci(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies);return t._elevation=this._elevation,t._centerAltitude=this._centerAltitude,t.tileSize=this.tileSize,t.latRange=this.latRange,t.width=this.width,t.height=this.height,t.cameraElevationReference=this.cameraElevationReference,t._center=this._center,t._setZoom(this.zoom),t._cameraZoom=this._cameraZoom,t.angle=this.angle,t._fov=this._fov,t._pitch=this._pitch,t._averageElevation=this._averageElevation,t._unmodified=this._unmodified,t._edgeInsets=this._edgeInsets.clone(),t._camera=this._camera.clone(),t._calcMatrices(),t.freezeTileCoverage=this.freezeTileCoverage,t}get elevation(){return this._elevation}set elevation(t){this._elevation!==t&&(this._elevation=t,t?this._updateCenterElevation()&&this._updateCameraOnTerrain():(this._cameraZoom=null,this._centerAltitude=0),this._calcMatrices())}updateElevation(t){this._terrainEnabled()&&null==this._cameraZoom&&this._updateCenterElevation()&&this._updateCameraOnTerrain(),t&&this._constrainCameraAltitude(),this._calcMatrices()}get minZoom(){return this._minZoom}set minZoom(t){this._minZoom!==t&&(this._minZoom=t,this.zoom=Math.max(this.zoom,t))}get maxZoom(){return this._maxZoom}set maxZoom(t){this._maxZoom!==t&&(this._maxZoom=t,this.zoom=Math.min(this.zoom,t))}get minPitch(){return this._minPitch}set minPitch(t){this._minPitch!==t&&(this._minPitch=t,this.pitch=Math.max(this.pitch,t))}get maxPitch(){return this._maxPitch}set maxPitch(t){this._maxPitch!==t&&(this._maxPitch=t,this.pitch=Math.min(this.pitch,t))}get renderWorldCopies(){return this._renderWorldCopies}set renderWorldCopies(t){void 0===t?t=!0:null===t&&(t=!1),this._renderWorldCopies=t}get worldSize(){return this.tileSize*this.scale}get cameraWorldSize(){const t=Math.max(this._camera.getDistanceToElevation(this._averageElevation),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(t))}get pixelsPerMeter(){return t.mercatorZfromAltitude(1,this.center.lat)*this.worldSize}get cameraPixelsPerMeter(){return t.mercatorZfromAltitude(1,this.center.lat)*this.cameraWorldSize}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new t.pointGeometry(this.width,this.height)}get bearing(){return-this.angle/Math.PI*180}set bearing(e){const n=-t.wrap(e,-180,180)*Math.PI/180;var i;this.angle!==n&&(this._unmodified=!1,this.angle=n,this._calcMatrices(),this.rotationMatrix=(i=new t.ARRAY_TYPE(4),t.ARRAY_TYPE!=Float32Array&&(i[1]=0,i[2]=0),i[0]=1,i[3]=1,i),function(t,e,n){var i=e[0],r=e[1],o=e[2],s=e[3],a=Math.sin(n),l=Math.cos(n);t[0]=i*l+o*a,t[1]=r*l+s*a,t[2]=i*-a+o*l,t[3]=r*-a+s*l}(this.rotationMatrix,this.rotationMatrix,this.angle))}get pitch(){return this._pitch/Math.PI*180}set pitch(e){const n=t.clamp(e,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==n&&(this._unmodified=!1,this._pitch=n,this._calcMatrices())}get fov(){return this._fov/Math.PI*180}set fov(t){t=Math.max(.01,Math.min(60,t)),this._fov!==t&&(this._unmodified=!1,this._fov=t/180*Math.PI,this._calcMatrices())}get averageElevation(){return this._averageElevation}set averageElevation(t){this._averageElevation=t,this._calcFogMatrices()}get zoom(){return this._zoom}set zoom(t){const e=Math.min(Math.max(t,this.minZoom),this.maxZoom);this._zoom!==e&&(this._unmodified=!1,this._setZoom(e),this._terrainEnabled()&&this._updateCameraOnTerrain(),this._constrain(),this._calcMatrices())}_setZoom(t){this._zoom=t,this.scale=this.zoomScale(t),this.tileZoom=Math.floor(t),this.zoomFraction=t-this.tileZoom}_updateCenterElevation(){if(!this._elevation)return!1;const e=this._elevation.getAtPointOrZero(t.MercatorCoordinate.fromLngLat(this.center),-1);return-1===e?(this._cameraZoom=null,!1):(this._centerAltitude=e,!0)}_updateCameraOnTerrain(){const e=this.cameraToCenterDistance/this.worldSize,n=t.mercatorZfromAltitude(this._centerAltitude,this.center.lat);this._cameraZoom=this._zoomFromMercatorZ(n+e)}sampleAverageElevation(){if(!this._elevation)return 0;const e=this._elevation,n=[[.5,.2],[.3,.5],[.5,.5],[.7,.5],[.5,.8]],i=this.horizonLineFromTop();let r=0,o=0;for(let s=0;s<n.length;s++){const a=new t.pointGeometry(n[s][0]*this.width,i+n[s][1]*(this.height-i)),l=e.pointCoordinate(a);if(!l)continue;const c=1/Math.hypot(l[0]-this._camera.position[0],l[1]-this._camera.position[1]);r+=l[3]*c,o+=c}return 0===o?NaN:r/o}get center(){return this._center}set center(t){t.lat===this._center.lat&&t.lng===this._center.lng||(this._unmodified=!1,this._center=t,this._terrainEnabled()&&("ground"===this.cameraElevationReference?this._updateCenterElevation()?this._updateCameraOnTerrain():this._cameraZoom=null:this._updateZoomFromElevation()),this._constrain(),this._calcMatrices())}_updateZoomFromElevation(){if(null==this._cameraZoom||!this._elevation)return;const e=this._cameraZoom,n=this._elevation.getAtPointOrZero(t.MercatorCoordinate.fromLngLat(this.center)),i=t.mercatorZfromAltitude(n,this.center.lat),r=this._mercatorZfromZoom(e),o=this._mercatorZfromZoom(this._maxZoom),s=Math.max(r-i,o);this._setZoom(this._zoomFromMercatorZ(s))}get padding(){return this._edgeInsets.toJSON()}set padding(t){this._edgeInsets.equals(t)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,t,1),this._calcMatrices())}computeZoomRelativeTo(e){const n=this.rayIntersectionCoordinate(this.pointRayIntersection(this.centerPoint,e.toAltitude()));let i;i=e.z<this._camera.position[2]?[n.x,n.y,n.z]:[e.x,e.y,e.z];const r=t.length(t.sub([],this._camera.position,i));return t.clamp(this._zoomFromMercatorZ(r),this._minZoom,this._maxZoom)}setFreeCameraOptions(e){if(!this.height)return;if(!e.position&&!e.orientation)return;this._updateCameraState();let n=!1;if(e.orientation&&!t.exactEquals(e.orientation,this._camera.orientation)&&(n=this._setCameraOrientation(e.orientation)),e.position){const i=[e.position.x,e.position.y,e.position.z];t.exactEquals$1(i,this._camera.position)||(this._setCameraPosition(i),n=!0)}n&&(this._updateStateFromCamera(),this.recenterOnTerrain())}getFreeCameraOptions(){this._updateCameraState();const e=this._camera.position,n=new bi;return n.position=new t.MercatorCoordinate(e[0],e[1],e[2]),n.orientation=this._camera.orientation,n._elevation=this.elevation,n._renderWorldCopies=this._renderWorldCopies,n}_setCameraOrientation(e){if(!t.length$1(e))return!1;t.normalize$1(e,e);const n=t.transformQuat([],[0,0,-1],e),i=t.transformQuat([],[0,-1,0],e);if(i[2]<0)return!1;const r=xi(n,i);return!!r&&(this._camera.orientation=r,!0)}_setCameraPosition(e){const n=this.zoomScale(this.minZoom)*this.tileSize,i=this.zoomScale(this.maxZoom)*this.tileSize,r=this.cameraToCenterDistance;e[2]=t.clamp(e[2],r/i,r/n),this._camera.position=e}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}get fovAboveCenter(){return this._fov*(.5+this.centerOffset.y/this.height)}isPaddingEqual(t){return this._edgeInsets.equals(t)}interpolatePadding(t,e,n){this._unmodified=!1,this._edgeInsets.interpolate(t,e,n),this._constrain(),this._calcMatrices()}coveringZoomLevel(t){const e=(t.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/t.tileSize));return Math.max(0,e)}getVisibleUnwrappedCoordinates(e){const n=[new t.UnwrappedTileID(0,e)];if(this._renderWorldCopies){const i=this.pointCoordinate(new t.pointGeometry(0,0)),r=this.pointCoordinate(new t.pointGeometry(this.width,0)),o=this.pointCoordinate(new t.pointGeometry(this.width,this.height)),s=this.pointCoordinate(new t.pointGeometry(0,this.height)),a=Math.floor(Math.min(i.x,r.x,o.x,s.x)),l=Math.floor(Math.max(i.x,r.x,o.x,s.x)),c=1;for(let u=a-c;u<=l+c;u++)0!==u&&n.push(new t.UnwrappedTileID(u,e))}return n}coveringTiles(e){let n=this.coveringZoomLevel(e);const i=n,r=this.elevation&&!e.isTerrainDEM;if(void 0!==e.minzoom&&n<e.minzoom)return[];void 0!==e.maxzoom&&n>e.maxzoom&&(n=e.maxzoom);const o=t.MercatorCoordinate.fromLngLat(this.center),s=1<<n,a=[s*o.x,s*o.y,0],l=p.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,n),c=this.pointCoordinate(this.getCameraPoint()),u=s*t.mercatorZfromAltitude(1,this.center.lat),h=this._camera.position[2]/t.mercatorZfromAltitude(1,this.center.lat),d=[s*c.x,s*c.y,h],m=this.cameraToCenterDistance/e.tileSize*(e.roundZoom?1:.502),g=this.pitch<=60&&this._edgeInsets.top<=this._edgeInsets.bottom&&!this._elevation?n:0,_=e.isTerrainDEM&&this._elevation?1e4*this._elevation.exaggeration():this._centerAltitude,y=e.isTerrainDEM?-_:this._elevation?this._elevation.getMinElevationBelowMSL():0,v=t=>({aabb:new f([t*s,0,y],[(t+1)*s,s,_]),zoom:0,x:0,y:0,wrap:t,fullyVisible:!1}),x=[],b=[],w=n,C=e.reparseOverscaled?i:n,T=t=>{if(!this._elevation||!t.tileID)return;const e=this._elevation.getMinMaxForTile(t.tileID),n=t.aabb;e?(n.min[2]=e.min,n.max[2]=e.max,n.center[2]=(n.min[2]+n.max[2])/2):(t.shouldSplit=k(t),t.shouldSplit||(n.min[2]=n.max[2]=n.center[2]=this._centerAltitude))},S=t=>t*t,E=S((h-this._centerAltitude)*u),k=t=>{if(t.zoom<g)return!0;if(t.zoom===w)return!1;if(null!=t.shouldSplit)return t.shouldSplit;const e=t.aabb.distanceX(d),n=t.aabb.distanceY(d);let i=E;r&&(i=S(t.aabb.distanceZ(d)*u));const o=e*e+n*n+i;return o<S((1<<w-t.zoom)*m*((t,e)=>{if(e*S(.707)<t)return 1;const n=Math.sqrt(e/t);return n/(1.4144271570014144+(Math.pow(1.1,n-1.4144271570014144+1)-1)/(1.1-1)-1)})(Math.max(i,E),o))};if(this._renderWorldCopies)for(let t=1;t<=3;t++)x.push(v(-t)),x.push(v(t));for(x.push(v(0));x.length>0;){const i=x.pop(),o=i.x,s=i.y;let c=i.fullyVisible;if(!c){const t=i.aabb.intersects(l);if(0===t)continue;c=2===t}if(i.zoom!==w&&k(i))for(let e=0;e<4;e++){const n=(o<<1)+e%2,a=(s<<1)+(e>>1),l={aabb:i.aabb.quadrant(e),zoom:i.zoom+1,x:n,y:a,wrap:i.wrap,fullyVisible:c,tileID:void 0,shouldSplit:void 0};r&&(l.tileID=new t.OverscaledTileID(i.zoom+1===w?C:i.zoom+1,i.wrap,i.zoom+1,n,a),T(l)),x.push(l)}else{const r=i.zoom===w?C:i.zoom;if(e.minzoom&&e.minzoom>r)continue;const l=a[0]-(.5+o+(i.wrap<<i.zoom))*(1<<n-i.zoom),c=a[1]-.5-s,u=i.tileID?i.tileID:new t.OverscaledTileID(r,i.wrap,i.zoom,o,s);b.push({tileID:u,distanceSq:l*l+c*c})}}if(this.fogCullDistSq){const e=this.fogCullDistSq;b.splice(0,b.length,...b.filter(n=>{const i=[0,0,0,1],o=[t.EXTENT,t.EXTENT,0,1],s=this.calculateFogTileMatrix(n.tileID.toUnwrapped());t.transformMat4(i,i,s),t.transformMat4(o,o,s);const a=t.getAABBPointSquareDist(i,o);if(0===a)return!0;let l=!1;const c=this.horizonLineFromTop();if(a>e&&0!==c){const e=this.calculateProjMatrix(n.tileID.toUnwrapped());let i;r&&this._elevation&&(i=this._elevation.getMinMaxForTile(n.tileID)),i||(i={min:y,max:_});const o=t.furthestTileCorner(this.bearing),s=[o[0]*t.EXTENT,o[1]*t.EXTENT,i.max];t.transformMat4$1(s,s,e),l=(1-s[1])*this.height*.5<c}return a<e||l}))}return b.sort((t,e)=>t.distanceSq-e.distanceSq).map(t=>t.tileID)}resize(t,e){this.width=t,this.height=e,this.pixelsToGLUnits=[2/t,-2/e],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(t){return Math.pow(2,t)}scaleZoom(t){return Math.log(t)/Math.LN2}project(e){const n=t.clamp(e.lat,-this.maxValidLatitude,this.maxValidLatitude);return new t.pointGeometry(t.mercatorXfromLng(e.lng)*this.worldSize,t.mercatorYfromLat(n)*this.worldSize)}unproject(e){return new t.MercatorCoordinate(e.x/this.worldSize,e.y/this.worldSize).toLngLat()}get point(){return this.project(this.center)}setLocationAtPoint(e,n){const i=this.pointCoordinate(n),r=this.pointCoordinate(this.centerPoint),o=this.locationCoordinate(e),s=new t.MercatorCoordinate(o.x-(i.x-r.x),o.y-(i.y-r.y));this.center=this.coordinateLocation(s),this._renderWorldCopies&&(this.center=this.center.wrap())}setLocation(t){this.center=this.coordinateLocation(t),this._renderWorldCopies&&(this.center=this.center.wrap())}locationPoint(t){return this._coordinatePoint(this.locationCoordinate(t),!1)}locationPoint3D(t){return this._coordinatePoint(this.locationCoordinate(t),!0)}pointLocation(t){return this.coordinateLocation(this.pointCoordinate(t))}pointLocation3D(t){return this.coordinateLocation(this.pointCoordinate3D(t))}locationCoordinate(e){return t.MercatorCoordinate.fromLngLat(e)}coordinateLocation(t){return t.toLngLat()}pointRayIntersection(e,n){const i=null!=n?n:this._centerAltitude,r=[e.x,e.y,0,1],o=[e.x,e.y,1,1];t.transformMat4(r,r,this.pixelMatrixInverse),t.transformMat4(o,o,this.pixelMatrixInverse);const s=o[3];t.scale$2(r,r,1/r[3]),t.scale$2(o,o,1/s);const a=r[2],l=o[2];return{p0:r,p1:o,t:a===l?0:(i-a)/(l-a)}}screenPointToMercatorRay(e){const n=[e.x,e.y,0,1],i=[e.x,e.y,1,1];return t.transformMat4(n,n,this.pixelMatrixInverse),t.transformMat4(i,i,this.pixelMatrixInverse),t.scale$2(n,n,1/n[3]),t.scale$2(i,i,1/i[3]),n[2]=t.mercatorZfromAltitude(n[2],this._center.lat)*this.worldSize,i[2]=t.mercatorZfromAltitude(i[2],this._center.lat)*this.worldSize,t.scale$2(n,n,1/this.worldSize),t.scale$2(i,i,1/this.worldSize),new d([n[0],n[1],n[2]],t.normalize([],t.sub([],i,n)))}rayIntersectionCoordinate(e){const{p0:n,p1:i,t:r}=e,o=t.mercatorZfromAltitude(n[2],this._center.lat),s=t.mercatorZfromAltitude(i[2],this._center.lat);return new t.MercatorCoordinate(t.number(n[0],i[0],r)/this.worldSize,t.number(n[1],i[1],r)/this.worldSize,t.number(o,s,r))}pointCoordinate(e){const n=this.horizonLineFromTop(!1),i=new t.pointGeometry(e.x,Math.max(n,e.y));return this.rayIntersectionCoordinate(this.pointRayIntersection(i))}pointCoordinate3D(e){if(!this.elevation)return this.pointCoordinate(e);const n=this.elevation;let i=this.elevation.pointCoordinate(e);if(i)return new t.MercatorCoordinate(i[0],i[1],i[2]);let r=0,o=this.horizonLineFromTop();if(e.y>o)return this.pointCoordinate(e);const s=.02*o,a=e.clone();for(let l=0;l<10&&o-r>s;l++){a.y=t.number(r,o,.66);const e=n.pointCoordinate(a);e?(o=a.y,i=e):r=a.y}return i?new t.MercatorCoordinate(i[0],i[1],i[2]):this.pointCoordinate(e)}isPointAboveHorizon(t){if(this.elevation)return!this.elevation.pointCoordinate(t);{const e=this.horizonLineFromTop();return t.y<e}}_coordinatePoint(e,n){const i=n&&this.elevation?this.elevation.getAtPointOrZero(e,this._centerAltitude):this._centerAltitude,r=[e.x*this.worldSize,e.y*this.worldSize,i+e.toAltitude(),1];return t.transformMat4(r,r,this.pixelMatrix),r[3]>0?new t.pointGeometry(r[0]/r[3],r[1]/r[3]):new t.pointGeometry(Number.MAX_VALUE,Number.MAX_VALUE)}getBounds(){return this._terrainEnabled()?this._getBounds3D():(new t.LngLatBounds).extend(this.pointLocation(new t.pointGeometry(this._edgeInsets.left,this._edgeInsets.top))).extend(this.pointLocation(new t.pointGeometry(this.width-this._edgeInsets.right,this._edgeInsets.top))).extend(this.pointLocation(new t.pointGeometry(this.width-this._edgeInsets.right,this.height-this._edgeInsets.bottom))).extend(this.pointLocation(new t.pointGeometry(this._edgeInsets.left,this.height-this._edgeInsets.bottom)))}_getBounds3D(){const e=this.elevation,n=e.visibleDemTiles.reduce((t,e)=>{if(e.dem){const n=e.dem.tree;t.min=Math.min(t.min,n.minimums[0]),t.max=Math.max(t.max,n.maximums[0])}return t},{min:Number.MAX_VALUE,max:0});n.min*=e.exaggeration(),n.max*=e.exaggeration();const i=this.horizonLineFromTop();return[new t.pointGeometry(0,i),new t.pointGeometry(this.width,i),new t.pointGeometry(this.width,this.height),new t.pointGeometry(0,this.height)].reduce((t,e)=>t.extend(this.coordinateLocation(this.rayIntersectionCoordinate(this.pointRayIntersection(e,n.min)))).extend(this.coordinateLocation(this.rayIntersectionCoordinate(this.pointRayIntersection(e,n.max)))),new t.LngLatBounds)}horizonLineFromTop(t=!0){const e=this.height/2/Math.tan(this._fov/2)/Math.tan(Math.max(this._pitch,.1))+this.centerOffset.y,n=this.height/2-.97*e;return t?Math.max(0,n):n}getMaxBounds(){return this.latRange&&2===this.latRange.length&&this.lngRange&&2===this.lngRange.length?new t.LngLatBounds([this.lngRange[0],this.latRange[0]],[this.lngRange[1],this.latRange[1]]):null}setMaxBounds(t){t?(this.lngRange=[t.getWest(),t.getEast()],this.latRange=[t.getSouth(),t.getNorth()],this._constrain()):(this.lngRange=null,this.latRange=[-this.maxValidLatitude,this.maxValidLatitude])}calculatePosMatrix(e,n){const i=e.canonical,r=n/this.zoomScale(i.z),o=i.x+Math.pow(2,i.z)*e.wrap,s=t.identity(new Float64Array(16));return t.translate(s,s,[o*r,i.y*r,0]),t.scale$1(s,s,[r/t.EXTENT,r/t.EXTENT,1]),s}calculateFogTileMatrix(e){const n=e.key,i=this._fogTileMatrixCache;if(i[n])return i[n];const r=this.calculatePosMatrix(e,this.cameraWorldSize);return t.multiply(r,this.worldToFogMatrix,r),i[n]=new Float32Array(r),i[n]}calculateProjMatrix(e,n=!1){const i=e.key,r=n?this._alignedProjMatrixCache:this._projMatrixCache;if(r[i])return r[i];const o=this.calculatePosMatrix(e,this.worldSize);return t.multiply(o,n?this.alignedProjMatrix:this.projMatrix,o),r[i]=new Float32Array(o),r[i]}customLayerMatrix(){return this.mercatorMatrix.slice()}recenterOnTerrain(){if(!this._elevation)return;const e=this._elevation;this._updateCameraState();const n=this._camera.position,i=this._camera.forward();if(n[2]<=0||i[2]>=0)return;const r=t.mercatorZfromAltitude(1,this._center.lat);n[2]/=r,i[2]/=r,t.normalize(i,i);const o=e.raycast(n,i,e.exaggeration());if(o){const e=t.scaleAndAdd([],n,i,o),r=new t.MercatorCoordinate(e[0],e[1],t.mercatorZfromAltitude(e[2],t.latFromMercatorY(e[1]))),s=this._camera.position,a=r.z+t.length([r.x-s[0],r.y-s[1],r.z-s[2]]);this._cameraZoom=this._zoomFromMercatorZ(a),this._centerAltitude=r.toAltitude(),this._center=r.toLngLat(),this._updateZoomFromElevation(),this._constrain(),this._calcMatrices()}}_constrainCameraAltitude(){if(!this._elevation)return;const e=this._elevation;this._updateCameraState();const n=e.getAtPointOrZero(this._camera.mercatorPosition),i=this._minimumHeightOverTerrain()*Math.cos(t.degToRad(this._maxPitch)),r=t.mercatorZfromAltitude(n,this._center.lat),o=this._camera.position[2]-r;if(o<i){const e=t.MercatorCoordinate.fromLngLat(this._center,this._centerAltitude),n=this._camera.mercatorPosition,r=[e.x-n.x,e.y-n.y,e.z-n.z],s=t.length(r);r[2]-=i-o;const a=t.length(r);if(0===a)return;t.scale(r,r,s/a),this._camera.position=[e.x-r[0],e.y-r[1],e.z-r[2]],this._camera.orientation=xi(r,this._camera.up()),this._updateStateFromCamera()}}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;this._constraining=!0;let e,n,i,r,o=-90,s=90,a=-180,l=180;const c=this.size,u=this._unmodified;if(this.latRange){const n=this.latRange;o=t.mercatorYfromLat(n[1])*this.worldSize,s=t.mercatorYfromLat(n[0])*this.worldSize,e=s-o<c.y?c.y/(s-o):0}if(this.lngRange){const e=this.lngRange;a=t.mercatorXfromLng(e[0])*this.worldSize,l=t.mercatorXfromLng(e[1])*this.worldSize,n=l-a<c.x?c.x/(l-a):0}const h=this.point,d=Math.max(n||0,e||0);if(d)return this.center=this.unproject(new t.pointGeometry(n?(l+a)/2:h.x,e?(s+o)/2:h.y)),this.zoom+=this.scaleZoom(d),this._unmodified=u,void(this._constraining=!1);if(this.latRange){const t=h.y,e=c.y/2;t-e<o&&(r=o+e),t+e>s&&(r=s-e)}if(this.lngRange){const t=h.x,e=c.x/2;t-e<a&&(i=a+e),t+e>l&&(i=l-e)}void 0===i&&void 0===r||(this.center=this.unproject(new t.pointGeometry(void 0!==i?i:h.x,void 0!==r?r:h.y))),this._constrainCameraAltitude(),this._unmodified=u,this._constraining=!1}_minZoomForBounds(){const e=(t,e)=>Math.log2(t/(this.tileSize*Math.abs(e[1]-e[0])));let n=0;if(this.latRange){const i=this.latRange;n=e(this.height,[t.mercatorYfromLat(i[0]),t.mercatorYfromLat(i[1])])}let i=0;if(this.lngRange){const n=this.lngRange;i=e(this.width,[t.mercatorXfromLng(n[0]),t.mercatorXfromLng(n[1])])}return Math.max(n,i)}_maxCameraBoundsDistance(){return this._mercatorZfromZoom(this._minZoomForBounds())}_calcMatrices(){if(!this.height)return;const e=this.centerOffset;this.cameraToCenterDistance=.5/Math.tan(this._fov/2)*this.height;const n=this.pixelsPerMeter;this._updateCameraState();const i=Math.PI/2+this._pitch,r=this.fovAboveCenter,o=this.elevation?this.elevation.getMinElevationBelowMSL()*n:0,s=(this._camera.position[2]*this.worldSize-o)/Math.cos(this._pitch),a=Math.sin(r)*s/Math.sin(t.clamp(Math.PI-i-r,.01,Math.PI-.01)),l=this.point,c=l.x,u=l.y,h=Math.cos(Math.PI/2-this._pitch)*a+s,d=Math.min(1.01*h,s*(1/this._horizonShift)),p=this.height/50,f=this._camera.getWorldToCamera(this.worldSize,n),m=this._camera.getCameraToClipPerspective(this._fov,this.width/this.height,p,d);m[8]=2*-e.x/this.width,m[9]=2*e.y/this.height;let g=t.mul$1([],m,f);this.mercatorMatrix=t.scale$1([],g,[this.worldSize,this.worldSize,this.worldSize/n]),this.projMatrix=g,this.invProjMatrix=t.invert(new Float64Array(16),this.projMatrix);const _=new Float32Array(16);t.identity(_),t.scale$1(_,_,[1,-1,1]),t.rotateX(_,_,this._pitch),t.rotateZ(_,_,this.angle);const y=t.perspective(new Float32Array(16),this._fov,this.width/this.height,p,d),v=(Math.PI/2-this._pitch)*(this.height/this._fov)*this._horizonShift;y[8]=2*-e.x/this.width,y[9]=2*(e.y+v)/this.height,this.skyboxMatrix=t.multiply(_,y,_);const x=this.width%2/2,b=this.height%2/2,w=Math.cos(this.angle),C=Math.sin(this.angle),T=c-Math.round(c)+w*x+C*b,S=u-Math.round(u)+w*b+C*x,E=new Float64Array(g);if(t.translate(E,E,[T>.5?T-1:T,S>.5?S-1:S,0]),this.alignedProjMatrix=E,g=t.create$1(),t.scale$1(g,g,[this.width/2,-this.height/2,1]),t.translate(g,g,[1,-1,0]),this.labelPlaneMatrix=g,g=t.create$1(),t.scale$1(g,g,[1,-1,1]),t.translate(g,g,[-1,-1,0]),t.scale$1(g,g,[2/this.width,2/this.height,1]),this.glCoordMatrix=g,this.pixelMatrix=t.multiply(new Float64Array(16),this.labelPlaneMatrix,this.projMatrix),this._calcFogMatrices(),g=t.invert(new Float64Array(16),this.pixelMatrix),!g)throw new Error("failed to invert matrix");this.pixelMatrixInverse=g,this._projMatrixCache={},this._alignedProjMatrixCache={}}_calcFogMatrices(){this._fogTileMatrixCache={};const e=this.cameraWorldSize,n=this.cameraPixelsPerMeter,i=this._camera.position,r=1/this.height,o=[e,e,n];t.scale(o,o,r),t.scale(i,i,-1),t.multiply$1(i,i,o);const s=t.create$1();t.translate(s,s,i),t.scale$1(s,s,o),this.mercatorFogMatrix=s,this.worldToFogMatrix=this._camera.getWorldToCameraPosition(e,n,r)}_updateCameraState(){if(!this.height)return;this._camera.setPitchBearing(this._pitch,this.angle);const e=this._camera.forward(),n=this.cameraToCenterDistance,i=this.point,r=this._mercatorZfromZoom(this._cameraZoom?this._cameraZoom:this._zoom)-t.mercatorZfromAltitude(this._centerAltitude,this.center.lat),o=this.cameraToCenterDistance/r;this._camera.position=[i.x/this.worldSize-e[0]*n/o,i.y/this.worldSize-e[1]*n/o,t.mercatorZfromAltitude(this._centerAltitude,this._center.lat)+-e[2]*n/o]}_translateCameraConstrained(e){const n=this._maxCameraBoundsDistance()*Math.cos(this._pitch),i=e[2];let r=1;i>0&&(r=Math.min((n-this._camera.position[2])/i,1)),this._camera.position=t.scaleAndAdd([],this._camera.position,e,r),this._updateStateFromCamera()}_updateStateFromCamera(){const e=this._camera.position,n=this._camera.forward(),{pitch:i,bearing:r}=this._camera.getPitchBearing(),o=t.mercatorZfromAltitude(this._centerAltitude,this.center.lat),s=this._mercatorZfromZoom(this._maxZoom)*Math.cos(t.degToRad(this._maxPitch)),a=Math.max((e[2]-o)/Math.cos(i),s),l=this._zoomFromMercatorZ(a);t.scaleAndAdd(e,e,n,a),this._pitch=t.clamp(i,t.degToRad(this.minPitch),t.degToRad(this.maxPitch)),this.angle=t.wrap(r,-Math.PI,Math.PI),this._setZoom(t.clamp(l,this._minZoom,this._maxZoom)),this._terrainEnabled()&&this._updateCameraOnTerrain(),this._center=new t.MercatorCoordinate(e[0],e[1],e[2]).toLngLat(),this._unmodified=!1,this._constrain(),this._calcMatrices()}_worldSizeFromZoom(t){return Math.pow(2,t)*this.tileSize}_mercatorZfromZoom(t){return this.cameraToCenterDistance/this._worldSizeFromZoom(t)}_minimumHeightOverTerrain(){const t=Math.min((null!=this._cameraZoom?this._cameraZoom:this._zoom)+2,this._maxZoom);return this._mercatorZfromZoom(t)}_zoomFromMercatorZ(t){return this.scaleZoom(this.cameraToCenterDistance/(t*this.tileSize))}_terrainEnabled(){return!!this._elevation}isHorizonVisibleForPoints(e,n){const i=Math.min(e.x,n.x),r=Math.max(e.x,n.x),o=Math.min(e.y,n.y),s=Math.max(e.y,n.y),a=[new t.pointGeometry(i,o),new t.pointGeometry(r,s),new t.pointGeometry(i,s),new t.pointGeometry(r,o)],l=this._renderWorldCopies?-3:0,c=this._renderWorldCopies?4:1;for(const t of a){const e=this.pointRayIntersection(t);if(e.t<0)return!0;const n=this.rayIntersectionCoordinate(e);if(n.x<l||n.y<0||n.x>c||n.y>1)return!0}return!1}isHorizonVisible(){return this.pitch+t.radToDeg(this.fovAboveCenter)>88||this.isHorizonVisibleForPoints(new t.pointGeometry(0,0),new t.pointGeometry(this.width,this.height))}zoomDeltaToMovement(e,n){const i=t.length(t.sub([],this._camera.position,e)),r=this._zoomFromMercatorZ(i)+n;return i-this._mercatorZfromZoom(r)}getCameraPoint(){const e=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new t.pointGeometry(0,e))}}class Ti{constructor(e){this._hashName=e&&encodeURIComponent(e),t.bindAll(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=function(t,e){let n=!1,i=null;const r=()=>{i=null,n&&(t(),i=setTimeout(r,300),n=!1)};return()=>(n=!0,i||r(),i)}(this._updateHashUnthrottled.bind(this))}addTo(e){return this._map=e,t.window.addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this}remove(){return t.window.removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),delete this._map,this}getHashString(e){const n=this._map.getCenter(),i=Math.round(100*this._map.getZoom())/100,r=Math.ceil((i*Math.LN2+Math.log(512/360/.5))/Math.LN10),o=Math.pow(10,r),s=Math.round(n.lng*o)/o,a=Math.round(n.lat*o)/o,l=this._map.getBearing(),c=this._map.getPitch();let u="";if(u+=e?`/${s}/${a}/${i}`:`${i}/${a}/${s}`,(l||c)&&(u+="/"+Math.round(10*l)/10),c&&(u+="/"+Math.round(c)),this._hashName){const e=this._hashName;let n=!1;const i=t.window.location.hash.slice(1).split("&").map(t=>{const i=t.split("=")[0];return i===e?(n=!0,`${i}=${u}`):t}).filter(t=>t);return n||i.push(`${e}=${u}`),"#"+i.join("&")}return"#"+u}_getCurrentHash(){const e=t.window.location.hash.replace("#","");if(this._hashName){let t;return e.split("&").map(t=>t.split("=")).forEach(e=>{e[0]===this._hashName&&(t=e)}),(t&&t[1]||"").split("/")}return e.split("/")}_onHashChange(){const t=this._getCurrentHash();if(t.length>=3&&!t.some(t=>isNaN(t))){const e=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(t[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+t[2],+t[1]],zoom:+t[0],bearing:e,pitch:+(t[4]||0)}),!0}return!1}_updateHashUnthrottled(){const e=t.window.location.href.replace(/(#.+)?$/,this.getHashString());t.window.history.replaceState(t.window.history.state,null,e)}}const Si={linearity:.3,easing:t.bezier(0,0,.3,1)},Ei=t.extend({deceleration:2500,maxSpeed:1400},Si),ki=t.extend({deceleration:20,maxSpeed:1400},Si),Ai=t.extend({deceleration:1e3,maxSpeed:360},Si),Ii=t.extend({deceleration:1e3,maxSpeed:90},Si);class Pi{constructor(t){this._map=t,this.clear()}clear(){this._inertiaBuffer=[]}record(e){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:t.exported.now(),settings:e})}_drainInertiaBuffer(){const e=this._inertiaBuffer,n=t.exported.now();for(;e.length>0&&n-e[0].time>160;)e.shift()}_onMoveEnd(e){if(this._drainInertiaBuffer(),this._inertiaBuffer.length<2)return;const n={zoom:0,bearing:0,pitch:0,pan:new t.pointGeometry(0,0),pinchAround:void 0,around:void 0};for(const{settings:t}of this._inertiaBuffer)n.zoom+=t.zoomDelta||0,n.bearing+=t.bearingDelta||0,n.pitch+=t.pitchDelta||0,t.panDelta&&n.pan._add(t.panDelta),t.around&&(n.around=t.around),t.pinchAround&&(n.pinchAround=t.pinchAround);const i=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,r={};if(n.pan.mag()){const o=Oi(n.pan.mag(),i,t.extend({},Ei,e||{}));r.offset=n.pan.mult(o.amount/n.pan.mag()),r.center=this._map.transform.center,Mi(r,o)}if(n.zoom){const t=Oi(n.zoom,i,ki);r.zoom=this._map.transform.zoom+t.amount,Mi(r,t)}if(n.bearing){const e=Oi(n.bearing,i,Ai);r.bearing=this._map.transform.bearing+t.clamp(e.amount,-179,179),Mi(r,e)}if(n.pitch){const t=Oi(n.pitch,i,Ii);r.pitch=this._map.transform.pitch+t.amount,Mi(r,t)}if(r.zoom||r.bearing){const t=void 0===n.pinchAround?n.around:n.pinchAround;r.around=t?this._map.unproject(t):this._map.getCenter()}return this.clear(),t.extend(r,{noMoveStart:!0})}}function Mi(t,e){(!t.duration||t.duration<e.duration)&&(t.duration=e.duration,t.easing=e.easing)}function Oi(e,n,i){const{maxSpeed:r,linearity:o,deceleration:s}=i,a=t.clamp(e*o/(n/1e3),-r,r),l=Math.abs(a)/(s*o);return{easing:i.easing,duration:1e3*l,amount:a*(l/2)}}class zi extends t.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(e,n,i,r={}){const s=o.mousePos(n.getCanvasContainer(),i),a=n.unproject(s);super(e,t.extend({point:s,lngLat:a,originalEvent:i},r)),this._defaultPrevented=!1,this.target=n}}class Di extends t.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(e,n,i){const r="touchend"===e?i.changedTouches:i.touches,s=o.touchPos(n.getCanvasContainer(),r),a=s.map(t=>n.unproject(t)),l=s.reduce((t,e,n,i)=>t.add(e.div(i.length)),new t.pointGeometry(0,0));super(e,{points:s,point:l,lngLats:a,lngLat:n.unproject(l),originalEvent:i}),this._defaultPrevented=!1}}class Li extends t.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(t,e,n){super(t,{originalEvent:n}),this._defaultPrevented=!1}}class Ri{constructor(t,e){this._map=t,this._clickTolerance=e.clickTolerance}reset(){delete this._mousedownPos}wheel(t){return this._firePreventable(new Li(t.type,this._map,t))}mousedown(t,e){return this._mousedownPos=e,this._firePreventable(new zi(t.type,this._map,t))}mouseup(t){this._map.fire(new zi(t.type,this._map,t))}click(t,e){this._mousedownPos&&this._mousedownPos.dist(e)>=this._clickTolerance||this._map.fire(new zi(t.type,this._map,t))}dblclick(t){return this._firePreventable(new zi(t.type,this._map,t))}mouseover(t){this._map.fire(new zi(t.type,this._map,t))}mouseout(t){this._map.fire(new zi(t.type,this._map,t))}touchstart(t){return this._firePreventable(new Di(t.type,this._map,t))}touchmove(t){this._map.fire(new Di(t.type,this._map,t))}touchend(t){this._map.fire(new Di(t.type,this._map,t))}touchcancel(t){this._map.fire(new Di(t.type,this._map,t))}_firePreventable(t){if(this._map.fire(t),t.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Fi{constructor(t){this._map=t}reset(){this._delayContextMenu=!1,delete this._contextMenuEvent}mousemove(t){this._map.fire(new zi(t.type,this._map,t))}mousedown(){this._delayContextMenu=!0}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new zi("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(t){this._delayContextMenu?this._contextMenuEvent=t:this._map.fire(new zi(t.type,this._map,t)),this._map.listens("contextmenu")&&t.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Bi{constructor(t,e){this._map=t,this._el=t.getCanvasContainer(),this._container=t.getContainer(),this._clickTolerance=e.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(t,e){this.isEnabled()&&t.shiftKey&&0===t.button&&(o.disableDrag(),this._startPos=this._lastPos=e,this._active=!0)}mousemoveWindow(t,e){if(!this._active)return;const n=e;if(this._lastPos.equals(n)||!this._box&&n.dist(this._startPos)<this._clickTolerance)return;const i=this._startPos;this._lastPos=n,this._box||(this._box=o.create("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),this._fireEvent("boxzoomstart",t));const r=Math.min(i.x,n.x),s=Math.max(i.x,n.x),a=Math.min(i.y,n.y),l=Math.max(i.y,n.y);this._map._requestDomTask(()=>{this._box&&(o.setTransform(this._box,`translate(${r}px,${a}px)`),this._box.style.width=s-r+"px",this._box.style.height=l-a+"px")})}mouseupWindow(e,n){if(!this._active)return;if(0!==e.button)return;const i=this._startPos,r=n;if(this.reset(),o.suppressClick(),i.x!==r.x||i.y!==r.y)return this._map.fire(new t.Event("boxzoomend",{originalEvent:e})),{cameraAnimation:t=>t.fitScreenCoordinates(i,r,this._map.getBearing(),{linear:!1})};this._fireEvent("boxzoomcancel",e)}keydown(t){this._active&&27===t.keyCode&&(this.reset(),this._fireEvent("boxzoomcancel",t))}reset(){this._active=!1,this._container.classList.remove("mapboxgl-crosshair"),this._box&&(o.remove(this._box),this._box=null),o.enableDrag(),delete this._startPos,delete this._lastPos}_fireEvent(e,n){return this._map.fire(new t.Event(e,{originalEvent:n}))}}function Vi(t,e){const n={};for(let i=0;i<t.length;i++)n[t[i].identifier]=e[i];return n}class Ui{constructor(t){this.reset(),this.numTouches=t.numTouches}reset(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1}touchstart(e,n,i){(this.centroid||i.length>this.numTouches)&&(this.aborted=!0),this.aborted||(void 0===this.startTime&&(this.startTime=e.timeStamp),i.length===this.numTouches&&(this.centroid=function(e){const n=new t.pointGeometry(0,0);for(const t of e)n._add(t);return n.div(e.length)}(n),this.touches=Vi(i,n)))}touchmove(t,e,n){if(this.aborted||!this.centroid)return;const i=Vi(n,e);for(const r in this.touches){const t=this.touches[r],e=i[r];(!e||e.dist(t)>30)&&(this.aborted=!0)}}touchend(t,e,n){if((!this.centroid||t.timeStamp-this.startTime>500)&&(this.aborted=!0),0===n.length){const t=!this.aborted&&this.centroid;if(this.reset(),t)return t}}}class Ni{constructor(t){this.singleTap=new Ui(t),this.numTaps=t.numTaps,this.reset()}reset(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()}touchstart(t,e,n){this.singleTap.touchstart(t,e,n)}touchmove(t,e,n){this.singleTap.touchmove(t,e,n)}touchend(t,e,n){const i=this.singleTap.touchend(t,e,n);if(i){const e=t.timeStamp-this.lastTime<500,n=!this.lastTap||this.lastTap.dist(i)<30;if(e&&n||this.reset(),this.count++,this.lastTime=t.timeStamp,this.lastTap=i,this.count===this.numTaps)return this.reset(),i}}}class ji{constructor(){this._zoomIn=new Ni({numTouches:1,numTaps:2}),this._zoomOut=new Ni({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(t,e,n){this._zoomIn.touchstart(t,e,n),this._zoomOut.touchstart(t,e,n)}touchmove(t,e,n){this._zoomIn.touchmove(t,e,n),this._zoomOut.touchmove(t,e,n)}touchend(t,e,n){const i=this._zoomIn.touchend(t,e,n),r=this._zoomOut.touchend(t,e,n);return i?(this._active=!0,t.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:e=>e.easeTo({duration:300,zoom:e.getZoom()+1,around:e.unproject(i)},{originalEvent:t})}):r?(this._active=!0,t.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:e=>e.easeTo({duration:300,zoom:e.getZoom()-1,around:e.unproject(r)},{originalEvent:t})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}const qi={0:1,2:2};class $i{constructor(t){this.reset(),this._clickTolerance=t.clickTolerance||1}reset(){this._active=!1,this._moved=!1,delete this._lastPoint,delete this._eventButton}_correctButton(t,e){return!1}_move(t,e){return{}}mousedown(t,e){if(this._lastPoint)return;const n=o.mouseButton(t);this._correctButton(t,n)&&(this._lastPoint=e,this._eventButton=n)}mousemoveWindow(t,e){const n=this._lastPoint;if(n)if(t.preventDefault(),function(t,e){const n=qi[e];return void 0===t.buttons||(t.buttons&n)!==n}(t,this._eventButton))this.reset();else if(this._moved||!(e.dist(n)<this._clickTolerance))return this._moved=!0,this._lastPoint=e,this._move(n,e)}mouseupWindow(t){this._lastPoint&&o.mouseButton(t)===this._eventButton&&(this._moved&&o.suppressClick(),this.reset())}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Gi extends $i{mousedown(t,e){super.mousedown(t,e),this._lastPoint&&(this._active=!0)}_correctButton(t,e){return 0===e&&!t.ctrlKey}_move(t,e){return{around:e,panDelta:e.sub(t)}}}class Zi extends $i{_correctButton(t,e){return 0===e&&t.ctrlKey||2===e}_move(t,e){const n=.8*(e.x-t.x);if(n)return this._active=!0,{bearingDelta:n}}contextmenu(t){t.preventDefault()}}class Hi extends $i{_correctButton(t,e){return 0===e&&t.ctrlKey||2===e}_move(t,e){const n=-.5*(e.y-t.y);if(n)return this._active=!0,{pitchDelta:n}}contextmenu(t){t.preventDefault()}}class Wi{constructor(t){this._minTouches=1,this._clickTolerance=t.clickTolerance||1,this.reset()}reset(){this._active=!1,this._touches={},this._sum=new t.pointGeometry(0,0)}touchstart(t,e,n){return this._calculateTransform(t,e,n)}touchmove(t,e,n){if(this._active&&!(n.length<this._minTouches))return t.preventDefault(),this._calculateTransform(t,e,n)}touchend(t,e,n){this._calculateTransform(t,e,n),this._active&&n.length<this._minTouches&&this.reset()}touchcancel(){this.reset()}_calculateTransform(e,n,i){i.length>0&&(this._active=!0);const r=Vi(i,n),o=new t.pointGeometry(0,0),s=new t.pointGeometry(0,0);let a=0;for(const t in r){const e=r[t],n=this._touches[t];n&&(o._add(e),s._add(e.sub(n)),a++,r[t]=e)}if(this._touches=r,a<this._minTouches||!s.mag())return;const l=s.div(a);return this._sum._add(l),this._sum.mag()<this._clickTolerance?void 0:{around:o.div(a),panDelta:l}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Xi{constructor(){this.reset()}reset(){this._active=!1,delete this._firstTwoTouches}_start(t){}_move(t,e,n){return{}}touchstart(t,e,n){this._firstTwoTouches||n.length<2||(this._firstTwoTouches=[n[0].identifier,n[1].identifier],this._start([e[0],e[1]]))}touchmove(t,e,n){if(!this._firstTwoTouches)return;t.preventDefault();const[i,r]=this._firstTwoTouches,o=Ki(n,e,i),s=Ki(n,e,r);if(!o||!s)return;const a=this._aroundCenter?null:o.add(s).div(2);return this._move([o,s],a,t)}touchend(t,e,n){if(!this._firstTwoTouches)return;const[i,r]=this._firstTwoTouches,s=Ki(n,e,i),a=Ki(n,e,r);s&&a||(this._active&&o.suppressClick(),this.reset())}touchcancel(){this.reset()}enable(t){this._enabled=!0,this._aroundCenter=!!t&&"center"===t.around}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}function Ki(t,e,n){for(let i=0;i<t.length;i++)if(t[i].identifier===n)return e[i]}function Yi(t,e){return Math.log(t/e)/Math.LN2}class Ji extends Xi{reset(){super.reset(),delete this._distance,delete this._startDistance}_start(t){this._startDistance=this._distance=t[0].dist(t[1])}_move(t,e){const n=this._distance;if(this._distance=t[0].dist(t[1]),this._active||!(Math.abs(Yi(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:Yi(this._distance,n),pinchAround:e}}}function Qi(t,e){return 180*t.angleWith(e)/Math.PI}class tr extends Xi{reset(){super.reset(),delete this._minDiameter,delete this._startVector,delete this._vector}_start(t){this._startVector=this._vector=t[0].sub(t[1]),this._minDiameter=t[0].dist(t[1])}_move(t,e){const n=this._vector;if(this._vector=t[0].sub(t[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:Qi(this._vector,n),pinchAround:e}}_isBelowThreshold(t){this._minDiameter=Math.min(this._minDiameter,t.mag());const e=25/(Math.PI*this._minDiameter)*360,n=Qi(t,this._startVector);return Math.abs(n)<e}}function er(t){return Math.abs(t.y)>Math.abs(t.x)}class nr extends Xi{reset(){super.reset(),this._valid=void 0,delete this._firstMove,delete this._lastPoints}_start(t){this._lastPoints=t,er(t[0].sub(t[1]))&&(this._valid=!1)}_move(t,e,n){const i=t[0].sub(this._lastPoints[0]),r=t[1].sub(this._lastPoints[1]);if(this._valid=this.gestureBeginsVertically(i,r,n.timeStamp),this._valid)return this._lastPoints=t,this._active=!0,{pitchDelta:(i.y+r.y)/2*-.5}}gestureBeginsVertically(t,e,n){if(void 0!==this._valid)return this._valid;const i=t.mag()>=2,r=e.mag()>=2;if(!i&&!r)return;if(!i||!r)return void 0===this._firstMove&&(this._firstMove=n),n-this._firstMove<100&&void 0;const o=t.y>0==e.y>0;return er(t)&&er(e)&&o}}const ir={panStep:100,bearingStep:15,pitchStep:10};class rr{constructor(){const t=ir;this._panStep=t.panStep,this._bearingStep=t.bearingStep,this._pitchStep=t.pitchStep,this._rotationDisabled=!1}reset(){this._active=!1}keydown(t){if(t.altKey||t.ctrlKey||t.metaKey)return;let e=0,n=0,i=0,r=0,o=0;switch(t.keyCode){case 61:case 107:case 171:case 187:e=1;break;case 189:case 109:case 173:e=-1;break;case 37:t.shiftKey?n=-1:(t.preventDefault(),r=-1);break;case 39:t.shiftKey?n=1:(t.preventDefault(),r=1);break;case 38:t.shiftKey?i=1:(t.preventDefault(),o=-1);break;case 40:t.shiftKey?i=-1:(t.preventDefault(),o=1);break;default:return}return this._rotationDisabled&&(n=0,i=0),{cameraAnimation:s=>{const a=s.getZoom();s.easeTo({duration:300,easeId:"keyboardHandler",easing:or,zoom:e?Math.round(a)+e*(t.shiftKey?2:1):a,bearing:s.getBearing()+n*this._bearingStep,pitch:s.getPitch()+i*this._pitchStep,offset:[-r*this._panStep,-o*this._panStep],center:s.getCenter()},{originalEvent:t})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function or(t){return t*(2-t)}const sr=4.000244140625;class ar{constructor(e,n){this._map=e,this._el=e.getCanvasContainer(),this._handler=n,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=.0022222222222222222,t.bindAll(["_onTimeout"],this)}setZoomRate(t){this._defaultZoomRate=t}setWheelZoomRate(t){this._wheelZoomRate=t}isEnabled(){return!!this._enabled}isActive(){return!!this._active||void 0!==this._finishTimeout}isZooming(){return!!this._zooming}enable(t){this.isEnabled()||(this._enabled=!0,this._aroundCenter=t&&"center"===t.around)}disable(){this.isEnabled()&&(this._enabled=!1)}wheel(e){if(!this.isEnabled())return;let n=e.deltaMode===t.window.WheelEvent.DOM_DELTA_LINE?40*e.deltaY:e.deltaY;const i=t.exported.now(),r=i-(this._lastWheelEventTime||0);this._lastWheelEventTime=i,0!==n&&n%sr==0?this._type="wheel":0!==n&&Math.abs(n)<4?this._type="trackpad":r>400?(this._type=null,this._lastValue=n,this._timeout=setTimeout(this._onTimeout,40,e)):this._type||(this._type=Math.abs(r*n)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,n+=this._lastValue)),e.shiftKey&&n&&(n/=4),this._type&&(this._lastWheelEvent=e,this._delta-=n,this._active||this._start(e)),e.preventDefault()}_onTimeout(t){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(t)}_start(t){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const e=o.mousePos(this._el,t);this._aroundPoint=this._aroundCenter?this._map.transform.centerPoint:e,this._aroundCoord=this._map.transform.pointCoordinate3D(this._aroundPoint),this._targetZoom=void 0,this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}renderFrame(){if(!this._frameId)return;if(this._frameId=null,!this.isActive())return;const e=this._map.transform,n=()=>e._terrainEnabled()?e.computeZoomRelativeTo(this._aroundCoord):e.zoom;if(0!==this._delta){const t="wheel"===this._type&&Math.abs(this._delta)>sr?this._wheelZoomRate:this._defaultZoomRate;let i=2/(1+Math.exp(-Math.abs(this._delta*t)));this._delta<0&&0!==i&&(i=1/i);const r=n(),o=Math.pow(2,r),s="number"==typeof this._targetZoom?e.zoomScale(this._targetZoom):o;this._targetZoom=Math.min(e.maxZoom,Math.max(e.minZoom,e.scaleZoom(s*i))),"wheel"===this._type&&(this._startZoom=n(),this._easing=this._smoothOutEasing(200)),this._delta=0}const i="number"==typeof this._targetZoom?this._targetZoom:n(),r=this._startZoom,o=this._easing;let s,a=!1;if("wheel"===this._type&&r&&o){const e=Math.min((t.exported.now()-this._lastWheelEventTime)/200,1),n=o(e);s=t.number(r,i,n),e<1?this._frameId||(this._frameId=!0):a=!0}else s=i,a=!0;return this._active=!0,a&&(this._active=!1,this._finishTimeout=setTimeout(()=>{this._zooming=!1,this._handler._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout},200)),{noInertia:!0,needsRenderFrame:!a,zoomDelta:s-n(),around:this._aroundPoint,aroundCoord:this._aroundCoord,originalEvent:this._lastWheelEvent}}_smoothOutEasing(e){let n=t.ease;if(this._prevEase){const e=this._prevEase,i=(t.exported.now()-e.start)/e.duration,r=e.easing(i+.01)-e.easing(i),o=.27/Math.sqrt(r*r+1e-4)*.01,s=Math.sqrt(.0729-o*o);n=t.bezier(o,s,.25,1)}return this._prevEase={start:t.exported.now(),duration:e,easing:n},n}reset(){this._active=!1}}class lr{constructor(t,e){this._clickZoom=t,this._tapZoom=e}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class cr{constructor(){this.reset()}reset(){this._active=!1}dblclick(t,e){return t.preventDefault(),{cameraAnimation:n=>{n.easeTo({duration:300,zoom:n.getZoom()+(t.shiftKey?-1:1),around:n.unproject(e)},{originalEvent:t})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class ur{constructor(){this._tap=new Ni({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,this._tap.reset()}touchstart(t,e,n){this._swipePoint||(this._tapTime&&t.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?n.length>0&&(this._swipePoint=e[0],this._swipeTouch=n[0].identifier):this._tap.touchstart(t,e,n))}touchmove(t,e,n){if(this._tapTime){if(this._swipePoint){if(n[0].identifier!==this._swipeTouch)return;const i=e[0],r=i.y-this._swipePoint.y;return this._swipePoint=i,t.preventDefault(),this._active=!0,{zoomDelta:r/128}}}else this._tap.touchmove(t,e,n)}touchend(t,e,n){this._tapTime?this._swipePoint&&0===n.length&&this.reset():this._tap.touchend(t,e,n)&&(this._tapTime=t.timeStamp)}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class hr{constructor(t,e,n){this._el=t,this._mousePan=e,this._touchPan=n}enable(t){this._inertiaOptions=t||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("mapboxgl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("mapboxgl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class dr{constructor(t,e,n){this._pitchWithRotate=t.pitchWithRotate,this._mouseRotate=e,this._mousePitch=n}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class pr{constructor(t,e,n,i){this._el=t,this._touchZoom=e,this._touchRotate=n,this._tapDragZoom=i,this._rotationDisabled=!1,this._enabled=!0}enable(t){this._touchZoom.enable(t),this._rotationDisabled||this._touchRotate.enable(t),this._tapDragZoom.enable(),this._el.classList.add("mapboxgl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("mapboxgl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}const fr=t=>t.zoom||t.drag||t.pitch||t.rotate;class mr extends t.Event{}class gr{constructor(){this.constants=[1,1,.01],this.radius=0}setup(e,n){const i=t.sub([],n,e);this.radius=t.length(i[2]<0?t.div([],i,this.constants):[i[0],i[1],0])}projectRay(e){t.div(e,e,this.constants),t.normalize(e,e),t.mul$2(e,e,this.constants);const n=t.scale([],e,this.radius);if(n[2]>0){const e=t.scale([],[0,0,1],t.dot(n,[0,0,1])),i=t.scale([],t.normalize([],[n[0],n[1],0]),this.radius),r=t.add([],n,t.scale([],t.sub([],t.add([],i,e),n),2));n[0]=r[0],n[1]=r[1]}return n}}function _r(t){return t.panDelta&&t.panDelta.mag()||t.zoomDelta||t.bearingDelta||t.pitchDelta}class yr{constructor(e,n){this._map=e,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new Pi(e),this._bearingSnap=n.bearingSnap,this._previousActiveHandlers={},this._trackingEllipsoid=new gr,this._dragOrigin=null,this._eventsInProgress={},this._addDefaultHandlers(n),t.bindAll(["handleEvent","handleWindowEvent"],this);const i=this._el;this._listeners=[[i,"touchstart",{passive:!0}],[i,"touchmove",{passive:!1}],[i,"touchend",void 0],[i,"touchcancel",void 0],[i,"mousedown",void 0],[i,"mousemove",void 0],[i,"mouseup",void 0],[t.window.document,"mousemove",{capture:!0}],[t.window.document,"mouseup",void 0],[i,"mouseover",void 0],[i,"mouseout",void 0],[i,"dblclick",void 0],[i,"click",void 0],[i,"keydown",{capture:!1}],[i,"keyup",void 0],[i,"wheel",{passive:!1}],[i,"contextmenu",void 0],[t.window,"blur",void 0]];for(const[r,s,a]of this._listeners)o.addEventListener(r,s,r===t.window.document?this.handleWindowEvent:this.handleEvent,a)}destroy(){for(const[e,n,i]of this._listeners)o.removeEventListener(e,n,e===t.window.document?this.handleWindowEvent:this.handleEvent,i)}_addDefaultHandlers(t){const e=this._map,n=e.getCanvasContainer();this._add("mapEvent",new Ri(e,t));const i=e.boxZoom=new Bi(e,t);this._add("boxZoom",i);const r=new ji,o=new cr;e.doubleClickZoom=new lr(o,r),this._add("tapZoom",r),this._add("clickZoom",o);const s=new ur;this._add("tapDragZoom",s);const a=e.touchPitch=new nr;this._add("touchPitch",a);const l=new Zi(t),c=new Hi(t);e.dragRotate=new dr(t,l,c),this._add("mouseRotate",l,["mousePitch"]),this._add("mousePitch",c,["mouseRotate"]);const u=new Gi(t),h=new Wi(t);e.dragPan=new hr(n,u,h),this._add("mousePan",u),this._add("touchPan",h,["touchZoom","touchRotate"]);const d=new tr,p=new Ji;e.touchZoomRotate=new pr(n,p,d,s),this._add("touchRotate",d,["touchPan","touchZoom"]),this._add("touchZoom",p,["touchPan","touchRotate"]),this._add("blockableMapEvent",new Fi(e));const f=e.scrollZoom=new ar(e,this);this._add("scrollZoom",f,["mousePan"]);const m=e.keyboard=new rr;this._add("keyboard",m);for(const g of["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"])t.interactive&&t[g]&&e[g].enable(t[g])}_add(t,e,n){this._handlers.push({handlerName:t,handler:e,allowed:n}),this._handlersById[t]=e}stop(t){if(!this._updatingCamera){for(const{handler:t}of this._handlers)t.reset();this._inertia.clear(),this._fireEvents({},{},t),this._changes=[]}}isActive(){for(const{handler:t}of this._handlers)if(t.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return Boolean(fr(this._eventsInProgress))||this.isZooming()}_blockedByActive(t,e,n){for(const i in t)if(i!==n&&(!e||e.indexOf(i)<0))return!0;return!1}handleWindowEvent(t){this.handleEvent(t,t.type+"Window")}_getMapTouches(t){const e=[];for(const n of t)this._el.contains(n.target)&&e.push(n);return e}handleEvent(t,e){if("blur"===t.type)return void this.stop(!0);this._updatingCamera=!0;const n="renderFrame"===t.type,i=n?void 0:t,r={needsRenderFrame:!1},s={},a={},l=t.touches?this._getMapTouches(t.touches):void 0,c=l?o.touchPos(this._el,l):n?void 0:o.mousePos(this._el,t);for(const{handlerName:o,handler:d,allowed:p}of this._handlers){if(!d.isEnabled())continue;let n;this._blockedByActive(a,p,o)?d.reset():d[e||t.type]&&(n=d[e||t.type](t,c,l),this.mergeHandlerResult(r,s,n,o,i),n&&n.needsRenderFrame&&this._triggerRenderFrame()),(n||d.isActive())&&(a[o]=d)}const u={};for(const o in this._previousActiveHandlers)a[o]||(u[o]=i);this._previousActiveHandlers=a,(Object.keys(u).length||_r(r))&&(this._changes.push([r,s,u]),this._triggerRenderFrame()),(Object.keys(a).length||_r(r))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:h}=r;h&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],h(this._map))}mergeHandlerResult(e,n,i,r,o){if(!i)return;t.extend(e,i);const s={handlerName:r,originalEvent:i.originalEvent||o};void 0!==i.zoomDelta&&(n.zoom=s),void 0!==i.panDelta&&(n.drag=s),void 0!==i.pitchDelta&&(n.pitch=s),void 0!==i.bearingDelta&&(n.rotate=s)}_applyChanges(){const e={},n={},i={};for(const[r,o,s]of this._changes)r.panDelta&&(e.panDelta=(e.panDelta||new t.pointGeometry(0,0))._add(r.panDelta)),r.zoomDelta&&(e.zoomDelta=(e.zoomDelta||0)+r.zoomDelta),r.bearingDelta&&(e.bearingDelta=(e.bearingDelta||0)+r.bearingDelta),r.pitchDelta&&(e.pitchDelta=(e.pitchDelta||0)+r.pitchDelta),void 0!==r.around&&(e.around=r.around),void 0!==r.aroundCoord&&(e.aroundCoord=r.aroundCoord),void 0!==r.pinchAround&&(e.pinchAround=r.pinchAround),r.noInertia&&(e.noInertia=r.noInertia),t.extend(n,o),t.extend(i,s);this._updateMapTransform(e,n,i),this._changes=[]}_updateMapTransform(e,n,i){const r=this._map,o=r.transform,s=t=>[t.x,t.y,t.z];if((t=>{const e=this._eventsInProgress.drag;return e&&!this._handlersById[e.handlerName].isActive()})()&&!_r(e)){const t=o.zoom;o.cameraElevationReference="sea",o.recenterOnTerrain(),o.cameraElevationReference="ground",t!==o.zoom&&this._map._update(!0)}if(!_r(e))return this._fireEvents(n,i,!0);let{panDelta:a,zoomDelta:l,bearingDelta:c,pitchDelta:u,around:h,aroundCoord:d,pinchAround:p}=e;void 0!==p&&(h=p),(t=>n.drag&&!this._eventsInProgress.drag)()&&h&&(this._dragOrigin=s(o.pointCoordinate3D(h)),this._trackingEllipsoid.setup(o._camera.position,this._dragOrigin)),o.cameraElevationReference="sea",r._stop(!0),h=h||r.transform.centerPoint,c&&(o.bearing+=c),u&&(o.pitch+=u),o._updateCameraState();const f=[0,0,0];if(a){const t=o.screenPointToMercatorRay(h),e=o.screenPointToMercatorRay(h.sub(a)),n=this._trackingEllipsoid.projectRay(t.dir),i=this._trackingEllipsoid.projectRay(e.dir);f[0]=i[0]-n[0],f[1]=i[1]-n[1]}const m=o.zoom,g=[0,0,0];if(l){const e=s(d||o.pointCoordinate3D(h)),n={dir:t.normalize([],t.sub([],e,o._camera.position))},i=o.screenPointToMercatorRay(o.centerPoint);if(n.dir[2]<0){const r=t.altitudeFromMercatorZ(e[2],e[1]),a=o.rayIntersectionCoordinate(o.pointRayIntersection(o.centerPoint,r)),c=o.zoomDeltaToMovement(s(a),l)*(i.dir[2]/n.dir[2]);t.scale(g,n.dir,c)}else if(o._terrainEnabled()){const i=o.zoomDeltaToMovement(e,l);t.scale(g,n.dir,i)}}const _=t.add(f,f,g);o._translateCameraConstrained(_),l&&Math.abs(o.zoom-m)>1e-4&&o.recenterOnTerrain(),o.cameraElevationReference="ground",this._map._update(),e.noInertia||this._inertia.record(e),this._fireEvents(n,i,!0)}_fireEvents(e,n,i){const r=fr(this._eventsInProgress),o=fr(e),s={};for(const t in e){const{originalEvent:n}=e[t];this._eventsInProgress[t]||(s[t+"start"]=n),this._eventsInProgress[t]=e[t]}!r&&o&&this._fireEvent("movestart",o.originalEvent);for(const t in s)this._fireEvent(t,s[t]);o&&this._fireEvent("move",o.originalEvent);for(const t in e){const{originalEvent:n}=e[t];this._fireEvent(t,n)}const a={};let l;for(const t in this._eventsInProgress){const{handlerName:e,originalEvent:i}=this._eventsInProgress[t];this._handlersById[e].isActive()||(delete this._eventsInProgress[t],l=n[e]||i,a[t+"end"]=l)}for(const t in a)this._fireEvent(t,a[t]);const c=fr(this._eventsInProgress);if(i&&(r||o)&&!c){this._updatingCamera=!0;const e=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),n=t=>0!==t&&-this._bearingSnap<t&&t<this._bearingSnap;e?(n(e.bearing||this._map.getBearing())&&(e.bearing=0),this._map.easeTo(e,{originalEvent:l})):(this._map.fire(new t.Event("moveend",{originalEvent:l})),n(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}}_fireEvent(e,n){this._map.fire(new t.Event(e,n?{originalEvent:n}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(t=>{delete this._frameId,this.handleEvent(new mr("renderFrame",{timeStamp:t})),this._applyChanges()})}_triggerRenderFrame(){void 0===this._frameId&&(this._frameId=this._requestFrame())}}class vr extends t.Evented{constructor(e,n){super(),this._moving=!1,this._zooming=!1,this.transform=e,this._bearingSnap=n.bearingSnap,t.bindAll(["_renderFrameCallback"],this)}getCenter(){return new t.LngLat(this.transform.center.lng,this.transform.center.lat)}setCenter(t,e){return this.jumpTo({center:t},e)}panBy(e,n,i){return e=t.pointGeometry.convert(e).mult(-1),this.panTo(this.transform.center,t.extend({offset:e},n),i)}panTo(e,n,i){return this.easeTo(t.extend({center:e},n),i)}getZoom(){return this.transform.zoom}setZoom(t,e){return this.jumpTo({zoom:t},e),this}zoomTo(e,n,i){return this.easeTo(t.extend({zoom:e},n),i)}zoomIn(t,e){return this.zoomTo(this.getZoom()+1,t,e),this}zoomOut(t,e){return this.zoomTo(this.getZoom()-1,t,e),this}getBearing(){return this.transform.bearing}setBearing(t,e){return this.jumpTo({bearing:t},e),this}getPadding(){return this.transform.padding}setPadding(t,e){return this.jumpTo({padding:t},e),this}rotateTo(e,n,i){return this.easeTo(t.extend({bearing:e},n),i)}resetNorth(e,n){return this.rotateTo(0,t.extend({duration:1e3},e),n),this}resetNorthPitch(e,n){return this.easeTo(t.extend({bearing:0,pitch:0,duration:1e3},e),n),this}snapToNorth(t,e){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(t,e):this}getPitch(){return this.transform.pitch}setPitch(t,e){return this.jumpTo({pitch:t},e),this}cameraForBounds(e,n){e=t.LngLatBounds.convert(e);const i=n&&n.bearing||0;return this._cameraForBoxAndBearing(e.getNorthWest(),e.getSouthEast(),i,n)}_extendCameraOptions(e){const n={top:0,bottom:0,right:0,left:0};if("number"==typeof(e=t.extend({padding:n,offset:[0,0],maxZoom:this.transform.maxZoom},e)).padding){const t=e.padding;e.padding={top:t,bottom:t,right:t,left:t}}return e.padding=t.extend(n,e.padding),e}_cameraForBoxAndBearing(e,n,i,r){const o=this._extendCameraOptions(r),s=this.transform,a=s.padding,l=s.project(t.LngLat.convert(e)),c=s.project(t.LngLat.convert(n)),u=l.rotate(-t.degToRad(i)),h=c.rotate(-t.degToRad(i)),d=new t.pointGeometry(Math.max(u.x,h.x),Math.max(u.y,h.y)),p=new t.pointGeometry(Math.min(u.x,h.x),Math.min(u.y,h.y)),f=d.sub(p),m=(s.width-(a.left+a.right+o.padding.left+o.padding.right))/f.x,g=(s.height-(a.top+a.bottom+o.padding.top+o.padding.bottom))/f.y;if(g<0||m<0)return void t.warnOnce("Map cannot fit within canvas with the given bounds, padding, and/or offset.");const _=Math.min(s.scaleZoom(s.scale*Math.min(m,g)),o.maxZoom),y="number"==typeof o.offset.x?new t.pointGeometry(o.offset.x,o.offset.y):t.pointGeometry.convert(o.offset),v=new t.pointGeometry((o.padding.left-o.padding.right)/2,(o.padding.top-o.padding.bottom)/2).rotate(i*Math.PI/180),x=y.add(v).mult(s.scale/s.zoomScale(_));return{center:s.unproject(l.add(c).div(2).sub(x)),zoom:_,bearing:i}}_cameraForBox(e,n,i,r,o){const s=this._extendCameraOptions(o);i=i||0,r=r||0,e=t.LngLat.convert(e),n=t.LngLat.convert(n);const a=this.transform.clone();a.padding=s.padding;const l=this.getFreeCameraOptions(),c=new t.LngLat(.5*(e.lng+n.lng),.5*(e.lat+n.lat)),u=.5*(i+r);if(a._camera.position[2]<t.mercatorZfromAltitude(u,c.lat))return void t.warnOnce("Map cannot fit within canvas with the given bounds, padding, and/or offset.");l.lookAtPoint(c),a.setFreeCameraOptions(l);const h=t.MercatorCoordinate.fromLngLat(e),d=t.MercatorCoordinate.fromLngLat(n),m=a.pointRayIntersection(a.centerPoint,u),g=[(_=a.rayIntersectionCoordinate(m)).x,_.y,_.z];var _;const y=a.screenPointToMercatorRay(a.centerPoint);let v,x=0;do{const n=Math.floor(a.zoom),o=1<<n,s=Math.min(o*h.x,o*d.x),l=Math.min(o*h.y,o*d.y),c=Math.max(o*h.x,o*d.x),u=Math.max(o*h.y,o*d.y),m=new f([s,l,i],[c,u,r]),_=p.fromInvProjectionMatrix(a.invProjMatrix,a.worldSize,n);if(2!==m.intersects(_)){v&&(a._camera.position=t.scaleAndAdd([],a._camera.position,y.dir,-v),a._updateStateFromCamera());break}const x=t.sub([],a._camera.position,g);v=.5*t.length(x),a._camera.position=t.scaleAndAdd([],a._camera.position,y.dir,v);try{a._updateStateFromCamera()}catch(e){return void t.warnOnce("Map cannot fit within canvas with the given bounds, padding, and/or offset.")}}while(++x<10);return{center:a.center,zoom:a.zoom,bearing:a.bearing,pitch:a.pitch}}fitBounds(t,e,n){return this._fitInternal(this.cameraForBounds(t,e),e,n)}_raycastElevationBox(e,n){const i=this.transform.elevation;if(!i)return;const r=new t.pointGeometry(e.x,n.y),o=new t.pointGeometry(n.x,e.y),s=i.pointCoordinate(e);if(!s)return;const a=i.pointCoordinate(n);if(!a)return;const l=i.pointCoordinate(r);if(!l)return;const c=i.pointCoordinate(o);if(!c)return;const u=new t.MercatorCoordinate(s[0],s[1]).toLngLat(),h=new t.MercatorCoordinate(a[0],a[1]).toLngLat(),d=new t.MercatorCoordinate(l[0],l[1]).toLngLat(),p=new t.MercatorCoordinate(c[0],c[1]).toLngLat(),f=Math.min(u.lng,Math.min(h.lng,Math.min(d.lng,p.lng))),m=Math.min(u.lat,Math.min(h.lat,Math.min(d.lat,p.lat))),g=Math.max(u.lng,Math.max(h.lng,Math.max(d.lng,p.lng))),_=Math.max(u.lat,Math.max(h.lat,Math.max(d.lat,p.lat))),y=Math.min(s[3],Math.min(a[3],Math.min(l[3],c[3]))),v=Math.max(s[3],Math.max(a[3],Math.max(l[3],c[3])));return{minLngLat:new t.LngLat(f,m),maxLngLat:new t.LngLat(g,_),minAltitude:y,maxAltitude:v}}fitScreenCoordinates(e,n,i,r,o){let s,a,l,c;const u=t.pointGeometry.convert(e),h=t.pointGeometry.convert(n),d=this._raycastElevationBox(u,h);if(d)s=d.minLngLat,a=d.maxLngLat,l=d.minAltitude,c=d.maxAltitude;else{if(this.transform.isHorizonVisibleForPoints(u,h))return this;s=this.transform.pointLocation(u),a=this.transform.pointLocation(h)}return this._fitInternal(0===this.transform.pitch?this._cameraForBoxAndBearing(this.transform.pointLocation(t.pointGeometry.convert(e)),this.transform.pointLocation(t.pointGeometry.convert(n)),i,r):this._cameraForBox(s,a,l,c,r),r,o)}_fitInternal(e,n,i){return e?(delete(n=t.extend(e,n)).padding,n.linear?this.easeTo(n,i):this.flyTo(n,i)):this}jumpTo(e,n){this.stop();const i=this.transform;let r=!1,o=!1,s=!1;return"zoom"in e&&i.zoom!==+e.zoom&&(r=!0,i.zoom=+e.zoom),void 0!==e.center&&(i.center=t.LngLat.convert(e.center)),"bearing"in e&&i.bearing!==+e.bearing&&(o=!0,i.bearing=+e.bearing),"pitch"in e&&i.pitch!==+e.pitch&&(s=!0,i.pitch=+e.pitch),null==e.padding||i.isPaddingEqual(e.padding)||(i.padding=e.padding),this.fire(new t.Event("movestart",n)).fire(new t.Event("move",n)),r&&this.fire(new t.Event("zoomstart",n)).fire(new t.Event("zoom",n)).fire(new t.Event("zoomend",n)),o&&this.fire(new t.Event("rotatestart",n)).fire(new t.Event("rotate",n)).fire(new t.Event("rotateend",n)),s&&this.fire(new t.Event("pitchstart",n)).fire(new t.Event("pitch",n)).fire(new t.Event("pitchend",n)),this.fire(new t.Event("moveend",n))}getFreeCameraOptions(){return this.transform.getFreeCameraOptions()}setFreeCameraOptions(e,n){this.stop();const i=this.transform,r=i.zoom,o=i.pitch,s=i.bearing;i.setFreeCameraOptions(e);const a=r!==i.zoom,l=o!==i.pitch,c=s!==i.bearing;return this.fire(new t.Event("movestart",n)).fire(new t.Event("move",n)),a&&this.fire(new t.Event("zoomstart",n)).fire(new t.Event("zoom",n)).fire(new t.Event("zoomend",n)),c&&this.fire(new t.Event("rotatestart",n)).fire(new t.Event("rotate",n)).fire(new t.Event("rotateend",n)),l&&this.fire(new t.Event("pitchstart",n)).fire(new t.Event("pitch",n)).fire(new t.Event("pitchend",n)),this.fire(new t.Event("moveend",n)),this}easeTo(e,n){this._stop(!1,e.easeId),(!1===(e=t.extend({offset:[0,0],duration:500,easing:t.ease},e)).animate||!e.essential&&t.exported.prefersReducedMotion)&&(e.duration=0);const i=this.transform,r=this.getZoom(),o=this.getBearing(),s=this.getPitch(),a=this.getPadding(),l="zoom"in e?+e.zoom:r,c="bearing"in e?this._normalizeBearing(e.bearing,o):o,u="pitch"in e?+e.pitch:s,h="padding"in e?e.padding:i.padding,d=t.pointGeometry.convert(e.offset);let p=i.centerPoint.add(d);const f=i.pointLocation(p),m=t.LngLat.convert(e.center||f);this._normalizeCenter(m);const g=i.project(f),_=i.project(m).sub(g),y=i.zoomScale(l-r);let v,x;e.around&&(v=t.LngLat.convert(e.around),x=i.locationPoint(v));const b={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=this._zooming||l!==r,this._rotating=this._rotating||o!==c,this._pitching=this._pitching||u!==s,this._padding=!i.isPaddingEqual(h),this._easeId=e.easeId,this._prepareEase(n,e.noMoveStart,b),this._ease(e=>{if(this._zooming&&(i.zoom=t.number(r,l,e)),this._rotating&&(i.bearing=t.number(o,c,e)),this._pitching&&(i.pitch=t.number(s,u,e)),this._padding&&(i.interpolatePadding(a,h,e),p=i.centerPoint.add(d)),v)i.setLocationAtPoint(v,x);else{const t=i.zoomScale(i.zoom-r),n=l>r?Math.min(2,y):Math.max(.5,y),o=Math.pow(n,1-e),s=i.unproject(g.add(_.mult(e*o)).mult(t));i.setLocationAtPoint(i.renderWorldCopies?s.wrap():s,p)}this._fireMoveEvents(n)},t=>{i.recenterOnTerrain(),this._afterEase(n,t)},e),this}_prepareEase(e,n,i={}){this._moving=!0,this.transform.cameraElevationReference="sea",n||i.moving||this.fire(new t.Event("movestart",e)),this._zooming&&!i.zooming&&this.fire(new t.Event("zoomstart",e)),this._rotating&&!i.rotating&&this.fire(new t.Event("rotatestart",e)),this._pitching&&!i.pitching&&this.fire(new t.Event("pitchstart",e))}_fireMoveEvents(e){this.fire(new t.Event("move",e)),this._zooming&&this.fire(new t.Event("zoom",e)),this._rotating&&this.fire(new t.Event("rotate",e)),this._pitching&&this.fire(new t.Event("pitch",e))}_afterEase(e,n){if(this._easeId&&n&&this._easeId===n)return;delete this._easeId,this.transform.cameraElevationReference="ground";const i=this._zooming,r=this._rotating,o=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,i&&this.fire(new t.Event("zoomend",e)),r&&this.fire(new t.Event("rotateend",e)),o&&this.fire(new t.Event("pitchend",e)),this.fire(new t.Event("moveend",e))}flyTo(e,n){if(!e.essential&&t.exported.prefersReducedMotion){const i=t.pick(e,["center","zoom","bearing","pitch","around"]);return this.jumpTo(i,n)}this.stop(),e=t.extend({offset:[0,0],speed:1.2,curve:1.42,easing:t.ease},e);const i=this.transform,r=this.getZoom(),o=this.getBearing(),s=this.getPitch(),a=this.getPadding(),l="zoom"in e?t.clamp(+e.zoom,i.minZoom,i.maxZoom):r,c="bearing"in e?this._normalizeBearing(e.bearing,o):o,u="pitch"in e?+e.pitch:s,h="padding"in e?e.padding:i.padding,d=i.zoomScale(l-r),p=t.pointGeometry.convert(e.offset);let f=i.centerPoint.add(p);const m=i.pointLocation(f),g=t.LngLat.convert(e.center||m);this._normalizeCenter(g);const _=i.project(m),y=i.project(g).sub(_);let v=e.curve;const x=Math.max(i.width,i.height),b=x/d,w=y.mag();if("minZoom"in e){const n=t.clamp(Math.min(e.minZoom,r,l),i.minZoom,i.maxZoom),o=x/i.zoomScale(n-r);v=Math.sqrt(o/w*2)}const C=v*v;function T(t){const e=(b*b-x*x+(t?-1:1)*C*C*w*w)/(2*(t?b:x)*C*w);return Math.log(Math.sqrt(e*e+1)-e)}function S(t){return(Math.exp(t)-Math.exp(-t))/2}function E(t){return(Math.exp(t)+Math.exp(-t))/2}const k=T(0);let A=function(t){return E(k)/E(k+v*t)},I=function(t){return x*((E(k)*(S(e=k+v*t)/E(e))-S(k))/C)/w;var e},P=(T(1)-k)/v;if(Math.abs(w)<1e-6||!isFinite(P)){if(Math.abs(x-b)<1e-6)return this.easeTo(e,n);const t=b<x?-1:1;P=Math.abs(Math.log(b/x))/v,I=function(){return 0},A=function(e){return Math.exp(t*v*e)}}return e.duration="duration"in e?+e.duration:1e3*P/("screenSpeed"in e?+e.screenSpeed/v:+e.speed),e.maxDuration&&e.duration>e.maxDuration&&(e.duration=0),this._zooming=!0,this._rotating=o!==c,this._pitching=u!==s,this._padding=!i.isPaddingEqual(h),this._prepareEase(n,!1),this._ease(e=>{const d=e*P,m=1/A(d);i.zoom=1===e?l:r+i.scaleZoom(m),this._rotating&&(i.bearing=t.number(o,c,e)),this._pitching&&(i.pitch=t.number(s,u,e)),this._padding&&(i.interpolatePadding(a,h,e),f=i.centerPoint.add(p));const v=1===e?g:i.unproject(_.add(y.mult(I(d))).mult(m));i.setLocationAtPoint(i.renderWorldCopies?v.wrap():v,f),i._updateCenterElevation(),this._fireMoveEvents(n)},()=>this._afterEase(n),e),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(t,e){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){const t=this._onEaseEnd;delete this._onEaseEnd,t.call(this,e)}if(!t){const t=this.handlers;t&&t.stop(!1)}return this}_ease(e,n,i){!1===i.animate||0===i.duration?(e(1),n()):(this._easeStart=t.exported.now(),this._easeOptions=i,this._onEaseFrame=e,this._onEaseEnd=n,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_renderFrameCallback(){const e=Math.min((t.exported.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(e)),e<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()}_normalizeBearing(e,n){e=t.wrap(e,-180,180);const i=Math.abs(e-n);return Math.abs(e-360-n)<i&&(e-=360),Math.abs(e+360-n)<i&&(e+=360),e}_normalizeCenter(t){const e=this.transform;if(!e.renderWorldCopies||e.lngRange)return;const n=t.lng-e.center.lng;t.lng+=n>180?-360:n<-180?360:0}}class xr{constructor(e={}){this.options=e,t.bindAll(["_toggleAttribution","_updateEditLink","_updateData","_updateCompact"],this)}getDefaultPosition(){return"bottom-right"}onAdd(t){const e=this.options&&this.options.compact;return this._map=t,this._container=o.create("div","mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._compactButton=o.create("button","mapboxgl-ctrl-attrib-button",this._container),this._compactButton.type="button",this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=o.create("div","mapboxgl-ctrl-attrib-inner",this._container),this._innerContainer.setAttribute("role","list"),e&&this._container.classList.add("mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),void 0===e&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container}onRemove(){o.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0,this._attribHTML=void 0}_setElementTitle(t,e){const n=this._map._getUIString("AttributionControl."+e);t.title=n,t.setAttribute("aria-label",n)}_toggleAttribution(){this._container.classList.contains("mapboxgl-compact-show")?(this._container.classList.remove("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-pressed","false")):(this._container.classList.add("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-pressed","true"))}_updateEditLink(){let e=this._editLink;e||(e=this._editLink=this._container.querySelector(".mapbox-improve-map"));const n=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:this._map._requestManager._customAccessToken||t.config.ACCESS_TOKEN}];if(e){const i=n.reduce((t,e,i)=>(e.value&&(t+=`${e.key}=${e.value}${i<n.length-1?"&":""}`),t),"?");e.href=`${t.config.FEEDBACK_URL}/${i}${this._map._hash?this._map._hash.getHashString(!0):""}`,e.rel="noopener nofollow",this._setElementTitle(e,"MapFeedback")}}_updateData(t){!t||"metadata"!==t.sourceDataType&&"visibility"!==t.sourceDataType&&"style"!==t.dataType||(this._updateAttributions(),this._updateEditLink())}_updateAttributions(){if(!this._map.style)return;let t=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?t=t.concat(this.options.customAttribution.map(t=>"string"!=typeof t?"":t)):"string"==typeof this.options.customAttribution&&t.push(this.options.customAttribution)),this._map.style.stylesheet){const t=this._map.style.stylesheet;this.styleOwner=t.owner,this.styleId=t.id}const e=this._map.style._sourceCaches;for(const i in e){const n=e[i];if(n.used){const e=n.getSource();e.attribution&&t.indexOf(e.attribution)<0&&t.push(e.attribution)}}t.sort((t,e)=>t.length-e.length),t=t.filter((e,n)=>{for(let i=n+1;i<t.length;i++)if(t[i].indexOf(e)>=0)return!1;return!0});const n=t.join(" | ");n!==this._attribHTML&&(this._attribHTML=n,t.length?(this._innerContainer.innerHTML=n,this._container.classList.remove("mapboxgl-attrib-empty")):this._container.classList.add("mapboxgl-attrib-empty"),this._editLink=null)}_updateCompact(){this._map.getCanvasContainer().offsetWidth<=640?this._container.classList.add("mapboxgl-compact"):this._container.classList.remove("mapboxgl-compact","mapboxgl-compact-show")}}class br{constructor(){t.bindAll(["_updateLogo"],this),t.bindAll(["_updateCompact"],this)}onAdd(t){this._map=t,this._container=o.create("div","mapboxgl-ctrl");const e=o.create("a","mapboxgl-ctrl-logo");return e.target="_blank",e.rel="noopener nofollow",e.href="https://www.mapbox.com/",e.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),e.setAttribute("rel","noopener nofollow"),this._container.appendChild(e),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){o.remove(this._container),this._map.off("sourcedata",this._updateLogo),this._map.off("resize",this._updateCompact)}getDefaultPosition(){return"bottom-left"}_updateLogo(t){t&&"metadata"!==t.sourceDataType||(this._container.style.display=this._logoRequired()?"block":"none")}_logoRequired(){if(!this._map.style)return!0;const t=this._map.style._sourceCaches;if(0===Object.entries(t).length)return!0;for(const e in t){const n=t[e].getSource();if(n.hasOwnProperty("mapbox_logo")&&!n.mapbox_logo)return!1}return!0}_updateCompact(){const t=this._container.children;if(t.length){const e=t[0];this._map.getCanvasContainer().offsetWidth<250?e.classList.add("mapboxgl-compact"):e.classList.remove("mapboxgl-compact")}}}class wr{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(t){const e=++this._id;return this._queue.push({callback:t,id:e,cancelled:!1}),e}remove(t){const e=this._currentlyRunning,n=e?this._queue.concat(e):this._queue;for(const i of n)if(i.id===t)return void(i.cancelled=!0)}run(t=0){const e=this._currentlyRunning=this._queue;this._queue=[];for(const n of e)if(!n.cancelled&&(n.callback(t),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}function Cr(e,n,i){if(e=new t.LngLat(e.lng,e.lat),n){const r=new t.LngLat(e.lng-360,e.lat),o=new t.LngLat(e.lng+360,e.lat),s=360*Math.ceil(Math.abs(e.lng-i.center.lng)/360),a=i.locationPoint(e).distSqr(n),l=n.x<0||n.y<0||n.x>i.width||n.y>i.height;i.locationPoint(r).distSqr(n)<a&&(l||Math.abs(r.lng-i.center.lng)<s)?e=r:i.locationPoint(o).distSqr(n)<a&&(l||Math.abs(o.lng-i.center.lng)<s)&&(e=o)}for(;Math.abs(e.lng-i.center.lng)>180;){const t=i.locationPoint(e);if(t.x>=0&&t.y>=0&&t.x<=i.width&&t.y<=i.height)break;e.lng>i.center.lng?e.lng-=360:e.lng+=360}return e}const Tr={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function Sr(t,e,n){const i=t.classList;for(const r in Tr)i.remove(`mapboxgl-${n}-anchor-${r}`);i.add(`mapboxgl-${n}-anchor-${e}`)}class Er extends t.Evented{constructor(e,n){if(super(),(e instanceof t.window.HTMLElement||n)&&(e=t.extend({element:e},n)),t.bindAll(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress","_clearFadeTimer"],this),this._anchor=e&&e.anchor||"center",this._color=e&&e.color||"#3FB1CE",this._scale=e&&e.scale||1,this._draggable=e&&e.draggable||!1,this._clickTolerance=e&&e.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=e&&e.rotation||0,this._rotationAlignment=e&&e.rotationAlignment||"auto",this._pitchAlignment=e&&e.pitchAlignment&&"auto"!==e.pitchAlignment?e.pitchAlignment:this._rotationAlignment,e&&e.element)this._element=e.element,this._offset=t.pointGeometry.convert(e&&e.offset||[0,0]);else{this._defaultMarker=!0,this._element=o.create("div"),this._element.setAttribute("aria-label","Map marker");const n=o.createNS("http://www.w3.org/2000/svg","svg"),i=41,r=27;n.setAttributeNS(null,"display","block"),n.setAttributeNS(null,"height",i+"px"),n.setAttributeNS(null,"width",r+"px"),n.setAttributeNS(null,"viewBox",`0 0 ${r} ${i}`);const s=o.createNS("http://www.w3.org/2000/svg","g");s.setAttributeNS(null,"stroke","none"),s.setAttributeNS(null,"stroke-width","1"),s.setAttributeNS(null,"fill","none"),s.setAttributeNS(null,"fill-rule","evenodd");const a=o.createNS("http://www.w3.org/2000/svg","g");a.setAttributeNS(null,"fill-rule","nonzero");const l=o.createNS("http://www.w3.org/2000/svg","g");l.setAttributeNS(null,"transform","translate(3.0, 29.0)"),l.setAttributeNS(null,"fill","#000000");const c=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];for(const t of c){const e=o.createNS("http://www.w3.org/2000/svg","ellipse");e.setAttributeNS(null,"opacity","0.04"),e.setAttributeNS(null,"cx","10.5"),e.setAttributeNS(null,"cy","5.80029008"),e.setAttributeNS(null,"rx",t.rx),e.setAttributeNS(null,"ry",t.ry),l.appendChild(e)}const u=o.createNS("http://www.w3.org/2000/svg","g");u.setAttributeNS(null,"fill",this._color);const h=o.createNS("http://www.w3.org/2000/svg","path");h.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),u.appendChild(h);const d=o.createNS("http://www.w3.org/2000/svg","g");d.setAttributeNS(null,"opacity","0.25"),d.setAttributeNS(null,"fill","#000000");const p=o.createNS("http://www.w3.org/2000/svg","path");p.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),d.appendChild(p);const f=o.createNS("http://www.w3.org/2000/svg","g");f.setAttributeNS(null,"transform","translate(6.0, 7.0)"),f.setAttributeNS(null,"fill","#FFFFFF");const m=o.createNS("http://www.w3.org/2000/svg","g");m.setAttributeNS(null,"transform","translate(8.0, 8.0)");const g=o.createNS("http://www.w3.org/2000/svg","circle");g.setAttributeNS(null,"fill","#000000"),g.setAttributeNS(null,"opacity","0.25"),g.setAttributeNS(null,"cx","5.5"),g.setAttributeNS(null,"cy","5.5"),g.setAttributeNS(null,"r","5.4999962");const _=o.createNS("http://www.w3.org/2000/svg","circle");_.setAttributeNS(null,"fill","#FFFFFF"),_.setAttributeNS(null,"cx","5.5"),_.setAttributeNS(null,"cy","5.5"),_.setAttributeNS(null,"r","5.4999962"),m.appendChild(g),m.appendChild(_),a.appendChild(l),a.appendChild(u),a.appendChild(d),a.appendChild(f),a.appendChild(m),n.appendChild(a),n.setAttributeNS(null,"height",i*this._scale+"px"),n.setAttributeNS(null,"width",r*this._scale+"px"),this._element.appendChild(n),this._offset=t.pointGeometry.convert(e&&e.offset||[0,-14])}this._element.classList.add("mapboxgl-marker"),this._element.addEventListener("dragstart",t=>{t.preventDefault()}),this._element.addEventListener("mousedown",t=>{t.preventDefault()}),Sr(this._element,this._anchor,"marker"),this._popup=null}addTo(t){return this.remove(),this._map=t,t.getCanvasContainer().appendChild(this._element),t.on("move",this._update),t.on("moveend",this._update),t.on("remove",this._clearFadeTimer),t._addMarker(this),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this}remove(){return this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),this._map.off("remove",this._clearFadeTimer),this._map._removeMarker(this),delete this._map),this._clearFadeTimer(),o.remove(this._element),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(e){return this._lngLat=t.LngLat.convert(e),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this}getElement(){return this._element}setPopup(t){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),t){if(!("offset"in t.options)){const e=38.1,n=13.5,i=Math.sqrt(Math.pow(n,2)/2);t.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-e],"bottom-left":[i,-1*(e-n+i)],"bottom-right":[-i,-1*(e-n+i)],left:[n,-1*(e-n)],right:[-n,-1*(e-n)]}:this._offset}this._popup=t,this._lngLat&&this._popup.setLngLat(this._lngLat),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this}_onKeyPress(t){const e=t.code,n=t.charCode||t.keyCode;"Space"!==e&&"Enter"!==e&&32!==n&&13!==n||this.togglePopup()}_onMapClick(t){const e=t.originalEvent.target,n=this._element;this._popup&&(e===n||n.contains(e))&&this.togglePopup()}getPopup(){return this._popup}togglePopup(){const t=this._popup;return t?(t.isOpen()?t.remove():t.addTo(this._map),this):this}_evaluateOpacity(){const t=this._pos?this._pos.sub(this._transformedOffset()):null;if(!this._withinScreenBounds(t))return void this._clearFadeTimer();const e=this._map.unproject(t);let n=!1;if(this._map.getTerrain()){const t=this._map.getFreeCameraOptions();if(t.position){const i=t.position.toLngLat();n=i.distanceTo(e)<.9*i.distanceTo(this._lngLat)}}const i=(1-this._map._queryFogOpacity(e))*(n?.2:1);this._element.style.opacity=""+i,this._popup&&this._popup._setOpacity(""+i),this._fadeTimer=null}_clearFadeTimer(){this._fadeTimer&&(clearTimeout(this._fadeTimer),this._fadeTimer=null)}_withinScreenBounds(t){const e=this._map.transform;return!!t&&t.x>=0&&t.x<e.width&&t.y>=0&&t.y<e.height}_update(t){if(!this._map)return;this._map.transform.renderWorldCopies&&(this._lngLat=Cr(this._lngLat,this._pos,this._map.transform)),this._pos=this._map.project(this._lngLat)._add(this._transformedOffset());let e="";"viewport"===this._rotationAlignment||"auto"===this._rotationAlignment?e=`rotateZ(${this._rotation}deg)`:"map"===this._rotationAlignment&&(e=`rotateZ(${this._rotation-this._map.getBearing()}deg)`);let n="";"viewport"===this._pitchAlignment||"auto"===this._pitchAlignment?n="rotateX(0deg)":"map"===this._pitchAlignment&&(n=`rotateX(${this._map.getPitch()}deg)`),t&&"moveend"!==t.type||(this._pos=this._pos.round()),this._map._requestDomTask(()=>{this._map&&(this._element&&this._pos&&this._anchor&&o.setTransform(this._element,`${Tr[this._anchor]} translate(${this._pos.x}px, ${this._pos.y}px) ${n} ${e}`),!this._map.getTerrain()&&!this._map.getFog()||this._fadeTimer||(this._fadeTimer=setTimeout(this._evaluateOpacity.bind(this),60)))})}_transformedOffset(){if(!this._defaultMarker)return this._offset;const t=this._map.transform,e=this._offset.mult(this._scale);return"map"===this._rotationAlignment&&e._rotate(t.angle),"map"===this._pitchAlignment&&(e.y*=Math.cos(t._pitch)),e}getOffset(){return this._offset}setOffset(e){return this._offset=t.pointGeometry.convert(e),this._update(),this}_onMove(e){if(!this._isDragging){const t=this._clickTolerance||this._map._clickTolerance;this._isDragging=e.point.dist(this._pointerdownPos)>=t}this._isDragging&&(this._pos=e.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none","pending"===this._state&&(this._state="active",this.fire(new t.Event("dragstart"))),this.fire(new t.Event("drag")))}_onUp(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),"active"===this._state&&this.fire(new t.Event("dragend")),this._state="inactive"}_addDragHandler(t){this._element.contains(t.originalEvent.target)&&(t.preventDefault(),this._positionDelta=t.point.sub(this._pos).add(this._transformedOffset()),this._pointerdownPos=t.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))}setDraggable(t){return this._draggable=!!t,this._map&&(t?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(t){return this._rotation=t||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(t){return this._rotationAlignment=t||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment}setPitchAlignment(t){return this._pitchAlignment=t&&"auto"!==t?t:this._rotationAlignment,this._update(),this}getPitchAlignment(){return this._pitchAlignment}}class kr{constructor(t){this.jumpTo(t)}getValue(e){if(e<=this._startTime)return this._start;if(e>=this._endTime)return this._end;const n=t.easeCubicInOut((e-this._startTime)/(this._endTime-this._startTime));return this._start*(1-n)+this._end*n}isEasing(t){return t>=this._startTime&&t<=this._endTime}jumpTo(t){this._startTime=-1/0,this._endTime=-1/0,this._start=t,this._end=t}easeTo(t,e,n){this._start=this.getValue(e),this._end=t,this._startTime=e,this._endTime=e+n}}const Ar={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm"},{HTMLImageElement:Ir,HTMLElement:Pr,ImageBitmap:Mr}=t.window,Or={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:85,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,optimizeForTerrain:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",localFontFamily:null,transformRequest:null,accessToken:null,fadeDuration:300,crossSourceCollisions:!0};function zr(t){t.parentNode&&t.parentNode.removeChild(t)}const Dr={showCompass:!0,showZoom:!0,visualizePitch:!1};class Lr{constructor(e,n,i=!1){this._clickTolerance=10,this.element=n,this.mouseRotate=new Zi({clickTolerance:e.dragRotate._mouseRotate._clickTolerance}),this.map=e,i&&(this.mousePitch=new Hi({clickTolerance:e.dragRotate._mousePitch._clickTolerance})),t.bindAll(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),o.addEventListener(n,"mousedown",this.mousedown),o.addEventListener(n,"touchstart",this.touchstart,{passive:!1}),o.addEventListener(n,"touchmove",this.touchmove),o.addEventListener(n,"touchend",this.touchend),o.addEventListener(n,"touchcancel",this.reset)}down(t,e){this.mouseRotate.mousedown(t,e),this.mousePitch&&this.mousePitch.mousedown(t,e),o.disableDrag()}move(t,e){const n=this.map,i=this.mouseRotate.mousemoveWindow(t,e);if(i&&i.bearingDelta&&n.setBearing(n.getBearing()+i.bearingDelta),this.mousePitch){const i=this.mousePitch.mousemoveWindow(t,e);i&&i.pitchDelta&&n.setPitch(n.getPitch()+i.pitchDelta)}}off(){const t=this.element;o.removeEventListener(t,"mousedown",this.mousedown),o.removeEventListener(t,"touchstart",this.touchstart,{passive:!1}),o.removeEventListener(t,"touchmove",this.touchmove),o.removeEventListener(t,"touchend",this.touchend),o.removeEventListener(t,"touchcancel",this.reset),this.offTemp()}offTemp(){o.enableDrag(),o.removeEventListener(t.window,"mousemove",this.mousemove),o.removeEventListener(t.window,"mouseup",this.mouseup)}mousedown(e){this.down(t.extend({},e,{ctrlKey:!0,preventDefault:()=>e.preventDefault()}),o.mousePos(this.element,e)),o.addEventListener(t.window,"mousemove",this.mousemove),o.addEventListener(t.window,"mouseup",this.mouseup)}mousemove(t){this.move(t,o.mousePos(this.element,t))}mouseup(t){this.mouseRotate.mouseupWindow(t),this.mousePitch&&this.mousePitch.mouseupWindow(t),this.offTemp()}touchstart(t){1!==t.targetTouches.length?this.reset():(this._startPos=this._lastPos=o.touchPos(this.element,t.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:()=>t.preventDefault()},this._startPos))}touchmove(t){1!==t.targetTouches.length?this.reset():(this._lastPos=o.touchPos(this.element,t.targetTouches)[0],this.move({preventDefault:()=>t.preventDefault()},this._lastPos))}touchend(t){0===t.targetTouches.length&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()}reset(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()}}const Rr={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0};let Fr,Br=0,Vr=!1;const Ur={maxWidth:100,unit:"metric"};function Nr(t,e,n){const i=n&&n.maxWidth||100,r=t._container.clientHeight/2,o=t.unproject([0,r]),s=t.unproject([i,r]),a=o.distanceTo(s);if(n&&"imperial"===n.unit){const n=3.2808*a;n>5280?jr(e,i,n/5280,t._getUIString("ScaleControl.Miles"),t):jr(e,i,n,t._getUIString("ScaleControl.Feet"),t)}else n&&"nautical"===n.unit?jr(e,i,a/1852,t._getUIString("ScaleControl.NauticalMiles"),t):a>=1e3?jr(e,i,a/1e3,t._getUIString("ScaleControl.Kilometers"),t):jr(e,i,a,t._getUIString("ScaleControl.Meters"),t)}function jr(t,e,n,i,r){const o=function(t){const e=Math.pow(10,(""+Math.floor(t)).length-1);let n=t/e;return n=n>=10?10:n>=5?5:n>=3?3:n>=2?2:n>=1?1:function(t){const e=Math.pow(10,Math.ceil(-Math.log(t)/Math.LN10));return Math.round(t*e)/e}(n),e*n}(n),s=o/n;r._requestDomTask(()=>{t.style.width=e*s+"px",t.innerHTML=`${o}&nbsp;${i}`})}const qr={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px"},$r=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function Gr(e){if(e){if("number"==typeof e){const n=Math.round(Math.sqrt(.5*Math.pow(e,2)));return{center:new t.pointGeometry(0,0),top:new t.pointGeometry(0,e),"top-left":new t.pointGeometry(n,n),"top-right":new t.pointGeometry(-n,n),bottom:new t.pointGeometry(0,-e),"bottom-left":new t.pointGeometry(n,-n),"bottom-right":new t.pointGeometry(-n,-n),left:new t.pointGeometry(e,0),right:new t.pointGeometry(-e,0)}}if(e instanceof t.pointGeometry||Array.isArray(e)){const n=t.pointGeometry.convert(e);return{center:n,top:n,"top-left":n,"top-right":n,bottom:n,"bottom-left":n,"bottom-right":n,left:n,right:n}}return{center:t.pointGeometry.convert(e.center||[0,0]),top:t.pointGeometry.convert(e.top||[0,0]),"top-left":t.pointGeometry.convert(e["top-left"]||[0,0]),"top-right":t.pointGeometry.convert(e["top-right"]||[0,0]),bottom:t.pointGeometry.convert(e.bottom||[0,0]),"bottom-left":t.pointGeometry.convert(e["bottom-left"]||[0,0]),"bottom-right":t.pointGeometry.convert(e["bottom-right"]||[0,0]),left:t.pointGeometry.convert(e.left||[0,0]),right:t.pointGeometry.convert(e.right||[0,0])}}return Gr(new t.pointGeometry(0,0))}const Zr={version:t.version,supported:e,setRTLTextPlugin:t.setRTLTextPlugin,getRTLTextPluginStatus:t.getRTLTextPluginStatus,Map:class extends vr{constructor(e){if(null!=(e=t.extend({},Or,e)).minZoom&&null!=e.maxZoom&&e.minZoom>e.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(null!=e.minPitch&&null!=e.maxPitch&&e.minPitch>e.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(null!=e.minPitch&&e.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(null!=e.maxPitch&&e.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(super(new Ci(e.minZoom,e.maxZoom,e.minPitch,e.maxPitch,e.renderWorldCopies),e),this._interactive=e.interactive,this._maxTileCacheSize=e.maxTileCacheSize,this._failIfMajorPerformanceCaveat=e.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=e.preserveDrawingBuffer,this._antialias=e.antialias,this._trackResize=e.trackResize,this._bearingSnap=e.bearingSnap,this._refreshExpiredTiles=e.refreshExpiredTiles,this._fadeDuration=e.fadeDuration,this._isInitialLoad=!0,this._crossSourceCollisions=e.crossSourceCollisions,this._crossFadingFactor=1,this._collectResourceTiming=e.collectResourceTiming,this._optimizeForTerrain=e.optimizeForTerrain,this._renderTaskQueue=new wr,this._domRenderTaskQueue=new wr,this._controls=[],this._markers=[],this._mapId=t.uniqueId(),this._locale=t.extend({},Ar,e.locale),this._clickTolerance=e.clickTolerance,this._averageElevationLastSampledAt=-1/0,this._averageElevation=new kr(0),this._requestManager=new t.RequestManager(e.transformRequest,e.accessToken,e.testMode),this._silenceAuthErrors=!!e.testMode,"string"==typeof e.container){if(this._container=t.window.document.getElementById(e.container),!this._container)throw new Error(`Container '${e.container}' not found.`)}else{if(!(e.container instanceof Pr))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=e.container}if(e.maxBounds&&this.setMaxBounds(e.maxBounds),t.bindAll(["_onWindowOnline","_onWindowResize","_onMapScroll","_contextLost","_contextRestored"],this),this._setupContainer(),this._setupPainter(),void 0===this.painter)throw new Error("Failed to initialize WebGL.");this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),void 0!==t.window&&(t.window.addEventListener("online",this._onWindowOnline,!1),t.window.addEventListener("resize",this._onWindowResize,!1),t.window.addEventListener("orientationchange",this._onWindowResize,!1)),this.handlers=new yr(this,e),this._hash=e.hash&&new Ti("string"==typeof e.hash&&e.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:e.center,zoom:e.zoom,bearing:e.bearing,pitch:e.pitch}),e.bounds&&(this.resize(),this.fitBounds(e.bounds,t.extend({},e.fitBoundsOptions,{duration:0})))),this.resize(),this._localFontFamily=e.localFontFamily,this._localIdeographFontFamily=e.localIdeographFontFamily,e.style&&this.setStyle(e.style,{localFontFamily:this._localFontFamily,localIdeographFontFamily:this._localIdeographFontFamily}),e.attributionControl&&this.addControl(new xr({customAttribution:e.customAttribution})),this._logoControl=new br,this.addControl(this._logoControl,e.logoPosition),this.on("style.load",()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet)}),this.on("data",e=>{this._update("style"===e.dataType),this.fire(new t.Event(e.dataType+"data",e))}),this.on("dataloading",e=>{this.fire(new t.Event(e.dataType+"dataloading",e))})}_getMapId(){return this._mapId}addControl(e,n){if(void 0===n&&(n=e.getDefaultPosition?e.getDefaultPosition():"top-right"),!e||!e.onAdd)return this.fire(new t.ErrorEvent(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const i=e.onAdd(this);this._controls.push(e);const r=this._controlPositions[n];return-1!==n.indexOf("bottom")?r.insertBefore(i,r.firstChild):r.appendChild(i),this}removeControl(e){if(!e||!e.onRemove)return this.fire(new t.ErrorEvent(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const n=this._controls.indexOf(e);return n>-1&&this._controls.splice(n,1),e.onRemove(this),this}hasControl(t){return this._controls.indexOf(t)>-1}resize(e){const n=this._containerDimensions(),i=n[0],r=n[1];this._resizeCanvas(i,r),this.transform.resize(i,r),this.painter.resize(i,r);const o=!this._moving;return o&&(this.stop(),this.fire(new t.Event("movestart",e)).fire(new t.Event("move",e))),this.fire(new t.Event("resize",e)),o&&this.fire(new t.Event("moveend",e)),this}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()}setMaxBounds(e){return this.transform.setMaxBounds(t.LngLatBounds.convert(e)),this._update()}setMinZoom(t){if((t=null==t?-2:t)>=-2&&t<=this.transform.maxZoom)return this.transform.minZoom=t,this._update(),this.getZoom()<t&&this.setZoom(t),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(t){if((t=null==t?22:t)>=this.transform.minZoom)return this.transform.maxZoom=t,this._update(),this.getZoom()>t&&this.setZoom(t),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(t){if((t=null==t?0:t)<0)throw new Error("minPitch must be greater than or equal to 0");if(t>=0&&t<=this.transform.maxPitch)return this.transform.minPitch=t,this._update(),this.getPitch()<t&&this.setPitch(t),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(t){if((t=null==t?85:t)>85)throw new Error("maxPitch must be less than or equal to 85");if(t>=this.transform.minPitch)return this.transform.maxPitch=t,this._update(),this.getPitch()>t&&this.setPitch(t),this;throw new Error("maxPitch must be greater than the current minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(t){return this.transform.renderWorldCopies=t,this._update()}project(e){return this.transform.locationPoint3D(t.LngLat.convert(e))}unproject(e){return this.transform.pointLocation3D(t.pointGeometry.convert(e))}isMoving(){return this._moving||this.handlers&&this.handlers.isMoving()}isZooming(){return this._zooming||this.handlers&&this.handlers.isZooming()}isRotating(){return this._rotating||this.handlers&&this.handlers.isRotating()}_createDelegatedListener(t,e,n){if("mouseenter"===t||"mouseover"===t){let i=!1;const r=r=>{const o=this.getLayer(e)?this.queryRenderedFeatures(r.point,{layers:[e]}):[];o.length?i||(i=!0,n.call(this,new zi(t,this,r.originalEvent,{features:o}))):i=!1};return{layer:e,listener:n,delegates:{mousemove:r,mouseout:()=>{i=!1}}}}if("mouseleave"===t||"mouseout"===t){let i=!1;const r=r=>{(this.getLayer(e)?this.queryRenderedFeatures(r.point,{layers:[e]}):[]).length?i=!0:i&&(i=!1,n.call(this,new zi(t,this,r.originalEvent)))},o=e=>{i&&(i=!1,n.call(this,new zi(t,this,e.originalEvent)))};return{layer:e,listener:n,delegates:{mousemove:r,mouseout:o}}}{const i=t=>{const i=this.getLayer(e)?this.queryRenderedFeatures(t.point,{layers:[e]}):[];i.length&&(t.features=i,n.call(this,t),delete t.features)};return{layer:e,listener:n,delegates:{[t]:i}}}}on(t,e,n){if(void 0===n)return super.on(t,e);const i=this._createDelegatedListener(t,e,n);this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[t]=this._delegatedListeners[t]||[],this._delegatedListeners[t].push(i);for(const r in i.delegates)this.on(r,i.delegates[r]);return this}once(t,e,n){if(void 0===n)return super.once(t,e);const i=this._createDelegatedListener(t,e,n);for(const r in i.delegates)this.once(r,i.delegates[r]);return this}off(t,e,n){return void 0===n?super.off(t,e):(this._delegatedListeners&&this._delegatedListeners[t]&&(i=>{const r=this._delegatedListeners[t];for(let t=0;t<r.length;t++){const i=r[t];if(i.layer===e&&i.listener===n){for(const t in i.delegates)this.off(t,i.delegates[t]);return r.splice(t,1),this}}})(),this)}queryRenderedFeatures(e,n){return this.style?(void 0!==n||void 0===e||e instanceof t.pointGeometry||Array.isArray(e)||(n=e,e=void 0),this.style.queryRenderedFeatures(e=e||[[0,0],[this.transform.width,this.transform.height]],n=n||{},this.transform)):[]}querySourceFeatures(t,e){return this.style.querySourceFeatures(t,e)}setStyle(e,n){return!1!==(n=t.extend({},{localIdeographFontFamily:this._localIdeographFontFamily,localFontFamily:this._localFontFamily},n)).diff&&n.localIdeographFontFamily===this._localIdeographFontFamily&&n.localFontFamily===this._localFontFamily&&this.style&&e?(this._diffStyle(e,n),this):(this._localIdeographFontFamily=n.localIdeographFontFamily,this._localFontFamily=n.localFontFamily,this._updateStyle(e,n))}_getUIString(t){const e=this._locale[t];if(null==e)throw new Error(`Missing UI string '${t}'`);return e}_updateStyle(t,e){return this.style&&(this.style.setEventedParent(null),this.style._remove(),delete this.style),t&&(this.style=new Ne(this,e||{}),this.style.setEventedParent(this,{style:this.style}),"string"==typeof t?this.style.loadURL(t):this.style.loadJSON(t)),this._updateTerrain(),this}_lazyInitEmptyStyle(){this.style||(this.style=new Ne(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(e,n){if("string"==typeof e){const i=this._requestManager.normalizeStyleURL(e),r=this._requestManager.transformRequest(i,t.ResourceType.Style);t.getJSON(r,(e,i)=>{e?this.fire(new t.ErrorEvent(e)):i&&this._updateDiff(i,n)})}else"object"==typeof e&&this._updateDiff(e,n)}_updateDiff(e,n){try{this.style.setState(e)&&this._update(!0)}catch(i){t.warnOnce(`Unable to perform style diff: ${i.message||i.error||i}.  Rebuilding the style from scratch.`),this._updateStyle(e,n)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():t.warnOnce("There is no style added to the map.")}addSource(t,e){return this._lazyInitEmptyStyle(),this.style.addSource(t,e),this._update(!0)}isSourceLoaded(e){const n=this.style&&this.style._getSourceCaches(e);if(0!==n.length)return n.every(t=>t.loaded());this.fire(new t.ErrorEvent(new Error(`There is no source with ID '${e}'`)))}areTilesLoaded(){const t=this.style&&this.style._sourceCaches;for(const e in t){const n=t[e]._tiles;for(const t in n){const e=n[t];if("loaded"!==e.state&&"errored"!==e.state)return!1}}return!0}addSourceType(t,e,n){return this._lazyInitEmptyStyle(),this.style.addSourceType(t,e,n)}removeSource(t){return this.style.removeSource(t),this._updateTerrain(),this._update(!0)}getSource(t){return this.style.getSource(t)}addImage(e,n,{pixelRatio:i=1,sdf:r=!1,stretchX:o,stretchY:s,content:a}={}){if(this._lazyInitEmptyStyle(),n instanceof Ir||Mr&&n instanceof Mr){const{width:l,height:c,data:u}=t.exported.getImageData(n);this.style.addImage(e,{data:new t.RGBAImage({width:l,height:c},u),pixelRatio:i,stretchX:o,stretchY:s,content:a,sdf:r,version:0})}else{if(void 0===n.width||void 0===n.height)return this.fire(new t.ErrorEvent(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));{const{width:l,height:c,data:u}=n,h=n;this.style.addImage(e,{data:new t.RGBAImage({width:l,height:c},new Uint8Array(u)),pixelRatio:i,stretchX:o,stretchY:s,content:a,sdf:r,version:0,userImage:h}),h.onAdd&&h.onAdd(this,e)}}}updateImage(e,n){const i=this.style.getImage(e);if(!i)return this.fire(new t.ErrorEvent(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const r=n instanceof Ir||Mr&&n instanceof Mr?t.exported.getImageData(n):n,{width:o,height:s,data:a}=r;return void 0===o||void 0===s?this.fire(new t.ErrorEvent(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`"))):o!==i.data.width||s!==i.data.height?this.fire(new t.ErrorEvent(new Error("The width and height of the updated image must be that same as the previous version of the image"))):(i.data.replace(a,!(n instanceof Ir||Mr&&n instanceof Mr)),void this.style.updateImage(e,i))}hasImage(e){return e?!!this.style.getImage(e):(this.fire(new t.ErrorEvent(new Error("Missing required image id"))),!1)}removeImage(t){this.style.removeImage(t)}loadImage(e,n){t.getImage(this._requestManager.transformRequest(e,t.ResourceType.Image),(e,i)=>{n(e,i instanceof Ir?t.exported.getImageData(i):i)})}listImages(){return this.style.listImages()}addLayer(t,e){return this._lazyInitEmptyStyle(),this.style.addLayer(t,e),this._update(!0)}moveLayer(t,e){return this.style.moveLayer(t,e),this._update(!0)}removeLayer(t){return this.style.removeLayer(t),this._update(!0)}getLayer(t){return this.style.getLayer(t)}setLayerZoomRange(t,e,n){return this.style.setLayerZoomRange(t,e,n),this._update(!0)}setFilter(t,e,n={}){return this.style.setFilter(t,e,n),this._update(!0)}getFilter(t){return this.style.getFilter(t)}setPaintProperty(t,e,n,i={}){return this.style.setPaintProperty(t,e,n,i),this._update(!0)}getPaintProperty(t,e){return this.style.getPaintProperty(t,e)}setLayoutProperty(t,e,n,i={}){return this.style.setLayoutProperty(t,e,n,i),this._update(!0)}getLayoutProperty(t,e){return this.style.getLayoutProperty(t,e)}setLight(t,e={}){return this._lazyInitEmptyStyle(),this.style.setLight(t,e),this._update(!0)}getLight(){return this.style.getLight()}setTerrain(t){return this._lazyInitEmptyStyle(),this.style.setTerrain(t),this._averageElevationLastSampledAt=-1/0,this._update(!0)}getTerrain(){return this.style?this.style.getTerrain():null}setFog(t){return this._lazyInitEmptyStyle(),this.style.setFog(t),this._update(!0)}getFog(){return this.style?this.style.getFog():null}_queryFogOpacity(e){return this.style&&this.style.fog?this.style.fog.getOpacityAtLatLng(t.LngLat.convert(e),this.transform):0}queryTerrainElevation(e,n){const i=this.transform.elevation;return i?(n=t.extend({},{exaggerated:!0},n),i.getAtPoint(t.MercatorCoordinate.fromLngLat(e),null,n.exaggerated)):null}setFeatureState(t,e){return this.style.setFeatureState(t,e),this._update()}removeFeatureState(t,e){return this.style.removeFeatureState(t,e),this._update()}getFeatureState(t){return this.style.getFeatureState(t)}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}_containerDimensions(){let t=0,e=0;return this._container&&(t=this._container.clientWidth||400,e=this._container.clientHeight||300),[t,e]}_detectMissingCSS(){"rgb(250, 128, 114)"!==t.window.getComputedStyle(this._missingCSSCanary).getPropertyValue("background-color")&&t.warnOnce("This page appears to be missing CSS declarations for Mapbox GL JS, which may cause the map to display incorrectly. Please ensure your page includes mapbox-gl.css, as described in https://www.mapbox.com/mapbox-gl-js/api/.")}_setupContainer(){const t=this._container;t.classList.add("mapboxgl-map"),(this._missingCSSCanary=o.create("div","mapboxgl-canary",t)).style.visibility="hidden",this._detectMissingCSS();const e=this._canvasContainer=o.create("div","mapboxgl-canvas-container",t);this._interactive&&e.classList.add("mapboxgl-interactive"),this._canvas=o.create("canvas","mapboxgl-canvas",e),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label","Map"),this._canvas.setAttribute("role","region");const n=this._containerDimensions();this._resizeCanvas(n[0],n[1]);const i=this._controlContainer=o.create("div","mapboxgl-control-container",t),r=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(t=>{r[t]=o.create("div","mapboxgl-ctrl-"+t,i)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(e,n){const i=t.exported.devicePixelRatio||1;this._canvas.width=i*e,this._canvas.height=i*n,this._canvas.style.width=e+"px",this._canvas.style.height=n+"px"}_addMarker(t){this._markers.push(t)}_removeMarker(t){const e=this._markers.indexOf(t);-1!==e&&this._markers.splice(e,1)}_setupPainter(){const n=t.extend({},e.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),i=this._canvas.getContext("webgl",n)||this._canvas.getContext("experimental-webgl",n);i?(t.storeAuthState(i,!0),this.painter=new pi(i,this.transform),this.on("data",t=>{"source"===t.dataType&&this.painter.setTileLoadedFlag(!0)}),t.exported$1.testSupport(i)):this.fire(new t.ErrorEvent(new Error("Failed to initialize WebGL")))}_contextLost(e){e.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new t.Event("webglcontextlost",{originalEvent:e}))}_contextRestored(e){this._setupPainter(),this.resize(),this._update(),this.fire(new t.Event("webglcontextrestored",{originalEvent:e}))}_onMapScroll(t){if(t.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(t){return this.style?(this._styleDirty=this._styleDirty||t,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(t){return this._update(),this._renderTaskQueue.add(t)}_cancelRenderFrame(t){this._renderTaskQueue.remove(t)}_requestDomTask(t){!this.isMoving()&&this.loaded()?t():this._domRenderTaskQueue.add(t)}_render(e){let n;const i=this.painter.context.extTimerQuery,r=t.exported.now();this.listens("gpu-timing-frame")&&(n=i.createQueryEXT(),i.beginQueryEXT(i.TIME_ELAPSED_EXT,n));let o=this._updateAverageElevation(r);if(this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(e),this._domRenderTaskQueue.run(e),this._removed)return;let s=!1;const a=this._isInitialLoad?0:this._fadeDuration;if(this.style&&this._styleDirty){this._styleDirty=!1;const e=this.transform.zoom,n=t.exported.now();this.style.zoomHistory.update(e,n);const i=new t.EvaluationParameters(e,{now:n,fadeDuration:a,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),r=i.crossFadingFactor();1===r&&r===this._crossFadingFactor||(s=!0,this._crossFadingFactor=r),this.style.update(i)}if(this.style&&this.style.fog&&this.style.fog.hasTransition()&&(this.style._markersNeedUpdate=!0,this._sourcesDirty=!0),this.style&&this._sourcesDirty&&(this._sourcesDirty=!1,this.painter._updateFog(this.style),this._updateTerrain(),this.style._updateSources(this.transform)),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,a,this._crossSourceCollisions),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showTerrainWireframe:this.showTerrainWireframe,showOverdrawInspector:this._showOverdrawInspector,showQueryGeometry:!!this._showQueryGeometry,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:a,isInitialLoad:this._isInitialLoad,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer"),speedIndexTiming:this.speedIndexTiming}),this.fire(new t.Event("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,this.fire(new t.Event("load"))),this.style&&(this.style.hasTransitions()||s)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),this.listens("gpu-timing-frame")){const e=t.exported.now()-r;i.endQueryEXT(i.TIME_ELAPSED_EXT,n),setTimeout(()=>{const r=i.getQueryObjectEXT(n,i.QUERY_RESULT_EXT)/1e6;i.deleteQueryEXT(n),this.fire(new t.Event("gpu-timing-frame",{cpuTime:e,gpuTime:r}))},50)}if(this.listens("gpu-timing-layer")){const e=this.painter.collectGpuTimers();setTimeout(()=>{const n=this.painter.queryGpuTimers(e);this.fire(new t.Event("gpu-timing-layer",{layerTimes:n}))},50)}const l=this._sourcesDirty||this._styleDirty||this._placementDirty||o;if(l||this._repaint)this.triggerRepaint();else{const e=!this.isMoving()&&this.loaded();if(e&&(o=this._updateAverageElevation(r,!0)),o)this.triggerRepaint();else if(this._triggerFrame(!1),e&&(this.fire(new t.Event("idle")),this._isInitialLoad=!1,this.speedIndexTiming)){const e=this._calculateSpeedIndex();this.fire(new t.Event("speedindexcompleted",{speedIndex:e})),this.speedIndexTiming=!1}}return!this._loaded||this._fullyLoaded||l||(this._fullyLoaded=!0,this._authenticate()),this}_updateAverageElevation(t,e=!1){const n=t=>(this.transform.averageElevation=t,this._update(!1),!0);if(!this.painter.averageElevationNeedsEasing())return 0!==this.transform.averageElevation&&n(0);if((e||t-this._averageElevationLastSampledAt>500)&&!this._averageElevation.isEasing(t)){const e=this.transform.averageElevation;let i=this.transform.sampleAverageElevation();isNaN(i)?i=0:this._averageElevationLastSampledAt=t;const r=Math.abs(e-i);if(r>1)this._averageElevation.easeTo(i,t,300);else if(r>1e-4)return this._averageElevation.jumpTo(i),n(i)}return!!this._averageElevation.isEasing(t)&&n(this._averageElevation.getValue(t))}_authenticate(){t.getMapSessionAPI(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,e=>{if(e&&(e.message===t.AUTH_ERR_MSG||401===e.status)){const e=this.painter.context.gl;t.storeAuthState(e,!1),this._logoControl instanceof br&&this._logoControl._updateLogo(),e&&e.clear(e.DEPTH_BUFFER_BIT|e.COLOR_BUFFER_BIT|e.STENCIL_BUFFER_BIT),this._silenceAuthErrors||this.fire(new t.ErrorEvent(new Error("A valid Mapbox access token is required to use Mapbox GL JS. To create an account or a new access token, visit https://account.mapbox.com/")))}}),t.postMapLoadEvent(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,()=>{})}_updateTerrain(){this.painter.updateTerrain(this.style,this.isMoving()||this.isRotating()||this.isZooming())}_calculateSpeedIndex(){const t=this.painter.canvasCopy(),e=this.painter.getCanvasCopiesAndTimestamps();e.timeStamps.push(performance.now());const n=this.painter.context.gl,i=n.createFramebuffer();function r(t){n.framebufferTexture2D(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,t,0);const e=new Uint8Array(n.drawingBufferWidth*n.drawingBufferHeight*4);return n.readPixels(0,0,n.drawingBufferWidth,n.drawingBufferHeight,n.RGBA,n.UNSIGNED_BYTE,e),e}return n.bindFramebuffer(n.FRAMEBUFFER,i),this._canvasPixelComparison(r(t),e.canvasCopies.map(r),e.timeStamps)}_canvasPixelComparison(t,e,n){let i=n[1]-n[0];const r=t.length/4;for(let o=0;o<e.length;o++){const s=e[o];let a=0;for(let e=0;e<s.length;e+=4)s[e]===t[e]&&s[e+1]===t[e+1]&&s[e+2]===t[e+2]&&s[e+3]===t[e+3]&&(a+=1);i+=(n[o+2]-n[o+1])*(1-a/r)}return i}remove(){this._hash&&this._hash.remove();for(const t of this._controls)t.onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this._domRenderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),void 0!==t.window&&(t.window.removeEventListener("resize",this._onWindowResize,!1),t.window.removeEventListener("orientationchange",this._onWindowResize,!1),t.window.removeEventListener("online",this._onWindowOnline,!1));const e=this.painter.context.gl.getExtension("WEBGL_lose_context");e&&e.loseContext(),zr(this._canvasContainer),zr(this._controlContainer),zr(this._missingCSSCanary),this._container.classList.remove("mapboxgl-map"),t.removeAuthState(this.painter.context.gl),this._removed=!0,this.fire(new t.Event("remove"))}triggerRepaint(){this._triggerFrame(!0)}_triggerFrame(e){this._renderNextFrame=this._renderNextFrame||e,this.style&&!this._frame&&(this._frame=t.exported.frame(t=>{const e=!!this._renderNextFrame;this._frame=null,this._renderNextFrame=null,e&&this._render(t)}))}_onWindowOnline(){this._update()}_onWindowResize(t){this._trackResize&&this.resize({originalEvent:t})._update()}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(t){this._showTileBoundaries!==t&&(this._showTileBoundaries=t,this._update())}get showTerrainWireframe(){return!!this._showTerrainWireframe}set showTerrainWireframe(t){this._showTerrainWireframe!==t&&(this._showTerrainWireframe=t,this._update())}get speedIndexTiming(){return!!this._speedIndexTiming}set speedIndexTiming(t){this._speedIndexTiming!==t&&(this._speedIndexTiming=t,this._update())}get showPadding(){return!!this._showPadding}set showPadding(t){this._showPadding!==t&&(this._showPadding=t,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(t){this._showCollisionBoxes!==t&&(this._showCollisionBoxes=t,t?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(t){this._showOverdrawInspector!==t&&(this._showOverdrawInspector=t,this._update())}get repaint(){return!!this._repaint}set repaint(t){this._repaint!==t&&(this._repaint=t,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(t){this._vertices=t,this._update()}_setCacheLimits(e,n){t.setCacheLimits(e,n)}get version(){return t.version}},NavigationControl:class{constructor(e){this.options=t.extend({},Dr,e),this._container=o.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",t=>t.preventDefault()),this.options.showZoom&&(t.bindAll(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("mapboxgl-ctrl-zoom-in",t=>this._map.zoomIn({},{originalEvent:t})),o.create("span","mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden",!0),this._zoomOutButton=this._createButton("mapboxgl-ctrl-zoom-out",t=>this._map.zoomOut({},{originalEvent:t})),o.create("span","mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden",!0)),this.options.showCompass&&(t.bindAll(["_rotateCompassArrow"],this),this._compass=this._createButton("mapboxgl-ctrl-compass",t=>{this.options.visualizePitch?this._map.resetNorthPitch({},{originalEvent:t}):this._map.resetNorth({},{originalEvent:t})}),this._compassIcon=o.create("span","mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden",!0))}_updateZoomButtons(){const t=this._map.getZoom(),e=t===this._map.getMaxZoom(),n=t===this._map.getMinZoom();this._zoomInButton.disabled=e,this._zoomOutButton.disabled=n,this._zoomInButton.setAttribute("aria-disabled",e.toString()),this._zoomOutButton.setAttribute("aria-disabled",n.toString())}_rotateCompassArrow(){const t=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(this._map.transform.pitch*(Math.PI/180)),.5)}) rotateX(${this._map.transform.pitch}deg) rotateZ(${this._map.transform.angle*(180/Math.PI)}deg)`:`rotate(${this._map.transform.angle*(180/Math.PI)}deg)`;this._map._requestDomTask(()=>{this._compassIcon&&(this._compassIcon.style.transform=t)})}onAdd(t){return this._map=t,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new Lr(this._map,this._compass,this.options.visualizePitch)),this._container}onRemove(){o.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map}_createButton(t,e){const n=o.create("button",t,this._container);return n.type="button",n.addEventListener("click",e),n}_setButtonTitle(t,e){const n=this._map._getUIString("NavigationControl."+e);t.title=n,t.setAttribute("aria-label",n)}},GeolocateControl:class extends t.Evented{constructor(e){super(),this.options=t.extend({},Rr,e),t.bindAll(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker"],this)}onAdd(e){var n;return this._map=e,this._container=o.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),n=this._setupUI,void 0!==Fr?n(Fr):void 0!==t.window.navigator.permissions?t.window.navigator.permissions.query({name:"geolocation"}).then(t=>{Fr="denied"!==t.state,n(Fr)}):(Fr=!!t.window.navigator.geolocation,n(Fr)),this._container}onRemove(){void 0!==this._geolocationWatchID&&(t.window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),o.remove(this._container),this._map.off("zoom",this._onZoom),this._map=void 0,Br=0,Vr=!1}_isOutOfMapMaxBounds(t){const e=this._map.getMaxBounds(),n=t.coords;return e&&(n.longitude<e.getWest()||n.longitude>e.getEast()||n.latitude<e.getSouth()||n.latitude>e.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting")}}_onSuccess(e){if(this._map){if(this._isOutOfMapMaxBounds(e))return this._setErrorState(),this.fire(new t.Event("outofmaxbounds",e)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=e,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background")}this.options.showUserLocation&&"OFF"!==this._watchState&&this._updateMarker(e),this.options.trackUserLocation&&"ACTIVE_LOCK"!==this._watchState||this._updateCamera(e),this.options.showUserLocation&&this._dotElement.classList.remove("mapboxgl-user-location-dot-stale"),this.fire(new t.Event("geolocate",e)),this._finish()}}_updateCamera(e){const n=new t.LngLat(e.coords.longitude,e.coords.latitude),i=e.coords.accuracy,r=this._map.getBearing(),o=t.extend({bearing:r},this.options.fitBoundsOptions);this._map.fitBounds(n.toBounds(i),o,{geolocateSource:!0})}_updateMarker(e){if(e){const n=new t.LngLat(e.coords.longitude,e.coords.latitude);this._accuracyCircleMarker.setLngLat(n).addTo(this._map),this._userLocationDotMarker.setLngLat(n).addTo(this._map),this._accuracy=e.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()}_updateCircleRadius(){const t=this._map._container.clientHeight/2,e=this._map.unproject([0,t]),n=this._map.unproject([100,t]),i=e.distanceTo(n)/100,r=Math.ceil(2*this._accuracy/i);this._circleElement.style.width=r+"px",this._circleElement.style.height=r+"px"}_onZoom(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}_onError(e){if(this._map){if(this.options.trackUserLocation)if(1===e.code){this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const t=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=t,this._geolocateButton.setAttribute("aria-label",t),void 0!==this._geolocationWatchID&&this._clearWatch()}else{if(3===e.code&&Vr)return;this._setErrorState()}"OFF"!==this._watchState&&this.options.showUserLocation&&this._dotElement.classList.add("mapboxgl-user-location-dot-stale"),this.fire(new t.Event("error",e)),this._finish()}}_finish(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0}_setupUI(e){if(this._container.addEventListener("contextmenu",t=>t.preventDefault()),this._geolocateButton=o.create("button","mapboxgl-ctrl-geolocate",this._container),o.create("span","mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden",!0),this._geolocateButton.type="button",!1===e){t.warnOnce("Geolocation support is not available so the GeolocateControl will be disabled.");const e=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=e,this._geolocateButton.setAttribute("aria-label",e)}else{const t=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.title=t,this._geolocateButton.setAttribute("aria-label",t)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=o.create("div","mapboxgl-user-location-dot"),this._userLocationDotMarker=new Er(this._dotElement),this._circleElement=o.create("div","mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new Er({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",e=>{e.geolocateSource||"ACTIVE_LOCK"!==this._watchState||e.originalEvent&&"resize"===e.originalEvent.type||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this.fire(new t.Event("trackuserlocationend")))})}trigger(){if(!this._setup)return t.warnOnce("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new t.Event("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":Br--,Vr=!1,this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this.fire(new t.Event("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new t.Event("trackuserlocationstart"))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error")}if("OFF"===this._watchState&&void 0!==this._geolocationWatchID)this._clearWatch();else if(void 0===this._geolocationWatchID){let e;this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),Br++,Br>1?(e={maximumAge:6e5,timeout:0},Vr=!0):(e=this.options.positionOptions,Vr=!1),this._geolocationWatchID=t.window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,e)}}else t.window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_clearWatch(){t.window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},AttributionControl:xr,ScaleControl:class{constructor(e){this.options=t.extend({},Ur,e),t.bindAll(["_onMove","setUnit"],this)}getDefaultPosition(){return"bottom-left"}_onMove(){Nr(this._map,this._container,this.options)}onAdd(t){return this._map=t,this._container=o.create("div","mapboxgl-ctrl mapboxgl-ctrl-scale",t.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container}onRemove(){o.remove(this._container),this._map.off("move",this._onMove),this._map=void 0}setUnit(t){this.options.unit=t,Nr(this._map,this._container,this.options)}},FullscreenControl:class{constructor(e){this._fullscreen=!1,e&&e.container&&(e.container instanceof t.window.HTMLElement?this._container=e.container:t.warnOnce("Full screen control 'container' must be a DOM element.")),t.bindAll(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in t.window.document?this._fullscreenchange="fullscreenchange":"onwebkitfullscreenchange"in t.window.document&&(this._fullscreenchange="webkitfullscreenchange")}onAdd(e){return this._map=e,this._container||(this._container=this._map.getContainer()),this._controlContainer=o.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",t.warnOnce("This device does not support fullscreen mode.")),this._controlContainer}onRemove(){o.remove(this._controlContainer),this._map=null,t.window.document.removeEventListener(this._fullscreenchange,this._changeIcon)}_checkFullscreenSupport(){return!(!t.window.document.fullscreenEnabled&&!t.window.document.webkitFullscreenEnabled)}_setupUI(){const e=this._fullscreenButton=o.create("button","mapboxgl-ctrl-fullscreen",this._controlContainer);o.create("span","mapboxgl-ctrl-icon",e).setAttribute("aria-hidden",!0),e.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),t.window.document.addEventListener(this._fullscreenchange,this._changeIcon)}_updateTitle(){const t=this._getTitle();this._fullscreenButton.setAttribute("aria-label",t),this._fullscreenButton.title=t}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_changeIcon(){(t.window.document.fullscreenElement||t.window.document.webkitFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())}_onClickFullscreen(){this._isFullscreen()?t.window.document.exitFullscreen?t.window.document.exitFullscreen():t.window.document.webkitCancelFullScreen&&t.window.document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()}},Popup:class extends t.Evented{constructor(e){super(),this.options=t.extend(Object.create(qr),e),t.bindAll(["_update","_onClose","remove","_onMouseMove","_onMouseUp","_onDrag"],this)}addTo(e){return this._map&&this.remove(),this._map=e,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.add("mapboxgl-track-pointer")):this._map.on("move",this._update),this.fire(new t.Event("open")),this}isOpen(){return!!this._map}remove(){return this._content&&o.remove(this._content),this._container&&(o.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),delete this._map),this.fire(new t.Event("close")),this}getLngLat(){return this._lngLat}setLngLat(e){return this._lngLat=t.LngLat.convert(e),this._pos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.remove("mapboxgl-track-pointer")),this}trackPointer(){return this._trackPointer=!0,this._pos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.add("mapboxgl-track-pointer")),this}getElement(){return this._container}setText(e){return this.setDOMContent(t.window.document.createTextNode(e))}setHTML(e){const n=t.window.document.createDocumentFragment(),i=t.window.document.createElement("body");let r;for(i.innerHTML=e;r=i.firstChild,r;)n.appendChild(r);return this.setDOMContent(n)}getMaxWidth(){return this._container&&this._container.style.maxWidth}setMaxWidth(t){return this.options.maxWidth=t,this._update(),this}setDOMContent(t){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=o.create("div","mapboxgl-popup-content",this._container);return this._content.appendChild(t),this._createCloseButton(),this._update(),this._focusFirstElement(),this}addClassName(t){this._container&&this._container.classList.add(t)}removeClassName(t){this._container&&this._container.classList.remove(t)}setOffset(t){return this.options.offset=t,this._update(),this}toggleClassName(t){if(this._container)return this._container.classList.toggle(t)}_createCloseButton(){this.options.closeButton&&(this._closeButton=o.create("button","mapboxgl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.setAttribute("aria-label","Close popup"),this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))}_onMouseUp(t){this._update(t.point)}_onMouseMove(t){this._update(t.point)}_onDrag(t){this._update(t.point)}_update(t){if(!this._map||!this._lngLat&&!this._trackPointer||!this._content)return;if(this._container||(this._container=o.create("div","mapboxgl-popup",this._map.getContainer()),this._tip=o.create("div","mapboxgl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className&&this.options.className.split(" ").forEach(t=>this._container.classList.add(t)),this._trackPointer&&this._container.classList.add("mapboxgl-popup-track-pointer")),this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._map.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=Cr(this._lngLat,this._pos,this._map.transform)),this._trackPointer&&!t)return;const e=this._pos=this._trackPointer&&t?t:this._map.project(this._lngLat);let n=this.options.anchor;const i=Gr(this.options.offset);if(!n){const t=this._container.offsetWidth,r=this._container.offsetHeight;let o;o=e.y+i.bottom.y<r?["top"]:e.y>this._map.transform.height-r?["bottom"]:[],e.x<t/2?o.push("left"):e.x>this._map.transform.width-t/2&&o.push("right"),n=0===o.length?"bottom":o.join("-")}const r=e.add(i[n]).round();this._map._requestDomTask(()=>{this._container&&n&&(o.setTransform(this._container,`${Tr[n]} translate(${r.x}px,${r.y}px)`),Sr(this._container,n,"popup"))})}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const t=this._container.querySelector($r);t&&t.focus()}_onClose(){this.remove()}_setOpacity(t){this._content&&(this._content.style.opacity=t),this._tip&&(this._tip.style.opacity=t)}},Marker:Er,Style:Ne,LngLat:t.LngLat,LngLatBounds:t.LngLatBounds,Point:t.pointGeometry,MercatorCoordinate:t.MercatorCoordinate,FreeCameraOptions:bi,Evented:t.Evented,config:t.config,prewarm:function(){Lt().acquire(Ot)},clearPrewarmedResources:function(){const t=Dt;t&&(t.isPreloaded()&&1===t.numActive()?(t.release(Ot),Dt=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},get accessToken(){return t.config.ACCESS_TOKEN},set accessToken(e){t.config.ACCESS_TOKEN=e},get baseApiUrl(){return t.config.API_URL},set baseApiUrl(e){t.config.API_URL=e},get workerCount(){return zt.workerCount},set workerCount(t){zt.workerCount=t},get maxParallelImageRequests(){return t.config.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(e){t.config.MAX_PARALLEL_IMAGE_REQUESTS=e},clearStorage(e){t.clearTileCache(e)},workerUrl:"",workerClass:null,setNow:t.exported.setNow,restoreNow:t.exported.restoreNow};return Zr}),n}()},PSD3:function(t,e,n){t.exports=function(){"use strict";function t(e){return(t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(e)}function e(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function n(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function i(t,e,i){return e&&n(t.prototype,e),i&&n(t,i),t}function r(){return(r=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t}).apply(this,arguments)}function o(t){return(o=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function s(t,e){return(s=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function a(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}function l(t,e,n){return(l=a()?Reflect.construct:function(t,e,n){var i=[null];i.push.apply(i,e);var r=new(Function.bind.apply(t,i));return n&&s(r,n.prototype),r}).apply(null,arguments)}function c(t,e){return!e||"object"!=typeof e&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function u(t,e,n){return(u="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var i=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=o(t)););return t}(t,e);if(i){var r=Object.getOwnPropertyDescriptor(i,e);return r.get?r.get.call(n):r.value}})(t,e,n||t)}var h=function(t){return t.charAt(0).toUpperCase()+t.slice(1)},d=function(t){return Object.keys(t).map(function(e){return t[e]})},p=function(t){return Array.prototype.slice.call(t)},f=function(e){console.warn("".concat("SweetAlert2:"," ").concat("object"===t(e)?e.join(" "):e))},m=function(t){console.error("".concat("SweetAlert2:"," ").concat(t))},g=[],_=function(t){return"function"==typeof t?t():t},y=function(t){return t&&"function"==typeof t.toPromise},v=function(t){return y(t)?t.toPromise():Promise.resolve(t)},x=function(t){return t&&Promise.resolve(t)===t},b=Object.freeze({cancel:"cancel",backdrop:"backdrop",close:"close",esc:"esc",timer:"timer"}),w=function(e){return e instanceof Element||function(e){return"object"===t(e)&&e.jquery}(e)},C=function(t){var e={};for(var n in t)e[t[n]]="swal2-"+t[n];return e},T=C(["container","shown","height-auto","iosfix","popup","modal","no-backdrop","no-transition","toast","toast-shown","toast-column","show","hide","close","title","header","content","html-container","actions","confirm","deny","cancel","footer","icon","icon-content","image","input","file","range","select","radio","checkbox","label","textarea","inputerror","input-label","validation-message","progress-steps","active-progress-step","progress-step","progress-step-line","loader","loading","styled","top","top-start","top-end","top-left","top-right","center","center-start","center-end","center-left","center-right","bottom","bottom-start","bottom-end","bottom-left","bottom-right","grow-row","grow-column","grow-fullscreen","rtl","timer-progress-bar","timer-progress-bar-container","scrollbar-measure","icon-success","icon-warning","icon-info","icon-question","icon-error"]),S=C(["success","warning","info","question","error"]),E=function(){return document.body.querySelector(".".concat(T.container))},k=function(t){var e=E();return e?e.querySelector(t):null},A=function(t){return k(".".concat(t))},I=function(){return A(T.popup)},P=function(){return A(T.icon)},M=function(){return A(T.title)},O=function(){return A(T.content)},z=function(){return A(T["html-container"])},D=function(){return A(T.image)},L=function(){return A(T["progress-steps"])},R=function(){return A(T["validation-message"])},F=function(){return k(".".concat(T.actions," .").concat(T.confirm))},B=function(){return k(".".concat(T.actions," .").concat(T.deny))},V=function(){return k(".".concat(T.loader))},U=function(){return k(".".concat(T.actions," .").concat(T.cancel))},N=function(){return A(T.actions)},j=function(){return A(T.header)},q=function(){return A(T.footer)},$=function(){return A(T["timer-progress-bar"])},G=function(){return A(T.close)},Z=function(){var t=p(I().querySelectorAll('[tabindex]:not([tabindex="-1"]):not([tabindex="0"])')).sort(function(t,e){return(t=parseInt(t.getAttribute("tabindex")))>(e=parseInt(e.getAttribute("tabindex")))?1:t<e?-1:0}),e=p(I().querySelectorAll('\n  a[href],\n  area[href],\n  input:not([disabled]),\n  select:not([disabled]),\n  textarea:not([disabled]),\n  button:not([disabled]),\n  iframe,\n  object,\n  embed,\n  [tabindex="0"],\n  [contenteditable],\n  audio[controls],\n  video[controls],\n  summary\n')).filter(function(t){return"-1"!==t.getAttribute("tabindex")});return function(t){for(var e=[],n=0;n<t.length;n++)-1===e.indexOf(t[n])&&e.push(t[n]);return e}(t.concat(e)).filter(function(t){return ht(t)})},H=function(){return!W()&&!document.body.classList.contains(T["no-backdrop"])},W=function(){return document.body.classList.contains(T["toast-shown"])},X={previousBodyPadding:null},K=function(t,e){if(t.textContent="",e){var n=(new DOMParser).parseFromString(e,"text/html");p(n.querySelector("head").childNodes).forEach(function(e){t.appendChild(e)}),p(n.querySelector("body").childNodes).forEach(function(e){t.appendChild(e)})}},Y=function(t,e){if(!e)return!1;for(var n=e.split(/\s+/),i=0;i<n.length;i++)if(!t.classList.contains(n[i]))return!1;return!0},J=function(e,n,i){if(function(t,e){p(t.classList).forEach(function(n){-1===d(T).indexOf(n)&&-1===d(S).indexOf(n)&&-1===d(e.showClass).indexOf(n)&&t.classList.remove(n)})}(e,n),n.customClass&&n.customClass[i]){if("string"!=typeof n.customClass[i]&&!n.customClass[i].forEach)return f("Invalid type of customClass.".concat(i,'! Expected string or iterable object, got "').concat(t(n.customClass[i]),'"'));it(e,n.customClass[i])}};function Q(t,e){if(!e)return null;switch(e){case"select":case"textarea":case"file":return ot(t,T[e]);case"checkbox":return t.querySelector(".".concat(T.checkbox," input"));case"radio":return t.querySelector(".".concat(T.radio," input:checked"))||t.querySelector(".".concat(T.radio," input:first-child"));case"range":return t.querySelector(".".concat(T.range," input"));default:return ot(t,T.input)}}var tt,et=function(t){if(t.focus(),"file"!==t.type){var e=t.value;t.value="",t.value=e}},nt=function(t,e,n){t&&e&&("string"==typeof e&&(e=e.split(/\s+/).filter(Boolean)),e.forEach(function(e){t.forEach?t.forEach(function(t){n?t.classList.add(e):t.classList.remove(e)}):n?t.classList.add(e):t.classList.remove(e)}))},it=function(t,e){nt(t,e,!0)},rt=function(t,e){nt(t,e,!1)},ot=function(t,e){for(var n=0;n<t.childNodes.length;n++)if(Y(t.childNodes[n],e))return t.childNodes[n]},st=function(t,e,n){n==="".concat(parseInt(n))&&(n=parseInt(n)),n||0===parseInt(n)?t.style[e]="number"==typeof n?"".concat(n,"px"):n:t.style.removeProperty(e)},at=function(t){t.style.display=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"flex"},lt=function(t){t.style.display="none"},ct=function(t,e,n,i){var r=t.querySelector(e);r&&(r.style[n]=i)},ut=function(t,e,n){e?at(t,n):lt(t)},ht=function(t){return!(!t||!(t.offsetWidth||t.offsetHeight||t.getClientRects().length))},dt=function(t){return!!(t.scrollHeight>t.clientHeight)},pt=function(t){var e=window.getComputedStyle(t),n=parseFloat(e.getPropertyValue("animation-duration")||"0"),i=parseFloat(e.getPropertyValue("transition-duration")||"0");return n>0||i>0},ft=function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=$();ht(n)&&(e&&(n.style.transition="none",n.style.width="100%"),setTimeout(function(){n.style.transition="width ".concat(t/1e3,"s linear"),n.style.width="0%"},10))},mt=function(){return"undefined"==typeof window||"undefined"==typeof document},gt='\n <div aria-labelledby="'.concat(T.title,'" aria-describedby="').concat(T.content,'" class="').concat(T.popup,'" tabindex="-1">\n   <div class="').concat(T.header,'">\n     <ul class="').concat(T["progress-steps"],'"></ul>\n     <div class="').concat(T.icon,'"></div>\n     <img class="').concat(T.image,'" />\n     <h2 class="').concat(T.title,'" id="').concat(T.title,'"></h2>\n     <button type="button" class="').concat(T.close,'"></button>\n   </div>\n   <div class="').concat(T.content,'">\n     <div id="').concat(T.content,'" class="').concat(T["html-container"],'"></div>\n     <input class="').concat(T.input,'" />\n     <input type="file" class="').concat(T.file,'" />\n     <div class="').concat(T.range,'">\n       <input type="range" />\n       <output></output>\n     </div>\n     <select class="').concat(T.select,'"></select>\n     <div class="').concat(T.radio,'"></div>\n     <label for="').concat(T.checkbox,'" class="').concat(T.checkbox,'">\n       <input type="checkbox" />\n       <span class="').concat(T.label,'"></span>\n     </label>\n     <textarea class="').concat(T.textarea,'"></textarea>\n     <div class="').concat(T["validation-message"],'" id="').concat(T["validation-message"],'"></div>\n   </div>\n   <div class="').concat(T.actions,'">\n     <div class="').concat(T.loader,'"></div>\n     <button type="button" class="').concat(T.confirm,'"></button>\n     <button type="button" class="').concat(T.deny,'"></button>\n     <button type="button" class="').concat(T.cancel,'"></button>\n   </div>\n   <div class="').concat(T.footer,'"></div>\n   <div class="').concat(T["timer-progress-bar-container"],'">\n     <div class="').concat(T["timer-progress-bar"],'"></div>\n   </div>\n </div>\n').replace(/(^|\n)\s*/g,""),_t=function(t){on.isVisible()&&tt!==t.target.value&&on.resetValidationMessage(),tt=t.target.value},yt=function(e,n){e instanceof HTMLElement?n.appendChild(e):"object"===t(e)?vt(e,n):e&&K(n,e)},vt=function(t,e){t.jquery?xt(e,t):K(e,t.toString())},xt=function(t,e){if(t.textContent="",0 in e)for(var n=0;n in e;n++)t.appendChild(e[n].cloneNode(!0));else t.appendChild(e.cloneNode(!0))},bt=function(){if(mt())return!1;var t=document.createElement("div"),e={WebkitAnimation:"webkitAnimationEnd",OAnimation:"oAnimationEnd oanimationend",animation:"animationend"};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)&&void 0!==t.style[n])return e[n];return!1}();function wt(t,e,n){ut(t,n["show".concat(h(e),"Button")],"inline-block"),K(t,n["".concat(e,"ButtonText")]),t.setAttribute("aria-label",n["".concat(e,"ButtonAriaLabel")]),t.className=T[e],J(t,n,"".concat(e,"Button")),it(t,n["".concat(e,"ButtonClass")])}var Ct={promise:new WeakMap,innerParams:new WeakMap,domCache:new WeakMap},Tt=["input","file","range","select","radio","checkbox","textarea"],St=function(t,e){t.placeholder&&!e.inputPlaceholder||(t.placeholder=e.inputPlaceholder)},Et=function(t,e,n){if(n.inputLabel){t.id=T.input;var i=document.createElement("label"),r=T["input-label"];i.setAttribute("for",t.id),i.className=r,it(i,n.customClass.inputLabel),i.innerText=n.inputLabel,e.insertAdjacentElement("beforebegin",i)}},kt=function(t){var e=T[t]?T[t]:T.input;return ot(O(),e)},At={};At.text=At.email=At.password=At.number=At.tel=At.url=function(e,n){return"string"==typeof n.inputValue||"number"==typeof n.inputValue?e.value=n.inputValue:x(n.inputValue)||f('Unexpected type of inputValue! Expected "string", "number" or "Promise", got "'.concat(t(n.inputValue),'"')),Et(e,e,n),St(e,n),e.type=n.input,e},At.file=function(t,e){return Et(t,t,e),St(t,e),t},At.range=function(t,e){var n=t.querySelector("input"),i=t.querySelector("output");return n.value=e.inputValue,n.type=e.input,i.value=e.inputValue,Et(n,t,e),t},At.select=function(t,e){if(t.textContent="",e.inputPlaceholder){var n=document.createElement("option");K(n,e.inputPlaceholder),n.value="",n.disabled=!0,n.selected=!0,t.appendChild(n)}return Et(t,t,e),t},At.radio=function(t){return t.textContent="",t},At.checkbox=function(t,e){var n=Q(O(),"checkbox");n.value=1,n.id=T.checkbox,n.checked=Boolean(e.inputValue);var i=t.querySelector("span");return K(i,e.inputPlaceholder),t},At.textarea=function(t,e){t.value=e.inputValue,St(t,e),Et(t,t,e);var n=function(t){return parseInt(window.getComputedStyle(t).paddingLeft)+parseInt(window.getComputedStyle(t).paddingRight)};if("MutationObserver"in window){var i=parseInt(window.getComputedStyle(I()).width);new MutationObserver(function(){var e=t.offsetWidth+n(I())+n(O());I().style.width=e>i?"".concat(e,"px"):null}).observe(t,{attributes:!0,attributeFilter:["style"]})}return t};var It=function(t,e){var n=z();J(n,e,"htmlContainer"),e.html?(yt(e.html,n),at(n,"block")):e.text?(n.textContent=e.text,at(n,"block")):lt(n),function(t,e){var n=O(),i=Ct.innerParams.get(t),r=!i||e.input!==i.input;Tt.forEach(function(t){var i=T[t],o=ot(n,i);(function(t,e){var n=Q(O(),t);if(n)for(var i in function(t){for(var e=0;e<t.attributes.length;e++){var n=t.attributes[e].name;-1===["type","value","style"].indexOf(n)&&t.removeAttribute(n)}}(n),e)"range"===t&&"placeholder"===i||n.setAttribute(i,e[i])})(t,e.inputAttributes),o.className=i,r&&lt(o)}),e.input&&(r&&function(t){if(!At[t.input])return m('Unexpected type of input! Expected "text", "email", "password", "number", "tel", "select", "radio", "checkbox", "textarea", "file" or "url", got "'.concat(t.input,'"'));var e=kt(t.input),n=At[t.input](e,t);at(n),setTimeout(function(){et(n)})}(e),function(t){var e=kt(t.input);t.customClass&&it(e,t.customClass.input)}(e))}(t,e),J(O(),e,"content")},Pt=function(t,e){for(var n in S)e.icon!==n&&rt(t,S[n]);it(t,S[e.icon]),zt(t,e),Mt(),J(t,e,"icon")},Mt=function(){for(var t=I(),e=window.getComputedStyle(t).getPropertyValue("background-color"),n=t.querySelectorAll("[class^=swal2-success-circular-line], .swal2-success-fix"),i=0;i<n.length;i++)n[i].style.backgroundColor=e},Ot=function(t,e){t.textContent="",K(t,e.iconHtml?Dt(e.iconHtml):"success"===e.icon?'\n      <div class="swal2-success-circular-line-left"></div>\n      <span class="swal2-success-line-tip"></span> <span class="swal2-success-line-long"></span>\n      <div class="swal2-success-ring"></div> <div class="swal2-success-fix"></div>\n      <div class="swal2-success-circular-line-right"></div>\n    ':"error"===e.icon?'\n      <span class="swal2-x-mark">\n        <span class="swal2-x-mark-line-left"></span>\n        <span class="swal2-x-mark-line-right"></span>\n      </span>\n    ':Dt({question:"?",warning:"!",info:"i"}[e.icon]))},zt=function(t,e){if(e.iconColor){t.style.color=e.iconColor,t.style.borderColor=e.iconColor;for(var n=0,i=[".swal2-success-line-tip",".swal2-success-line-long",".swal2-x-mark-line-left",".swal2-x-mark-line-right"];n<i.length;n++)ct(t,i[n],"backgroundColor",e.iconColor);ct(t,".swal2-success-ring","borderColor",e.iconColor)}},Dt=function(t){return'<div class="'.concat(T["icon-content"],'">').concat(t,"</div>")},Lt=[],Rt=function(){return E()&&E().getAttribute("data-queue-step")},Ft=function(t,e){var n=j();J(n,e,"header"),function(t,e){var n=L();if(!e.progressSteps||0===e.progressSteps.length)return lt(n);at(n),n.textContent="";var i=parseInt(void 0===e.currentProgressStep?Rt():e.currentProgressStep);i>=e.progressSteps.length&&f("Invalid currentProgressStep parameter, it should be less than progressSteps.length (currentProgressStep like JS arrays starts from 0)"),e.progressSteps.forEach(function(t,r){var o=function(t){var e=document.createElement("li");return it(e,T["progress-step"]),K(e,t),e}(t);if(n.appendChild(o),r===i&&it(o,T["active-progress-step"]),r!==e.progressSteps.length-1){var s=function(t){var e=document.createElement("li");return it(e,T["progress-step-line"]),t.progressStepsDistance&&(e.style.width=t.progressStepsDistance),e}(e);n.appendChild(s)}})}(0,e),function(t,e){var n=Ct.innerParams.get(t),i=P();n&&e.icon===n.icon?(Ot(i,e),Pt(i,e)):e.icon||e.iconHtml?e.icon&&-1===Object.keys(S).indexOf(e.icon)?(m('Unknown icon! Expected "success", "error", "warning", "info" or "question", got "'.concat(e.icon,'"')),lt(i)):(at(i),Ot(i,e),Pt(i,e),it(i,e.showClass.icon)):lt(i)}(t,e),function(t,e){var n=D();if(!e.imageUrl)return lt(n);at(n,""),n.setAttribute("src",e.imageUrl),n.setAttribute("alt",e.imageAlt),st(n,"width",e.imageWidth),st(n,"height",e.imageHeight),n.className=T.image,J(n,e,"image")}(0,e),function(t,e){var n=M();ut(n,e.title||e.titleText),e.title&&yt(e.title,n),e.titleText&&(n.innerText=e.titleText),J(n,e,"title")}(0,e),function(t,e){var n=G();K(n,e.closeButtonHtml),J(n,e,"closeButton"),ut(n,e.showCloseButton),n.setAttribute("aria-label",e.closeButtonAriaLabel)}(0,e)},Bt=function(t,e){(function(t,e){var n=E(),i=I();e.toast?(st(n,"width",e.width),i.style.width="100%"):st(i,"width",e.width),st(i,"padding",e.padding),e.background&&(i.style.background=e.background),lt(R()),function(t,e){t.className="".concat(T.popup," ").concat(ht(t)?e.showClass.popup:""),e.toast?(it([document.documentElement,document.body],T["toast-shown"]),it(t,T.toast)):it(t,T.modal),J(t,e,"popup"),"string"==typeof e.customClass&&it(t,e.customClass),e.icon&&it(t,T["icon-".concat(e.icon)])}(i,e)})(0,e),function(t,e){var n=E();if(n){(function(t,e){"string"==typeof e?t.style.background=e:e||it([document.documentElement,document.body],T["no-backdrop"])})(n,e.backdrop),!e.backdrop&&e.allowOutsideClick&&f('"allowOutsideClick" parameter requires `backdrop` parameter to be set to `true`'),function(t,e){e in T?it(t,T[e]):(f('The "position" parameter is not valid, defaulting to "center"'),it(t,T.center))}(n,e.position),function(t,e){if(e&&"string"==typeof e){var n="grow-".concat(e);n in T&&it(t,T[n])}}(n,e.grow),J(n,e,"container");var i=document.body.getAttribute("data-swal2-queue-step");i&&(n.setAttribute("data-queue-step",i),document.body.removeAttribute("data-swal2-queue-step"))}}(0,e),Ft(t,e),It(t,e),function(t,e){var n=N(),i=V(),r=F(),o=B(),s=U();e.showConfirmButton||e.showDenyButton||e.showCancelButton||lt(n),J(n,e,"actions"),wt(r,"confirm",e),wt(o,"deny",e),wt(s,"cancel",e),function(t,e,n,i){if(!i.buttonsStyling)return rt([t,e,n],T.styled);it([t,e,n],T.styled),i.confirmButtonColor&&(t.style.backgroundColor=i.confirmButtonColor),i.denyButtonColor&&(e.style.backgroundColor=i.denyButtonColor),i.cancelButtonColor&&(n.style.backgroundColor=i.cancelButtonColor)}(r,o,s,e),e.reverseButtons&&(n.insertBefore(s,i),n.insertBefore(o,i),n.insertBefore(r,i)),K(i,e.loaderHtml),J(i,e,"loader")}(0,e),function(t,e){var n=q();ut(n,e.footer),e.footer&&yt(e.footer,n),J(n,e,"footer")}(0,e),"function"==typeof e.didRender?e.didRender(I()):"function"==typeof e.onRender&&e.onRender(I())},Vt=function(){return F()&&F().click()},Ut=function(t){var e=I();e||on.fire(),e=I();var n=N(),i=V();!t&&ht(F())&&(t=F()),at(n),t&&(lt(t),i.setAttribute("data-button-to-replace",t.className)),i.parentNode.insertBefore(i,t),it([e,n],T.loading),at(i),e.setAttribute("data-loading",!0),e.setAttribute("aria-busy",!0),e.focus()},Nt={},jt=function(){if(Nt.timeout)return function(){var t=$(),e=parseInt(window.getComputedStyle(t).width);t.style.removeProperty("transition"),t.style.width="100%";var n=parseInt(window.getComputedStyle(t).width),i=parseInt(e/n*100);t.style.removeProperty("transition"),t.style.width="".concat(i,"%")}(),Nt.timeout.stop()},qt=function(){if(Nt.timeout){var t=Nt.timeout.start();return ft(t),t}},$t=!1,Gt={},Zt=function(t){for(var e=t.target;e&&e!==document;e=e.parentNode)for(var n in Gt){var i=e.getAttribute(n);if(i)return void Gt[n].fire({template:i})}},Ht={title:"",titleText:"",text:"",html:"",footer:"",icon:void 0,iconColor:void 0,iconHtml:void 0,template:void 0,toast:!1,animation:!0,showClass:{popup:"swal2-show",backdrop:"swal2-backdrop-show",icon:"swal2-icon-show"},hideClass:{popup:"swal2-hide",backdrop:"swal2-backdrop-hide",icon:"swal2-icon-hide"},customClass:{},target:"body",backdrop:!0,heightAuto:!0,allowOutsideClick:!0,allowEscapeKey:!0,allowEnterKey:!0,stopKeydownPropagation:!0,keydownListenerCapture:!1,showConfirmButton:!0,showDenyButton:!1,showCancelButton:!1,preConfirm:void 0,preDeny:void 0,confirmButtonText:"OK",confirmButtonAriaLabel:"",confirmButtonColor:void 0,denyButtonText:"No",denyButtonAriaLabel:"",denyButtonColor:void 0,cancelButtonText:"Cancel",cancelButtonAriaLabel:"",cancelButtonColor:void 0,buttonsStyling:!0,reverseButtons:!1,focusConfirm:!0,focusDeny:!1,focusCancel:!1,showCloseButton:!1,closeButtonHtml:"&times;",closeButtonAriaLabel:"Close this dialog",loaderHtml:"",showLoaderOnConfirm:!1,showLoaderOnDeny:!1,imageUrl:void 0,imageWidth:void 0,imageHeight:void 0,imageAlt:"",timer:void 0,timerProgressBar:!1,width:void 0,padding:void 0,background:void 0,input:void 0,inputPlaceholder:"",inputLabel:"",inputValue:"",inputOptions:{},inputAutoTrim:!0,inputAttributes:{},inputValidator:void 0,returnInputValueOnDeny:!1,validationMessage:void 0,grow:!1,position:"center",progressSteps:[],currentProgressStep:void 0,progressStepsDistance:void 0,onBeforeOpen:void 0,onOpen:void 0,willOpen:void 0,didOpen:void 0,onRender:void 0,didRender:void 0,onClose:void 0,onAfterClose:void 0,willClose:void 0,didClose:void 0,onDestroy:void 0,didDestroy:void 0,scrollbarPadding:!0},Wt=["allowEscapeKey","allowOutsideClick","background","buttonsStyling","cancelButtonAriaLabel","cancelButtonColor","cancelButtonText","closeButtonAriaLabel","closeButtonHtml","confirmButtonAriaLabel","confirmButtonColor","confirmButtonText","currentProgressStep","customClass","denyButtonAriaLabel","denyButtonColor","denyButtonText","didClose","didDestroy","footer","hideClass","html","icon","iconColor","iconHtml","imageAlt","imageHeight","imageUrl","imageWidth","onAfterClose","onClose","onDestroy","progressSteps","reverseButtons","showCancelButton","showCloseButton","showConfirmButton","showDenyButton","text","title","titleText","willClose"],Xt={animation:'showClass" and "hideClass',onBeforeOpen:"willOpen",onOpen:"didOpen",onRender:"didRender",onClose:"willClose",onAfterClose:"didClose",onDestroy:"didDestroy"},Kt=["allowOutsideClick","allowEnterKey","backdrop","focusConfirm","focusDeny","focusCancel","heightAuto","keydownListenerCapture"],Yt=function(t){return Object.prototype.hasOwnProperty.call(Ht,t)},Jt=function(t){return Xt[t]},Qt=function(t){Yt(t)||f('Unknown parameter "'.concat(t,'"'))},te=function(t){-1!==Kt.indexOf(t)&&f('The parameter "'.concat(t,'" is incompatible with toasts'))},ee=function(t){var e,n,i;Jt(t)&&(e=t,n=Jt(t),i='"'.concat(e,'" is deprecated and will be removed in the next major release. Please use "').concat(n,'" instead.'),-1===g.indexOf(i)&&(g.push(i),f(i)))},ne=function(t){for(var e in t)Qt(e),t.toast&&te(e),ee(e)},ie=Object.freeze({isValidParameter:Yt,isUpdatableParameter:function(t){return-1!==Wt.indexOf(t)},isDeprecatedParameter:Jt,argsToParams:function(e){var n={};return"object"!==t(e[0])||w(e[0])?["title","html","icon"].forEach(function(i,r){var o=e[r];"string"==typeof o||w(o)?n[i]=o:void 0!==o&&m("Unexpected type of ".concat(i,'! Expected "string" or "Element", got ').concat(t(o)))}):r(n,e[0]),n},isVisible:function(){return ht(I())},clickConfirm:Vt,clickDeny:function(){return B()&&B().click()},clickCancel:function(){return U()&&U().click()},getContainer:E,getPopup:I,getTitle:M,getContent:O,getHtmlContainer:z,getImage:D,getIcon:P,getInputLabel:function(){return A(T["input-label"])},getCloseButton:G,getActions:N,getConfirmButton:F,getDenyButton:B,getCancelButton:U,getLoader:V,getHeader:j,getFooter:q,getTimerProgressBar:$,getFocusableElements:Z,getValidationMessage:R,isLoading:function(){return I().hasAttribute("data-loading")},fire:function(){for(var t=this,e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return l(t,n)},mixin:function(t){return function(n){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&s(t,e)}(p,n);var l,h,d=(l=p,h=a(),function(){var t,e=o(l);if(h){var n=o(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return c(this,t)});function p(){return e(this,p),d.apply(this,arguments)}return i(p,[{key:"_main",value:function(e,n){return u(o(p.prototype),"_main",this).call(this,e,r({},t,n))}}]),p}(this)},queue:function(t){var e=this;Lt=t;var n=function(t,e){Lt=[],t(e)},i=[];return new Promise(function(t){!function r(o,s){o<Lt.length?(document.body.setAttribute("data-swal2-queue-step",o),e.fire(Lt[o]).then(function(e){void 0!==e.value?(i.push(e.value),r(o+1,s)):n(t,{dismiss:e.dismiss})})):n(t,{value:i})}(0)})},getQueueStep:Rt,insertQueueStep:function(t,e){return e&&e<Lt.length?Lt.splice(e,0,t):Lt.push(t)},deleteQueueStep:function(t){void 0!==Lt[t]&&Lt.splice(t,1)},showLoading:Ut,enableLoading:Ut,getTimerLeft:function(){return Nt.timeout&&Nt.timeout.getTimerLeft()},stopTimer:jt,resumeTimer:qt,toggleTimer:function(){var t=Nt.timeout;return t&&(t.running?jt():qt())},increaseTimer:function(t){if(Nt.timeout){var e=Nt.timeout.increase(t);return ft(e,!0),e}},isTimerRunning:function(){return Nt.timeout&&Nt.timeout.isRunning()},bindClickHandler:function(){Gt[arguments.length>0&&void 0!==arguments[0]?arguments[0]:"data-swal-template"]=this,$t||(document.body.addEventListener("click",Zt),$t=!0)}});function re(){if(Ct.innerParams.get(this)){var t=Ct.domCache.get(this);lt(t.loader);var e=t.popup.getElementsByClassName(t.loader.getAttribute("data-button-to-replace"));e.length?at(e[0],"inline-block"):!ht(F())&&!ht(B())&&!ht(U())&&lt(t.actions),rt([t.popup,t.actions],T.loading),t.popup.removeAttribute("aria-busy"),t.popup.removeAttribute("data-loading"),t.confirmButton.disabled=!1,t.denyButton.disabled=!1,t.cancelButton.disabled=!1}}var oe=function(t){var e=t.target,n=E();return!(se(t)||ae(t)||e!==n&&(dt(n)||"INPUT"===e.tagName||dt(O())&&O().contains(e)))},se=function(t){return t.touches&&t.touches.length&&"stylus"===t.touches[0].touchType},ae=function(t){return t.touches&&t.touches.length>1},le=function(){return!!window.MSInputMethodContext&&!!document.documentMode},ce=function(){var t=E(),e=I();t.style.removeProperty("align-items"),e.offsetTop<0&&(t.style.alignItems="flex-start")},ue={swalPromiseResolve:new WeakMap};function he(t,e,n,i){n?_e(t,i):(new Promise(function(t){var e=window.scrollX,n=window.scrollY;Nt.restoreFocusTimeout=setTimeout(function(){Nt.previousActiveElement&&Nt.previousActiveElement.focus?(Nt.previousActiveElement.focus(),Nt.previousActiveElement=null):document.body&&document.body.focus(),t()},100),void 0!==e&&void 0!==n&&window.scrollTo(e,n)}).then(function(){return _e(t,i)}),Nt.keydownTarget.removeEventListener("keydown",Nt.keydownHandler,{capture:Nt.keydownListenerCapture}),Nt.keydownHandlerAdded=!1),e.parentNode&&!document.body.getAttribute("data-swal2-queue-step")&&e.parentNode.removeChild(e),H()&&(null!==X.previousBodyPadding&&(document.body.style.paddingRight="".concat(X.previousBodyPadding,"px"),X.previousBodyPadding=null),function(){if(Y(document.body,T.iosfix)){var t=parseInt(document.body.style.top,10);rt(document.body,T.iosfix),document.body.style.top="",document.body.scrollTop=-1*t}}(),"undefined"!=typeof window&&le()&&window.removeEventListener("resize",ce),p(document.body.children).forEach(function(t){t.hasAttribute("data-previous-aria-hidden")?(t.setAttribute("aria-hidden",t.getAttribute("data-previous-aria-hidden")),t.removeAttribute("data-previous-aria-hidden")):t.removeAttribute("aria-hidden")})),rt([document.documentElement,document.body],[T.shown,T["height-auto"],T["no-backdrop"],T["toast-shown"],T["toast-column"]])}function de(t){var e=I();if(e){t=pe(t);var n=Ct.innerParams.get(this);if(n&&!Y(e,n.hideClass.popup)){var i=ue.swalPromiseResolve.get(this);rt(e,n.showClass.popup),it(e,n.hideClass.popup);var r=E();rt(r,n.showClass.backdrop),it(r,n.hideClass.backdrop),fe(this,e,n),i(t)}}}var pe=function(t){return void 0===t?{isConfirmed:!1,isDenied:!1,isDismissed:!0}:r({isConfirmed:!1,isDenied:!1,isDismissed:!1},t)},fe=function(t,e,n){var i=E(),r=bt&&pt(e),o=n.onAfterClose,s=n.didClose;me(e,n.willClose,n.onClose),r?ge(t,e,i,s||o):he(t,i,W(),s||o)},me=function(t,e,n){null!==e&&"function"==typeof e?e(t):null!==n&&"function"==typeof n&&n(t)},ge=function(t,e,n,i){Nt.swalCloseEventFinishedCallback=he.bind(null,t,n,W(),i),e.addEventListener(bt,function(t){t.target===e&&(Nt.swalCloseEventFinishedCallback(),delete Nt.swalCloseEventFinishedCallback)})},_e=function(t,e){setTimeout(function(){"function"==typeof e&&e(),t._destroy()})};function ye(t,e,n){var i=Ct.domCache.get(t);e.forEach(function(t){i[t].disabled=n})}function ve(t,e){if(!t)return!1;if("radio"===t.type)for(var n=t.parentNode.parentNode.querySelectorAll("input"),i=0;i<n.length;i++)n[i].disabled=e;else t.disabled=e}var xe=function(){function t(n,i){e(this,t),this.callback=n,this.remaining=i,this.running=!1,this.start()}return i(t,[{key:"start",value:function(){return this.running||(this.running=!0,this.started=new Date,this.id=setTimeout(this.callback,this.remaining)),this.remaining}},{key:"stop",value:function(){return this.running&&(this.running=!1,clearTimeout(this.id),this.remaining-=new Date-this.started),this.remaining}},{key:"increase",value:function(t){var e=this.running;return e&&this.stop(),this.remaining+=t,e&&this.start(),this.remaining}},{key:"getTimerLeft",value:function(){return this.running&&(this.stop(),this.start()),this.remaining}},{key:"isRunning",value:function(){return this.running}}]),t}(),be={email:function(t,e){return/^[a-zA-Z0-9.+_-]+@[a-zA-Z0-9.-]+\.[a-zA-Z0-9-]{2,24}$/.test(t)?Promise.resolve():Promise.resolve(e||"Invalid email address")},url:function(t,e){return/^https?:\/\/(www\.)?[-a-zA-Z0-9@:%._+~#=]{1,256}\.[a-z]{2,63}\b([-a-zA-Z0-9@:%_+.~#?&/=]*)$/.test(t)?Promise.resolve():Promise.resolve(e||"Invalid URL")}};function we(t){(function(t){t.inputValidator||Object.keys(be).forEach(function(e){t.input===e&&(t.inputValidator=be[e])})})(t),t.showLoaderOnConfirm&&!t.preConfirm&&f("showLoaderOnConfirm is set to true, but preConfirm is not defined.\nshowLoaderOnConfirm should be used together with preConfirm, see usage example:\nhttps://sweetalert2.github.io/#ajax-request"),t.animation=_(t.animation),function(t){(!t.target||"string"==typeof t.target&&!document.querySelector(t.target)||"string"!=typeof t.target&&!t.target.appendChild)&&(f('Target parameter is not valid, defaulting to "body"'),t.target="body")}(t),"string"==typeof t.title&&(t.title=t.title.split("\n").join("<br />")),function(t){var e,n,i,r,o,s,a,l,c,u,h=!!(e=E())&&(e.parentNode.removeChild(e),rt([document.documentElement,document.body],[T["no-backdrop"],T["toast-shown"],T["has-column"]]),!0);if(mt())m("SweetAlert2 requires document to initialize");else{var d=document.createElement("div");d.className=T.container,h&&it(d,T["no-transition"]),K(d,gt);var p="string"==typeof(u=t.target)?document.querySelector(u):u;p.appendChild(d),function(t){var e=I();e.setAttribute("role",t.toast?"alert":"dialog"),e.setAttribute("aria-live",t.toast?"polite":"assertive"),t.toast||e.setAttribute("aria-modal","true")}(t),function(t){"rtl"===window.getComputedStyle(t).direction&&it(E(),T.rtl)}(p),n=O(),i=ot(n,T.input),r=ot(n,T.file),o=n.querySelector(".".concat(T.range," input")),s=n.querySelector(".".concat(T.range," output")),a=ot(n,T.select),l=n.querySelector(".".concat(T.checkbox," input")),c=ot(n,T.textarea),i.oninput=_t,r.onchange=_t,a.onchange=_t,l.onchange=_t,c.oninput=_t,o.oninput=function(t){_t(t),s.value=o.value},o.onchange=function(t){_t(t),o.nextSibling.value=o.value}}}(t)}var Ce,Te=["swal-title","swal-html","swal-footer"],Se=function(t,e){p(t.attributes).forEach(function(n){-1===e.indexOf(n.name)&&f(['Unrecognized attribute "'.concat(n.name,'" on <').concat(t.tagName.toLowerCase(),">."),"".concat(e.length?"Allowed attributes are: ".concat(e.join(", ")):"To set the value, use HTML within the element.")])})},Ee=function(t,e){"function"==typeof e.didOpen?setTimeout(function(){return e.didOpen(t)}):"function"==typeof e.onOpen&&setTimeout(function(){return e.onOpen(t)})},ke=function t(e){var n=I();if(e.target===n){var i=E();n.removeEventListener(bt,t),i.style.overflowY="auto"}},Ae=function(t,e){bt&&pt(e)?(t.style.overflowY="hidden",e.addEventListener(bt,ke)):t.style.overflowY="auto"},Ie=function(t,e,n){(function(){if((/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream||"MacIntel"===navigator.platform&&navigator.maxTouchPoints>1)&&!Y(document.body,T.iosfix)){var t=document.body.scrollTop;document.body.style.top="".concat(-1*t,"px"),it(document.body,T.iosfix),function(){var t,e=E();e.ontouchstart=function(e){t=oe(e)},e.ontouchmove=function(e){t&&(e.preventDefault(),e.stopPropagation())}}(),navigator.userAgent.match(/(CriOS|FxiOS|EdgiOS|YaBrowser|UCBrowser)/i)||I().scrollHeight>window.innerHeight-44&&(E().style.paddingBottom="".concat(44,"px"))}})(),"undefined"!=typeof window&&le()&&(ce(),window.addEventListener("resize",ce)),e&&"hidden"!==n&&(null===X.previousBodyPadding&&document.body.scrollHeight>window.innerHeight&&(X.previousBodyPadding=parseInt(window.getComputedStyle(document.body).getPropertyValue("padding-right")),document.body.style.paddingRight="".concat(X.previousBodyPadding+function(){var t=document.createElement("div");t.className=T["scrollbar-measure"],document.body.appendChild(t);var e=t.getBoundingClientRect().width-t.clientWidth;return document.body.removeChild(t),e}(),"px"))),setTimeout(function(){t.scrollTop=0})},Pe=function(t,e,n){it(t,n.showClass.backdrop),e.style.setProperty("opacity","0","important"),at(e),setTimeout(function(){it(e,n.showClass.popup),e.style.removeProperty("opacity")},10),it([document.documentElement,document.body],T.shown),n.heightAuto&&n.backdrop&&!n.toast&&it([document.documentElement,document.body],T["height-auto"])},Me={select:function(t,e,n){var i=ot(t,T.select),r=function(t,e,i){var r=document.createElement("option");r.value=i,K(r,e),r.selected=ze(i,n.inputValue),t.appendChild(r)};e.forEach(function(t){var e=t[0],n=t[1];if(Array.isArray(n)){var o=document.createElement("optgroup");o.label=e,o.disabled=!1,i.appendChild(o),n.forEach(function(t){return r(o,t[1],t[0])})}else r(i,n,e)}),i.focus()},radio:function(t,e,n){var i=ot(t,T.radio);e.forEach(function(t){var e=t[0],r=t[1],o=document.createElement("input"),s=document.createElement("label");o.type="radio",o.name=T.radio,o.value=e,ze(e,n.inputValue)&&(o.checked=!0);var a=document.createElement("span");K(a,r),a.className=T.label,s.appendChild(o),s.appendChild(a),i.appendChild(s)});var r=i.querySelectorAll("input");r.length&&r[0].focus()}},Oe=function e(n){var i=[];return"undefined"!=typeof Map&&n instanceof Map?n.forEach(function(n,r){var o=n;"object"===t(o)&&(o=e(o)),i.push([r,o])}):Object.keys(n).forEach(function(r){var o=n[r];"object"===t(o)&&(o=e(o)),i.push([r,o])}),i},ze=function(t,e){return e&&e.toString()===t.toString()},De=function(t,e,n){var i=function(t,e){var n=t.getInput();if(!n)return null;switch(e.input){case"checkbox":return function(t){return t.checked?1:0}(n);case"radio":return function(t){return t.checked?t.value:null}(n);case"file":return function(t){return t.files.length?null!==t.getAttribute("multiple")?t.files:t.files[0]:null}(n);default:return e.inputAutoTrim?n.value.trim():n.value}}(t,e);e.inputValidator?Le(t,e,i):t.getInput().checkValidity()?"deny"===n?Re(t,e,i):Be(t,e,i):(t.enableButtons(),t.showValidationMessage(e.validationMessage))},Le=function(t,e,n){t.disableInput(),Promise.resolve().then(function(){return v(e.inputValidator(n,e.validationMessage))}).then(function(i){t.enableButtons(),t.enableInput(),i?t.showValidationMessage(i):Be(t,e,n)})},Re=function(t,e,n){e.showLoaderOnDeny&&Ut(B()),e.preDeny?Promise.resolve().then(function(){return v(e.preDeny(n,e.validationMessage))}).then(function(e){!1===e?t.hideLoading():t.closePopup({isDenied:!0,value:void 0===e?n:e})}):t.closePopup({isDenied:!0,value:n})},Fe=function(t,e){t.closePopup({isConfirmed:!0,value:e})},Be=function(t,e,n){e.showLoaderOnConfirm&&Ut(),e.preConfirm?(t.resetValidationMessage(),Promise.resolve().then(function(){return v(e.preConfirm(n,e.validationMessage))}).then(function(e){ht(R())||!1===e?t.hideLoading():Fe(t,void 0===e?n:e)})):Fe(t,n)},Ve=function(t,e,n){var i=Z();if(i.length)return(e+=n)===i.length?e=0:-1===e&&(e=i.length-1),i[e].focus();I().focus()},Ue=["ArrowRight","ArrowDown","Right","Down"],Ne=["ArrowLeft","ArrowUp","Left","Up"],je=["Escape","Esc"],qe=function(t,e,n){if(!e.isComposing&&e.target&&t.getInput()&&e.target.outerHTML===t.getInput().outerHTML){if(-1!==["textarea","file"].indexOf(n.input))return;Vt(),e.preventDefault()}},$e=function(t,e){for(var n=t.target,i=Z(),r=-1,o=0;o<i.length;o++)if(n===i[o]){r=o;break}Ve(0,r,t.shiftKey?-1:1),t.stopPropagation(),t.preventDefault()},Ge=function(t){if(-1!==[F(),B(),U()].indexOf(document.activeElement)){var e=-1!==Ue.indexOf(t)?"nextElementSibling":"previousElementSibling",n=document.activeElement[e];n&&n.focus()}},Ze=function(t,e,n){_(e.allowEscapeKey)&&(t.preventDefault(),n(b.esc))},He=!1,We=function(e,n){var i=function(e){var n="string"==typeof e.template?document.querySelector(e.template):e.template;if(!n)return{};var i=n.content||n;return function(t){var e=Te.concat(["swal-param","swal-button","swal-image","swal-icon","swal-input","swal-input-option"]);p(t.querySelectorAll("*")).forEach(function(n){if(n.parentNode===t){var i=n.tagName.toLowerCase();-1===e.indexOf(i)&&f("Unrecognized element <".concat(i,">"))}})}(i),r(function(e){var n={};return p(e.querySelectorAll("swal-param")).forEach(function(e){Se(e,["name","value"]);var i=e.getAttribute("name"),r=e.getAttribute("value");"boolean"==typeof Ht[i]&&"false"===r&&(r=!1),"object"===t(Ht[i])&&(r=JSON.parse(r)),n[i]=r}),n}(i),function(t){var e={};return p(t.querySelectorAll("swal-button")).forEach(function(t){Se(t,["type","color","aria-label"]);var n=t.getAttribute("type");e["".concat(n,"ButtonText")]=t.innerHTML,e["show".concat(h(n),"Button")]=!0,t.hasAttribute("color")&&(e["".concat(n,"ButtonColor")]=t.getAttribute("color")),t.hasAttribute("aria-label")&&(e["".concat(n,"ButtonAriaLabel")]=t.getAttribute("aria-label"))}),e}(i),function(t){var e={},n=t.querySelector("swal-image");return n&&(Se(n,["src","width","height","alt"]),n.hasAttribute("src")&&(e.imageUrl=n.getAttribute("src")),n.hasAttribute("width")&&(e.imageWidth=n.getAttribute("width")),n.hasAttribute("height")&&(e.imageHeight=n.getAttribute("height")),n.hasAttribute("alt")&&(e.imageAlt=n.getAttribute("alt"))),e}(i),function(t){var e={},n=t.querySelector("swal-icon");return n&&(Se(n,["type","color"]),n.hasAttribute("type")&&(e.icon=n.getAttribute("type")),n.hasAttribute("color")&&(e.iconColor=n.getAttribute("color")),e.iconHtml=n.innerHTML),e}(i),function(t){var e={},n=t.querySelector("swal-input");n&&(Se(n,["type","label","placeholder","value"]),e.input=n.getAttribute("type")||"text",n.hasAttribute("label")&&(e.inputLabel=n.getAttribute("label")),n.hasAttribute("placeholder")&&(e.inputPlaceholder=n.getAttribute("placeholder")),n.hasAttribute("value")&&(e.inputValue=n.getAttribute("value")));var i=t.querySelectorAll("swal-input-option");return i.length&&(e.inputOptions={},p(i).forEach(function(t){Se(t,["value"]);var n=t.getAttribute("value");e.inputOptions[n]=t.innerHTML})),e}(i),function(t,e){var n={};for(var i in e){var r=e[i],o=t.querySelector(r);o&&(Se(o,[]),n[r.replace(/^swal-/,"")]=o.innerHTML)}return n}(i,Te))}(e),o=r({},Ht.showClass,n.showClass,i.showClass,e.showClass),s=r({},Ht.hideClass,n.hideClass,i.hideClass,e.hideClass),a=r({},Ht,n,i,e);return a.showClass=o,a.hideClass=s,!1===e.animation&&(a.showClass={popup:"swal2-noanimation",backdrop:"swal2-noanimation"},a.hideClass={}),a},Xe=function(e,n,i){return new Promise(function(r){var o=function(t){e.closePopup({isDismissed:!0,dismiss:t})};ue.swalPromiseResolve.set(e,r),n.confirmButton.onclick=function(){return function(t,e){t.disableButtons(),e.input?De(t,e,"confirm"):Be(t,e,!0)}(e,i)},n.denyButton.onclick=function(){return function(t,e){t.disableButtons(),e.returnInputValueOnDeny?De(t,e,"deny"):Re(t,e,!1)}(e,i)},n.cancelButton.onclick=function(){return function(t,e){t.disableButtons(),e(b.cancel)}(e,o)},n.closeButton.onclick=function(){return o(b.close)},function(t,e,n){Ct.innerParams.get(t).toast?function(t,e,n){e.popup.onclick=function(){var e=Ct.innerParams.get(t);e.showConfirmButton||e.showDenyButton||e.showCancelButton||e.showCloseButton||e.timer||e.input||n(b.close)}}(t,e,n):(function(t){t.popup.onmousedown=function(){t.container.onmouseup=function(e){t.container.onmouseup=void 0,e.target===t.container&&(He=!0)}}}(e),function(t){t.container.onmousedown=function(){t.popup.onmouseup=function(e){t.popup.onmouseup=void 0,(e.target===t.popup||t.popup.contains(e.target))&&(He=!0)}}}(e),function(t,e,n){e.container.onclick=function(i){var r=Ct.innerParams.get(t);He?He=!1:i.target===e.container&&_(r.allowOutsideClick)&&n(b.backdrop)}}(t,e,n))}(e,n,o),function(t,e,n,i){e.keydownTarget&&e.keydownHandlerAdded&&(e.keydownTarget.removeEventListener("keydown",e.keydownHandler,{capture:e.keydownListenerCapture}),e.keydownHandlerAdded=!1),n.toast||(e.keydownHandler=function(e){return function(t,e,n){var i=Ct.innerParams.get(t);i&&(i.stopKeydownPropagation&&e.stopPropagation(),"Enter"===e.key?qe(t,e,i):"Tab"===e.key?$e(e,i):-1!==[].concat(Ue,Ne).indexOf(e.key)?Ge(e.key):-1!==je.indexOf(e.key)&&Ze(e,i,n))}(t,e,i)},e.keydownTarget=n.keydownListenerCapture?window:I(),e.keydownListenerCapture=n.keydownListenerCapture,e.keydownTarget.addEventListener("keydown",e.keydownHandler,{capture:e.keydownListenerCapture}),e.keydownHandlerAdded=!0)}(e,Nt,i,o),i.toast&&(i.input||i.footer||i.showCloseButton)?it(document.body,T["toast-column"]):rt(document.body,T["toast-column"]),function(e,n){"select"===n.input||"radio"===n.input?function(e,n){var i=O(),r=function(t){return Me[n.input](i,Oe(t),n)};y(n.inputOptions)||x(n.inputOptions)?(Ut(F()),v(n.inputOptions).then(function(t){e.hideLoading(),r(t)})):"object"===t(n.inputOptions)?r(n.inputOptions):m("Unexpected type of inputOptions! Expected object, Map or Promise, got ".concat(t(n.inputOptions)))}(e,n):-1!==["text","email","number","tel","textarea"].indexOf(n.input)&&(y(n.inputValue)||x(n.inputValue))&&function(t,e){var n=t.getInput();lt(n),v(e.inputValue).then(function(i){n.value="number"===e.input?parseFloat(i)||0:"".concat(i),at(n),n.focus(),t.hideLoading()}).catch(function(e){m("Error in inputValue promise: ".concat(e)),n.value="",at(n),n.focus(),t.hideLoading()})}(e,n)}(e,i),function(t){var e=E(),n=I();"function"==typeof t.willOpen?t.willOpen(n):"function"==typeof t.onBeforeOpen&&t.onBeforeOpen(n);var i=window.getComputedStyle(document.body).overflowY;Pe(e,n,t),setTimeout(function(){Ae(e,n)},10),H()&&(Ie(e,t.scrollbarPadding,i),p(document.body.children).forEach(function(t){t===E()||function(t,e){if("function"==typeof t.contains)return t.contains(e)}(t,E())||(t.hasAttribute("aria-hidden")&&t.setAttribute("data-previous-aria-hidden",t.getAttribute("aria-hidden")),t.setAttribute("aria-hidden","true"))})),W()||Nt.previousActiveElement||(Nt.previousActiveElement=document.activeElement),Ee(n,t),rt(e,T["no-transition"])}(i),Ye(Nt,i,o),Je(n,i),setTimeout(function(){n.container.scrollTop=0})})},Ke=function(t){var e={popup:I(),container:E(),content:O(),actions:N(),confirmButton:F(),denyButton:B(),cancelButton:U(),loader:V(),closeButton:G(),validationMessage:R(),progressSteps:L()};return Ct.domCache.set(t,e),e},Ye=function(t,e,n){var i=$();lt(i),e.timer&&(t.timeout=new xe(function(){n("timer"),delete t.timeout},e.timer),e.timerProgressBar&&(at(i),setTimeout(function(){t.timeout&&t.timeout.running&&ft(e.timer)})))},Je=function(t,e){if(!e.toast)return _(e.allowEnterKey)?void(Qe(t,e)||Ve(0,-1,1)):tn()},Qe=function(t,e){return e.focusDeny&&ht(t.denyButton)?(t.denyButton.focus(),!0):e.focusCancel&&ht(t.cancelButton)?(t.cancelButton.focus(),!0):!(!e.focusConfirm||!ht(t.confirmButton)||(t.confirmButton.focus(),0))},tn=function(){document.activeElement&&"function"==typeof document.activeElement.blur&&document.activeElement.blur()},en=function(t){for(var e in t)t[e]=new WeakMap},nn=Object.freeze({hideLoading:re,disableLoading:re,getInput:function(t){var e=Ct.innerParams.get(t||this),n=Ct.domCache.get(t||this);return n?Q(n.content,e.input):null},close:de,closePopup:de,closeModal:de,closeToast:de,enableButtons:function(){ye(this,["confirmButton","denyButton","cancelButton"],!1)},disableButtons:function(){ye(this,["confirmButton","denyButton","cancelButton"],!0)},enableInput:function(){return ve(this.getInput(),!1)},disableInput:function(){return ve(this.getInput(),!0)},showValidationMessage:function(t){var e=Ct.domCache.get(this),n=Ct.innerParams.get(this);K(e.validationMessage,t),e.validationMessage.className=T["validation-message"],n.customClass&&n.customClass.validationMessage&&it(e.validationMessage,n.customClass.validationMessage),at(e.validationMessage);var i=this.getInput();i&&(i.setAttribute("aria-invalid",!0),i.setAttribute("aria-describedBy",T["validation-message"]),et(i),it(i,T.inputerror))},resetValidationMessage:function(){var t=Ct.domCache.get(this);t.validationMessage&&lt(t.validationMessage);var e=this.getInput();e&&(e.removeAttribute("aria-invalid"),e.removeAttribute("aria-describedBy"),rt(e,T.inputerror))},getProgressSteps:function(){return Ct.domCache.get(this).progressSteps},_main:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};ne(r({},e,t)),Nt.currentInstance&&Nt.currentInstance._destroy(),Nt.currentInstance=this;var n=We(t,e);we(n),Object.freeze(n),Nt.timeout&&(Nt.timeout.stop(),delete Nt.timeout),clearTimeout(Nt.restoreFocusTimeout);var i=Ke(this);return Bt(this,n),Ct.innerParams.set(this,n),Xe(this,i,n)},update:function(t){var e=I(),n=Ct.innerParams.get(this);if(!e||Y(e,n.hideClass.popup))return f("You're trying to update the closed or closing popup, that won't work. Use the update() method in preConfirm parameter or show a new popup.");var i={};Object.keys(t).forEach(function(e){on.isUpdatableParameter(e)?i[e]=t[e]:f('Invalid parameter to update: "'.concat(e,'". Updatable params are listed here: https://github.com/sweetalert2/sweetalert2/blob/master/src/utils/params.js\n\nIf you think this parameter should be updatable, request it here: https://github.com/sweetalert2/sweetalert2/issues/new?template=02_feature_request.md'))});var o=r({},n,i);Bt(this,o),Ct.innerParams.set(this,o),Object.defineProperties(this,{params:{value:r({},this.params,t),writable:!1,enumerable:!0}})},_destroy:function(){var t=Ct.domCache.get(this),e=Ct.innerParams.get(this);e&&(t.popup&&Nt.swalCloseEventFinishedCallback&&(Nt.swalCloseEventFinishedCallback(),delete Nt.swalCloseEventFinishedCallback),Nt.deferDisposalTimer&&(clearTimeout(Nt.deferDisposalTimer),delete Nt.deferDisposalTimer),function(t){"function"==typeof t.didDestroy?t.didDestroy():"function"==typeof t.onDestroy&&t.onDestroy()}(e),delete this.params,delete Nt.keydownHandler,delete Nt.keydownTarget,en(Ct),en(ue))}}),rn=function(){function t(){if(e(this,t),"undefined"!=typeof window){"undefined"==typeof Promise&&m("This package requires a Promise library, please include a shim to enable it in this browser (See: https://github.com/sweetalert2/sweetalert2/wiki/Migration-from-SweetAlert-to-SweetAlert2#1-ie-support)"),Ce=this;for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];var o=Object.freeze(this.constructor.argsToParams(i));Object.defineProperties(this,{params:{value:o,writable:!1,enumerable:!0,configurable:!0}});var s=this._main(this.params);Ct.promise.set(this,s)}}return i(t,[{key:"then",value:function(t){return Ct.promise.get(this).then(t)}},{key:"finally",value:function(t){return Ct.promise.get(this).finally(t)}}]),t}();r(rn.prototype,nn),r(rn,ie),Object.keys(nn).forEach(function(t){rn[t]=function(){var e;if(Ce)return(e=Ce)[t].apply(e,arguments)}}),rn.DismissReason=b,rn.version="10.15.7";var on=rn;return on.default=on,on}(),void 0!==this&&this.Sweetalert2&&(this.swal=this.sweetAlert=this.Swal=this.SweetAlert=this.Sweetalert2),"undefined"!=typeof document&&function(t,e){var n=t.createElement("style");if(t.getElementsByTagName("head")[0].appendChild(n),n.styleSheet)n.styleSheet.disabled||(n.styleSheet.cssText=e);else try{n.innerHTML=e}catch(t){n.innerText=e}}(document,'.swal2-popup.swal2-toast{flex-direction:row;align-items:center;width:auto;padding:.625em;overflow-y:hidden;background:#fff;box-shadow:0 0 .625em #d9d9d9}.swal2-popup.swal2-toast .swal2-header{flex-direction:row;padding:0}.swal2-popup.swal2-toast .swal2-title{flex-grow:1;justify-content:flex-start;margin:0 .6em;font-size:1em}.swal2-popup.swal2-toast .swal2-footer{margin:.5em 0 0;padding:.5em 0 0;font-size:.8em}.swal2-popup.swal2-toast .swal2-close{position:static;width:.8em;height:.8em;line-height:.8}.swal2-popup.swal2-toast .swal2-content{justify-content:flex-start;padding:0;font-size:1em}.swal2-popup.swal2-toast .swal2-icon{width:2em;min-width:2em;height:2em;margin:0}.swal2-popup.swal2-toast .swal2-icon .swal2-icon-content{display:flex;align-items:center;font-size:1.8em;font-weight:700}@media all and (-ms-high-contrast:none),(-ms-high-contrast:active){.swal2-popup.swal2-toast .swal2-icon .swal2-icon-content{font-size:.25em}}.swal2-popup.swal2-toast .swal2-icon.swal2-success .swal2-success-ring{width:2em;height:2em}.swal2-popup.swal2-toast .swal2-icon.swal2-error [class^=swal2-x-mark-line]{top:.875em;width:1.375em}.swal2-popup.swal2-toast .swal2-icon.swal2-error [class^=swal2-x-mark-line][class$=left]{left:.3125em}.swal2-popup.swal2-toast .swal2-icon.swal2-error [class^=swal2-x-mark-line][class$=right]{right:.3125em}.swal2-popup.swal2-toast .swal2-actions{flex-basis:auto!important;width:auto;height:auto;margin:0 .3125em;padding:0}.swal2-popup.swal2-toast .swal2-styled{margin:.125em .3125em;padding:.3125em .625em;font-size:1em}.swal2-popup.swal2-toast .swal2-styled:focus{box-shadow:0 0 0 1px #fff,0 0 0 3px rgba(100,150,200,.5)}.swal2-popup.swal2-toast .swal2-success{border-color:#a5dc86}.swal2-popup.swal2-toast .swal2-success [class^=swal2-success-circular-line]{position:absolute;width:1.6em;height:3em;transform:rotate(45deg);border-radius:50%}.swal2-popup.swal2-toast .swal2-success [class^=swal2-success-circular-line][class$=left]{top:-.8em;left:-.5em;transform:rotate(-45deg);transform-origin:2em 2em;border-radius:4em 0 0 4em}.swal2-popup.swal2-toast .swal2-success [class^=swal2-success-circular-line][class$=right]{top:-.25em;left:.9375em;transform-origin:0 1.5em;border-radius:0 4em 4em 0}.swal2-popup.swal2-toast .swal2-success .swal2-success-ring{width:2em;height:2em}.swal2-popup.swal2-toast .swal2-success .swal2-success-fix{top:0;left:.4375em;width:.4375em;height:2.6875em}.swal2-popup.swal2-toast .swal2-success [class^=swal2-success-line]{height:.3125em}.swal2-popup.swal2-toast .swal2-success [class^=swal2-success-line][class$=tip]{top:1.125em;left:.1875em;width:.75em}.swal2-popup.swal2-toast .swal2-success [class^=swal2-success-line][class$=long]{top:.9375em;right:.1875em;width:1.375em}.swal2-popup.swal2-toast .swal2-success.swal2-icon-show .swal2-success-line-tip{-webkit-animation:swal2-toast-animate-success-line-tip .75s;animation:swal2-toast-animate-success-line-tip .75s}.swal2-popup.swal2-toast .swal2-success.swal2-icon-show .swal2-success-line-long{-webkit-animation:swal2-toast-animate-success-line-long .75s;animation:swal2-toast-animate-success-line-long .75s}.swal2-popup.swal2-toast.swal2-show{-webkit-animation:swal2-toast-show .5s;animation:swal2-toast-show .5s}.swal2-popup.swal2-toast.swal2-hide{-webkit-animation:swal2-toast-hide .1s forwards;animation:swal2-toast-hide .1s forwards}.swal2-container{display:flex;position:fixed;z-index:1060;top:0;right:0;bottom:0;left:0;flex-direction:row;align-items:center;justify-content:center;padding:.625em;overflow-x:hidden;transition:background-color .1s;-webkit-overflow-scrolling:touch}.swal2-container.swal2-backdrop-show,.swal2-container.swal2-noanimation{background:rgba(0,0,0,.4)}.swal2-container.swal2-backdrop-hide{background:0 0!important}.swal2-container.swal2-top{align-items:flex-start}.swal2-container.swal2-top-left,.swal2-container.swal2-top-start{align-items:flex-start;justify-content:flex-start}.swal2-container.swal2-top-end,.swal2-container.swal2-top-right{align-items:flex-start;justify-content:flex-end}.swal2-container.swal2-center{align-items:center}.swal2-container.swal2-center-left,.swal2-container.swal2-center-start{align-items:center;justify-content:flex-start}.swal2-container.swal2-center-end,.swal2-container.swal2-center-right{align-items:center;justify-content:flex-end}.swal2-container.swal2-bottom{align-items:flex-end}.swal2-container.swal2-bottom-left,.swal2-container.swal2-bottom-start{align-items:flex-end;justify-content:flex-start}.swal2-container.swal2-bottom-end,.swal2-container.swal2-bottom-right{align-items:flex-end;justify-content:flex-end}.swal2-container.swal2-bottom-end>:first-child,.swal2-container.swal2-bottom-left>:first-child,.swal2-container.swal2-bottom-right>:first-child,.swal2-container.swal2-bottom-start>:first-child,.swal2-container.swal2-bottom>:first-child{margin-top:auto}.swal2-container.swal2-grow-fullscreen>.swal2-modal{display:flex!important;flex:1;align-self:stretch;justify-content:center}.swal2-container.swal2-grow-row>.swal2-modal{display:flex!important;flex:1;align-content:center;justify-content:center}.swal2-container.swal2-grow-column{flex:1;flex-direction:column}.swal2-container.swal2-grow-column.swal2-bottom,.swal2-container.swal2-grow-column.swal2-center,.swal2-container.swal2-grow-column.swal2-top{align-items:center}.swal2-container.swal2-grow-column.swal2-bottom-left,.swal2-container.swal2-grow-column.swal2-bottom-start,.swal2-container.swal2-grow-column.swal2-center-left,.swal2-container.swal2-grow-column.swal2-center-start,.swal2-container.swal2-grow-column.swal2-top-left,.swal2-container.swal2-grow-column.swal2-top-start{align-items:flex-start}.swal2-container.swal2-grow-column.swal2-bottom-end,.swal2-container.swal2-grow-column.swal2-bottom-right,.swal2-container.swal2-grow-column.swal2-center-end,.swal2-container.swal2-grow-column.swal2-center-right,.swal2-container.swal2-grow-column.swal2-top-end,.swal2-container.swal2-grow-column.swal2-top-right{align-items:flex-end}.swal2-container.swal2-grow-column>.swal2-modal{display:flex!important;flex:1;align-content:center;justify-content:center}.swal2-container.swal2-no-transition{transition:none!important}.swal2-container:not(.swal2-top):not(.swal2-top-start):not(.swal2-top-end):not(.swal2-top-left):not(.swal2-top-right):not(.swal2-center-start):not(.swal2-center-end):not(.swal2-center-left):not(.swal2-center-right):not(.swal2-bottom):not(.swal2-bottom-start):not(.swal2-bottom-end):not(.swal2-bottom-left):not(.swal2-bottom-right):not(.swal2-grow-fullscreen)>.swal2-modal{margin:auto}@media all and (-ms-high-contrast:none),(-ms-high-contrast:active){.swal2-container .swal2-modal{margin:0!important}}.swal2-popup{display:none;position:relative;box-sizing:border-box;flex-direction:column;justify-content:center;width:32em;max-width:100%;padding:1.25em;border:none;border-radius:5px;background:#fff;font-family:inherit;font-size:1rem}.swal2-popup:focus{outline:0}.swal2-popup.swal2-loading{overflow-y:hidden}.swal2-header{display:flex;flex-direction:column;align-items:center;padding:0 1.8em}.swal2-title{position:relative;max-width:100%;margin:0 0 .4em;padding:0;color:#595959;font-size:1.875em;font-weight:600;text-align:center;text-transform:none;word-wrap:break-word}.swal2-actions{display:flex;z-index:1;box-sizing:border-box;flex-wrap:wrap;align-items:center;justify-content:center;width:100%;margin:1.25em auto 0;padding:0 1.6em}.swal2-actions:not(.swal2-loading) .swal2-styled[disabled]{opacity:.4}.swal2-actions:not(.swal2-loading) .swal2-styled:hover{background-image:linear-gradient(rgba(0,0,0,.1),rgba(0,0,0,.1))}.swal2-actions:not(.swal2-loading) .swal2-styled:active{background-image:linear-gradient(rgba(0,0,0,.2),rgba(0,0,0,.2))}.swal2-loader{display:none;align-items:center;justify-content:center;width:2.2em;height:2.2em;margin:0 1.875em;-webkit-animation:swal2-rotate-loading 1.5s linear 0s infinite normal;animation:swal2-rotate-loading 1.5s linear 0s infinite normal;border-width:.25em;border-style:solid;border-radius:100%;border-color:#2778c4 transparent #2778c4 transparent}.swal2-styled{margin:.3125em;padding:.625em 1.1em;box-shadow:none;font-weight:500}.swal2-styled:not([disabled]){cursor:pointer}.swal2-styled.swal2-confirm{border:0;border-radius:.25em;background:initial;background-color:#2778c4;color:#fff;font-size:1.0625em}.swal2-styled.swal2-deny{border:0;border-radius:.25em;background:initial;background-color:#d14529;color:#fff;font-size:1.0625em}.swal2-styled.swal2-cancel{border:0;border-radius:.25em;background:initial;background-color:#757575;color:#fff;font-size:1.0625em}.swal2-styled:focus{outline:0;box-shadow:0 0 0 3px rgba(100,150,200,.5)}.swal2-styled::-moz-focus-inner{border:0}.swal2-footer{justify-content:center;margin:1.25em 0 0;padding:1em 0 0;border-top:1px solid #eee;color:#545454;font-size:1em}.swal2-timer-progress-bar-container{position:absolute;right:0;bottom:0;left:0;height:.25em;overflow:hidden;border-bottom-right-radius:5px;border-bottom-left-radius:5px}.swal2-timer-progress-bar{width:100%;height:.25em;background:rgba(0,0,0,.2)}.swal2-image{max-width:100%;margin:1.25em auto}.swal2-close{position:absolute;z-index:2;top:0;right:0;align-items:center;justify-content:center;width:1.2em;height:1.2em;padding:0;overflow:hidden;transition:color .1s ease-out;border:none;border-radius:5px;background:0 0;color:#ccc;font-family:serif;font-size:2.5em;line-height:1.2;cursor:pointer}.swal2-close:hover{transform:none;background:0 0;color:#f27474}.swal2-close:focus{outline:0;box-shadow:inset 0 0 0 3px rgba(100,150,200,.5)}.swal2-close::-moz-focus-inner{border:0}.swal2-content{z-index:1;justify-content:center;margin:0;padding:0 1.6em;color:#545454;font-size:1.125em;font-weight:400;line-height:normal;text-align:center;word-wrap:break-word}.swal2-checkbox,.swal2-file,.swal2-input,.swal2-radio,.swal2-select,.swal2-textarea{margin:1em auto}.swal2-file,.swal2-input,.swal2-textarea{box-sizing:border-box;width:100%;transition:border-color .3s,box-shadow .3s;border:1px solid #d9d9d9;border-radius:.1875em;background:inherit;box-shadow:inset 0 1px 1px rgba(0,0,0,.06);color:inherit;font-size:1.125em}.swal2-file.swal2-inputerror,.swal2-input.swal2-inputerror,.swal2-textarea.swal2-inputerror{border-color:#f27474!important;box-shadow:0 0 2px #f27474!important}.swal2-file:focus,.swal2-input:focus,.swal2-textarea:focus{border:1px solid #b4dbed;outline:0;box-shadow:0 0 0 3px rgba(100,150,200,.5)}.swal2-file::-moz-placeholder,.swal2-input::-moz-placeholder,.swal2-textarea::-moz-placeholder{color:#ccc}.swal2-file:-ms-input-placeholder,.swal2-input:-ms-input-placeholder,.swal2-textarea:-ms-input-placeholder{color:#ccc}.swal2-file::placeholder,.swal2-input::placeholder,.swal2-textarea::placeholder{color:#ccc}.swal2-range{margin:1em auto;background:#fff}.swal2-range input{width:80%}.swal2-range output{width:20%;color:inherit;font-weight:600;text-align:center}.swal2-range input,.swal2-range output{height:2.625em;padding:0;font-size:1.125em;line-height:2.625em}.swal2-input{height:2.625em;padding:0 .75em}.swal2-input[type=number]{max-width:10em}.swal2-file{background:inherit;font-size:1.125em}.swal2-textarea{height:6.75em;padding:.75em}.swal2-select{min-width:50%;max-width:100%;padding:.375em .625em;background:inherit;color:inherit;font-size:1.125em}.swal2-checkbox,.swal2-radio{align-items:center;justify-content:center;background:#fff;color:inherit}.swal2-checkbox label,.swal2-radio label{margin:0 .6em;font-size:1.125em}.swal2-checkbox input,.swal2-radio input{margin:0 .4em}.swal2-input-label{display:flex;justify-content:center;margin:1em auto}.swal2-validation-message{align-items:center;justify-content:center;margin:0 -2.7em;padding:.625em;overflow:hidden;background:#f0f0f0;color:#666;font-size:1em;font-weight:300}.swal2-validation-message::before{content:"!";display:inline-block;width:1.5em;min-width:1.5em;height:1.5em;margin:0 .625em;border-radius:50%;background-color:#f27474;color:#fff;font-weight:600;line-height:1.5em;text-align:center}.swal2-icon{position:relative;box-sizing:content-box;justify-content:center;width:5em;height:5em;margin:1.25em auto 1.875em;border:.25em solid transparent;border-radius:50%;border-color:#000;font-family:inherit;line-height:5em;cursor:default;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.swal2-icon .swal2-icon-content{display:flex;align-items:center;font-size:3.75em}.swal2-icon.swal2-error{border-color:#f27474;color:#f27474}.swal2-icon.swal2-error .swal2-x-mark{position:relative;flex-grow:1}.swal2-icon.swal2-error [class^=swal2-x-mark-line]{display:block;position:absolute;top:2.3125em;width:2.9375em;height:.3125em;border-radius:.125em;background-color:#f27474}.swal2-icon.swal2-error [class^=swal2-x-mark-line][class$=left]{left:1.0625em;transform:rotate(45deg)}.swal2-icon.swal2-error [class^=swal2-x-mark-line][class$=right]{right:1em;transform:rotate(-45deg)}.swal2-icon.swal2-error.swal2-icon-show{-webkit-animation:swal2-animate-error-icon .5s;animation:swal2-animate-error-icon .5s}.swal2-icon.swal2-error.swal2-icon-show .swal2-x-mark{-webkit-animation:swal2-animate-error-x-mark .5s;animation:swal2-animate-error-x-mark .5s}.swal2-icon.swal2-warning{border-color:#facea8;color:#f8bb86}.swal2-icon.swal2-info{border-color:#9de0f6;color:#3fc3ee}.swal2-icon.swal2-question{border-color:#c9dae1;color:#87adbd}.swal2-icon.swal2-success{border-color:#a5dc86;color:#a5dc86}.swal2-icon.swal2-success [class^=swal2-success-circular-line]{position:absolute;width:3.75em;height:7.5em;transform:rotate(45deg);border-radius:50%}.swal2-icon.swal2-success [class^=swal2-success-circular-line][class$=left]{top:-.4375em;left:-2.0635em;transform:rotate(-45deg);transform-origin:3.75em 3.75em;border-radius:7.5em 0 0 7.5em}.swal2-icon.swal2-success [class^=swal2-success-circular-line][class$=right]{top:-.6875em;left:1.875em;transform:rotate(-45deg);transform-origin:0 3.75em;border-radius:0 7.5em 7.5em 0}.swal2-icon.swal2-success .swal2-success-ring{position:absolute;z-index:2;top:-.25em;left:-.25em;box-sizing:content-box;width:100%;height:100%;border:.25em solid rgba(165,220,134,.3);border-radius:50%}.swal2-icon.swal2-success .swal2-success-fix{position:absolute;z-index:1;top:.5em;left:1.625em;width:.4375em;height:5.625em;transform:rotate(-45deg)}.swal2-icon.swal2-success [class^=swal2-success-line]{display:block;position:absolute;z-index:2;height:.3125em;border-radius:.125em;background-color:#a5dc86}.swal2-icon.swal2-success [class^=swal2-success-line][class$=tip]{top:2.875em;left:.8125em;width:1.5625em;transform:rotate(45deg)}.swal2-icon.swal2-success [class^=swal2-success-line][class$=long]{top:2.375em;right:.5em;width:2.9375em;transform:rotate(-45deg)}.swal2-icon.swal2-success.swal2-icon-show .swal2-success-line-tip{-webkit-animation:swal2-animate-success-line-tip .75s;animation:swal2-animate-success-line-tip .75s}.swal2-icon.swal2-success.swal2-icon-show .swal2-success-line-long{-webkit-animation:swal2-animate-success-line-long .75s;animation:swal2-animate-success-line-long .75s}.swal2-icon.swal2-success.swal2-icon-show .swal2-success-circular-line-right{-webkit-animation:swal2-rotate-success-circular-line 4.25s ease-in;animation:swal2-rotate-success-circular-line 4.25s ease-in}.swal2-progress-steps{flex-wrap:wrap;align-items:center;max-width:100%;margin:0 0 1.25em;padding:0;background:inherit;font-weight:600}.swal2-progress-steps li{display:inline-block;position:relative}.swal2-progress-steps .swal2-progress-step{z-index:20;flex-shrink:0;width:2em;height:2em;border-radius:2em;background:#2778c4;color:#fff;line-height:2em;text-align:center}.swal2-progress-steps .swal2-progress-step.swal2-active-progress-step{background:#2778c4}.swal2-progress-steps .swal2-progress-step.swal2-active-progress-step~.swal2-progress-step{background:#add8e6;color:#fff}.swal2-progress-steps .swal2-progress-step.swal2-active-progress-step~.swal2-progress-step-line{background:#add8e6}.swal2-progress-steps .swal2-progress-step-line{z-index:10;flex-shrink:0;width:2.5em;height:.4em;margin:0 -1px;background:#2778c4}[class^=swal2]{-webkit-tap-highlight-color:transparent}.swal2-show{-webkit-animation:swal2-show .3s;animation:swal2-show .3s}.swal2-hide{-webkit-animation:swal2-hide .15s forwards;animation:swal2-hide .15s forwards}.swal2-noanimation{transition:none}.swal2-scrollbar-measure{position:absolute;top:-9999px;width:50px;height:50px;overflow:scroll}.swal2-rtl .swal2-close{right:auto;left:0}.swal2-rtl .swal2-timer-progress-bar{right:0;left:auto}@supports (-ms-accelerator:true){.swal2-range input{width:100%!important}.swal2-range output{display:none}}@media all and (-ms-high-contrast:none),(-ms-high-contrast:active){.swal2-range input{width:100%!important}.swal2-range output{display:none}}@-webkit-keyframes swal2-toast-show{0%{transform:translateY(-.625em) rotateZ(2deg)}33%{transform:translateY(0) rotateZ(-2deg)}66%{transform:translateY(.3125em) rotateZ(2deg)}100%{transform:translateY(0) rotateZ(0)}}@keyframes swal2-toast-show{0%{transform:translateY(-.625em) rotateZ(2deg)}33%{transform:translateY(0) rotateZ(-2deg)}66%{transform:translateY(.3125em) rotateZ(2deg)}100%{transform:translateY(0) rotateZ(0)}}@-webkit-keyframes swal2-toast-hide{100%{transform:rotateZ(1deg);opacity:0}}@keyframes swal2-toast-hide{100%{transform:rotateZ(1deg);opacity:0}}@-webkit-keyframes swal2-toast-animate-success-line-tip{0%{top:.5625em;left:.0625em;width:0}54%{top:.125em;left:.125em;width:0}70%{top:.625em;left:-.25em;width:1.625em}84%{top:1.0625em;left:.75em;width:.5em}100%{top:1.125em;left:.1875em;width:.75em}}@keyframes swal2-toast-animate-success-line-tip{0%{top:.5625em;left:.0625em;width:0}54%{top:.125em;left:.125em;width:0}70%{top:.625em;left:-.25em;width:1.625em}84%{top:1.0625em;left:.75em;width:.5em}100%{top:1.125em;left:.1875em;width:.75em}}@-webkit-keyframes swal2-toast-animate-success-line-long{0%{top:1.625em;right:1.375em;width:0}65%{top:1.25em;right:.9375em;width:0}84%{top:.9375em;right:0;width:1.125em}100%{top:.9375em;right:.1875em;width:1.375em}}@keyframes swal2-toast-animate-success-line-long{0%{top:1.625em;right:1.375em;width:0}65%{top:1.25em;right:.9375em;width:0}84%{top:.9375em;right:0;width:1.125em}100%{top:.9375em;right:.1875em;width:1.375em}}@-webkit-keyframes swal2-show{0%{transform:scale(.7)}45%{transform:scale(1.05)}80%{transform:scale(.95)}100%{transform:scale(1)}}@keyframes swal2-show{0%{transform:scale(.7)}45%{transform:scale(1.05)}80%{transform:scale(.95)}100%{transform:scale(1)}}@-webkit-keyframes swal2-hide{0%{transform:scale(1);opacity:1}100%{transform:scale(.5);opacity:0}}@keyframes swal2-hide{0%{transform:scale(1);opacity:1}100%{transform:scale(.5);opacity:0}}@-webkit-keyframes swal2-animate-success-line-tip{0%{top:1.1875em;left:.0625em;width:0}54%{top:1.0625em;left:.125em;width:0}70%{top:2.1875em;left:-.375em;width:3.125em}84%{top:3em;left:1.3125em;width:1.0625em}100%{top:2.8125em;left:.8125em;width:1.5625em}}@keyframes swal2-animate-success-line-tip{0%{top:1.1875em;left:.0625em;width:0}54%{top:1.0625em;left:.125em;width:0}70%{top:2.1875em;left:-.375em;width:3.125em}84%{top:3em;left:1.3125em;width:1.0625em}100%{top:2.8125em;left:.8125em;width:1.5625em}}@-webkit-keyframes swal2-animate-success-line-long{0%{top:3.375em;right:2.875em;width:0}65%{top:3.375em;right:2.875em;width:0}84%{top:2.1875em;right:0;width:3.4375em}100%{top:2.375em;right:.5em;width:2.9375em}}@keyframes swal2-animate-success-line-long{0%{top:3.375em;right:2.875em;width:0}65%{top:3.375em;right:2.875em;width:0}84%{top:2.1875em;right:0;width:3.4375em}100%{top:2.375em;right:.5em;width:2.9375em}}@-webkit-keyframes swal2-rotate-success-circular-line{0%{transform:rotate(-45deg)}5%{transform:rotate(-45deg)}12%{transform:rotate(-405deg)}100%{transform:rotate(-405deg)}}@keyframes swal2-rotate-success-circular-line{0%{transform:rotate(-45deg)}5%{transform:rotate(-45deg)}12%{transform:rotate(-405deg)}100%{transform:rotate(-405deg)}}@-webkit-keyframes swal2-animate-error-x-mark{0%{margin-top:1.625em;transform:scale(.4);opacity:0}50%{margin-top:1.625em;transform:scale(.4);opacity:0}80%{margin-top:-.375em;transform:scale(1.15)}100%{margin-top:0;transform:scale(1);opacity:1}}@keyframes swal2-animate-error-x-mark{0%{margin-top:1.625em;transform:scale(.4);opacity:0}50%{margin-top:1.625em;transform:scale(.4);opacity:0}80%{margin-top:-.375em;transform:scale(1.15)}100%{margin-top:0;transform:scale(1);opacity:1}}@-webkit-keyframes swal2-animate-error-icon{0%{transform:rotateX(100deg);opacity:0}100%{transform:rotateX(0);opacity:1}}@keyframes swal2-animate-error-icon{0%{transform:rotateX(100deg);opacity:0}100%{transform:rotateX(0);opacity:1}}@-webkit-keyframes swal2-rotate-loading{0%{transform:rotate(0)}100%{transform:rotate(360deg)}}@keyframes swal2-rotate-loading{0%{transform:rotate(0)}100%{transform:rotate(360deg)}}body.swal2-shown:not(.swal2-no-backdrop):not(.swal2-toast-shown){overflow:hidden}body.swal2-height-auto{height:auto!important}body.swal2-no-backdrop .swal2-container{top:auto;right:auto;bottom:auto;left:auto;max-width:calc(100% - .625em * 2);background-color:transparent!important}body.swal2-no-backdrop .swal2-container>.swal2-modal{box-shadow:0 0 10px rgba(0,0,0,.4)}body.swal2-no-backdrop .swal2-container.swal2-top{top:0;left:50%;transform:translateX(-50%)}body.swal2-no-backdrop .swal2-container.swal2-top-left,body.swal2-no-backdrop .swal2-container.swal2-top-start{top:0;left:0}body.swal2-no-backdrop .swal2-container.swal2-top-end,body.swal2-no-backdrop .swal2-container.swal2-top-right{top:0;right:0}body.swal2-no-backdrop .swal2-container.swal2-center{top:50%;left:50%;transform:translate(-50%,-50%)}body.swal2-no-backdrop .swal2-container.swal2-center-left,body.swal2-no-backdrop .swal2-container.swal2-center-start{top:50%;left:0;transform:translateY(-50%)}body.swal2-no-backdrop .swal2-container.swal2-center-end,body.swal2-no-backdrop .swal2-container.swal2-center-right{top:50%;right:0;transform:translateY(-50%)}body.swal2-no-backdrop .swal2-container.swal2-bottom{bottom:0;left:50%;transform:translateX(-50%)}body.swal2-no-backdrop .swal2-container.swal2-bottom-left,body.swal2-no-backdrop .swal2-container.swal2-bottom-start{bottom:0;left:0}body.swal2-no-backdrop .swal2-container.swal2-bottom-end,body.swal2-no-backdrop .swal2-container.swal2-bottom-right{right:0;bottom:0}@media print{body.swal2-shown:not(.swal2-no-backdrop):not(.swal2-toast-shown){overflow-y:scroll!important}body.swal2-shown:not(.swal2-no-backdrop):not(.swal2-toast-shown)>[aria-hidden=true]{display:none}body.swal2-shown:not(.swal2-no-backdrop):not(.swal2-toast-shown) .swal2-container{position:static!important}}body.swal2-toast-shown .swal2-container{background-color:transparent}body.swal2-toast-shown .swal2-container.swal2-top{top:0;right:auto;bottom:auto;left:50%;transform:translateX(-50%)}body.swal2-toast-shown .swal2-container.swal2-top-end,body.swal2-toast-shown .swal2-container.swal2-top-right{top:0;right:0;bottom:auto;left:auto}body.swal2-toast-shown .swal2-container.swal2-top-left,body.swal2-toast-shown .swal2-container.swal2-top-start{top:0;right:auto;bottom:auto;left:0}body.swal2-toast-shown .swal2-container.swal2-center-left,body.swal2-toast-shown .swal2-container.swal2-center-start{top:50%;right:auto;bottom:auto;left:0;transform:translateY(-50%)}body.swal2-toast-shown .swal2-container.swal2-center{top:50%;right:auto;bottom:auto;left:50%;transform:translate(-50%,-50%)}body.swal2-toast-shown .swal2-container.swal2-center-end,body.swal2-toast-shown .swal2-container.swal2-center-right{top:50%;right:0;bottom:auto;left:auto;transform:translateY(-50%)}body.swal2-toast-shown .swal2-container.swal2-bottom-left,body.swal2-toast-shown .swal2-container.swal2-bottom-start{top:auto;right:auto;bottom:0;left:0}body.swal2-toast-shown .swal2-container.swal2-bottom{top:auto;right:auto;bottom:0;left:50%;transform:translateX(-50%)}body.swal2-toast-shown .swal2-container.swal2-bottom-end,body.swal2-toast-shown .swal2-container.swal2-bottom-right{top:auto;right:0;bottom:0;left:auto}body.swal2-toast-column .swal2-toast{flex-direction:column;align-items:stretch}body.swal2-toast-column .swal2-toast .swal2-actions{flex:1;align-self:stretch;height:2.2em;margin-top:.3125em}body.swal2-toast-column .swal2-toast .swal2-loading{justify-content:center}body.swal2-toast-column .swal2-toast .swal2-input{height:2em;margin:.3125em auto;font-size:1em}body.swal2-toast-column .swal2-toast .swal2-validation-message{font-size:1em}')},zUnb:function(t,e,n){"use strict";function i(t){return"function"==typeof t}n.r(e);let r=!1;const o={Promise:void 0,set useDeprecatedSynchronousErrorHandling(t){if(t){const t=new Error;console.warn("DEPRECATED! RxJS was set to use deprecated synchronous error handling behavior by code at: \n"+t.stack)}else r&&console.log("RxJS: Back to a better error behavior. Thank you. <3");r=t},get useDeprecatedSynchronousErrorHandling(){return r}};function s(t){setTimeout(()=>{throw t},0)}const a={closed:!0,next(t){},error(t){if(o.useDeprecatedSynchronousErrorHandling)throw t;s(t)},complete(){}},l=(()=>Array.isArray||(t=>t&&"number"==typeof t.length))();function c(t){return null!==t&&"object"==typeof t}const u=(()=>{function t(t){return Error.call(this),this.message=t?`${t.length} errors occurred during unsubscription:\n${t.map((t,e)=>`${e+1}) ${t.toString()}`).join("\n  ")}`:"",this.name="UnsubscriptionError",this.errors=t,this}return t.prototype=Object.create(Error.prototype),t})();let h=(()=>{class t{constructor(t){this.closed=!1,this._parentOrParents=null,this._subscriptions=null,t&&(this._ctorUnsubscribe=!0,this._unsubscribe=t)}unsubscribe(){let e;if(this.closed)return;let{_parentOrParents:n,_ctorUnsubscribe:r,_unsubscribe:o,_subscriptions:s}=this;if(this.closed=!0,this._parentOrParents=null,this._subscriptions=null,n instanceof t)n.remove(this);else if(null!==n)for(let t=0;t<n.length;++t)n[t].remove(this);if(i(o)){r&&(this._unsubscribe=void 0);try{o.call(this)}catch(a){e=a instanceof u?d(a.errors):[a]}}if(l(s)){let t=-1,n=s.length;for(;++t<n;){const n=s[t];if(c(n))try{n.unsubscribe()}catch(a){e=e||[],a instanceof u?e=e.concat(d(a.errors)):e.push(a)}}}if(e)throw new u(e)}add(e){let n=e;if(!e)return t.EMPTY;switch(typeof e){case"function":n=new t(e);case"object":if(n===this||n.closed||"function"!=typeof n.unsubscribe)return n;if(this.closed)return n.unsubscribe(),n;if(!(n instanceof t)){const e=n;n=new t,n._subscriptions=[e]}break;default:throw new Error("unrecognized teardown "+e+" added to Subscription.")}let{_parentOrParents:i}=n;if(null===i)n._parentOrParents=this;else if(i instanceof t){if(i===this)return n;n._parentOrParents=[i,this]}else{if(-1!==i.indexOf(this))return n;i.push(this)}const r=this._subscriptions;return null===r?this._subscriptions=[n]:r.push(n),n}remove(t){const e=this._subscriptions;if(e){const n=e.indexOf(t);-1!==n&&e.splice(n,1)}}}return t.EMPTY=function(t){return t.closed=!0,t}(new t),t})();function d(t){return t.reduce((t,e)=>t.concat(e instanceof u?e.errors:e),[])}const p=(()=>"function"==typeof Symbol?Symbol("rxSubscriber"):"@@rxSubscriber_"+Math.random())();class f extends h{constructor(t,e,n){switch(super(),this.syncErrorValue=null,this.syncErrorThrown=!1,this.syncErrorThrowable=!1,this.isStopped=!1,arguments.length){case 0:this.destination=a;break;case 1:if(!t){this.destination=a;break}if("object"==typeof t){t instanceof f?(this.syncErrorThrowable=t.syncErrorThrowable,this.destination=t,t.add(this)):(this.syncErrorThrowable=!0,this.destination=new m(this,t));break}default:this.syncErrorThrowable=!0,this.destination=new m(this,t,e,n)}}[p](){return this}static create(t,e,n){const i=new f(t,e,n);return i.syncErrorThrowable=!1,i}next(t){this.isStopped||this._next(t)}error(t){this.isStopped||(this.isStopped=!0,this._error(t))}complete(){this.isStopped||(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe())}_next(t){this.destination.next(t)}_error(t){this.destination.error(t),this.unsubscribe()}_complete(){this.destination.complete(),this.unsubscribe()}_unsubscribeAndRecycle(){const{_parentOrParents:t}=this;return this._parentOrParents=null,this.unsubscribe(),this.closed=!1,this.isStopped=!1,this._parentOrParents=t,this}}class m extends f{constructor(t,e,n,r){let o;super(),this._parentSubscriber=t;let s=this;i(e)?o=e:e&&(o=e.next,n=e.error,r=e.complete,e!==a&&(s=Object.create(e),i(s.unsubscribe)&&this.add(s.unsubscribe.bind(s)),s.unsubscribe=this.unsubscribe.bind(this))),this._context=s,this._next=o,this._error=n,this._complete=r}next(t){if(!this.isStopped&&this._next){const{_parentSubscriber:e}=this;o.useDeprecatedSynchronousErrorHandling&&e.syncErrorThrowable?this.__tryOrSetError(e,this._next,t)&&this.unsubscribe():this.__tryOrUnsub(this._next,t)}}error(t){if(!this.isStopped){const{_parentSubscriber:e}=this,{useDeprecatedSynchronousErrorHandling:n}=o;if(this._error)n&&e.syncErrorThrowable?(this.__tryOrSetError(e,this._error,t),this.unsubscribe()):(this.__tryOrUnsub(this._error,t),this.unsubscribe());else if(e.syncErrorThrowable)n?(e.syncErrorValue=t,e.syncErrorThrown=!0):s(t),this.unsubscribe();else{if(this.unsubscribe(),n)throw t;s(t)}}}complete(){if(!this.isStopped){const{_parentSubscriber:t}=this;if(this._complete){const e=()=>this._complete.call(this._context);o.useDeprecatedSynchronousErrorHandling&&t.syncErrorThrowable?(this.__tryOrSetError(t,e),this.unsubscribe()):(this.__tryOrUnsub(e),this.unsubscribe())}else this.unsubscribe()}}__tryOrUnsub(t,e){try{t.call(this._context,e)}catch(n){if(this.unsubscribe(),o.useDeprecatedSynchronousErrorHandling)throw n;s(n)}}__tryOrSetError(t,e,n){if(!o.useDeprecatedSynchronousErrorHandling)throw new Error("bad call");try{e.call(this._context,n)}catch(i){return o.useDeprecatedSynchronousErrorHandling?(t.syncErrorValue=i,t.syncErrorThrown=!0,!0):(s(i),!0)}return!1}_unsubscribe(){const{_parentSubscriber:t}=this;this._context=null,this._parentSubscriber=null,t.unsubscribe()}}const g=(()=>"function"==typeof Symbol&&Symbol.observable||"@@observable")();function _(t){return t}let y=(()=>{class t{constructor(t){this._isScalar=!1,t&&(this._subscribe=t)}lift(e){const n=new t;return n.source=this,n.operator=e,n}subscribe(t,e,n){const{operator:i}=this,r=function(t,e,n){if(t){if(t instanceof f)return t;if(t[p])return t[p]()}return t||e||n?new f(t,e,n):new f(a)}(t,e,n);if(r.add(i?i.call(r,this.source):this.source||o.useDeprecatedSynchronousErrorHandling&&!r.syncErrorThrowable?this._subscribe(r):this._trySubscribe(r)),o.useDeprecatedSynchronousErrorHandling&&r.syncErrorThrowable&&(r.syncErrorThrowable=!1,r.syncErrorThrown))throw r.syncErrorValue;return r}_trySubscribe(t){try{return this._subscribe(t)}catch(e){o.useDeprecatedSynchronousErrorHandling&&(t.syncErrorThrown=!0,t.syncErrorValue=e),function(t){for(;t;){const{closed:e,destination:n,isStopped:i}=t;if(e||i)return!1;t=n&&n instanceof f?n:null}return!0}(t)?t.error(e):console.warn(e)}}forEach(t,e){return new(e=v(e))((e,n)=>{let i;i=this.subscribe(e=>{try{t(e)}catch(r){n(r),i&&i.unsubscribe()}},n,e)})}_subscribe(t){const{source:e}=this;return e&&e.subscribe(t)}[g](){return this}pipe(...t){return 0===t.length?this:(0===(e=t).length?_:1===e.length?e[0]:function(t){return e.reduce((t,e)=>e(t),t)})(this);var e}toPromise(t){return new(t=v(t))((t,e)=>{let n;this.subscribe(t=>n=t,t=>e(t),()=>t(n))})}}return t.create=e=>new t(e),t})();function v(t){if(t||(t=o.Promise||Promise),!t)throw new Error("no Promise impl found");return t}const x=(()=>{function t(){return Error.call(this),this.message="object unsubscribed",this.name="ObjectUnsubscribedError",this}return t.prototype=Object.create(Error.prototype),t})();class b extends h{constructor(t,e){super(),this.subject=t,this.subscriber=e,this.closed=!1}unsubscribe(){if(this.closed)return;this.closed=!0;const t=this.subject,e=t.observers;if(this.subject=null,!e||0===e.length||t.isStopped||t.closed)return;const n=e.indexOf(this.subscriber);-1!==n&&e.splice(n,1)}}class w extends f{constructor(t){super(t),this.destination=t}}let C=(()=>{class t extends y{constructor(){super(),this.observers=[],this.closed=!1,this.isStopped=!1,this.hasError=!1,this.thrownError=null}[p](){return new w(this)}lift(t){const e=new T(this,this);return e.operator=t,e}next(t){if(this.closed)throw new x;if(!this.isStopped){const{observers:e}=this,n=e.length,i=e.slice();for(let r=0;r<n;r++)i[r].next(t)}}error(t){if(this.closed)throw new x;this.hasError=!0,this.thrownError=t,this.isStopped=!0;const{observers:e}=this,n=e.length,i=e.slice();for(let r=0;r<n;r++)i[r].error(t);this.observers.length=0}complete(){if(this.closed)throw new x;this.isStopped=!0;const{observers:t}=this,e=t.length,n=t.slice();for(let i=0;i<e;i++)n[i].complete();this.observers.length=0}unsubscribe(){this.isStopped=!0,this.closed=!0,this.observers=null}_trySubscribe(t){if(this.closed)throw new x;return super._trySubscribe(t)}_subscribe(t){if(this.closed)throw new x;return this.hasError?(t.error(this.thrownError),h.EMPTY):this.isStopped?(t.complete(),h.EMPTY):(this.observers.push(t),new b(this,t))}asObservable(){const t=new y;return t.source=this,t}}return t.create=(t,e)=>new T(t,e),t})();class T extends C{constructor(t,e){super(),this.destination=t,this.source=e}next(t){const{destination:e}=this;e&&e.next&&e.next(t)}error(t){const{destination:e}=this;e&&e.error&&this.destination.error(t)}complete(){const{destination:t}=this;t&&t.complete&&this.destination.complete()}_subscribe(t){const{source:e}=this;return e?this.source.subscribe(t):h.EMPTY}}function S(t){return t&&"function"==typeof t.schedule}function E(t,e){return function(n){if("function"!=typeof t)throw new TypeError("argument is not a function. Are you looking for `mapTo()`?");return n.lift(new k(t,e))}}class k{constructor(t,e){this.project=t,this.thisArg=e}call(t,e){return e.subscribe(new A(t,this.project,this.thisArg))}}class A extends f{constructor(t,e,n){super(t),this.project=e,this.count=0,this.thisArg=n||this}_next(t){let e;try{e=this.project.call(this.thisArg,t,this.count++)}catch(n){return void this.destination.error(n)}this.destination.next(e)}}const I=t=>e=>{for(let n=0,i=t.length;n<i&&!e.closed;n++)e.next(t[n]);e.complete()};function P(){return"function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"}const M=P(),O=t=>t&&"number"==typeof t.length&&"function"!=typeof t;function z(t){return!!t&&"function"!=typeof t.subscribe&&"function"==typeof t.then}const D=t=>{if(t&&"function"==typeof t[g])return i=t,t=>{const e=i[g]();if("function"!=typeof e.subscribe)throw new TypeError("Provided object does not correctly implement Symbol.observable");return e.subscribe(t)};if(O(t))return I(t);if(z(t))return n=t,t=>(n.then(e=>{t.closed||(t.next(e),t.complete())},e=>t.error(e)).then(null,s),t);if(t&&"function"==typeof t[M])return e=t,t=>{const n=e[M]();for(;;){let e;try{e=n.next()}catch(i){return t.error(i),t}if(e.done){t.complete();break}if(t.next(e.value),t.closed)break}return"function"==typeof n.return&&t.add(()=>{n.return&&n.return()}),t};{const e=c(t)?"an invalid object":`'${t}'`;throw new TypeError(`You provided ${e} where a stream was expected. You can provide an Observable, Promise, Array, or Iterable.`)}var e,n,i};function L(t,e){return new y(n=>{const i=new h;let r=0;return i.add(e.schedule(function(){r!==t.length?(n.next(t[r++]),n.closed||i.add(this.schedule())):n.complete()})),i})}function R(t,e){return e?function(t,e){if(null!=t){if(function(t){return t&&"function"==typeof t[g]}(t))return function(t,e){return new y(n=>{const i=new h;return i.add(e.schedule(()=>{const r=t[g]();i.add(r.subscribe({next(t){i.add(e.schedule(()=>n.next(t)))},error(t){i.add(e.schedule(()=>n.error(t)))},complete(){i.add(e.schedule(()=>n.complete()))}}))})),i})}(t,e);if(z(t))return function(t,e){return new y(n=>{const i=new h;return i.add(e.schedule(()=>t.then(t=>{i.add(e.schedule(()=>{n.next(t),i.add(e.schedule(()=>n.complete()))}))},t=>{i.add(e.schedule(()=>n.error(t)))}))),i})}(t,e);if(O(t))return L(t,e);if(function(t){return t&&"function"==typeof t[M]}(t)||"string"==typeof t)return function(t,e){if(!t)throw new Error("Iterable cannot be null");return new y(n=>{const i=new h;let r;return i.add(()=>{r&&"function"==typeof r.return&&r.return()}),i.add(e.schedule(()=>{r=t[M](),i.add(e.schedule(function(){if(n.closed)return;let t,e;try{const n=r.next();t=n.value,e=n.done}catch(i){return void n.error(i)}e?n.complete():(n.next(t),this.schedule())}))})),i})}(t,e)}throw new TypeError((null!==t&&typeof t||t)+" is not observable")}(t,e):t instanceof y?t:new y(D(t))}class F extends f{constructor(t){super(),this.parent=t}_next(t){this.parent.notifyNext(t)}_error(t){this.parent.notifyError(t),this.unsubscribe()}_complete(){this.parent.notifyComplete(),this.unsubscribe()}}class B extends f{notifyNext(t){this.destination.next(t)}notifyError(t){this.destination.error(t)}notifyComplete(){this.destination.complete()}}function V(t,e){if(!e.closed)return t instanceof y?t.subscribe(e):D(t)(e)}function U(t,e,n=Number.POSITIVE_INFINITY){return"function"==typeof e?i=>i.pipe(U((n,i)=>R(t(n,i)).pipe(E((t,r)=>e(n,t,i,r))),n)):("number"==typeof e&&(n=e),e=>e.lift(new N(t,n)))}class N{constructor(t,e=Number.POSITIVE_INFINITY){this.project=t,this.concurrent=e}call(t,e){return e.subscribe(new j(t,this.project,this.concurrent))}}class j extends B{constructor(t,e,n=Number.POSITIVE_INFINITY){super(t),this.project=e,this.concurrent=n,this.hasCompleted=!1,this.buffer=[],this.active=0,this.index=0}_next(t){this.active<this.concurrent?this._tryNext(t):this.buffer.push(t)}_tryNext(t){let e;const n=this.index++;try{e=this.project(t,n)}catch(i){return void this.destination.error(i)}this.active++,this._innerSub(e)}_innerSub(t){const e=new F(this),n=this.destination;n.add(e);const i=V(t,e);i!==e&&n.add(i)}_complete(){this.hasCompleted=!0,0===this.active&&0===this.buffer.length&&this.destination.complete(),this.unsubscribe()}notifyNext(t){this.destination.next(t)}notifyComplete(){const t=this.buffer;this.active--,t.length>0?this._next(t.shift()):0===this.active&&this.hasCompleted&&this.destination.complete()}}function q(t=Number.POSITIVE_INFINITY){return U(_,t)}function $(t,e){return e?L(t,e):new y(I(t))}function G(...t){let e=Number.POSITIVE_INFINITY,n=null,i=t[t.length-1];return S(i)?(n=t.pop(),t.length>1&&"number"==typeof t[t.length-1]&&(e=t.pop())):"number"==typeof i&&(e=t.pop()),null===n&&1===t.length&&t[0]instanceof y?t[0]:q(e)($(t,n))}function Z(){return function(t){return t.lift(new H(t))}}class H{constructor(t){this.connectable=t}call(t,e){const{connectable:n}=this;n._refCount++;const i=new W(t,n),r=e.subscribe(i);return i.closed||(i.connection=n.connect()),r}}class W extends f{constructor(t,e){super(t),this.connectable=e}_unsubscribe(){const{connectable:t}=this;if(!t)return void(this.connection=null);this.connectable=null;const e=t._refCount;if(e<=0)return void(this.connection=null);if(t._refCount=e-1,e>1)return void(this.connection=null);const{connection:n}=this,i=t._connection;this.connection=null,!i||n&&i!==n||i.unsubscribe()}}class X extends y{constructor(t,e){super(),this.source=t,this.subjectFactory=e,this._refCount=0,this._isComplete=!1}_subscribe(t){return this.getSubject().subscribe(t)}getSubject(){const t=this._subject;return t&&!t.isStopped||(this._subject=this.subjectFactory()),this._subject}connect(){let t=this._connection;return t||(this._isComplete=!1,t=this._connection=new h,t.add(this.source.subscribe(new Y(this.getSubject(),this))),t.closed&&(this._connection=null,t=h.EMPTY)),t}refCount(){return Z()(this)}}const K=(()=>{const t=X.prototype;return{operator:{value:null},_refCount:{value:0,writable:!0},_subject:{value:null,writable:!0},_connection:{value:null,writable:!0},_subscribe:{value:t._subscribe},_isComplete:{value:t._isComplete,writable:!0},getSubject:{value:t.getSubject},connect:{value:t.connect},refCount:{value:t.refCount}}})();class Y extends w{constructor(t,e){super(t),this.connectable=e}_error(t){this._unsubscribe(),super._error(t)}_complete(){this.connectable._isComplete=!0,this._unsubscribe(),super._complete()}_unsubscribe(){const t=this.connectable;if(t){this.connectable=null;const e=t._connection;t._refCount=0,t._subject=null,t._connection=null,e&&e.unsubscribe()}}}function J(){return new C}function Q(t){for(let e in t)if(t[e]===Q)return e;throw Error("Could not find renamed property on target object.")}function tt(t,e){for(const n in e)e.hasOwnProperty(n)&&!t.hasOwnProperty(n)&&(t[n]=e[n])}function et(t){if("string"==typeof t)return t;if(Array.isArray(t))return"["+t.map(et).join(", ")+"]";if(null==t)return""+t;if(t.overriddenName)return""+t.overriddenName;if(t.name)return""+t.name;const e=t.toString();if(null==e)return""+e;const n=e.indexOf("\n");return-1===n?e:e.substring(0,n)}function nt(t,e){return null==t||""===t?null===e?"":e:null==e||""===e?t:t+" "+e}const it=Q({__forward_ref__:Q});function rt(t){return t.__forward_ref__=rt,t.toString=function(){return et(this())},t}function ot(t){return st(t)?t():t}function st(t){return"function"==typeof t&&t.hasOwnProperty(it)&&t.__forward_ref__===rt}function at(t){return{token:t.token,providedIn:t.providedIn||null,factory:t.factory,value:void 0}}function lt(t){return{factory:t.factory,providers:t.providers||[],imports:t.imports||[]}}function ct(t){return ut(t,dt)||ut(t,ft)}function ut(t,e){return t.hasOwnProperty(e)?t[e]:null}function ht(t){return t&&(t.hasOwnProperty(pt)||t.hasOwnProperty(mt))?t[pt]:null}const dt=Q({\u0275prov:Q}),pt=Q({\u0275inj:Q}),ft=Q({ngInjectableDef:Q}),mt=Q({ngInjectorDef:Q});var gt=function(t){return t[t.Default=0]="Default",t[t.Host=1]="Host",t[t.Self=2]="Self",t[t.SkipSelf=4]="SkipSelf",t[t.Optional=8]="Optional",t}({});let _t;function yt(t){const e=_t;return _t=t,e}function vt(t,e,n){const i=ct(t);if(i&&"root"==i.providedIn)return void 0===i.value?i.value=i.factory():i.value;if(n&gt.Optional)return null;if(void 0!==e)return e;throw new Error(`Injector: NOT_FOUND [${et(t)}]`)}function xt(t){return{toString:t}.toString()}var bt=function(t){return t[t.OnPush=0]="OnPush",t[t.Default=1]="Default",t}({}),wt=function(t){return t[t.Emulated=0]="Emulated",t[t.None=2]="None",t[t.ShadowDom=3]="ShadowDom",t}({});const Ct="undefined"!=typeof globalThis&&globalThis,Tt="undefined"!=typeof window&&window,St="undefined"!=typeof self&&"undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope&&self,Et="undefined"!=typeof global&&global,kt=Ct||Et||Tt||St,At={},It=[],Pt=Q({\u0275cmp:Q}),Mt=Q({\u0275dir:Q}),Ot=Q({\u0275pipe:Q}),zt=Q({\u0275mod:Q}),Dt=Q({\u0275loc:Q}),Lt=Q({\u0275fac:Q}),Rt=Q({__NG_ELEMENT_ID__:Q});let Ft=0;function Bt(t){return xt(()=>{const e={},n={type:t.type,providersResolver:null,decls:t.decls,vars:t.vars,factory:null,template:t.template||null,consts:t.consts||null,ngContentSelectors:t.ngContentSelectors,hostBindings:t.hostBindings||null,hostVars:t.hostVars||0,hostAttrs:t.hostAttrs||null,contentQueries:t.contentQueries||null,declaredInputs:e,inputs:null,outputs:null,exportAs:t.exportAs||null,onPush:t.changeDetection===bt.OnPush,directiveDefs:null,pipeDefs:null,selectors:t.selectors||It,viewQuery:t.viewQuery||null,features:t.features||null,data:t.data||{},encapsulation:t.encapsulation||wt.Emulated,id:"c",styles:t.styles||It,_:null,setInput:null,schemas:t.schemas||null,tView:null},i=t.directives,r=t.features,o=t.pipes;return n.id+=Ft++,n.inputs=qt(t.inputs,e),n.outputs=qt(t.outputs),r&&r.forEach(t=>t(n)),n.directiveDefs=i?()=>("function"==typeof i?i():i).map(Vt):null,n.pipeDefs=o?()=>("function"==typeof o?o():o).map(Ut):null,n})}function Vt(t){return Gt(t)||function(t){return t[Mt]||null}(t)}function Ut(t){return function(t){return t[Ot]||null}(t)}const Nt={};function jt(t){const e={type:t.type,bootstrap:t.bootstrap||It,declarations:t.declarations||It,imports:t.imports||It,exports:t.exports||It,transitiveCompileScopes:null,schemas:t.schemas||null,id:t.id||null};return null!=t.id&&xt(()=>{Nt[t.id]=t.type}),e}function qt(t,e){if(null==t)return At;const n={};for(const i in t)if(t.hasOwnProperty(i)){let r=t[i],o=r;Array.isArray(r)&&(o=r[1],r=r[0]),n[r]=i,e&&(e[r]=o)}return n}const $t=Bt;function Gt(t){return t[Pt]||null}function Zt(t,e){const n=t[zt]||null;if(!n&&!0===e)throw new Error(`Type ${et(t)} does not have '\u0275mod' property.`);return n}function Ht(t){return Array.isArray(t)&&"object"==typeof t[1]}function Wt(t){return Array.isArray(t)&&!0===t[1]}function Xt(t){return 0!=(8&t.flags)}function Kt(t){return 2==(2&t.flags)}function Yt(t){return 1==(1&t.flags)}function Jt(t){return null!==t.template}function Qt(t,e){return t.hasOwnProperty(Lt)?t[Lt]:null}class te extends Error{constructor(t,e){super(function(t,e){return`${t?`NG0${t}: `:""}${e}`}(t,e)),this.code=t}}function ee(t){return"string"==typeof t?t:null==t?"":String(t)}function ne(t){return"function"==typeof t?t.name||t.toString():"object"==typeof t&&null!=t&&"function"==typeof t.type?t.type.name||t.type.toString():ee(t)}function ie(t,e){const n=e?" in "+e:"";throw new te("201",`No provider for ${ne(t)} found${n}`)}class re{constructor(t,e,n){this.previousValue=t,this.currentValue=e,this.firstChange=n}isFirstChange(){return this.firstChange}}function oe(){return se}function se(t){return t.type.prototype.ngOnChanges&&(t.setInput=le),ae}function ae(){const t=ce(this),e=null==t?void 0:t.current;if(e){const n=t.previous;if(n===At)t.previous=e;else for(let t in e)n[t]=e[t];t.current=null,this.ngOnChanges(e)}}function le(t,e,n,i){const r=ce(t)||function(t,e){return t.__ngSimpleChanges__=e}(t,{previous:At,current:null}),o=r.current||(r.current={}),s=r.previous,a=this.declaredInputs[n],l=s[a];o[a]=new re(l&&l.currentValue,e,s===At),t[i]=e}function ce(t){return t.__ngSimpleChanges__||null}oe.ngInherit=!0;let ue=void 0;function he(t){return!!t.listen}const de={createRenderer:(t,e)=>void 0!==ue?ue:"undefined"!=typeof document?document:void 0};function pe(t){for(;Array.isArray(t);)t=t[0];return t}function fe(t,e){return pe(e[t])}function me(t,e){return pe(e[t.index])}function ge(t,e){return t.data[e]}function _e(t,e){return t[e]}function ye(t,e){const n=e[t];return Ht(n)?n:n[0]}function ve(t){const e=function(t){return t.__ngContext__||null}(t);return e?Array.isArray(e)?e:e.lView:null}function xe(t){return 4==(4&t[2])}function be(t){return 128==(128&t[2])}function we(t,e){return null==e?null:t[e]}function Ce(t){t[18]=0}function Te(t,e){t[5]+=e;let n=t,i=t[3];for(;null!==i&&(1===e&&1===n[5]||-1===e&&0===n[5]);)i[5]+=e,n=i,i=i[3]}const Se={lFrame:Xe(null),bindingsEnabled:!0,isInCheckNoChangesMode:!1};function Ee(){return Se.bindingsEnabled}function ke(){return Se.lFrame.lView}function Ae(){return Se.lFrame.tView}function Ie(t){Se.lFrame.contextLView=t}function Pe(){let t=Me();for(;null!==t&&64===t.type;)t=t.parent;return t}function Me(){return Se.lFrame.currentTNode}function Oe(t,e){const n=Se.lFrame;n.currentTNode=t,n.isParent=e}function ze(){return Se.lFrame.isParent}function De(){Se.lFrame.isParent=!1}function Le(){return Se.isInCheckNoChangesMode}function Re(t){Se.isInCheckNoChangesMode=t}function Fe(){const t=Se.lFrame;let e=t.bindingRootIndex;return-1===e&&(e=t.bindingRootIndex=t.tView.bindingStartIndex),e}function Be(){return Se.lFrame.bindingIndex}function Ve(){return Se.lFrame.bindingIndex++}function Ue(t){const e=Se.lFrame,n=e.bindingIndex;return e.bindingIndex=e.bindingIndex+t,n}function Ne(t,e){const n=Se.lFrame;n.bindingIndex=n.bindingRootIndex=t,je(e)}function je(t){Se.lFrame.currentDirectiveIndex=t}function qe(){return Se.lFrame.currentQueryIndex}function $e(t){Se.lFrame.currentQueryIndex=t}function Ge(t){const e=t[1];return 2===e.type?e.declTNode:1===e.type?t[6]:null}function Ze(t,e,n){if(n&gt.SkipSelf){let i=e,r=t;for(;i=i.parent,!(null!==i||n&gt.Host||(i=Ge(r),null===i)||(r=r[15],10&i.type)););if(null===i)return!1;e=i,t=r}const i=Se.lFrame=We();return i.currentTNode=e,i.lView=t,!0}function He(t){const e=We(),n=t[1];Se.lFrame=e,e.currentTNode=n.firstChild,e.lView=t,e.tView=n,e.contextLView=t,e.bindingIndex=n.bindingStartIndex,e.inI18n=!1}function We(){const t=Se.lFrame,e=null===t?null:t.child;return null===e?Xe(t):e}function Xe(t){const e={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:t,child:null,inI18n:!1};return null!==t&&(t.child=e),e}function Ke(){const t=Se.lFrame;return Se.lFrame=t.parent,t.currentTNode=null,t.lView=null,t}const Ye=Ke;function Je(){const t=Ke();t.isParent=!0,t.tView=null,t.selectedIndex=-1,t.contextLView=null,t.elementDepthCount=0,t.currentDirectiveIndex=-1,t.currentNamespace=null,t.bindingRootIndex=-1,t.bindingIndex=-1,t.currentQueryIndex=0}function Qe(){return Se.lFrame.selectedIndex}function tn(t){Se.lFrame.selectedIndex=t}function en(){const t=Se.lFrame;return ge(t.tView,t.selectedIndex)}function nn(t,e){for(let n=e.directiveStart,i=e.directiveEnd;n<i;n++){const e=t.data[n].type.prototype,{ngAfterContentInit:i,ngAfterContentChecked:r,ngAfterViewInit:o,ngAfterViewChecked:s,ngOnDestroy:a}=e;i&&(t.contentHooks||(t.contentHooks=[])).push(-n,i),r&&((t.contentHooks||(t.contentHooks=[])).push(n,r),(t.contentCheckHooks||(t.contentCheckHooks=[])).push(n,r)),o&&(t.viewHooks||(t.viewHooks=[])).push(-n,o),s&&((t.viewHooks||(t.viewHooks=[])).push(n,s),(t.viewCheckHooks||(t.viewCheckHooks=[])).push(n,s)),null!=a&&(t.destroyHooks||(t.destroyHooks=[])).push(n,a)}}function rn(t,e,n){an(t,e,3,n)}function on(t,e,n,i){(3&t[2])===n&&an(t,e,n,i)}function sn(t,e){let n=t[2];(3&n)===e&&(n&=2047,n+=1,t[2]=n)}function an(t,e,n,i){const r=null!=i?i:-1,o=e.length-1;let s=0;for(let a=void 0!==i?65535&t[18]:0;a<o;a++)if("number"==typeof e[a+1]){if(s=e[a],null!=i&&s>=i)break}else e[a]<0&&(t[18]+=65536),(s<r||-1==r)&&(ln(t,n,e,a),t[18]=(4294901760&t[18])+a+2),a++}function ln(t,e,n,i){const r=n[i]<0,o=n[i+1],s=t[r?-n[i]:n[i]];r?t[2]>>11<t[18]>>16&&(3&t[2])===e&&(t[2]+=2048,o.call(s)):o.call(s)}class cn{constructor(t,e,n){this.factory=t,this.resolving=!1,this.canSeeViewProviders=e,this.injectImpl=n}}function un(t,e,n){const i=he(t);let r=0;for(;r<n.length;){const o=n[r];if("number"==typeof o){if(0!==o)break;r++;const s=n[r++],a=n[r++],l=n[r++];i?t.setAttribute(e,a,l,s):e.setAttributeNS(s,a,l)}else{const s=o,a=n[++r];dn(s)?i&&t.setProperty(e,s,a):i?t.setAttribute(e,s,a):e.setAttribute(s,a),r++}}return r}function hn(t){return 3===t||4===t||6===t}function dn(t){return 64===t.charCodeAt(0)}function pn(t,e){if(null===e||0===e.length);else if(null===t||0===t.length)t=e.slice();else{let n=-1;for(let i=0;i<e.length;i++){const r=e[i];"number"==typeof r?n=r:0===n||fn(t,n,r,null,-1===n||2===n?e[++i]:null)}}return t}function fn(t,e,n,i,r){let o=0,s=t.length;if(-1===e)s=-1;else for(;o<t.length;){const n=t[o++];if("number"==typeof n){if(n===e){s=-1;break}if(n>e){s=o-1;break}}}for(;o<t.length;){const e=t[o];if("number"==typeof e)break;if(e===n){if(null===i)return void(null!==r&&(t[o+1]=r));if(i===t[o+1])return void(t[o+2]=r)}o++,null!==i&&o++,null!==r&&o++}-1!==s&&(t.splice(s,0,e),o=s+1),t.splice(o++,0,n),null!==i&&t.splice(o++,0,i),null!==r&&t.splice(o++,0,r)}function mn(t){return-1!==t}function gn(t){return 32767&t}function _n(t,e){let n=t>>16,i=e;for(;n>0;)i=i[15],n--;return i}let yn=!0;function vn(t){const e=yn;return yn=t,e}let xn=0;function bn(t,e){const n=Cn(t,e);if(-1!==n)return n;const i=e[1];i.firstCreatePass&&(t.injectorIndex=e.length,wn(i.data,t),wn(e,null),wn(i.blueprint,null));const r=Tn(t,e),o=t.injectorIndex;if(mn(r)){const t=gn(r),n=_n(r,e),i=n[1].data;for(let r=0;r<8;r++)e[o+r]=n[t+r]|i[t+r]}return e[o+8]=r,o}function wn(t,e){t.push(0,0,0,0,0,0,0,0,e)}function Cn(t,e){return-1===t.injectorIndex||t.parent&&t.parent.injectorIndex===t.injectorIndex||null===e[t.injectorIndex+8]?-1:t.injectorIndex}function Tn(t,e){if(t.parent&&-1!==t.parent.injectorIndex)return t.parent.injectorIndex;let n=0,i=null,r=e;for(;null!==r;){const t=r[1],e=t.type;if(i=2===e?t.declTNode:1===e?r[6]:null,null===i)return-1;if(n++,r=r[15],-1!==i.injectorIndex)return i.injectorIndex|n<<16}return-1}function Sn(t,e,n){!function(t,e,n){let i;"string"==typeof n?i=n.charCodeAt(0)||0:n.hasOwnProperty(Rt)&&(i=n[Rt]),null==i&&(i=n[Rt]=xn++);const r=255&i,o=1<<r,s=64&r,a=32&r,l=e.data;128&r?s?a?l[t+7]|=o:l[t+6]|=o:a?l[t+5]|=o:l[t+4]|=o:s?a?l[t+3]|=o:l[t+2]|=o:a?l[t+1]|=o:l[t]|=o}(t,e,n)}function En(t,e,n){if(n&gt.Optional)return t;ie(e,"NodeInjector")}function kn(t,e,n,i){if(n&gt.Optional&&void 0===i&&(i=null),0==(n&(gt.Self|gt.Host))){const r=t[9],o=yt(void 0);try{return r?r.get(e,i,n&gt.Optional):vt(e,i,n&gt.Optional)}finally{yt(o)}}return En(i,e,n)}function An(t,e,n,i=gt.Default,r){if(null!==t){const o=function(t){if("string"==typeof t)return t.charCodeAt(0)||0;const e=t.hasOwnProperty(Rt)?t[Rt]:void 0;return"number"==typeof e?e>=0?255&e:Pn:e}(n);if("function"==typeof o){if(!Ze(e,t,i))return i&gt.Host?En(r,n,i):kn(e,n,i,r);try{const t=o();if(null!=t||i&gt.Optional)return t;ie(n)}finally{Ye()}}else if("number"==typeof o){let r=null,s=Cn(t,e),a=-1,l=i&gt.Host?e[16][6]:null;for((-1===s||i&gt.SkipSelf)&&(a=-1===s?Tn(t,e):e[s+8],-1!==a&&Ln(i,!1)?(r=e[1],s=gn(a),e=_n(a,e)):s=-1);-1!==s;){const t=e[1];if(Dn(o,s,t.data)){const t=Mn(s,e,n,r,i,l);if(t!==In)return t}a=e[s+8],-1!==a&&Ln(i,e[1].data[s+8]===l)&&Dn(o,s,e)?(r=t,s=gn(a),e=_n(a,e)):s=-1}}}return kn(e,n,i,r)}const In={};function Pn(){return new Rn(Pe(),ke())}function Mn(t,e,n,i,r,o){const s=e[1],a=s.data[t+8],l=On(a,s,n,null==i?Kt(a)&&yn:i!=s&&0!=(3&a.type),r&gt.Host&&o===a);return null!==l?zn(e,s,l,a):In}function On(t,e,n,i,r){const o=t.providerIndexes,s=e.data,a=1048575&o,l=t.directiveStart,c=o>>20,u=r?a+c:t.directiveEnd;for(let h=i?a:a+c;h<u;h++){const t=s[h];if(h<l&&n===t||h>=l&&t.type===n)return h}if(r){const t=s[l];if(t&&Jt(t)&&t.type===n)return l}return null}function zn(t,e,n,i){let r=t[n];const o=e.data;if(r instanceof cn){const s=r;s.resolving&&function(t,e){throw new te("200","Circular dependency in DI detected for "+t)}(ne(o[n]));const a=vn(s.canSeeViewProviders);s.resolving=!0;const l=s.injectImpl?yt(s.injectImpl):null;Ze(t,i,gt.Default);try{r=t[n]=s.factory(void 0,o,t,i),e.firstCreatePass&&n>=i.directiveStart&&function(t,e,n){const{ngOnChanges:i,ngOnInit:r,ngDoCheck:o}=e.type.prototype;if(i){const i=se(e);(n.preOrderHooks||(n.preOrderHooks=[])).push(t,i),(n.preOrderCheckHooks||(n.preOrderCheckHooks=[])).push(t,i)}r&&(n.preOrderHooks||(n.preOrderHooks=[])).push(0-t,r),o&&((n.preOrderHooks||(n.preOrderHooks=[])).push(t,o),(n.preOrderCheckHooks||(n.preOrderCheckHooks=[])).push(t,o))}(n,o[n],e)}finally{null!==l&&yt(l),vn(a),s.resolving=!1,Ye()}}return r}function Dn(t,e,n){const i=64&t,r=32&t;let o;return o=128&t?i?r?n[e+7]:n[e+6]:r?n[e+5]:n[e+4]:i?r?n[e+3]:n[e+2]:r?n[e+1]:n[e],!!(o&1<<t)}function Ln(t,e){return!(t&gt.Self||t&gt.Host&&e)}class Rn{constructor(t,e){this._tNode=t,this._lView=e}get(t,e){return An(this._tNode,this._lView,t,void 0,e)}}function Fn(t){const e=t;if(st(t))return()=>{const t=Fn(ot(e));return t?t():null};let n=Qt(e);if(null===n){const t=ht(e);n=t&&t.factory}return n||null}function Bn(t){return xt(()=>{const e=t.prototype.constructor,n=e[Lt]||Fn(e),i=Object.prototype;let r=Object.getPrototypeOf(t.prototype).constructor;for(;r&&r!==i;){const t=r[Lt]||Fn(r);if(t&&t!==n)return t;r=Object.getPrototypeOf(r)}return t=>new t})}function Vn(t){return function(t,e){if("class"===e)return t.classes;if("style"===e)return t.styles;const n=t.attrs;if(n){const t=n.length;let i=0;for(;i<t;){const r=n[i];if(hn(r))break;if(0===r)i+=2;else if("number"==typeof r)for(i++;i<t&&"string"==typeof n[i];)i++;else{if(r===e)return n[i+1];i+=2}}}return null}(Pe(),t)}function Un(t,e,n){return xt(()=>{const i=function(t){return function(...e){if(t){const n=t(...e);for(const t in n)this[t]=n[t]}}}(e);function r(...t){if(this instanceof r)return i.apply(this,t),this;const e=new r(...t);return n.annotation=e,n;function n(t,n,i){const r=t.hasOwnProperty("__parameters__")?t.__parameters__:Object.defineProperty(t,"__parameters__",{value:[]}).__parameters__;for(;r.length<=i;)r.push(null);return(r[i]=r[i]||[]).push(e),t}}return n&&(r.prototype=Object.create(n.prototype)),r.prototype.ngMetadataName=t,r.annotationCls=r,r})}class Nn{constructor(t,e){this._desc=t,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,"number"==typeof e?this.__NG_ELEMENT_ID__=e:void 0!==e&&(this.\u0275prov=at({token:this,providedIn:e.providedIn||"root",factory:e.factory}))}toString(){return"InjectionToken "+this._desc}}const jn=new Nn("AnalyzeForEntryComponents"),qn=Function;function $n(t,e){void 0===e&&(e=t);for(let n=0;n<t.length;n++){let i=t[n];Array.isArray(i)?(e===t&&(e=t.slice(0,n)),$n(i,e)):e!==t&&e.push(i)}return e}function Gn(t,e){t.forEach(t=>Array.isArray(t)?Gn(t,e):e(t))}function Zn(t,e,n){e>=t.length?t.push(n):t.splice(e,0,n)}function Hn(t,e){return e>=t.length-1?t.pop():t.splice(e,1)[0]}function Wn(t,e){const n=[];for(let i=0;i<t;i++)n.push(e);return n}function Xn(t,e,n){let i=Yn(t,e);return i>=0?t[1|i]=n:(i=~i,function(t,e,n,i){let r=t.length;if(r==e)t.push(n,i);else if(1===r)t.push(i,t[0]),t[0]=n;else{for(r--,t.push(t[r-1],t[r]);r>e;)t[r]=t[r-2],r--;t[e]=n,t[e+1]=i}}(t,i,e,n)),i}function Kn(t,e){const n=Yn(t,e);if(n>=0)return t[1|n]}function Yn(t,e){return function(t,e,n){let i=0,r=t.length>>1;for(;r!==i;){const n=i+(r-i>>1),o=t[n<<1];if(e===o)return n<<1;o>e?r=n:i=n+1}return~(r<<1)}(t,e)}const Jn=Un("Inject",t=>({token:t})),Qn=Un("Optional"),ti=Un("Self"),ei=Un("SkipSelf"),ni=Un("Host"),ii={},ri=/\n/gm,oi=Q({provide:String,useValue:Q});let si,ai=void 0;function li(t){const e=ai;return ai=t,e}function ci(t,e=gt.Default){if(void 0===ai)throw new Error("inject() must be called from an injection context");return null===ai?vt(t,void 0,e):ai.get(t,e&gt.Optional?null:void 0,e)}function ui(t,e=gt.Default){return(_t||ci)(ot(t),e)}function hi(t){const e=[];for(let n=0;n<t.length;n++){const i=ot(t[n]);if(Array.isArray(i)){if(0===i.length)throw new Error("Arguments array must have arguments.");let t=void 0,n=gt.Default;for(let e=0;e<i.length;e++){const r=i[e];r instanceof Qn||"Optional"===r.ngMetadataName||r===Qn?n|=gt.Optional:r instanceof ei||"SkipSelf"===r.ngMetadataName||r===ei?n|=gt.SkipSelf:r instanceof ti||"Self"===r.ngMetadataName||r===ti?n|=gt.Self:r instanceof ni||"Host"===r.ngMetadataName||r===ni?n|=gt.Host:t=r instanceof Jn||r===Jn?r.token:r}e.push(ui(t,n))}else e.push(ui(i))}return e}class di{constructor(t){this.changingThisBreaksApplicationSecurity=t}toString(){return"SafeValue must use [property]=binding: "+this.changingThisBreaksApplicationSecurity+" (see https://g.co/ng/security#xss)"}}function pi(t){return t instanceof di?t.changingThisBreaksApplicationSecurity:t}const fi=/^(?:(?:https?|mailto|ftp|tel|file|sms):|[^&:/?#]*(?:[/?#]|$))/gi,mi=/^data:(?:image\/(?:bmp|gif|jpeg|jpg|png|tiff|webp)|video\/(?:mpeg|mp4|ogg|webm)|audio\/(?:mp3|oga|ogg|opus));base64,[a-z0-9+\/]+=*$/i;var gi=function(t){return t[t.NONE=0]="NONE",t[t.HTML=1]="HTML",t[t.STYLE=2]="STYLE",t[t.SCRIPT=3]="SCRIPT",t[t.URL=4]="URL",t[t.RESOURCE_URL=5]="RESOURCE_URL",t}({});function _i(t){const e=function(){const t=ke();return t&&t[12]}();return e?e.sanitize(gi.URL,t)||"":function(t,e){const n=function(t){return t instanceof di&&t.getTypeName()||null}(t);if(null!=n&&n!==e){if("ResourceURL"===n&&"URL"===e)return!0;throw new Error(`Required a safe ${e}, got a ${n} (see https://g.co/ng/security#xss)`)}return n===e}(t,"URL")?pi(t):(n=ee(t),(n=String(n)).match(fi)||n.match(mi)?n:"unsafe:"+n);var n}function yi(t){return t.ngDebugContext}function vi(t){return t.ngOriginalError}function xi(t,...e){t.error(...e)}class bi{constructor(){this._console=console}handleError(t){const e=this._findOriginalError(t),n=this._findContext(t),i=function(t){return t.ngErrorLogger||xi}(t);i(this._console,"ERROR",t),e&&i(this._console,"ORIGINAL ERROR",e),n&&i(this._console,"ERROR CONTEXT",n)}_findContext(t){return t?yi(t)?yi(t):this._findContext(vi(t)):null}_findOriginalError(t){let e=vi(t);for(;e&&vi(e);)e=vi(e);return e}}function wi(t,e){t.__ngContext__=e}const Ci=(()=>("undefined"!=typeof requestAnimationFrame&&requestAnimationFrame||setTimeout).bind(kt))();function Ti(t){return t instanceof Function?t():t}var Si=function(t){return t[t.Important=1]="Important",t[t.DashCase=2]="DashCase",t}({});function Ei(t,e){return(void 0)(t,e)}function ki(t){const e=t[3];return Wt(e)?e[3]:e}function Ai(t){return Pi(t[13])}function Ii(t){return Pi(t[4])}function Pi(t){for(;null!==t&&!Wt(t);)t=t[4];return t}function Mi(t,e,n,i,r){if(null!=i){let o,s=!1;Wt(i)?o=i:Ht(i)&&(s=!0,i=i[0]);const a=pe(i);0===t&&null!==n?null==r?Vi(e,n,a):Bi(e,n,a,r||null,!0):1===t&&null!==n?Bi(e,n,a,r||null,!0):2===t?function(t,e,n){const i=Ni(t,e);i&&function(t,e,n,i){he(t)?t.removeChild(e,n,i):e.removeChild(n)}(t,i,e,n)}(e,a,s):3===t&&e.destroyNode(a),null!=o&&function(t,e,n,i,r){const o=n[7];o!==pe(n)&&Mi(e,t,i,o,r);for(let s=10;s<n.length;s++){const r=n[s];Wi(r[1],r,t,e,i,o)}}(e,t,o,n,r)}}function Oi(t,e,n){return he(t)?t.createElement(e,n):null===n?t.createElement(e):t.createElementNS(n,e)}function zi(t,e){const n=t[9],i=n.indexOf(e),r=e[3];1024&e[2]&&(e[2]&=-1025,Te(r,-1)),n.splice(i,1)}function Di(t,e){if(t.length<=10)return;const n=10+e,i=t[n];if(i){const o=i[17];null!==o&&o!==t&&zi(o,i),e>0&&(t[n-1][4]=i[4]);const s=Hn(t,10+e);Wi(i[1],r=i,r[11],2,null,null),r[0]=null,r[6]=null;const a=s[19];null!==a&&a.detachView(s[1]),i[3]=null,i[4]=null,i[2]&=-129}var r;return i}function Li(t,e){if(!(256&e[2])){const n=e[11];he(n)&&n.destroyNode&&Wi(t,e,n,3,null,null),function(t){let e=t[13];if(!e)return Ri(t[1],t);for(;e;){let n=null;if(Ht(e))n=e[13];else{const t=e[10];t&&(n=t)}if(!n){for(;e&&!e[4]&&e!==t;)Ht(e)&&Ri(e[1],e),e=e[3];null===e&&(e=t),Ht(e)&&Ri(e[1],e),n=e&&e[4]}e=n}}(e)}}function Ri(t,e){if(!(256&e[2])){e[2]&=-129,e[2]|=256,function(t,e){let n;if(null!=t&&null!=(n=t.destroyHooks))for(let i=0;i<n.length;i+=2){const t=e[n[i]];if(!(t instanceof cn)){const e=n[i+1];if(Array.isArray(e))for(let n=0;n<e.length;n+=2)e[n+1].call(t[e[n]]);else e.call(t)}}}(t,e),function(t,e){const n=t.cleanup,i=e[7];let r=-1;if(null!==n)for(let o=0;o<n.length-1;o+=2)if("string"==typeof n[o]){const t=n[o+1],s="function"==typeof t?t(e):pe(e[t]),a=i[r=n[o+2]],l=n[o+3];"boolean"==typeof l?s.removeEventListener(n[o],a,l):l>=0?i[r=l]():i[r=-l].unsubscribe(),o+=2}else{const t=i[r=n[o+1]];n[o].call(t)}if(null!==i){for(let t=r+1;t<i.length;t++)(0,i[t])();e[7]=null}}(t,e),1===e[1].type&&he(e[11])&&e[11].destroy();const n=e[17];if(null!==n&&Wt(e[3])){n!==e[3]&&zi(n,e);const i=e[19];null!==i&&i.detachView(t)}}}function Fi(t,e,n){return function(t,e,n){let i=e;for(;null!==i&&40&i.type;)i=(e=i).parent;if(null===i)return n[0];if(2&i.flags){const e=t.data[i.directiveStart].encapsulation;if(e===wt.None||e===wt.Emulated)return null}return me(i,n)}(t,e.parent,n)}function Bi(t,e,n,i,r){he(t)?t.insertBefore(e,n,i,r):e.insertBefore(n,i,r)}function Vi(t,e,n){he(t)?t.appendChild(e,n):e.appendChild(n)}function Ui(t,e,n,i,r){null!==i?Bi(t,e,n,i,r):Vi(t,e,n)}function Ni(t,e){return he(t)?t.parentNode(e):e.parentNode}function ji(t,e,n){return qi(t,e,n)}let qi=function(t,e,n){return 40&t.type?me(t,n):null};function $i(t,e,n,i){const r=Fi(t,i,e),o=e[11],s=ji(i.parent||e[6],i,e);if(null!=r)if(Array.isArray(n))for(let a=0;a<n.length;a++)Ui(o,r,n[a],s,!1);else Ui(o,r,n,s,!1)}function Gi(t,e){if(null!==e){const n=e.type;if(3&n)return me(e,t);if(4&n)return Zi(-1,t[e.index]);if(8&n){const n=e.child;if(null!==n)return Gi(t,n);{const n=t[e.index];return Wt(n)?Zi(-1,n):pe(n)}}if(32&n)return Ei(e,t)()||pe(t[e.index]);{const n=t[16],i=n[6],r=ki(n),o=i.projection[e.projection];return null!=o?Gi(r,o):Gi(t,e.next)}}return null}function Zi(t,e){const n=10+t+1;if(n<e.length){const t=e[n],i=t[1].firstChild;if(null!==i)return Gi(t,i)}return e[7]}function Hi(t,e,n,i,r,o,s){for(;null!=n;){const a=i[n.index],l=n.type;if(s&&0===e&&(a&&wi(pe(a),i),n.flags|=4),64!=(64&n.flags))if(8&l)Hi(t,e,n.child,i,r,o,!1),Mi(e,t,r,a,o);else if(32&l){const s=Ei(n,i);let l;for(;l=s();)Mi(e,t,r,l,o);Mi(e,t,r,a,o)}else 16&l?Xi(t,e,i,n,r,o):Mi(e,t,r,a,o);n=s?n.projectionNext:n.next}}function Wi(t,e,n,i,r,o){Hi(n,i,t.firstChild,e,r,o,!1)}function Xi(t,e,n,i,r,o){const s=n[16],a=s[6].projection[i.projection];if(Array.isArray(a))for(let l=0;l<a.length;l++)Mi(e,t,r,a[l],o);else Hi(t,e,a,s[3],r,o,!0)}function Ki(t,e,n){he(t)?t.setAttribute(e,"style",n):e.style.cssText=n}function Yi(t,e,n){he(t)?""===n?t.removeAttribute(e,"class"):t.setAttribute(e,"class",n):e.className=n}function Ji(t,e,n){let i=t.length;for(;;){const r=t.indexOf(e,n);if(-1===r)return r;if(0===r||t.charCodeAt(r-1)<=32){const n=e.length;if(r+n===i||t.charCodeAt(r+n)<=32)return r}n=r+1}}function Qi(t,e,n){let i=0;for(;i<t.length;){let r=t[i++];if(n&&"class"===r){if(r=t[i],-1!==Ji(r.toLowerCase(),e,0))return!0}else if(1===r){for(;i<t.length&&"string"==typeof(r=t[i++]);)if(r.toLowerCase()===e)return!0;return!1}}return!1}function tr(t){return 4===t.type&&"ng-template"!==t.value}function er(t,e,n){return e===(4!==t.type||n?t.value:"ng-template")}function nr(t,e,n){let i=4;const r=t.attrs||[],o=function(t){for(let e=0;e<t.length;e++)if(hn(t[e]))return e;return t.length}(r);let s=!1;for(let a=0;a<e.length;a++){const l=e[a];if("number"!=typeof l){if(!s)if(4&i){if(i=2|1&i,""!==l&&!er(t,l,n)||""===l&&1===e.length){if(ir(i))return!1;s=!0}}else{const c=8&i?l:e[++a];if(8&i&&null!==t.attrs){if(!Qi(t.attrs,c,n)){if(ir(i))return!1;s=!0}continue}const u=rr(8&i?"class":l,r,tr(t),n);if(-1===u){if(ir(i))return!1;s=!0;continue}if(""!==c){let t;t=u>o?"":r[u+1].toLowerCase();const e=8&i?t:null;if(e&&-1!==Ji(e,c,0)||2&i&&c!==t){if(ir(i))return!1;s=!0}}}}else{if(!s&&!ir(i)&&!ir(l))return!1;if(s&&ir(l))continue;s=!1,i=l|1&i}}return ir(i)||s}function ir(t){return 0==(1&t)}function rr(t,e,n,i){if(null===e)return-1;let r=0;if(i||!n){let n=!1;for(;r<e.length;){const i=e[r];if(i===t)return r;if(3===i||6===i)n=!0;else{if(1===i||2===i){let t=e[++r];for(;"string"==typeof t;)t=e[++r];continue}if(4===i)break;if(0===i){r+=4;continue}}r+=n?1:2}return-1}return function(t,e){let n=t.indexOf(4);if(n>-1)for(n++;n<t.length;){const i=t[n];if("number"==typeof i)return-1;if(i===e)return n;n++}return-1}(e,t)}function or(t,e,n=!1){for(let i=0;i<e.length;i++)if(nr(t,e[i],n))return!0;return!1}function sr(t,e){t:for(let n=0;n<e.length;n++){const i=e[n];if(t.length===i.length){for(let e=0;e<t.length;e++)if(t[e]!==i[e])continue t;return!0}}return!1}function ar(t,e){return t?":not("+e.trim()+")":e}function lr(t){let e=t[0],n=1,i=2,r="",o=!1;for(;n<t.length;){let s=t[n];if("string"==typeof s)if(2&i){const e=t[++n];r+="["+s+(e.length>0?'="'+e+'"':"")+"]"}else 8&i?r+="."+s:4&i&&(r+=" "+s);else""===r||ir(s)||(e+=ar(o,r),r=""),i=s,o=o||!ir(i);n++}return""!==r&&(e+=ar(o,r)),e}const cr={};function ur(t){hr(Ae(),ke(),Qe()+t,Le())}function hr(t,e,n,i){if(!i)if(3==(3&e[2])){const i=t.preOrderCheckHooks;null!==i&&rn(e,i,n)}else{const i=t.preOrderHooks;null!==i&&on(e,i,0,n)}tn(n)}function dr(t,e){return t<<17|e<<2}function pr(t){return t>>17&32767}function fr(t){return 2|t}function mr(t){return(131068&t)>>2}function gr(t,e){return-131069&t|e<<2}function _r(t){return 1|t}function yr(t,e){const n=t.contentQueries;if(null!==n)for(let i=0;i<n.length;i+=2){const r=n[i],o=n[i+1];if(-1!==o){const n=t.data[o];$e(r),n.contentQueries(2,e[o],o)}}}function vr(t,e,n,i,r,o,s,a,l,c){const u=e.blueprint.slice();return u[0]=r,u[2]=140|i,Ce(u),u[3]=u[15]=t,u[8]=n,u[10]=s||t&&t[10],u[11]=a||t&&t[11],u[12]=l||t&&t[12]||null,u[9]=c||t&&t[9]||null,u[6]=o,u[16]=2==e.type?t[16]:u,u}function xr(t,e,n,i,r){let o=t.data[e];if(null===o)o=function(t,e,n,i,r){const o=Me(),s=ze(),a=t.data[e]=function(t,e,n,i,r,o){return{type:n,index:i,insertBeforeIndex:null,injectorIndex:e?e.injectorIndex:-1,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,propertyBindings:null,flags:0,providerIndexes:0,value:r,attrs:o,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tViews:null,next:null,projectionNext:null,child:null,parent:e,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}(0,s?o:o&&o.parent,n,e,i,r);return null===t.firstChild&&(t.firstChild=a),null!==o&&(s?null==o.child&&null!==a.parent&&(o.child=a):null===o.next&&(o.next=a)),a}(t,e,n,i,r),Se.lFrame.inI18n&&(o.flags|=64);else if(64&o.type){o.type=n,o.value=i,o.attrs=r;const t=function(){const t=Se.lFrame,e=t.currentTNode;return t.isParent?e:e.parent}();o.injectorIndex=null===t?-1:t.injectorIndex}return Oe(o,!0),o}function br(t,e,n,i){if(0===n)return-1;const r=e.length;for(let o=0;o<n;o++)e.push(i),t.blueprint.push(i),t.data.push(null);return r}function wr(t,e,n){He(e);try{const i=t.viewQuery;null!==i&&Jr(1,i,n);const r=t.template;null!==r&&Sr(t,e,r,1,n),t.firstCreatePass&&(t.firstCreatePass=!1),t.staticContentQueries&&yr(t,e),t.staticViewQueries&&Jr(2,t.viewQuery,n);const o=t.components;null!==o&&function(t,e){for(let n=0;n<e.length;n++)Hr(t,e[n])}(e,o)}catch(i){throw t.firstCreatePass&&(t.incompleteFirstPass=!0),i}finally{e[2]&=-5,Je()}}function Cr(t,e,n,i){const r=e[2];if(256==(256&r))return;He(e);const o=Le();try{Ce(e),Se.lFrame.bindingIndex=t.bindingStartIndex,null!==n&&Sr(t,e,n,2,i);const s=3==(3&r);if(!o)if(s){const n=t.preOrderCheckHooks;null!==n&&rn(e,n,null)}else{const n=t.preOrderHooks;null!==n&&on(e,n,0,null),sn(e,0)}if(function(t){for(let e=Ai(t);null!==e;e=Ii(e)){if(!e[2])continue;const t=e[9];for(let e=0;e<t.length;e++){const n=t[e],i=n[3];0==(1024&n[2])&&Te(i,1),n[2]|=1024}}}(e),function(t){for(let e=Ai(t);null!==e;e=Ii(e))for(let t=10;t<e.length;t++){const n=e[t],i=n[1];be(n)&&Cr(i,n,i.template,n[8])}}(e),null!==t.contentQueries&&yr(t,e),!o)if(s){const n=t.contentCheckHooks;null!==n&&rn(e,n)}else{const n=t.contentHooks;null!==n&&on(e,n,1),sn(e,1)}!function(t,e){const n=t.hostBindingOpCodes;if(null!==n)try{for(let t=0;t<n.length;t++){const i=n[t];if(i<0)tn(~i);else{const r=i,o=n[++t],s=n[++t];Ne(o,r),s(2,e[r])}}}finally{tn(-1)}}(t,e);const a=t.components;null!==a&&function(t,e){for(let n=0;n<e.length;n++)Gr(t,e[n])}(e,a);const l=t.viewQuery;if(null!==l&&Jr(2,l,i),!o)if(s){const n=t.viewCheckHooks;null!==n&&rn(e,n)}else{const n=t.viewHooks;null!==n&&on(e,n,2),sn(e,2)}!0===t.firstUpdatePass&&(t.firstUpdatePass=!1),o||(e[2]&=-73),1024&e[2]&&(e[2]&=-1025,Te(e[3],-1))}finally{Je()}}function Tr(t,e,n,i){const r=e[10],o=!Le(),s=xe(e);try{o&&!s&&r.begin&&r.begin(),s&&wr(t,e,i),Cr(t,e,n,i)}finally{o&&!s&&r.end&&r.end()}}function Sr(t,e,n,i,r){const o=Qe();try{tn(-1),2&i&&e.length>20&&hr(t,e,20,Le()),n(i,r)}finally{tn(o)}}function Er(t,e,n){if(Xt(e)){const i=e.directiveEnd;for(let r=e.directiveStart;r<i;r++){const e=t.data[r];e.contentQueries&&e.contentQueries(1,n[r],r)}}}function kr(t,e,n){Ee()&&(function(t,e,n,i){const r=n.directiveStart,o=n.directiveEnd;t.firstCreatePass||bn(n,e),wi(i,e);const s=n.initialInputs;for(let a=r;a<o;a++){const i=t.data[a],o=Jt(i);o&&Nr(e,n,i);const l=zn(e,t,a,n);wi(l,e),null!==s&&jr(0,a-r,l,i,0,s),o&&(ye(n.index,e)[8]=l)}}(t,e,n,me(n,e)),128==(128&n.flags)&&function(t,e,n){const i=n.directiveStart,r=n.directiveEnd,o=n.index,s=Se.lFrame.currentDirectiveIndex;try{tn(o);for(let n=i;n<r;n++){const i=t.data[n],r=e[n];je(n),null===i.hostBindings&&0===i.hostVars&&null===i.hostAttrs||Rr(i,r)}}finally{tn(-1),je(s)}}(t,e,n))}function Ar(t,e,n=me){const i=e.localNames;if(null!==i){let r=e.index+1;for(let o=0;o<i.length;o+=2){const s=i[o+1],a=-1===s?n(e,t):t[s];t[r++]=a}}}function Ir(t){const e=t.tView;return null===e||e.incompleteFirstPass?t.tView=Pr(1,null,t.template,t.decls,t.vars,t.directiveDefs,t.pipeDefs,t.viewQuery,t.schemas,t.consts):e}function Pr(t,e,n,i,r,o,s,a,l,c){const u=20+i,h=u+r,d=function(t,e){const n=[];for(let i=0;i<e;i++)n.push(i<t?null:cr);return n}(u,h),p="function"==typeof c?c():c;return d[1]={type:t,blueprint:d,template:n,queries:null,viewQuery:a,declTNode:e,data:d.slice().fill(null,u),bindingStartIndex:u,expandoStartIndex:h,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:"function"==typeof o?o():o,pipeRegistry:"function"==typeof s?s():s,firstChild:null,schemas:l,consts:p,incompleteFirstPass:!1}}function Mr(t,e,n,i){const r=to(e);null===n?r.push(i):(r.push(n),t.firstCreatePass&&eo(t).push(i,r.length-1))}function Or(t,e,n){for(let i in t)if(t.hasOwnProperty(i)){const r=t[i];(n=null===n?{}:n).hasOwnProperty(i)?n[i].push(e,r):n[i]=[e,r]}return n}function zr(t,e,n,i,r,o,s,a){const l=me(e,n);let c,u=e.inputs;var h;!a&&null!=u&&(c=u[i])?(io(t,n,c,i,r),Kt(e)&&function(t,e){const n=ye(e,t);16&n[2]||(n[2]|=64)}(n,e.index)):3&e.type&&(i="class"===(h=i)?"className":"for"===h?"htmlFor":"formaction"===h?"formAction":"innerHtml"===h?"innerHTML":"readonly"===h?"readOnly":"tabindex"===h?"tabIndex":h,r=null!=s?s(r,e.value||"",i):r,he(o)?o.setProperty(l,i,r):dn(i)||(l.setProperty?l.setProperty(i,r):l[i]=r))}function Dr(t,e,n,i){let r=!1;if(Ee()){const o=function(t,e,n){const i=t.directiveRegistry;let r=null;if(i)for(let o=0;o<i.length;o++){const s=i[o];or(n,s.selectors,!1)&&(r||(r=[]),Sn(bn(n,e),t,s.type),Jt(s)?(Fr(t,n),r.unshift(s)):r.push(s))}return r}(t,e,n),s=null===i?null:{"":-1};if(null!==o){r=!0,Vr(n,t.data.length,o.length);for(let t=0;t<o.length;t++){const e=o[t];e.providersResolver&&e.providersResolver(e)}let i=!1,a=!1,l=br(t,e,o.length,null);for(let r=0;r<o.length;r++){const c=o[r];n.mergedAttrs=pn(n.mergedAttrs,c.hostAttrs),Ur(t,n,e,l,c),Br(l,c,s),null!==c.contentQueries&&(n.flags|=8),null===c.hostBindings&&null===c.hostAttrs&&0===c.hostVars||(n.flags|=128);const u=c.type.prototype;!i&&(u.ngOnChanges||u.ngOnInit||u.ngDoCheck)&&((t.preOrderHooks||(t.preOrderHooks=[])).push(n.index),i=!0),a||!u.ngOnChanges&&!u.ngDoCheck||((t.preOrderCheckHooks||(t.preOrderCheckHooks=[])).push(n.index),a=!0),l++}!function(t,e){const n=e.directiveEnd,i=t.data,r=e.attrs,o=[];let s=null,a=null;for(let l=e.directiveStart;l<n;l++){const t=i[l],n=t.inputs,c=null===r||tr(e)?null:qr(n,r);o.push(c),s=Or(n,l,s),a=Or(t.outputs,l,a)}null!==s&&(s.hasOwnProperty("class")&&(e.flags|=16),s.hasOwnProperty("style")&&(e.flags|=32)),e.initialInputs=o,e.inputs=s,e.outputs=a}(t,n)}s&&function(t,e,n){if(e){const i=t.localNames=[];for(let t=0;t<e.length;t+=2){const r=n[e[t+1]];if(null==r)throw new te("301",`Export of name '${e[t+1]}' not found!`);i.push(e[t],r)}}}(n,i,s)}return n.mergedAttrs=pn(n.mergedAttrs,n.attrs),r}function Lr(t,e,n,i,r,o){const s=o.hostBindings;if(s){let n=t.hostBindingOpCodes;null===n&&(n=t.hostBindingOpCodes=[]);const o=~e.index;(function(t){let e=t.length;for(;e>0;){const n=t[--e];if("number"==typeof n&&n<0)return n}return 0})(n)!=o&&n.push(o),n.push(i,r,s)}}function Rr(t,e){null!==t.hostBindings&&t.hostBindings(1,e)}function Fr(t,e){e.flags|=2,(t.components||(t.components=[])).push(e.index)}function Br(t,e,n){if(n){if(e.exportAs)for(let i=0;i<e.exportAs.length;i++)n[e.exportAs[i]]=t;Jt(e)&&(n[""]=t)}}function Vr(t,e,n){t.flags|=1,t.directiveStart=e,t.directiveEnd=e+n,t.providerIndexes=e}function Ur(t,e,n,i,r){t.data[i]=r;const o=r.factory||(r.factory=Qt(r.type)),s=new cn(o,Jt(r),null);t.blueprint[i]=s,n[i]=s,Lr(t,e,0,i,br(t,n,r.hostVars,cr),r)}function Nr(t,e,n){const i=me(e,t),r=Ir(n),o=t[10],s=Wr(t,vr(t,r,null,n.onPush?64:16,i,e,o,o.createRenderer(i,n),null,null));t[e.index]=s}function jr(t,e,n,i,r,o){const s=o[e];if(null!==s){const t=i.setInput;for(let e=0;e<s.length;){const r=s[e++],o=s[e++],a=s[e++];null!==t?i.setInput(n,a,r,o):n[o]=a}}}function qr(t,e){let n=null,i=0;for(;i<e.length;){const r=e[i];if(0!==r)if(5!==r){if("number"==typeof r)break;t.hasOwnProperty(r)&&(null===n&&(n=[]),n.push(r,t[r],e[i+1])),i+=2}else i+=2;else i+=4}return n}function $r(t,e,n,i){return new Array(t,!0,!1,e,null,0,i,n,null,null)}function Gr(t,e){const n=ye(e,t);if(be(n)){const t=n[1];80&n[2]?Cr(t,n,t.template,n[8]):n[5]>0&&Zr(n)}}function Zr(t){for(let n=Ai(t);null!==n;n=Ii(n))for(let t=10;t<n.length;t++){const e=n[t];if(1024&e[2]){const t=e[1];Cr(t,e,t.template,e[8])}else e[5]>0&&Zr(e)}const e=t[1].components;if(null!==e)for(let n=0;n<e.length;n++){const i=ye(e[n],t);be(i)&&i[5]>0&&Zr(i)}}function Hr(t,e){const n=ye(e,t),i=n[1];!function(t,e){for(let n=e.length;n<t.blueprint.length;n++)e.push(t.blueprint[n])}(i,n),wr(i,n,n[8])}function Wr(t,e){return t[13]?t[14][4]=e:t[13]=e,t[14]=e,e}function Xr(t){for(;t;){t[2]|=64;const e=ki(t);if(0!=(512&t[2])&&!e)return t;t=e}return null}function Kr(t,e,n){const i=e[10];i.begin&&i.begin();try{Cr(t,e,t.template,n)}catch(r){throw no(e,r),r}finally{i.end&&i.end()}}function Yr(t){!function(t){for(let e=0;e<t.components.length;e++){const n=t.components[e],i=ve(n),r=i[1];Tr(r,i,r.template,n)}}(t[8])}function Jr(t,e,n){$e(0),e(t,n)}const Qr=(()=>Promise.resolve(null))();function to(t){return t[7]||(t[7]=[])}function eo(t){return t.cleanup||(t.cleanup=[])}function no(t,e){const n=t[9],i=n?n.get(bi,null):null;i&&i.handleError(e)}function io(t,e,n,i,r){for(let o=0;o<n.length;){const s=n[o++],a=n[o++],l=e[s],c=t.data[s];null!==c.setInput?c.setInput(l,r,i,a):l[a]=r}}function ro(t,e,n){const i=fe(e,t);!function(t,e,n){he(t)?t.setValue(e,n):e.textContent=n}(t[11],i,n)}function oo(t,e,n){let i=n?t.styles:null,r=n?t.classes:null,o=0;if(null!==e)for(let s=0;s<e.length;s++){const t=e[s];"number"==typeof t?o=t:1==o?r=nt(r,t):2==o&&(i=nt(i,t+": "+e[++s]+";"))}n?t.styles=i:t.stylesWithoutHost=i,n?t.classes=r:t.classesWithoutHost=r}const so=new Nn("INJECTOR",-1);class ao{get(t,e=ii){if(e===ii){const e=new Error(`NullInjectorError: No provider for ${et(t)}!`);throw e.name="NullInjectorError",e}return e}}const lo=new Nn("Set Injector scope."),co={},uo={},ho=[];let po=void 0;function fo(){return void 0===po&&(po=new ao),po}function mo(t,e=null,n=null,i){return new go(t,n,e||fo(),i)}class go{constructor(t,e,n,i=null){this.parent=n,this.records=new Map,this.injectorDefTypes=new Set,this.onDestroy=new Set,this._destroyed=!1;const r=[];e&&Gn(e,n=>this.processProvider(n,t,e)),Gn([t],t=>this.processInjectorType(t,[],r)),this.records.set(so,vo(void 0,this));const o=this.records.get(lo);this.scope=null!=o?o.value:null,this.source=i||("object"==typeof t?null:et(t))}get destroyed(){return this._destroyed}destroy(){this.assertNotDestroyed(),this._destroyed=!0;try{this.onDestroy.forEach(t=>t.ngOnDestroy())}finally{this.records.clear(),this.onDestroy.clear(),this.injectorDefTypes.clear()}}get(t,e=ii,n=gt.Default){this.assertNotDestroyed();const i=li(this);try{if(!(n&gt.SkipSelf)){let e=this.records.get(t);if(void 0===e){const n=("function"==typeof(r=t)||"object"==typeof r&&r instanceof Nn)&&ct(t);e=n&&this.injectableDefInScope(n)?vo(_o(t),co):null,this.records.set(t,e)}if(null!=e)return this.hydrate(t,e)}return(n&gt.Self?fo():this.parent).get(t,e=n&gt.Optional&&e===ii?null:e)}catch(o){if("NullInjectorError"===o.name){if((o.ngTempTokenPath=o.ngTempTokenPath||[]).unshift(et(t)),i)throw o;return function(t,e,n,i){const r=t.ngTempTokenPath;throw e.__source&&r.unshift(e.__source),t.message=function(t,e,n,i=null){t=t&&"\n"===t.charAt(0)&&"\u0275"==t.charAt(1)?t.substr(2):t;let r=et(e);if(Array.isArray(e))r=e.map(et).join(" -> ");else if("object"==typeof e){let t=[];for(let n in e)if(e.hasOwnProperty(n)){let i=e[n];t.push(n+":"+("string"==typeof i?JSON.stringify(i):et(i)))}r=`{${t.join(", ")}}`}return`${n}${i?"("+i+")":""}[${r}]: ${t.replace(ri,"\n  ")}`}("\n"+t.message,r,n,i),t.ngTokenPath=r,t.ngTempTokenPath=null,t}(o,t,"R3InjectorError",this.source)}throw o}finally{li(i)}var r}_resolveInjectorDefTypes(){this.injectorDefTypes.forEach(t=>this.get(t))}toString(){const t=[];return this.records.forEach((e,n)=>t.push(et(n))),`R3Injector[${t.join(", ")}]`}assertNotDestroyed(){if(this._destroyed)throw new Error("Injector has already been destroyed.")}processInjectorType(t,e,n){if(!(t=ot(t)))return!1;let i=ht(t);const r=null==i&&t.ngModule||void 0,o=void 0===r?t:r,s=-1!==n.indexOf(o);if(void 0!==r&&(i=ht(r)),null==i)return!1;if(null!=i.imports&&!s){let t;n.push(o);try{Gn(i.imports,i=>{this.processInjectorType(i,e,n)&&(void 0===t&&(t=[]),t.push(i))})}finally{}if(void 0!==t)for(let e=0;e<t.length;e++){const{ngModule:n,providers:i}=t[e];Gn(i,t=>this.processProvider(t,n,i||ho))}}this.injectorDefTypes.add(o),this.records.set(o,vo(i.factory,co));const a=i.providers;if(null!=a&&!s){const e=t;Gn(a,t=>this.processProvider(t,e,a))}return void 0!==r&&void 0!==t.providers}processProvider(t,e,n){let i=bo(t=ot(t))?t:ot(t&&t.provide);const r=function(t,e,n){return xo(t)?vo(void 0,t.useValue):vo(yo(t),co)}(t);if(bo(t)||!0!==t.multi)this.records.get(i);else{let e=this.records.get(i);e||(e=vo(void 0,co,!0),e.factory=()=>hi(e.multi),this.records.set(i,e)),i=t,e.multi.push(t)}this.records.set(i,r)}hydrate(t,e){var n;return e.value===co&&(e.value=uo,e.value=e.factory()),"object"==typeof e.value&&e.value&&null!==(n=e.value)&&"object"==typeof n&&"function"==typeof n.ngOnDestroy&&this.onDestroy.add(e.value),e.value}injectableDefInScope(t){return!!t.providedIn&&("string"==typeof t.providedIn?"any"===t.providedIn||t.providedIn===this.scope:this.injectorDefTypes.has(t.providedIn))}}function _o(t){const e=ct(t),n=null!==e?e.factory:Qt(t);if(null!==n)return n;const i=ht(t);if(null!==i)return i.factory;if(t instanceof Nn)throw new Error(`Token ${et(t)} is missing a \u0275prov definition.`);if(t instanceof Function)return function(t){const e=t.length;if(e>0){const n=Wn(e,"?");throw new Error(`Can't resolve all parameters for ${et(t)}: (${n.join(", ")}).`)}const n=function(t){const e=t&&(t[dt]||t[ft]);if(e){const n=function(t){if(t.hasOwnProperty("name"))return t.name;const e=(""+t).match(/^function\s*([^\s(]+)/);return null===e?"":e[1]}(t);return console.warn(`DEPRECATED: DI is instantiating a token "${n}" that inherits its @Injectable decorator but does not provide one itself.\nThis will become an error in a future version of Angular. Please add @Injectable() to the "${n}" class.`),e}return null}(t);return null!==n?()=>n.factory(t):()=>new t}(t);throw new Error("unreachable")}function yo(t,e,n){let i=void 0;if(bo(t)){const e=ot(t);return Qt(e)||_o(e)}if(xo(t))i=()=>ot(t.useValue);else if((r=t)&&r.useFactory)i=()=>t.useFactory(...hi(t.deps||[]));else if(function(t){return!(!t||!t.useExisting)}(t))i=()=>ui(ot(t.useExisting));else{const e=ot(t&&(t.useClass||t.provide));if(!function(t){return!!t.deps}(t))return Qt(e)||_o(e);i=()=>new e(...hi(t.deps))}var r;return i}function vo(t,e,n=!1){return{factory:t,value:e,multi:n?[]:void 0}}function xo(t){return null!==t&&"object"==typeof t&&oi in t}function bo(t){return"function"==typeof t}const wo=function(t,e,n){return function(t,e=null,n=null,i){const r=mo(t,e,n,i);return r._resolveInjectorDefTypes(),r}({name:n},e,t,n)};let Co=(()=>{class t{static create(t,e){return Array.isArray(t)?wo(t,e,""):wo(t.providers,t.parent,t.name||"")}}return t.THROW_IF_NOT_FOUND=ii,t.NULL=new ao,t.\u0275prov=at({token:t,providedIn:"any",factory:()=>ui(so)}),t.__NG_ELEMENT_ID__=-1,t})();function To(t,e){nn(ve(t)[1],Pe())}function So(t){let e=Object.getPrototypeOf(t.type.prototype).constructor,n=!0;const i=[t];for(;e;){let r=void 0;if(Jt(t))r=e.\u0275cmp||e.\u0275dir;else{if(e.\u0275cmp)throw new Error("Directives cannot inherit Components");r=e.\u0275dir}if(r){if(n){i.push(r);const e=t;e.inputs=Eo(t.inputs),e.declaredInputs=Eo(t.declaredInputs),e.outputs=Eo(t.outputs);const n=r.hostBindings;n&&Io(t,n);const o=r.viewQuery,s=r.contentQueries;if(o&&ko(t,o),s&&Ao(t,s),tt(t.inputs,r.inputs),tt(t.declaredInputs,r.declaredInputs),tt(t.outputs,r.outputs),Jt(r)&&r.data.animation){const e=t.data;e.animation=(e.animation||[]).concat(r.data.animation)}}const e=r.features;if(e)for(let i=0;i<e.length;i++){const r=e[i];r&&r.ngInherit&&r(t),r===So&&(n=!1)}}e=Object.getPrototypeOf(e)}!function(t){let e=0,n=null;for(let i=t.length-1;i>=0;i--){const r=t[i];r.hostVars=e+=r.hostVars,r.hostAttrs=pn(r.hostAttrs,n=pn(n,r.hostAttrs))}}(i)}function Eo(t){return t===At?{}:t===It?[]:t}function ko(t,e){const n=t.viewQuery;t.viewQuery=n?(t,i)=>{e(t,i),n(t,i)}:e}function Ao(t,e){const n=t.contentQueries;t.contentQueries=n?(t,i,r)=>{e(t,i,r),n(t,i,r)}:e}function Io(t,e){const n=t.hostBindings;t.hostBindings=n?(t,i)=>{e(t,i),n(t,i)}:e}let Po=null;function Mo(){if(!Po){const t=kt.Symbol;if(t&&t.iterator)Po=t.iterator;else{const t=Object.getOwnPropertyNames(Map.prototype);for(let e=0;e<t.length;++e){const n=t[e];"entries"!==n&&"size"!==n&&Map.prototype[n]===Map.prototype.entries&&(Po=n)}}}return Po}class Oo{constructor(t){this.wrapped=t}static wrap(t){return new Oo(t)}static unwrap(t){return Oo.isWrapped(t)?t.wrapped:t}static isWrapped(t){return t instanceof Oo}}function zo(t){return!!Do(t)&&(Array.isArray(t)||!(t instanceof Map)&&Mo()in t)}function Do(t){return null!==t&&("function"==typeof t||"object"==typeof t)}function Lo(t,e,n){return t[e]=n}function Ro(t,e,n){return!Object.is(t[e],n)&&(t[e]=n,!0)}function Fo(t,e,n,i){const r=Ro(t,e,n);return Ro(t,e+1,i)||r}function Bo(t,e,n,i){const r=ke();return Ro(r,Ve(),e)&&(Ae(),function(t,e,n,i,r,o){const s=me(t,e);!function(t,e,n,i,r,o,s){if(null==o)he(t)?t.removeAttribute(e,r,n):e.removeAttribute(r);else{const a=null==s?ee(o):s(o,i||"",r);he(t)?t.setAttribute(e,r,a,n):n?e.setAttributeNS(n,r,a):e.setAttribute(r,a)}}(e[11],s,o,t.value,n,i,r)}(en(),r,t,e,n,i)),Bo}function Vo(t,e,n,i){return Ro(t,Ve(),n)?e+ee(n)+i:cr}function Uo(t,e,n,i,r,o,s,a){const l=ke(),c=Ae(),u=t+20,h=c.firstCreatePass?function(t,e,n,i,r,o,s,a,l){const c=e.consts,u=xr(e,t,4,s||null,we(c,a));Dr(e,n,u,we(c,l)),nn(e,u);const h=u.tViews=Pr(2,u,i,r,o,e.directiveRegistry,e.pipeRegistry,null,e.schemas,c);return null!==e.queries&&(e.queries.template(e,u),h.queries=e.queries.embeddedTView(u)),u}(u,c,l,e,n,i,r,o,s):c.data[u];Oe(h,!1);const d=l[11].createComment("");$i(c,l,d,h),wi(d,l),Wr(l,l[u]=$r(d,l,d,h)),Yt(h)&&kr(c,l,h),null!=s&&Ar(l,h,a)}function No(t){return _e(Se.lFrame.contextLView,20+t)}function jo(t,e=gt.Default){const n=ke();return null===n?ui(t,e):An(Pe(),n,ot(t),e)}function qo(t,e,n){const i=ke();return Ro(i,Ve(),e)&&zr(Ae(),en(),i,t,e,i[11],n,!1),qo}function $o(t,e,n,i,r){const o=r?"class":"style";io(t,n,e.inputs[o],o,i)}function Go(t,e,n,i){const r=ke(),o=Ae(),s=20+t,a=r[11],l=r[s]=Oi(a,e,Se.lFrame.currentNamespace),c=o.firstCreatePass?function(t,e,n,i,r,o,s){const a=e.consts,l=xr(e,t,2,r,we(a,o));return Dr(e,n,l,we(a,s)),null!==l.attrs&&oo(l,l.attrs,!1),null!==l.mergedAttrs&&oo(l,l.mergedAttrs,!0),null!==e.queries&&e.queries.elementStart(e,l),l}(s,o,r,0,e,n,i):o.data[s];Oe(c,!0);const u=c.mergedAttrs;null!==u&&un(a,l,u);const h=c.classes;null!==h&&Yi(a,l,h);const d=c.styles;null!==d&&Ki(a,l,d),64!=(64&c.flags)&&$i(o,r,l,c),0===Se.lFrame.elementDepthCount&&wi(l,r),Se.lFrame.elementDepthCount++,Yt(c)&&(kr(o,r,c),Er(o,c,r)),null!==i&&Ar(r,c)}function Zo(){let t=Pe();ze()?De():(t=t.parent,Oe(t,!1));const e=t;Se.lFrame.elementDepthCount--;const n=Ae();n.firstCreatePass&&(nn(n,t),Xt(t)&&n.queries.elementEnd(t)),null!=e.classesWithoutHost&&function(t){return 0!=(16&t.flags)}(e)&&$o(n,e,ke(),e.classesWithoutHost,!0),null!=e.stylesWithoutHost&&function(t){return 0!=(32&t.flags)}(e)&&$o(n,e,ke(),e.stylesWithoutHost,!1)}function Ho(t,e,n,i){Go(t,e,n,i),Zo()}function Wo(t,e,n){const i=ke(),r=Ae(),o=t+20,s=r.firstCreatePass?function(t,e,n,i,r){const o=e.consts,s=we(o,i),a=xr(e,t,8,"ng-container",s);return null!==s&&oo(a,s,!0),Dr(e,n,a,we(o,r)),null!==e.queries&&e.queries.elementStart(e,a),a}(o,r,i,e,n):r.data[o];Oe(s,!0);const a=i[o]=i[11].createComment("");$i(r,i,a,s),wi(a,i),Yt(s)&&(kr(r,i,s),Er(r,s,i)),null!=n&&Ar(i,s)}function Xo(){let t=Pe();const e=Ae();ze()?De():(t=t.parent,Oe(t,!1)),e.firstCreatePass&&(nn(e,t),Xt(t)&&e.queries.elementEnd(t))}function Ko(t,e,n){Wo(t,e,n),Xo()}function Yo(){return ke()}function Jo(t){return!!t&&"function"==typeof t.then}function Qo(t){return!!t&&"function"==typeof t.subscribe}function ts(t,e,n=!1,i){const r=ke(),o=Ae(),s=Pe();return function(t,e,n,i,r,o,s=!1,a){const l=Yt(i),c=t.firstCreatePass&&eo(t),u=to(e);let h=!0;if(3&i.type){const d=me(i,e),p=a?a(d):At,f=p.target||d,m=u.length,g=a?t=>a(pe(t[i.index])).target:i.index;if(he(n)){let s=null;if(!a&&l&&(s=function(t,e,n,i){const r=t.cleanup;if(null!=r)for(let o=0;o<r.length-1;o+=2){const t=r[o];if(t===n&&r[o+1]===i){const t=e[7],n=r[o+2];return t.length>n?t[n]:null}"string"==typeof t&&(o+=2)}return null}(t,e,r,i.index)),null!==s)(s.__ngLastListenerFn__||s).__ngNextListenerFn__=o,s.__ngLastListenerFn__=o,h=!1;else{o=ns(i,e,o,!1);const t=n.listen(p.name||f,r,o);u.push(o,t),c&&c.push(r,g,m,m+1)}}else o=ns(i,e,o,!0),f.addEventListener(r,o,s),u.push(o),c&&c.push(r,g,m,s)}else o=ns(i,e,o,!1);const d=i.outputs;let p;if(h&&null!==d&&(p=d[r])){const t=p.length;if(t)for(let n=0;n<t;n+=2){const t=e[p[n]][p[n+1]].subscribe(o),s=u.length;u.push(o,t),c&&c.push(r,i.index,s,-(s+1))}}}(o,r,r[11],s,t,e,n,i),ts}function es(t,e,n){try{return!1!==e(n)}catch(i){return no(t,i),!1}}function ns(t,e,n,i){return function r(o){if(o===Function)return n;const s=2&t.flags?ye(t.index,e):e;0==(32&e[2])&&Xr(s);let a=es(e,n,o),l=r.__ngNextListenerFn__;for(;l;)a=es(e,l,o)&&a,l=l.__ngNextListenerFn__;return i&&!1===a&&(o.preventDefault(),o.returnValue=!1),a}}function is(t=1){return function(t){return(Se.lFrame.contextLView=function(t,e){for(;t>0;)e=e[15],t--;return e}(t,Se.lFrame.contextLView))[8]}(t)}function rs(t,e){let n=null;const i=function(t){const e=t.attrs;if(null!=e){const t=e.indexOf(5);if(0==(1&t))return e[t+1]}return null}(t);for(let r=0;r<e.length;r++){const o=e[r];if("*"!==o){if(null===i?or(t,o,!0):sr(i,o))return r}else n=r}return n}function os(t){const e=ke()[16][6];if(!e.projection){const n=e.projection=Wn(t?t.length:1,null),i=n.slice();let r=e.child;for(;null!==r;){const e=t?rs(r,t):0;null!==e&&(i[e]?i[e].projectionNext=r:n[e]=r,i[e]=r),r=r.next}}}function ss(t,e=0,n){const i=ke(),r=Ae(),o=xr(r,20+t,16,null,n||null);null===o.projection&&(o.projection=e),De(),64!=(64&o.flags)&&function(t,e,n){Xi(e[11],0,e,n,Fi(t,n,e),ji(n.parent||e[6],n,e))}(r,i,o)}function as(t,e,n){return ls(t,"",e,"",n),as}function ls(t,e,n,i,r){const o=ke(),s=Vo(o,e,n,i);return s!==cr&&zr(Ae(),en(),o,t,s,o[11],r,!1),ls}const cs=[];function us(t,e,n,i,r){const o=t[n+1],s=null===e;let a=i?pr(o):mr(o),l=!1;for(;0!==a&&(!1===l||s);){const n=t[a+1];hs(t[a],e)&&(l=!0,t[a+1]=i?_r(n):fr(n)),a=i?pr(n):mr(n)}l&&(t[n+1]=i?fr(o):_r(o))}function hs(t,e){return null===t||null==e||(Array.isArray(t)?t[1]:t)===e||!(!Array.isArray(t)||"string"!=typeof e)&&Yn(t,e)>=0}const ds={textEnd:0,key:0,keyEnd:0,value:0,valueEnd:0};function ps(t){return t.substring(ds.key,ds.keyEnd)}function fs(t,e){const n=ds.textEnd;return n===e?-1:(e=ds.keyEnd=function(t,e,n){for(;e<n&&t.charCodeAt(e)>32;)e++;return e}(t,ds.key=e,n),ms(t,e,n))}function ms(t,e,n){for(;e<n&&t.charCodeAt(e)<=32;)e++;return e}function gs(t,e){return function(t,e,n,i){const r=ke(),o=Ae(),s=Ue(2);o.firstUpdatePass&&xs(o,t,s,true),e!==cr&&Ro(r,s,e)&&Cs(o,o.data[Qe()],r,r[11],t,r[s+1]=function(t,e){return null==t||"object"==typeof t&&(t=et(pi(t))),t}(e),true,s)}(t,e),gs}function _s(t){!function(t,e,n,i){const r=Ae(),o=Ue(2);r.firstUpdatePass&&xs(r,null,o,true);const s=ke();if(n!==cr&&Ro(s,o,n)){const i=r.data[Qe()];if(Es(i,true)&&!vs(r,o)){let t=i.classesWithoutHost;null!==t&&(n=nt(t,n||"")),$o(r,i,s,n,true)}else!function(t,e,n,i,r,o,s,a){r===cr&&(r=cs);let l=0,c=0,u=0<r.length?r[0]:null,h=0<o.length?o[0]:null;for(;null!==u||null!==h;){const s=l<r.length?r[l+1]:void 0,d=c<o.length?o[c+1]:void 0;let p=null,f=void 0;u===h?(l+=2,c+=2,s!==d&&(p=h,f=d)):null===h||null!==u&&u<h?(l+=2,p=u):(c+=2,p=h,f=d),null!==p&&Cs(t,e,n,i,p,f,true,a),u=l<r.length?r[l]:null,h=c<o.length?o[c]:null}}(r,i,s,s[11],s[o+1],s[o+1]=function(t,e,n){if(null==n||""===n)return cs;const i=[],r=pi(n);if(Array.isArray(r))for(let o=0;o<r.length;o++)t(i,r[o],!0);else if("object"==typeof r)for(const o in r)r.hasOwnProperty(o)&&t(i,o,r[o]);else"string"==typeof r&&e(i,r);return i}(t,e,n),0,o)}}(Xn,ys,t)}function ys(t,e){for(let n=function(t){return function(t){ds.key=0,ds.keyEnd=0,ds.value=0,ds.valueEnd=0,ds.textEnd=t.length}(t),fs(t,ms(t,0,ds.textEnd))}(e);n>=0;n=fs(e,n))Xn(t,ps(e),!0)}function vs(t,e){return e>=t.expandoStartIndex}function xs(t,e,n,i){const r=t.data;if(null===r[n+1]){const o=r[Qe()],s=vs(t,n);Es(o,i)&&null===e&&!s&&(e=!1),e=function(t,e,n,i){const r=function(t){const e=Se.lFrame.currentDirectiveIndex;return-1===e?null:t[e]}(t);let o=i?e.residualClasses:e.residualStyles;if(null===r)0===(i?e.classBindings:e.styleBindings)&&(n=ws(n=bs(null,t,e,n,i),e.attrs,i),o=null);else{const s=e.directiveStylingLast;if(-1===s||t[s]!==r)if(n=bs(r,t,e,n,i),null===o){let n=function(t,e,n){const i=n?e.classBindings:e.styleBindings;if(0!==mr(i))return t[pr(i)]}(t,e,i);void 0!==n&&Array.isArray(n)&&(n=bs(null,t,e,n[1],i),n=ws(n,e.attrs,i),function(t,e,n,i){t[pr(n?e.classBindings:e.styleBindings)]=i}(t,e,i,n))}else o=function(t,e,n){let i=void 0;const r=e.directiveEnd;for(let o=1+e.directiveStylingLast;o<r;o++)i=ws(i,t[o].hostAttrs,n);return ws(i,e.attrs,n)}(t,e,i)}return void 0!==o&&(i?e.residualClasses=o:e.residualStyles=o),n}(r,o,e,i),function(t,e,n,i,r,o){let s=o?e.classBindings:e.styleBindings,a=pr(s),l=mr(s);t[i]=n;let c,u=!1;if(Array.isArray(n)){const t=n;c=t[1],(null===c||Yn(t,c)>0)&&(u=!0)}else c=n;if(r)if(0!==l){const e=pr(t[a+1]);t[i+1]=dr(e,a),0!==e&&(t[e+1]=gr(t[e+1],i)),t[a+1]=131071&t[a+1]|i<<17}else t[i+1]=dr(a,0),0!==a&&(t[a+1]=gr(t[a+1],i)),a=i;else t[i+1]=dr(l,0),0===a?a=i:t[l+1]=gr(t[l+1],i),l=i;u&&(t[i+1]=fr(t[i+1])),us(t,c,i,!0),us(t,c,i,!1),function(t,e,n,i,r){const o=r?t.residualClasses:t.residualStyles;null!=o&&"string"==typeof e&&Yn(o,e)>=0&&(n[i+1]=_r(n[i+1]))}(e,c,t,i,o),s=dr(a,l),o?e.classBindings=s:e.styleBindings=s}(r,o,e,n,s,i)}}function bs(t,e,n,i,r){let o=null;const s=n.directiveEnd;let a=n.directiveStylingLast;for(-1===a?a=n.directiveStart:a++;a<s&&(o=e[a],i=ws(i,o.hostAttrs,r),o!==t);)a++;return null!==t&&(n.directiveStylingLast=a),i}function ws(t,e,n){const i=n?1:2;let r=-1;if(null!==e)for(let o=0;o<e.length;o++){const s=e[o];"number"==typeof s?r=s:r===i&&(Array.isArray(t)||(t=void 0===t?[]:["",t]),Xn(t,s,!!n||e[++o]))}return void 0===t?null:t}function Cs(t,e,n,i,r,o,s,a){if(!(3&e.type))return;const l=t.data,c=l[a+1];Ss(1==(1&c)?Ts(l,e,n,r,mr(c),s):void 0)||(Ss(o)||2==(2&c)&&(o=Ts(l,null,n,r,a,s)),function(t,e,n,i,r){const o=he(t);if(e)r?o?t.addClass(n,i):n.classList.add(i):o?t.removeClass(n,i):n.classList.remove(i);else{let e=-1===i.indexOf("-")?void 0:Si.DashCase;if(null==r)o?t.removeStyle(n,i,e):n.style.removeProperty(i);else{const s="string"==typeof r&&r.endsWith("!important");s&&(r=r.slice(0,-10),e|=Si.Important),o?t.setStyle(n,i,r,e):n.style.setProperty(i,r,s?"important":"")}}}(i,s,fe(Qe(),n),r,o))}function Ts(t,e,n,i,r,o){const s=null===e;let a=void 0;for(;r>0;){const e=t[r],o=Array.isArray(e),l=o?e[1]:e,c=null===l;let u=n[r+1];u===cr&&(u=c?cs:void 0);let h=c?Kn(u,i):l===i?u:void 0;if(o&&!Ss(h)&&(h=Kn(e,i)),Ss(h)&&(a=h,s))return a;const d=t[r+1];r=s?pr(d):mr(d)}if(null!==e){let t=o?e.residualClasses:e.residualStyles;null!=t&&(a=Kn(t,i))}return a}function Ss(t){return void 0!==t}function Es(t,e){return 0!=(t.flags&(e?16:32))}function ks(t,e=""){const n=ke(),i=Ae(),r=t+20,o=i.firstCreatePass?xr(i,r,1,e,null):i.data[r],s=n[r]=function(t,e){return he(t)?t.createText(e):t.createTextNode(e)}(n[11],e);$i(i,n,s,o),Oe(o,!1)}function As(t){return Is("",t,""),As}function Is(t,e,n){const i=ke(),r=Vo(i,t,e,n);return r!==cr&&ro(i,Qe(),r),Is}function Ps(t,e,n,i,r){const o=ke(),s=function(t,e,n,i,r,o){const s=Fo(t,Be(),n,r);return Ue(2),s?e+ee(n)+i+ee(r)+o:cr}(o,t,e,n,i,r);return s!==cr&&ro(o,Qe(),s),Ps}function Ms(t,e,n){const i=ke();return Ro(i,Ve(),e)&&zr(Ae(),en(),i,t,e,i[11],n,!0),Ms}const Os=void 0;var zs=["en",[["a","p"],["AM","PM"],Os],[["AM","PM"],Os,Os],[["S","M","T","W","T","F","S"],["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],["Su","Mo","Tu","We","Th","Fr","Sa"]],Os,[["J","F","M","A","M","J","J","A","S","O","N","D"],["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],["January","February","March","April","May","June","July","August","September","October","November","December"]],Os,[["B","A"],["BC","AD"],["Before Christ","Anno Domini"]],0,[6,0],["M/d/yy","MMM d, y","MMMM d, y","EEEE, MMMM d, y"],["h:mm a","h:mm:ss a","h:mm:ss a z","h:mm:ss a zzzz"],["{1}, {0}",Os,"{1} 'at' {0}",Os],[".",",",";","%","+","-","E","\xd7","\u2030","\u221e","NaN",":"],["#,##0.###","#,##0%","\xa4#,##0.00","#E0"],"USD","$","US Dollar",{},"ltr",function(t){let e=Math.floor(Math.abs(t)),n=t.toString().replace(/^[^.]*\.?/,"").length;return 1===e&&0===n?1:5}];let Ds={};function Ls(t){return t in Ds||(Ds[t]=kt.ng&&kt.ng.common&&kt.ng.common.locales&&kt.ng.common.locales[t]),Ds[t]}var Rs=function(t){return t[t.LocaleId=0]="LocaleId",t[t.DayPeriodsFormat=1]="DayPeriodsFormat",t[t.DayPeriodsStandalone=2]="DayPeriodsStandalone",t[t.DaysFormat=3]="DaysFormat",t[t.DaysStandalone=4]="DaysStandalone",t[t.MonthsFormat=5]="MonthsFormat",t[t.MonthsStandalone=6]="MonthsStandalone",t[t.Eras=7]="Eras",t[t.FirstDayOfWeek=8]="FirstDayOfWeek",t[t.WeekendRange=9]="WeekendRange",t[t.DateFormat=10]="DateFormat",t[t.TimeFormat=11]="TimeFormat",t[t.DateTimeFormat=12]="DateTimeFormat",t[t.NumberSymbols=13]="NumberSymbols",t[t.NumberFormats=14]="NumberFormats",t[t.CurrencyCode=15]="CurrencyCode",t[t.CurrencySymbol=16]="CurrencySymbol",t[t.CurrencyName=17]="CurrencyName",t[t.Currencies=18]="Currencies",t[t.Directionality=19]="Directionality",t[t.PluralCase=20]="PluralCase",t[t.ExtraData=21]="ExtraData",t}({});let Fs="en-US";function Bs(t){var e,n;n="Expected localeId to be defined",null==(e=t)&&function(t,e,n,i){throw new Error("ASSERTION ERROR: "+t+` [Expected=> null != ${e} <=Actual]`)}(n,e),"string"==typeof t&&(Fs=t.toLowerCase().replace(/_/g,"-"))}function Vs(t,e,n,i,r){if(t=ot(t),Array.isArray(t))for(let o=0;o<t.length;o++)Vs(t[o],e,n,i,r);else{const o=Ae(),s=ke();let a=bo(t)?t:ot(t.provide),l=yo(t);const c=Pe(),u=1048575&c.providerIndexes,h=c.directiveStart,d=c.providerIndexes>>20;if(bo(t)||!t.multi){const i=new cn(l,r,jo),p=js(a,e,r?u:u+d,h);-1===p?(Sn(bn(c,s),o,a),Us(o,t,e.length),e.push(a),c.directiveStart++,c.directiveEnd++,r&&(c.providerIndexes+=1048576),n.push(i),s.push(i)):(n[p]=i,s[p]=i)}else{const p=js(a,e,u+d,h),f=js(a,e,u,u+d),m=p>=0&&n[p],g=f>=0&&n[f];if(r&&!g||!r&&!m){Sn(bn(c,s),o,a);const u=function(t,e,n,i,r){const o=new cn(t,n,jo);return o.multi=[],o.index=e,o.componentProviders=0,Ns(o,r,i&&!n),o}(r?$s:qs,n.length,r,i,l);!r&&g&&(n[f].providerFactory=u),Us(o,t,e.length,0),e.push(a),c.directiveStart++,c.directiveEnd++,r&&(c.providerIndexes+=1048576),n.push(u),s.push(u)}else Us(o,t,p>-1?p:f,Ns(n[r?f:p],l,!r&&i));!r&&i&&g&&n[f].componentProviders++}}}function Us(t,e,n,i){const r=bo(e);if(r||e.useClass){const o=(e.useClass||e).prototype.ngOnDestroy;if(o){const s=t.destroyHooks||(t.destroyHooks=[]);if(!r&&e.multi){const t=s.indexOf(n);-1===t?s.push(n,[i,o]):s[t+1].push(i,o)}else s.push(n,o)}}}function Ns(t,e,n){return n&&t.componentProviders++,t.multi.push(e)-1}function js(t,e,n,i){for(let r=n;r<i;r++)if(e[r]===t)return r;return-1}function qs(t,e,n,i){return Gs(this.multi,[])}function $s(t,e,n,i){const r=this.multi;let o;if(this.providerFactory){const t=this.providerFactory.componentProviders,e=zn(n,n[1],this.providerFactory.index,i);o=e.slice(0,t),Gs(r,o);for(let n=t;n<e.length;n++)o.push(e[n])}else o=[],Gs(r,o);return o}function Gs(t,e){for(let n=0;n<t.length;n++)e.push((0,t[n])());return e}function Zs(t,e=[]){return n=>{n.providersResolver=(n,i)=>function(t,e,n){const i=Ae();if(i.firstCreatePass){const r=Jt(t);Vs(n,i.data,i.blueprint,r,!0),Vs(e,i.data,i.blueprint,r,!1)}}(n,i?i(t):t,e)}}class Hs{}class Ws{resolveComponentFactory(t){throw function(t){const e=Error(`No component factory found for ${et(t)}. Did you add it to @NgModule.entryComponents?`);return e.ngComponent=t,e}(t)}}let Xs=(()=>{class t{}return t.NULL=new Ws,t})();function Ks(...t){}function Ys(t,e){return new Qs(me(t,e))}const Js=function(){return Ys(Pe(),ke())};let Qs=(()=>{class t{constructor(t){this.nativeElement=t}}return t.__NG_ELEMENT_ID__=Js,t})();class ta{}let ea=(()=>{class t{}return t.__NG_ELEMENT_ID__=()=>na(),t})();const na=function(){const t=ke(),e=ye(Pe().index,t);return function(t){return t[11]}(Ht(e)?e:t)};let ia=(()=>{class t{}return t.\u0275prov=at({token:t,providedIn:"root",factory:()=>null}),t})();class ra{constructor(t){this.full=t,this.major=t.split(".")[0],this.minor=t.split(".")[1],this.patch=t.split(".").slice(2).join(".")}}const oa=new ra("11.0.9");class sa{constructor(){}supports(t){return zo(t)}create(t){return new la(t)}}const aa=(t,e)=>e;class la{constructor(t){this.length=0,this._linkedRecords=null,this._unlinkedRecords=null,this._previousItHead=null,this._itHead=null,this._itTail=null,this._additionsHead=null,this._additionsTail=null,this._movesHead=null,this._movesTail=null,this._removalsHead=null,this._removalsTail=null,this._identityChangesHead=null,this._identityChangesTail=null,this._trackByFn=t||aa}forEachItem(t){let e;for(e=this._itHead;null!==e;e=e._next)t(e)}forEachOperation(t){let e=this._itHead,n=this._removalsHead,i=0,r=null;for(;e||n;){const o=!n||e&&e.currentIndex<da(n,i,r)?e:n,s=da(o,i,r),a=o.currentIndex;if(o===n)i--,n=n._nextRemoved;else if(e=e._next,null==o.previousIndex)i++;else{r||(r=[]);const t=s-i,e=a-i;if(t!=e){for(let n=0;n<t;n++){const i=n<r.length?r[n]:r[n]=0,o=i+n;e<=o&&o<t&&(r[n]=i+1)}r[o.previousIndex]=e-t}}s!==a&&t(o,s,a)}}forEachPreviousItem(t){let e;for(e=this._previousItHead;null!==e;e=e._nextPrevious)t(e)}forEachAddedItem(t){let e;for(e=this._additionsHead;null!==e;e=e._nextAdded)t(e)}forEachMovedItem(t){let e;for(e=this._movesHead;null!==e;e=e._nextMoved)t(e)}forEachRemovedItem(t){let e;for(e=this._removalsHead;null!==e;e=e._nextRemoved)t(e)}forEachIdentityChange(t){let e;for(e=this._identityChangesHead;null!==e;e=e._nextIdentityChange)t(e)}diff(t){if(null==t&&(t=[]),!zo(t))throw new Error(`Error trying to diff '${et(t)}'. Only arrays and iterables are allowed`);return this.check(t)?this:null}onDestroy(){}check(t){this._reset();let e,n,i,r=this._itHead,o=!1;if(Array.isArray(t)){this.length=t.length;for(let e=0;e<this.length;e++)n=t[e],i=this._trackByFn(e,n),null!==r&&Object.is(r.trackById,i)?(o&&(r=this._verifyReinsertion(r,n,i,e)),Object.is(r.item,n)||this._addIdentityChange(r,n)):(r=this._mismatch(r,n,i,e),o=!0),r=r._next}else e=0,function(t,e){if(Array.isArray(t))for(let n=0;n<t.length;n++)e(t[n]);else{const n=t[Mo()]();let i;for(;!(i=n.next()).done;)e(i.value)}}(t,t=>{i=this._trackByFn(e,t),null!==r&&Object.is(r.trackById,i)?(o&&(r=this._verifyReinsertion(r,t,i,e)),Object.is(r.item,t)||this._addIdentityChange(r,t)):(r=this._mismatch(r,t,i,e),o=!0),r=r._next,e++}),this.length=e;return this._truncate(r),this.collection=t,this.isDirty}get isDirty(){return null!==this._additionsHead||null!==this._movesHead||null!==this._removalsHead||null!==this._identityChangesHead}_reset(){if(this.isDirty){let t;for(t=this._previousItHead=this._itHead;null!==t;t=t._next)t._nextPrevious=t._next;for(t=this._additionsHead;null!==t;t=t._nextAdded)t.previousIndex=t.currentIndex;for(this._additionsHead=this._additionsTail=null,t=this._movesHead;null!==t;t=t._nextMoved)t.previousIndex=t.currentIndex;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}_mismatch(t,e,n,i){let r;return null===t?r=this._itTail:(r=t._prev,this._remove(t)),null!==(t=null===this._linkedRecords?null:this._linkedRecords.get(n,i))?(Object.is(t.item,e)||this._addIdentityChange(t,e),this._moveAfter(t,r,i)):null!==(t=null===this._unlinkedRecords?null:this._unlinkedRecords.get(n,null))?(Object.is(t.item,e)||this._addIdentityChange(t,e),this._reinsertAfter(t,r,i)):t=this._addAfter(new ca(e,n),r,i),t}_verifyReinsertion(t,e,n,i){let r=null===this._unlinkedRecords?null:this._unlinkedRecords.get(n,null);return null!==r?t=this._reinsertAfter(r,t._prev,i):t.currentIndex!=i&&(t.currentIndex=i,this._addToMoves(t,i)),t}_truncate(t){for(;null!==t;){const e=t._next;this._addToRemovals(this._unlink(t)),t=e}null!==this._unlinkedRecords&&this._unlinkedRecords.clear(),null!==this._additionsTail&&(this._additionsTail._nextAdded=null),null!==this._movesTail&&(this._movesTail._nextMoved=null),null!==this._itTail&&(this._itTail._next=null),null!==this._removalsTail&&(this._removalsTail._nextRemoved=null),null!==this._identityChangesTail&&(this._identityChangesTail._nextIdentityChange=null)}_reinsertAfter(t,e,n){null!==this._unlinkedRecords&&this._unlinkedRecords.remove(t);const i=t._prevRemoved,r=t._nextRemoved;return null===i?this._removalsHead=r:i._nextRemoved=r,null===r?this._removalsTail=i:r._prevRemoved=i,this._insertAfter(t,e,n),this._addToMoves(t,n),t}_moveAfter(t,e,n){return this._unlink(t),this._insertAfter(t,e,n),this._addToMoves(t,n),t}_addAfter(t,e,n){return this._insertAfter(t,e,n),this._additionsTail=null===this._additionsTail?this._additionsHead=t:this._additionsTail._nextAdded=t,t}_insertAfter(t,e,n){const i=null===e?this._itHead:e._next;return t._next=i,t._prev=e,null===i?this._itTail=t:i._prev=t,null===e?this._itHead=t:e._next=t,null===this._linkedRecords&&(this._linkedRecords=new ha),this._linkedRecords.put(t),t.currentIndex=n,t}_remove(t){return this._addToRemovals(this._unlink(t))}_unlink(t){null!==this._linkedRecords&&this._linkedRecords.remove(t);const e=t._prev,n=t._next;return null===e?this._itHead=n:e._next=n,null===n?this._itTail=e:n._prev=e,t}_addToMoves(t,e){return t.previousIndex===e||(this._movesTail=null===this._movesTail?this._movesHead=t:this._movesTail._nextMoved=t),t}_addToRemovals(t){return null===this._unlinkedRecords&&(this._unlinkedRecords=new ha),this._unlinkedRecords.put(t),t.currentIndex=null,t._nextRemoved=null,null===this._removalsTail?(this._removalsTail=this._removalsHead=t,t._prevRemoved=null):(t._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=t),t}_addIdentityChange(t,e){return t.item=e,this._identityChangesTail=null===this._identityChangesTail?this._identityChangesHead=t:this._identityChangesTail._nextIdentityChange=t,t}}class ca{constructor(t,e){this.item=t,this.trackById=e,this.currentIndex=null,this.previousIndex=null,this._nextPrevious=null,this._prev=null,this._next=null,this._prevDup=null,this._nextDup=null,this._prevRemoved=null,this._nextRemoved=null,this._nextAdded=null,this._nextMoved=null,this._nextIdentityChange=null}}class ua{constructor(){this._head=null,this._tail=null}add(t){null===this._head?(this._head=this._tail=t,t._nextDup=null,t._prevDup=null):(this._tail._nextDup=t,t._prevDup=this._tail,t._nextDup=null,this._tail=t)}get(t,e){let n;for(n=this._head;null!==n;n=n._nextDup)if((null===e||e<=n.currentIndex)&&Object.is(n.trackById,t))return n;return null}remove(t){const e=t._prevDup,n=t._nextDup;return null===e?this._head=n:e._nextDup=n,null===n?this._tail=e:n._prevDup=e,null===this._head}}class ha{constructor(){this.map=new Map}put(t){const e=t.trackById;let n=this.map.get(e);n||(n=new ua,this.map.set(e,n)),n.add(t)}get(t,e){const n=this.map.get(t);return n?n.get(t,e):null}remove(t){const e=t.trackById;return this.map.get(e).remove(t)&&this.map.delete(e),t}get isEmpty(){return 0===this.map.size}clear(){this.map.clear()}}function da(t,e,n){const i=t.previousIndex;if(null===i)return i;let r=0;return n&&i<n.length&&(r=n[i]),i+e+r}class pa{constructor(){}supports(t){return t instanceof Map||Do(t)}create(){return new fa}}class fa{constructor(){this._records=new Map,this._mapHead=null,this._appendAfter=null,this._previousMapHead=null,this._changesHead=null,this._changesTail=null,this._additionsHead=null,this._additionsTail=null,this._removalsHead=null,this._removalsTail=null}get isDirty(){return null!==this._additionsHead||null!==this._changesHead||null!==this._removalsHead}forEachItem(t){let e;for(e=this._mapHead;null!==e;e=e._next)t(e)}forEachPreviousItem(t){let e;for(e=this._previousMapHead;null!==e;e=e._nextPrevious)t(e)}forEachChangedItem(t){let e;for(e=this._changesHead;null!==e;e=e._nextChanged)t(e)}forEachAddedItem(t){let e;for(e=this._additionsHead;null!==e;e=e._nextAdded)t(e)}forEachRemovedItem(t){let e;for(e=this._removalsHead;null!==e;e=e._nextRemoved)t(e)}diff(t){if(t){if(!(t instanceof Map||Do(t)))throw new Error(`Error trying to diff '${et(t)}'. Only maps and objects are allowed`)}else t=new Map;return this.check(t)?this:null}onDestroy(){}check(t){this._reset();let e=this._mapHead;if(this._appendAfter=null,this._forEach(t,(t,n)=>{if(e&&e.key===n)this._maybeAddToChanges(e,t),this._appendAfter=e,e=e._next;else{const i=this._getOrCreateRecordForKey(n,t);e=this._insertBeforeOrAppend(e,i)}}),e){e._prev&&(e._prev._next=null),this._removalsHead=e;for(let t=e;null!==t;t=t._nextRemoved)t===this._mapHead&&(this._mapHead=null),this._records.delete(t.key),t._nextRemoved=t._next,t.previousValue=t.currentValue,t.currentValue=null,t._prev=null,t._next=null}return this._changesTail&&(this._changesTail._nextChanged=null),this._additionsTail&&(this._additionsTail._nextAdded=null),this.isDirty}_insertBeforeOrAppend(t,e){if(t){const n=t._prev;return e._next=t,e._prev=n,t._prev=e,n&&(n._next=e),t===this._mapHead&&(this._mapHead=e),this._appendAfter=t,t}return this._appendAfter?(this._appendAfter._next=e,e._prev=this._appendAfter):this._mapHead=e,this._appendAfter=e,null}_getOrCreateRecordForKey(t,e){if(this._records.has(t)){const n=this._records.get(t);this._maybeAddToChanges(n,e);const i=n._prev,r=n._next;return i&&(i._next=r),r&&(r._prev=i),n._next=null,n._prev=null,n}const n=new ma(t);return this._records.set(t,n),n.currentValue=e,this._addToAdditions(n),n}_reset(){if(this.isDirty){let t;for(this._previousMapHead=this._mapHead,t=this._previousMapHead;null!==t;t=t._next)t._nextPrevious=t._next;for(t=this._changesHead;null!==t;t=t._nextChanged)t.previousValue=t.currentValue;for(t=this._additionsHead;null!=t;t=t._nextAdded)t.previousValue=t.currentValue;this._changesHead=this._changesTail=null,this._additionsHead=this._additionsTail=null,this._removalsHead=null}}_maybeAddToChanges(t,e){Object.is(e,t.currentValue)||(t.previousValue=t.currentValue,t.currentValue=e,this._addToChanges(t))}_addToAdditions(t){null===this._additionsHead?this._additionsHead=this._additionsTail=t:(this._additionsTail._nextAdded=t,this._additionsTail=t)}_addToChanges(t){null===this._changesHead?this._changesHead=this._changesTail=t:(this._changesTail._nextChanged=t,this._changesTail=t)}_forEach(t,e){t instanceof Map?t.forEach(e):Object.keys(t).forEach(n=>e(t[n],n))}}class ma{constructor(t){this.key=t,this.previousValue=null,this.currentValue=null,this._nextPrevious=null,this._next=null,this._prev=null,this._nextAdded=null,this._nextRemoved=null,this._nextChanged=null}}let ga=(()=>{class t{constructor(t){this.factories=t}static create(e,n){if(null!=n){const t=n.factories.slice();e=e.concat(t)}return new t(e)}static extend(e){return{provide:t,useFactory:n=>{if(!n)throw new Error("Cannot extend IterableDiffers without a parent injector");return t.create(e,n)},deps:[[t,new ei,new Qn]]}}find(t){const e=this.factories.find(e=>e.supports(t));if(null!=e)return e;throw new Error(`Cannot find a differ supporting object '${t}' of type '${n=t,n.name||typeof n}'`);var n}}return t.\u0275prov=at({token:t,providedIn:"root",factory:()=>new t([new sa])}),t})(),_a=(()=>{class t{constructor(t){this.factories=t}static create(e,n){if(n){const t=n.factories.slice();e=e.concat(t)}return new t(e)}static extend(e){return{provide:t,useFactory:n=>{if(!n)throw new Error("Cannot extend KeyValueDiffers without a parent injector");return t.create(e,n)},deps:[[t,new ei,new Qn]]}}find(t){const e=this.factories.find(e=>e.supports(t));if(e)return e;throw new Error(`Cannot find a differ supporting object '${t}'`)}}return t.\u0275prov=at({token:t,providedIn:"root",factory:()=>new t([new pa])}),t})();function ya(t,e,n,i,r=!1){for(;null!==n;){const o=e[n.index];if(null!==o&&i.push(pe(o)),Wt(o))for(let t=10;t<o.length;t++){const e=o[t],n=e[1].firstChild;null!==n&&ya(e[1],e,n,i)}const s=n.type;if(8&s)ya(t,e,n.child,i);else if(32&s){const t=Ei(n,e);let r;for(;r=t();)i.push(r)}else if(16&s){const t=e[16],r=t[6].projection[n.projection];if(Array.isArray(r))i.push(...r);else{const e=ki(t);ya(e[1],e,r,i,!0)}}n=r?n.projectionNext:n.next}return i}class va{constructor(t,e){this._lView=t,this._cdRefInjectingView=e,this._appRef=null,this._attachedToViewContainer=!1}get rootNodes(){const t=this._lView,e=t[1];return ya(e,t,e.firstChild,[])}get context(){return this._lView[8]}get destroyed(){return 256==(256&this._lView[2])}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){const t=this._lView[3];if(Wt(t)){const e=t[8],n=e?e.indexOf(this):-1;n>-1&&(Di(t,n),Hn(e,n))}this._attachedToViewContainer=!1}Li(this._lView[1],this._lView)}onDestroy(t){Mr(this._lView[1],this._lView,null,t)}markForCheck(){Xr(this._cdRefInjectingView||this._lView)}detach(){this._lView[2]&=-129}reattach(){this._lView[2]|=128}detectChanges(){Kr(this._lView[1],this._lView,this.context)}checkNoChanges(){!function(t,e,n){Re(!0);try{Kr(t,e,n)}finally{Re(!1)}}(this._lView[1],this._lView,this.context)}attachToViewContainerRef(){if(this._appRef)throw new Error("This view is already attached directly to the ApplicationRef!");this._attachedToViewContainer=!0}detachFromAppRef(){var t;this._appRef=null,Wi(this._lView[1],t=this._lView,t[11],2,null,null)}attachToAppRef(t){if(this._attachedToViewContainer)throw new Error("This view is already attached to a ViewContainer!");this._appRef=t}}class xa extends va{constructor(t){super(t),this._view=t}detectChanges(){Yr(this._view)}checkNoChanges(){!function(t){Re(!0);try{Yr(t)}finally{Re(!1)}}(this._view)}get context(){return null}}const ba=function(t=!1){return function(t,e,n){if(!n&&Kt(t)){const n=ye(t.index,e);return new va(n,n)}return 47&t.type?new va(e[16],e):null}(Pe(),ke(),t)};let wa=(()=>{class t{}return t.__NG_ELEMENT_ID__=ba,t.__ChangeDetectorRef__=!0,t})();const Ca=[new pa],Ta=new ga([new sa]),Sa=new _a(Ca),Ea=function(){return Pa(Pe(),ke())};let ka=(()=>{class t{}return t.__NG_ELEMENT_ID__=Ea,t})();const Aa=ka,Ia=class extends Aa{constructor(t,e,n){super(),this._declarationLView=t,this._declarationTContainer=e,this.elementRef=n}createEmbeddedView(t){const e=this._declarationTContainer.tViews,n=vr(this._declarationLView,e,t,16,null,e.declTNode,null,null,null,null);n[17]=this._declarationLView[this._declarationTContainer.index];const i=this._declarationLView[19];return null!==i&&(n[19]=i.createEmbeddedView(e)),wr(e,n,t),new va(n)}};function Pa(t,e){return 4&t.type?new Ia(e,t,Ys(t,e)):null}class Ma{}class Oa{}const za=function(){return Va(Pe(),ke())};let Da=(()=>{class t{}return t.__NG_ELEMENT_ID__=za,t})();const La=Da,Ra=class extends La{constructor(t,e,n){super(),this._lContainer=t,this._hostTNode=e,this._hostLView=n}get element(){return Ys(this._hostTNode,this._hostLView)}get injector(){return new Rn(this._hostTNode,this._hostLView)}get parentInjector(){const t=Tn(this._hostTNode,this._hostLView);if(mn(t)){const e=_n(t,this._hostLView),n=gn(t);return new Rn(e[1].data[n+8],e)}return new Rn(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(t){const e=Fa(this._lContainer);return null!==e&&e[t]||null}get length(){return this._lContainer.length-10}createEmbeddedView(t,e,n){const i=t.createEmbeddedView(e||{});return this.insert(i,n),i}createComponent(t,e,n,i,r){const o=n||this.parentInjector;if(!r&&null==t.ngModule&&o){const t=o.get(Ma,null);t&&(r=t)}const s=t.create(o,i,void 0,r);return this.insert(s.hostView,e),s}insert(t,e){const n=t._lView,i=n[1];if(Wt(n[3])){const e=this.indexOf(t);if(-1!==e)this.detach(e);else{const e=n[3],i=new Ra(e,e[6],e[3]);i.detach(i.indexOf(t))}}const r=this._adjustIndex(e),o=this._lContainer;!function(t,e,n,i){const r=10+i,o=n.length;i>0&&(n[r-1][4]=e),i<o-10?(e[4]=n[r],Zn(n,10+i,e)):(n.push(e),e[4]=null),e[3]=n;const s=e[17];null!==s&&n!==s&&function(t,e){const n=t[9];e[16]!==e[3][3][16]&&(t[2]=!0),null===n?t[9]=[e]:n.push(e)}(s,e);const a=e[19];null!==a&&a.insertView(t),e[2]|=128}(i,n,o,r);const s=Zi(r,o),a=n[11],l=Ni(a,o[7]);return null!==l&&function(t,e,n,i,r,o){i[0]=r,i[6]=e,Wi(t,i,n,1,r,o)}(i,o[6],a,n,l,s),t.attachToViewContainerRef(),Zn(Ba(o),r,t),t}move(t,e){return this.insert(t,e)}indexOf(t){const e=Fa(this._lContainer);return null!==e?e.indexOf(t):-1}remove(t){const e=this._adjustIndex(t,-1),n=Di(this._lContainer,e);n&&(Hn(Ba(this._lContainer),e),Li(n[1],n))}detach(t){const e=this._adjustIndex(t,-1),n=Di(this._lContainer,e);return n&&null!=Hn(Ba(this._lContainer),e)?new va(n):null}_adjustIndex(t,e=0){return null==t?this.length+e:t}};function Fa(t){return t[8]}function Ba(t){return t[8]||(t[8]=[])}function Va(t,e){let n;const i=e[t.index];if(Wt(i))n=i;else{let r;if(8&t.type)r=pe(i);else{const n=e[11];r=n.createComment("");const i=me(t,e);Bi(n,Ni(n,i),r,function(t,e){return he(t)?t.nextSibling(e):e.nextSibling}(n,i),!1)}e[t.index]=n=$r(i,e,r,t),Wr(e,n)}return new Ra(n,t,e)}const Ua={};class Na extends Xs{constructor(t){super(),this.ngModule=t}resolveComponentFactory(t){const e=Gt(t);return new $a(e,this.ngModule)}}function ja(t){const e=[];for(let n in t)t.hasOwnProperty(n)&&e.push({propName:t[n],templateName:n});return e}const qa=new Nn("SCHEDULER_TOKEN",{providedIn:"root",factory:()=>Ci});class $a extends Hs{constructor(t,e){super(),this.componentDef=t,this.ngModule=e,this.componentType=t.type,this.selector=t.selectors.map(lr).join(","),this.ngContentSelectors=t.ngContentSelectors?t.ngContentSelectors:[],this.isBoundToModule=!!e}get inputs(){return ja(this.componentDef.inputs)}get outputs(){return ja(this.componentDef.outputs)}create(t,e,n,i){const r=(i=i||this.ngModule)?function(t,e){return{get:(n,i,r)=>{const o=t.get(n,Ua,r);return o!==Ua||i===Ua?o:e.get(n,i,r)}}}(t,i.injector):t,o=r.get(ta,de),s=r.get(ia,null),a=o.createRenderer(null,this.componentDef),l=this.componentDef.selectors[0][0]||"div",c=n?function(t,e,n){if(he(t))return t.selectRootElement(e,n===wt.ShadowDom);let i="string"==typeof e?t.querySelector(e):e;return i.textContent="",i}(a,n,this.componentDef.encapsulation):Oi(o.createRenderer(null,this.componentDef),l,function(t){const e=t.toLowerCase();return"svg"===e?"http://www.w3.org/2000/svg":"math"===e?"http://www.w3.org/1998/MathML/":null}(l)),u=this.componentDef.onPush?576:528,h={components:[],scheduler:Ci,clean:Qr,playerHandler:null,flags:0},d=Pr(0,null,null,1,0,null,null,null,null,null),p=vr(null,d,h,u,null,null,o,a,s,r);let f,m;He(p);try{const t=function(t,e,n,i,r,o){const s=n[1];n[20]=t;const a=xr(s,20,2,"#host",null),l=a.mergedAttrs=e.hostAttrs;null!==l&&(oo(a,l,!0),null!==t&&(un(r,t,l),null!==a.classes&&Yi(r,t,a.classes),null!==a.styles&&Ki(r,t,a.styles)));const c=i.createRenderer(t,e),u=vr(n,Ir(e),null,e.onPush?64:16,n[20],a,i,c,null,null);return s.firstCreatePass&&(Sn(bn(a,n),s,e.type),Fr(s,a),Vr(a,n.length,1)),Wr(n,u),n[20]=u}(c,this.componentDef,p,o,a);if(c)if(n)un(a,c,["ng-version",oa.full]);else{const{attrs:t,classes:e}=function(t){const e=[],n=[];let i=1,r=2;for(;i<t.length;){let o=t[i];if("string"==typeof o)2===r?""!==o&&e.push(o,t[++i]):8===r&&n.push(o);else{if(!ir(r))break;r=o}i++}return{attrs:e,classes:n}}(this.componentDef.selectors[0]);t&&un(a,c,t),e&&e.length>0&&Yi(a,c,e.join(" "))}if(m=ge(d,20),void 0!==e){const t=m.projection=[];for(let n=0;n<this.ngContentSelectors.length;n++){const i=e[n];t.push(null!=i?Array.from(i):null)}}f=function(t,e,n,i,r){const o=n[1],s=function(t,e,n){const i=Pe();t.firstCreatePass&&(n.providersResolver&&n.providersResolver(n),Ur(t,i,e,br(t,e,1,null),n));const r=zn(e,t,i.directiveStart,i);wi(r,e);const o=me(i,e);return o&&wi(o,e),r}(o,n,e);if(i.components.push(s),t[8]=s,r&&r.forEach(t=>t(s,e)),e.contentQueries){const t=Pe();e.contentQueries(1,s,t.directiveStart)}const a=Pe();return!o.firstCreatePass||null===e.hostBindings&&null===e.hostAttrs||(tn(a.index),Lr(n[1],a,0,a.directiveStart,a.directiveEnd,e),Rr(e,s)),s}(t,this.componentDef,p,h,[To]),wr(d,p,null)}finally{Je()}return new Ga(this.componentType,f,Ys(m,p),p,m)}}class Ga extends class{}{constructor(t,e,n,i,r){super(),this.location=n,this._rootLView=i,this._tNode=r,this.instance=e,this.hostView=this.changeDetectorRef=new xa(i),this.componentType=t}get injector(){return new Rn(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(t){this.hostView.onDestroy(t)}}const Za=new Map;class Ha extends Ma{constructor(t,e){super(),this._parent=e,this._bootstrapComponents=[],this.injector=this,this.destroyCbs=[],this.componentFactoryResolver=new Na(this);const n=Zt(t),i=t[Dt]||null;i&&Bs(i),this._bootstrapComponents=Ti(n.bootstrap),this._r3Injector=mo(t,e,[{provide:Ma,useValue:this},{provide:Xs,useValue:this.componentFactoryResolver}],et(t)),this._r3Injector._resolveInjectorDefTypes(),this.instance=this.get(t)}get(t,e=Co.THROW_IF_NOT_FOUND,n=gt.Default){return t===Co||t===Ma||t===so?this:this._r3Injector.get(t,e,n)}destroy(){const t=this._r3Injector;!t.destroyed&&t.destroy(),this.destroyCbs.forEach(t=>t()),this.destroyCbs=null}onDestroy(t){this.destroyCbs.push(t)}}class Wa extends Oa{constructor(t){super(),this.moduleType=t,null!==Zt(t)&&function(t){const e=new Set;!function t(n){const i=Zt(n,!0),r=i.id;null!==r&&(function(t,e,n){if(e&&e!==n)throw new Error(`Duplicate module registered for ${t} - ${et(e)} vs ${et(e.name)}`)}(r,Za.get(r),n),Za.set(r,n));const o=Ti(i.imports);for(const s of o)e.has(s)||(e.add(s),t(s))}(t)}(t)}create(t){return new Ha(this.moduleType,t)}}function Xa(t,e,n){const i=Fe()+t,r=ke();return r[i]===cr?Lo(r,i,n?e.call(n):e()):function(t,e){return t[e]}(r,i)}function Ka(t,e,n,i){return function(t,e,n,i,r,o){const s=e+n;return Ro(t,s,r)?Lo(t,s+1,o?i.call(o,r):i(r)):Ya(t,s+1)}(ke(),Fe(),t,e,n,i)}function Ya(t,e){const n=t[e];return n===cr?void 0:n}function Ja(t,e,n,i,r,o,s){const a=e+n;return Fo(t,a,r,o)?Lo(t,a+2,s?i.call(s,r,o):i(r,o)):Ya(t,a+2)}function Qa(t,e){const n=Ae();let i;const r=t+20;n.firstCreatePass?(i=function(t,e){if(e)for(let n=e.length-1;n>=0;n--){const i=e[n];if(t===i.name)return i}throw new te("302",`The pipe '${t}' could not be found!`)}(e,n.pipeRegistry),n.data[r]=i,i.onDestroy&&(n.destroyHooks||(n.destroyHooks=[])).push(r,i.onDestroy)):i=n.data[r];const o=i.factory||(i.factory=Qt(i.type)),s=yt(jo);try{const t=vn(!1),e=o();return vn(t),function(t,e,n,i){n>=t.data.length&&(t.data[n]=null,t.blueprint[n]=null),e[n]=i}(n,ke(),r,e),e}finally{yt(s)}}function tl(t,e,n,i){const r=t+20,o=ke(),s=_e(o,r);return function(t,e){return Oo.isWrapped(e)&&(e=Oo.unwrap(e),t[Be()]=cr),e}(o,function(t,e){return t[1].data[e].pure}(o,r)?Ja(o,Fe(),e,s.transform,n,i,s):s.transform(n,i))}const el=class extends C{constructor(t=!1){super(),this.__isAsync=t}emit(t){super.next(t)}subscribe(t,e,n){let i,r=t=>null,o=()=>null;t&&"object"==typeof t?(i=this.__isAsync?e=>{setTimeout(()=>t.next(e))}:e=>{t.next(e)},t.error&&(r=this.__isAsync?e=>{setTimeout(()=>t.error(e))}:e=>{t.error(e)}),t.complete&&(o=this.__isAsync?()=>{setTimeout(()=>t.complete())}:()=>{t.complete()})):(i=this.__isAsync?e=>{setTimeout(()=>t(e))}:e=>{t(e)},e&&(r=this.__isAsync?t=>{setTimeout(()=>e(t))}:t=>{e(t)}),n&&(o=this.__isAsync?()=>{setTimeout(()=>n())}:()=>{n()}));const s=super.subscribe(i,r,o);return t instanceof h&&t.add(s),s}};function nl(){return this._results[Mo()]()}class il{constructor(){this.dirty=!0,this._results=[],this.changes=new el,this.length=0;const t=Mo(),e=il.prototype;e[t]||(e[t]=nl)}map(t){return this._results.map(t)}filter(t){return this._results.filter(t)}find(t){return this._results.find(t)}reduce(t,e){return this._results.reduce(t,e)}forEach(t){this._results.forEach(t)}some(t){return this._results.some(t)}toArray(){return this._results.slice()}toString(){return this._results.toString()}reset(t){this._results=$n(t),this.dirty=!1,this.length=this._results.length,this.last=this._results[this.length-1],this.first=this._results[0]}notifyOnChanges(){this.changes.emit(this)}setDirty(){this.dirty=!0}destroy(){this.changes.complete(),this.changes.unsubscribe()}}class rl{constructor(t){this.queryList=t,this.matches=null}clone(){return new rl(this.queryList)}setDirty(){this.queryList.setDirty()}}class ol{constructor(t=[]){this.queries=t}createEmbeddedView(t){const e=t.queries;if(null!==e){const n=null!==t.contentQueries?t.contentQueries[0]:e.length,i=[];for(let t=0;t<n;t++){const n=e.getByIndex(t);i.push(this.queries[n.indexInDeclarationView].clone())}return new ol(i)}return null}insertView(t){this.dirtyQueriesWithMatches(t)}detachView(t){this.dirtyQueriesWithMatches(t)}dirtyQueriesWithMatches(t){for(let e=0;e<this.queries.length;e++)null!==xl(t,e).matches&&this.queries[e].setDirty()}}class sl{constructor(t,e,n,i=null){this.predicate=t,this.descendants=e,this.isStatic=n,this.read=i}}class al{constructor(t=[]){this.queries=t}elementStart(t,e){for(let n=0;n<this.queries.length;n++)this.queries[n].elementStart(t,e)}elementEnd(t){for(let e=0;e<this.queries.length;e++)this.queries[e].elementEnd(t)}embeddedTView(t){let e=null;for(let n=0;n<this.length;n++){const i=null!==e?e.length:0,r=this.getByIndex(n).embeddedTView(t,i);r&&(r.indexInDeclarationView=n,null!==e?e.push(r):e=[r])}return null!==e?new al(e):null}template(t,e){for(let n=0;n<this.queries.length;n++)this.queries[n].template(t,e)}getByIndex(t){return this.queries[t]}get length(){return this.queries.length}track(t){this.queries.push(t)}}class ll{constructor(t,e=-1){this.metadata=t,this.matches=null,this.indexInDeclarationView=-1,this.crossesNgTemplate=!1,this._appliesToNextNode=!0,this._declarationNodeIndex=e}elementStart(t,e){this.isApplyingToNode(e)&&this.matchTNode(t,e)}elementEnd(t){this._declarationNodeIndex===t.index&&(this._appliesToNextNode=!1)}template(t,e){this.elementStart(t,e)}embeddedTView(t,e){return this.isApplyingToNode(t)?(this.crossesNgTemplate=!0,this.addMatch(-t.index,e),new ll(this.metadata)):null}isApplyingToNode(t){if(this._appliesToNextNode&&!1===this.metadata.descendants){const e=this._declarationNodeIndex;let n=t.parent;for(;null!==n&&8&n.type&&n.index!==e;)n=n.parent;return e===(null!==n?n.index:-1)}return this._appliesToNextNode}matchTNode(t,e){const n=this.metadata.predicate;if(Array.isArray(n))for(let i=0;i<n.length;i++){const r=n[i];this.matchTNodeWithReadOption(t,e,cl(e,r)),this.matchTNodeWithReadOption(t,e,On(e,t,r,!1,!1))}else n===ka?4&e.type&&this.matchTNodeWithReadOption(t,e,-1):this.matchTNodeWithReadOption(t,e,On(e,t,n,!1,!1))}matchTNodeWithReadOption(t,e,n){if(null!==n){const i=this.metadata.read;if(null!==i)if(i===Qs||i===Da||i===ka&&4&e.type)this.addMatch(e.index,-2);else{const n=On(e,t,i,!1,!1);null!==n&&this.addMatch(e.index,n)}else this.addMatch(e.index,n)}}addMatch(t,e){null===this.matches?this.matches=[t,e]:this.matches.push(t,e)}}function cl(t,e){const n=t.localNames;if(null!==n)for(let i=0;i<n.length;i+=2)if(n[i]===e)return n[i+1];return null}function ul(t,e,n,i){return-1===n?function(t,e){return 11&t.type?Ys(t,e):4&t.type?Pa(t,e):null}(e,t):-2===n?function(t,e,n){return n===Qs?Ys(e,t):n===ka?Pa(e,t):n===Da?Va(e,t):void 0}(t,e,i):zn(t,t[1],n,e)}function hl(t,e,n,i){const r=e[19].queries[i];if(null===r.matches){const i=t.data,o=n.matches,s=[];for(let t=0;t<o.length;t+=2){const r=o[t];s.push(r<0?null:ul(e,i[r],o[t+1],n.metadata.read))}r.matches=s}return r.matches}function dl(t,e,n,i){const r=t.queries.getByIndex(n),o=r.matches;if(null!==o){const s=hl(t,e,r,n);for(let t=0;t<o.length;t+=2){const n=o[t];if(n>0)i.push(s[t/2]);else{const r=o[t+1],s=e[-n];for(let t=10;t<s.length;t++){const e=s[t];e[17]===e[3]&&dl(e[1],e,r,i)}if(null!==s[9]){const t=s[9];for(let e=0;e<t.length;e++){const n=t[e];dl(n[1],n,r,i)}}}}}return i}function pl(t){const e=ke(),n=Ae(),i=qe();$e(i+1);const r=xl(n,i);if(t.dirty&&xe(e)===r.metadata.isStatic){if(null===r.matches)t.reset([]);else{const o=r.crossesNgTemplate?dl(n,e,i,[]):hl(n,e,r,i);t.reset(o),t.notifyOnChanges()}return!0}return!1}function fl(t,e,n){ml(Ae(),ke(),t,e,n,!0)}function ml(t,e,n,i,r,o){t.firstCreatePass&&(vl(t,new sl(n,i,o,r),-1),o&&(t.staticViewQueries=!0)),yl(t,e)}function gl(t,e,n,i){!function(t,e,n,i,r,o,s,a){t.firstCreatePass&&(vl(t,new sl(n,i,false,r),s.index),function(t,e){const n=t.contentQueries||(t.contentQueries=[]);e!==(n.length?n[n.length-1]:-1)&&n.push(t.queries.length-1,e)}(t,a)),yl(t,e)}(Ae(),ke(),e,n,i,0,Pe(),t)}function _l(){return t=ke(),e=qe(),t[19].queries[e].queryList;var t,e}function yl(t,e){const n=new il;Mr(t,e,n,n.destroy),null===e[19]&&(e[19]=new ol),e[19].queries.push(new rl(n))}function vl(t,e,n){null===t.queries&&(t.queries=new al),t.queries.track(new ll(e,n))}function xl(t,e){return t.queries.getByIndex(e)}function bl(t,e){return Pa(t,e)}const wl=new Nn("Application Initializer");let Cl=(()=>{class t{constructor(t){this.appInits=t,this.resolve=Ks,this.reject=Ks,this.initialized=!1,this.done=!1,this.donePromise=new Promise((t,e)=>{this.resolve=t,this.reject=e})}runInitializers(){if(this.initialized)return;const t=[],e=()=>{this.done=!0,this.resolve()};if(this.appInits)for(let n=0;n<this.appInits.length;n++){const e=this.appInits[n]();Jo(e)&&t.push(e)}Promise.all(t).then(()=>{e()}).catch(t=>{this.reject(t)}),0===t.length&&e(),this.initialized=!0}}return t.\u0275fac=function(e){return new(e||t)(ui(wl,8))},t.\u0275prov=at({token:t,factory:t.\u0275fac}),t})();const Tl=new Nn("AppId"),Sl={provide:Tl,useFactory:function(){return`${El()}${El()}${El()}`},deps:[]};function El(){return String.fromCharCode(97+Math.floor(25*Math.random()))}const kl=new Nn("Platform Initializer"),Al=new Nn("Platform ID"),Il=new Nn("appBootstrapListener");let Pl=(()=>{class t{log(t){console.log(t)}warn(t){console.warn(t)}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=at({token:t,factory:t.\u0275fac}),t})();const Ml=new Nn("LocaleId"),Ol=new Nn("DefaultCurrencyCode");class zl{constructor(t,e){this.ngModuleFactory=t,this.componentFactories=e}}const Dl=function(t){return new Wa(t)},Ll=Dl,Rl=function(t){return Promise.resolve(Dl(t))},Fl=function(t){const e=Dl(t),n=Ti(Zt(t).declarations).reduce((t,e)=>{const n=Gt(e);return n&&t.push(new $a(n)),t},[]);return new zl(e,n)},Bl=Fl,Vl=function(t){return Promise.resolve(Fl(t))};let Ul=(()=>{class t{constructor(){this.compileModuleSync=Ll,this.compileModuleAsync=Rl,this.compileModuleAndAllComponentsSync=Bl,this.compileModuleAndAllComponentsAsync=Vl}clearCache(){}clearCacheFor(t){}getModuleId(t){}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=at({token:t,factory:t.\u0275fac}),t})();const Nl=(()=>Promise.resolve(0))();function jl(t){"undefined"==typeof Zone?Nl.then(()=>{t&&t.apply(null,null)}):Zone.current.scheduleMicroTask("scheduleMicrotask",t)}class ql{constructor({enableLongStackTrace:t=!1,shouldCoalesceEventChangeDetection:e=!1}){if(this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new el(!1),this.onMicrotaskEmpty=new el(!1),this.onStable=new el(!1),this.onError=new el(!1),"undefined"==typeof Zone)throw new Error("In this configuration Angular requires Zone.js");Zone.assertZonePatched(),this._nesting=0,this._outer=this._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(this._inner=this._inner.fork(new Zone.TaskTrackingZoneSpec)),t&&Zone.longStackTraceZoneSpec&&(this._inner=this._inner.fork(Zone.longStackTraceZoneSpec)),this.shouldCoalesceEventChangeDetection=e,this.lastRequestAnimationFrameId=-1,this.nativeRequestAnimationFrame=function(){let t=kt.requestAnimationFrame,e=kt.cancelAnimationFrame;if("undefined"!=typeof Zone&&t&&e){const n=t[Zone.__symbol__("OriginalDelegate")];n&&(t=n);const i=e[Zone.__symbol__("OriginalDelegate")];i&&(e=i)}return{nativeRequestAnimationFrame:t,nativeCancelAnimationFrame:e}}().nativeRequestAnimationFrame,function(t){const e=!!t.shouldCoalesceEventChangeDetection&&t.nativeRequestAnimationFrame&&(()=>{!function(t){-1===t.lastRequestAnimationFrameId&&(t.lastRequestAnimationFrameId=t.nativeRequestAnimationFrame.call(kt,()=>{t.fakeTopEventTask||(t.fakeTopEventTask=Zone.root.scheduleEventTask("fakeTopEventTask",()=>{t.lastRequestAnimationFrameId=-1,Zl(t),Gl(t)},void 0,()=>{},()=>{})),t.fakeTopEventTask.invoke()}),Zl(t))}(t)});t._inner=t._inner.fork({name:"angular",properties:{isAngularZone:!0,maybeDelayChangeDetection:e},onInvokeTask:(n,i,r,o,s,a)=>{try{return Hl(t),n.invokeTask(r,o,s,a)}finally{e&&"eventTask"===o.type&&e(),Wl(t)}},onInvoke:(e,n,i,r,o,s,a)=>{try{return Hl(t),e.invoke(i,r,o,s,a)}finally{Wl(t)}},onHasTask:(e,n,i,r)=>{e.hasTask(i,r),n===i&&("microTask"==r.change?(t._hasPendingMicrotasks=r.microTask,Zl(t),Gl(t)):"macroTask"==r.change&&(t.hasPendingMacrotasks=r.macroTask))},onHandleError:(e,n,i,r)=>(e.handleError(i,r),t.runOutsideAngular(()=>t.onError.emit(r)),!1)})}(this)}static isInAngularZone(){return!0===Zone.current.get("isAngularZone")}static assertInAngularZone(){if(!ql.isInAngularZone())throw new Error("Expected to be in Angular Zone, but it is not!")}static assertNotInAngularZone(){if(ql.isInAngularZone())throw new Error("Expected to not be in Angular Zone, but it is!")}run(t,e,n){return this._inner.run(t,e,n)}runTask(t,e,n,i){const r=this._inner,o=r.scheduleEventTask("NgZoneEvent: "+i,t,$l,Ks,Ks);try{return r.runTask(o,e,n)}finally{r.cancelTask(o)}}runGuarded(t,e,n){return this._inner.runGuarded(t,e,n)}runOutsideAngular(t){return this._outer.run(t)}}const $l={};function Gl(t){if(0==t._nesting&&!t.hasPendingMicrotasks&&!t.isStable)try{t._nesting++,t.onMicrotaskEmpty.emit(null)}finally{if(t._nesting--,!t.hasPendingMicrotasks)try{t.runOutsideAngular(()=>t.onStable.emit(null))}finally{t.isStable=!0}}}function Zl(t){t.hasPendingMicrotasks=!!(t._hasPendingMicrotasks||t.shouldCoalesceEventChangeDetection&&-1!==t.lastRequestAnimationFrameId)}function Hl(t){t._nesting++,t.isStable&&(t.isStable=!1,t.onUnstable.emit(null))}function Wl(t){t._nesting--,Gl(t)}class Xl{constructor(){this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new el,this.onMicrotaskEmpty=new el,this.onStable=new el,this.onError=new el}run(t,e,n){return t.apply(e,n)}runGuarded(t,e,n){return t.apply(e,n)}runOutsideAngular(t){return t()}runTask(t,e,n,i){return t.apply(e,n)}}let Kl=(()=>{class t{constructor(t){this._ngZone=t,this._pendingCount=0,this._isZoneStable=!0,this._didWork=!1,this._callbacks=[],this.taskTrackingZone=null,this._watchAngularEvents(),t.run(()=>{this.taskTrackingZone="undefined"==typeof Zone?null:Zone.current.get("TaskTrackingZone")})}_watchAngularEvents(){this._ngZone.onUnstable.subscribe({next:()=>{this._didWork=!0,this._isZoneStable=!1}}),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.subscribe({next:()=>{ql.assertNotInAngularZone(),jl(()=>{this._isZoneStable=!0,this._runCallbacksIfReady()})}})})}increasePendingRequestCount(){return this._pendingCount+=1,this._didWork=!0,this._pendingCount}decreasePendingRequestCount(){if(this._pendingCount-=1,this._pendingCount<0)throw new Error("pending async requests below zero");return this._runCallbacksIfReady(),this._pendingCount}isStable(){return this._isZoneStable&&0===this._pendingCount&&!this._ngZone.hasPendingMacrotasks}_runCallbacksIfReady(){if(this.isStable())jl(()=>{for(;0!==this._callbacks.length;){let t=this._callbacks.pop();clearTimeout(t.timeoutId),t.doneCb(this._didWork)}this._didWork=!1});else{let t=this.getPendingTasks();this._callbacks=this._callbacks.filter(e=>!e.updateCb||!e.updateCb(t)||(clearTimeout(e.timeoutId),!1)),this._didWork=!0}}getPendingTasks(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map(t=>({source:t.source,creationLocation:t.creationLocation,data:t.data})):[]}addCallback(t,e,n){let i=-1;e&&e>0&&(i=setTimeout(()=>{this._callbacks=this._callbacks.filter(t=>t.timeoutId!==i),t(this._didWork,this.getPendingTasks())},e)),this._callbacks.push({doneCb:t,timeoutId:i,updateCb:n})}whenStable(t,e,n){if(n&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/dist/task-tracking.js" loaded?');this.addCallback(t,e,n),this._runCallbacksIfReady()}getPendingRequestCount(){return this._pendingCount}findProviders(t,e,n){return[]}}return t.\u0275fac=function(e){return new(e||t)(ui(ql))},t.\u0275prov=at({token:t,factory:t.\u0275fac}),t})(),Yl=(()=>{class t{constructor(){this._applications=new Map,tc.addToWindow(this)}registerApplication(t,e){this._applications.set(t,e)}unregisterApplication(t){this._applications.delete(t)}unregisterAllApplications(){this._applications.clear()}getTestability(t){return this._applications.get(t)||null}getAllTestabilities(){return Array.from(this._applications.values())}getAllRootElements(){return Array.from(this._applications.keys())}findTestabilityInTree(t,e=!0){return tc.findTestabilityInTree(this,t,e)}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=at({token:t,factory:t.\u0275fac}),t})();class Jl{addToWindow(t){}findTestabilityInTree(t,e,n){return null}}let Ql,tc=new Jl,ec=!0,nc=!1;function ic(){return nc=!0,ec}const rc=new Nn("AllowMultipleToken");class oc{constructor(t,e){this.name=t,this.token=e}}function sc(t,e,n=[]){const i="Platform: "+e,r=new Nn(i);return(e=[])=>{let o=ac();if(!o||o.injector.get(rc,!1))if(t)t(n.concat(e).concat({provide:r,useValue:!0}));else{const t=n.concat(e).concat({provide:r,useValue:!0},{provide:lo,useValue:"platform"});!function(t){if(Ql&&!Ql.destroyed&&!Ql.injector.get(rc,!1))throw new Error("There can be only one platform. Destroy the previous one to create a new one.");Ql=t.get(lc);const e=t.get(kl,null);e&&e.forEach(t=>t())}(Co.create({providers:t,name:i}))}return function(t){const e=ac();if(!e)throw new Error("No platform exists!");if(!e.injector.get(t,null))throw new Error("A platform with a different configuration has been created. Please destroy it first.");return e}(r)}}function ac(){return Ql&&!Ql.destroyed?Ql:null}let lc=(()=>{class t{constructor(t){this._injector=t,this._modules=[],this._destroyListeners=[],this._destroyed=!1}bootstrapModuleFactory(t,e){const n=function(t,e){let n;return n="noop"===t?new Xl:("zone.js"===t?void 0:t)||new ql({enableLongStackTrace:ic(),shouldCoalesceEventChangeDetection:e}),n}(e?e.ngZone:void 0,e&&e.ngZoneEventCoalescing||!1),i=[{provide:ql,useValue:n}];return n.run(()=>{const e=Co.create({providers:i,parent:this.injector,name:t.moduleType.name}),r=t.create(e),o=r.injector.get(bi,null);if(!o)throw new Error("No ErrorHandler. Is platform module (BrowserModule) included?");return n.runOutsideAngular(()=>{const t=n.onError.subscribe({next:t=>{o.handleError(t)}});r.onDestroy(()=>{hc(this._modules,r),t.unsubscribe()})}),function(t,e,n){try{const i=n();return Jo(i)?i.catch(n=>{throw e.runOutsideAngular(()=>t.handleError(n)),n}):i}catch(i){throw e.runOutsideAngular(()=>t.handleError(i)),i}}(o,n,()=>{const t=r.injector.get(Cl);return t.runInitializers(),t.donePromise.then(()=>(Bs(r.injector.get(Ml,"en-US")||"en-US"),this._moduleDoBootstrap(r),r))})})}bootstrapModule(t,e=[]){const n=cc({},e);return function(t,e,n){const i=new Wa(n);return Promise.resolve(i)}(0,0,t).then(t=>this.bootstrapModuleFactory(t,n))}_moduleDoBootstrap(t){const e=t.injector.get(uc);if(t._bootstrapComponents.length>0)t._bootstrapComponents.forEach(t=>e.bootstrap(t));else{if(!t.instance.ngDoBootstrap)throw new Error(`The module ${et(t.instance.constructor)} was bootstrapped, but it does not declare "@NgModule.bootstrap" components nor a "ngDoBootstrap" method. Please define one of these.`);t.instance.ngDoBootstrap(e)}this._modules.push(t)}onDestroy(t){this._destroyListeners.push(t)}get injector(){return this._injector}destroy(){if(this._destroyed)throw new Error("The platform has already been destroyed!");this._modules.slice().forEach(t=>t.destroy()),this._destroyListeners.forEach(t=>t()),this._destroyed=!0}get destroyed(){return this._destroyed}}return t.\u0275fac=function(e){return new(e||t)(ui(Co))},t.\u0275prov=at({token:t,factory:t.\u0275fac}),t})();function cc(t,e){return Array.isArray(e)?e.reduce(cc,t):Object.assign(Object.assign({},t),e)}let uc=(()=>{class t{constructor(t,e,n,i,r,o){this._zone=t,this._console=e,this._injector=n,this._exceptionHandler=i,this._componentFactoryResolver=r,this._initStatus=o,this._bootstrapListeners=[],this._views=[],this._runningTick=!1,this._stable=!0,this.componentTypes=[],this.components=[],this._onMicrotaskEmptySubscription=this._zone.onMicrotaskEmpty.subscribe({next:()=>{this._zone.run(()=>{this.tick()})}});const s=new y(t=>{this._stable=this._zone.isStable&&!this._zone.hasPendingMacrotasks&&!this._zone.hasPendingMicrotasks,this._zone.runOutsideAngular(()=>{t.next(this._stable),t.complete()})}),a=new y(t=>{let e;this._zone.runOutsideAngular(()=>{e=this._zone.onStable.subscribe(()=>{ql.assertNotInAngularZone(),jl(()=>{this._stable||this._zone.hasPendingMacrotasks||this._zone.hasPendingMicrotasks||(this._stable=!0,t.next(!0))})})});const n=this._zone.onUnstable.subscribe(()=>{ql.assertInAngularZone(),this._stable&&(this._stable=!1,this._zone.runOutsideAngular(()=>{t.next(!1)}))});return()=>{e.unsubscribe(),n.unsubscribe()}});this.isStable=G(s,a.pipe(t=>{return Z()((e=J,function(t){let n;n="function"==typeof e?e:function(){return e};const i=Object.create(t,K);return i.source=t,i.subjectFactory=n,i})(t));var e}))}bootstrap(t,e){if(!this._initStatus.done)throw new Error("Cannot bootstrap as there are still asynchronous initializers running. Bootstrap components in the `ngDoBootstrap` method of the root module.");let n;n=t instanceof Hs?t:this._componentFactoryResolver.resolveComponentFactory(t),this.componentTypes.push(n.componentType);const i=n.isBoundToModule?void 0:this._injector.get(Ma),r=n.create(Co.NULL,[],e||n.selector,i),o=r.location.nativeElement,s=r.injector.get(Kl,null),a=s&&r.injector.get(Yl);return s&&a&&a.registerApplication(o,s),r.onDestroy(()=>{this.detachView(r.hostView),hc(this.components,r),a&&a.unregisterApplication(o)}),this._loadComponent(r),ic()&&this._console.log("Angular is running in development mode. Call enableProdMode() to enable production mode."),r}tick(){if(this._runningTick)throw new Error("ApplicationRef.tick is called recursively");try{this._runningTick=!0;for(let t of this._views)t.detectChanges()}catch(t){this._zone.runOutsideAngular(()=>this._exceptionHandler.handleError(t))}finally{this._runningTick=!1}}attachView(t){const e=t;this._views.push(e),e.attachToAppRef(this)}detachView(t){const e=t;hc(this._views,e),e.detachFromAppRef()}_loadComponent(t){this.attachView(t.hostView),this.tick(),this.components.push(t),this._injector.get(Il,[]).concat(this._bootstrapListeners).forEach(e=>e(t))}ngOnDestroy(){this._views.slice().forEach(t=>t.destroy()),this._onMicrotaskEmptySubscription.unsubscribe()}get viewCount(){return this._views.length}}return t.\u0275fac=function(e){return new(e||t)(ui(ql),ui(Pl),ui(Co),ui(bi),ui(Xs),ui(Cl))},t.\u0275prov=at({token:t,factory:t.\u0275fac}),t})();function hc(t,e){const n=t.indexOf(e);n>-1&&t.splice(n,1)}class dc{}class pc{}const fc={factoryPathPrefix:"",factoryPathSuffix:".ngfactory"};let mc=(()=>{class t{constructor(t,e){this._compiler=t,this._config=e||fc}load(t){return this.loadAndCompile(t)}loadAndCompile(t){let[e,i]=t.split("#");return void 0===i&&(i="default"),n("zn8P")(e).then(t=>t[i]).then(t=>gc(t,e,i)).then(t=>this._compiler.compileModuleAsync(t))}loadFactory(t){let[e,i]=t.split("#"),r="NgFactory";return void 0===i&&(i="default",r=""),n("zn8P")(this._config.factoryPathPrefix+e+this._config.factoryPathSuffix).then(t=>t[i+r]).then(t=>gc(t,e,i))}}return t.\u0275fac=function(e){return new(e||t)(ui(Ul),ui(pc,8))},t.\u0275prov=at({token:t,factory:t.\u0275fac}),t})();function gc(t,e,n){if(!t)throw new Error(`Cannot find '${n}' in '${e}'`);return t}const _c=sc(null,"core",[{provide:Al,useValue:"unknown"},{provide:lc,deps:[Co]},{provide:Yl,deps:[]},{provide:Pl,deps:[]}]),yc=[{provide:uc,useClass:uc,deps:[ql,Pl,Co,bi,Xs,Cl]},{provide:qa,deps:[ql],useFactory:function(t){let e=[];return t.onStable.subscribe(()=>{for(;e.length;)e.pop()()}),function(t){e.push(t)}}},{provide:Cl,useClass:Cl,deps:[[new Qn,wl]]},{provide:Ul,useClass:Ul,deps:[]},Sl,{provide:ga,useFactory:function(){return Ta},deps:[]},{provide:_a,useFactory:function(){return Sa},deps:[]},{provide:Ml,useFactory:function(t){return Bs(t=t||"undefined"!=typeof $localize&&$localize.locale||"en-US"),t},deps:[[new Jn(Ml),new Qn,new ei]]},{provide:Ol,useValue:"USD"}];let vc=(()=>{class t{constructor(t){}}return t.\u0275mod=jt({type:t}),t.\u0275inj=lt({factory:function(e){return new(e||t)(ui(uc))},providers:yc}),t})(),xc=null;function bc(){return xc}const wc=new Nn("DocumentToken");let Cc=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=at({factory:Tc,token:t,providedIn:"platform"}),t})();function Tc(){return ui(Ec)}const Sc=new Nn("Location Initialized");let Ec=(()=>{class t extends Cc{constructor(t){super(),this._doc=t,this._init()}_init(){this.location=bc().getLocation(),this._history=bc().getHistory()}getBaseHrefFromDOM(){return bc().getBaseHref(this._doc)}onPopState(t){bc().getGlobalEventTarget(this._doc,"window").addEventListener("popstate",t,!1)}onHashChange(t){bc().getGlobalEventTarget(this._doc,"window").addEventListener("hashchange",t,!1)}get href(){return this.location.href}get protocol(){return this.location.protocol}get hostname(){return this.location.hostname}get port(){return this.location.port}get pathname(){return this.location.pathname}get search(){return this.location.search}get hash(){return this.location.hash}set pathname(t){this.location.pathname=t}pushState(t,e,n){kc()?this._history.pushState(t,e,n):this.location.hash=n}replaceState(t,e,n){kc()?this._history.replaceState(t,e,n):this.location.hash=n}forward(){this._history.forward()}back(){this._history.back()}getState(){return this._history.state}}return t.\u0275fac=function(e){return new(e||t)(ui(wc))},t.\u0275prov=at({factory:Ac,token:t,providedIn:"platform"}),t})();function kc(){return!!window.history.pushState}function Ac(){return new Ec(ui(wc))}function Ic(t,e){if(0==t.length)return e;if(0==e.length)return t;let n=0;return t.endsWith("/")&&n++,e.startsWith("/")&&n++,2==n?t+e.substring(1):1==n?t+e:t+"/"+e}function Pc(t){const e=t.match(/#|\?|$/),n=e&&e.index||t.length;return t.slice(0,n-("/"===t[n-1]?1:0))+t.slice(n)}function Mc(t){return t&&"?"!==t[0]?"?"+t:t}let Oc=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=at({factory:zc,token:t,providedIn:"root"}),t})();function zc(t){const e=ui(wc).location;return new Lc(ui(Cc),e&&e.origin||"")}const Dc=new Nn("appBaseHref");let Lc=(()=>{class t extends Oc{constructor(t,e){if(super(),this._platformLocation=t,null==e&&(e=this._platformLocation.getBaseHrefFromDOM()),null==e)throw new Error("No base href set. Please provide a value for the APP_BASE_HREF token or add a base element to the document.");this._baseHref=e}onPopState(t){this._platformLocation.onPopState(t),this._platformLocation.onHashChange(t)}getBaseHref(){return this._baseHref}prepareExternalUrl(t){return Ic(this._baseHref,t)}path(t=!1){const e=this._platformLocation.pathname+Mc(this._platformLocation.search),n=this._platformLocation.hash;return n&&t?`${e}${n}`:e}pushState(t,e,n,i){const r=this.prepareExternalUrl(n+Mc(i));this._platformLocation.pushState(t,e,r)}replaceState(t,e,n,i){const r=this.prepareExternalUrl(n+Mc(i));this._platformLocation.replaceState(t,e,r)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}}return t.\u0275fac=function(e){return new(e||t)(ui(Cc),ui(Dc,8))},t.\u0275prov=at({token:t,factory:t.\u0275fac}),t})(),Rc=(()=>{class t extends Oc{constructor(t,e){super(),this._platformLocation=t,this._baseHref="",null!=e&&(this._baseHref=e)}onPopState(t){this._platformLocation.onPopState(t),this._platformLocation.onHashChange(t)}getBaseHref(){return this._baseHref}path(t=!1){let e=this._platformLocation.hash;return null==e&&(e="#"),e.length>0?e.substring(1):e}prepareExternalUrl(t){const e=Ic(this._baseHref,t);return e.length>0?"#"+e:e}pushState(t,e,n,i){let r=this.prepareExternalUrl(n+Mc(i));0==r.length&&(r=this._platformLocation.pathname),this._platformLocation.pushState(t,e,r)}replaceState(t,e,n,i){let r=this.prepareExternalUrl(n+Mc(i));0==r.length&&(r=this._platformLocation.pathname),this._platformLocation.replaceState(t,e,r)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}}return t.\u0275fac=function(e){return new(e||t)(ui(Cc),ui(Dc,8))},t.\u0275prov=at({token:t,factory:t.\u0275fac}),t})(),Fc=(()=>{class t{constructor(t,e){this._subject=new el,this._urlChangeListeners=[],this._platformStrategy=t;const n=this._platformStrategy.getBaseHref();this._platformLocation=e,this._baseHref=Pc(Vc(n)),this._platformStrategy.onPopState(t=>{this._subject.emit({url:this.path(!0),pop:!0,state:t.state,type:t.type})})}path(t=!1){return this.normalize(this._platformStrategy.path(t))}getState(){return this._platformLocation.getState()}isCurrentPathEqualTo(t,e=""){return this.path()==this.normalize(t+Mc(e))}normalize(e){return t.stripTrailingSlash(function(t,e){return t&&e.startsWith(t)?e.substring(t.length):e}(this._baseHref,Vc(e)))}prepareExternalUrl(t){return t&&"/"!==t[0]&&(t="/"+t),this._platformStrategy.prepareExternalUrl(t)}go(t,e="",n=null){this._platformStrategy.pushState(n,"",t,e),this._notifyUrlChangeListeners(this.prepareExternalUrl(t+Mc(e)),n)}replaceState(t,e="",n=null){this._platformStrategy.replaceState(n,"",t,e),this._notifyUrlChangeListeners(this.prepareExternalUrl(t+Mc(e)),n)}forward(){this._platformStrategy.forward()}back(){this._platformStrategy.back()}onUrlChange(t){this._urlChangeListeners.push(t),this._urlChangeSubscription||(this._urlChangeSubscription=this.subscribe(t=>{this._notifyUrlChangeListeners(t.url,t.state)}))}_notifyUrlChangeListeners(t="",e){this._urlChangeListeners.forEach(n=>n(t,e))}subscribe(t,e,n){return this._subject.subscribe({next:t,error:e,complete:n})}}return t.\u0275fac=function(e){return new(e||t)(ui(Oc),ui(Cc))},t.normalizeQueryParams=Mc,t.joinWithSlash=Ic,t.stripTrailingSlash=Pc,t.\u0275prov=at({factory:Bc,token:t,providedIn:"root"}),t})();function Bc(){return new Fc(ui(Oc),ui(Cc))}function Vc(t){return t.replace(/\/index.html$/,"")}var Uc=function(t){return t[t.Zero=0]="Zero",t[t.One=1]="One",t[t.Two=2]="Two",t[t.Few=3]="Few",t[t.Many=4]="Many",t[t.Other=5]="Other",t}({});class Nc{}let jc=(()=>{class t extends Nc{constructor(t){super(),this.locale=t}getPluralCategory(t,e){switch(function(t){return function(t){const e=function(t){return t.toLowerCase().replace(/_/g,"-")}(t);let n=Ls(e);if(n)return n;const i=e.split("-")[0];if(n=Ls(i),n)return n;if("en"===i)return zs;throw new Error(`Missing locale data for the locale "${t}".`)}(t)[Rs.PluralCase]}(e||this.locale)(t)){case Uc.Zero:return"zero";case Uc.One:return"one";case Uc.Two:return"two";case Uc.Few:return"few";case Uc.Many:return"many";default:return"other"}}}return t.\u0275fac=function(e){return new(e||t)(ui(Ml))},t.\u0275prov=at({token:t,factory:t.\u0275fac}),t})();function qc(t,e){e=encodeURIComponent(e);for(const n of t.split(";")){const t=n.indexOf("="),[i,r]=-1==t?[n,""]:[n.slice(0,t),n.slice(t+1)];if(i.trim()===e)return decodeURIComponent(r)}return null}let $c=(()=>{class t{constructor(t,e,n,i){this._iterableDiffers=t,this._keyValueDiffers=e,this._ngEl=n,this._renderer=i,this._iterableDiffer=null,this._keyValueDiffer=null,this._initialClasses=[],this._rawClass=null}set klass(t){this._removeClasses(this._initialClasses),this._initialClasses="string"==typeof t?t.split(/\s+/):[],this._applyClasses(this._initialClasses),this._applyClasses(this._rawClass)}set ngClass(t){this._removeClasses(this._rawClass),this._applyClasses(this._initialClasses),this._iterableDiffer=null,this._keyValueDiffer=null,this._rawClass="string"==typeof t?t.split(/\s+/):t,this._rawClass&&(zo(this._rawClass)?this._iterableDiffer=this._iterableDiffers.find(this._rawClass).create():this._keyValueDiffer=this._keyValueDiffers.find(this._rawClass).create())}ngDoCheck(){if(this._iterableDiffer){const t=this._iterableDiffer.diff(this._rawClass);t&&this._applyIterableChanges(t)}else if(this._keyValueDiffer){const t=this._keyValueDiffer.diff(this._rawClass);t&&this._applyKeyValueChanges(t)}}_applyKeyValueChanges(t){t.forEachAddedItem(t=>this._toggleClass(t.key,t.currentValue)),t.forEachChangedItem(t=>this._toggleClass(t.key,t.currentValue)),t.forEachRemovedItem(t=>{t.previousValue&&this._toggleClass(t.key,!1)})}_applyIterableChanges(t){t.forEachAddedItem(t=>{if("string"!=typeof t.item)throw new Error("NgClass can only toggle CSS classes expressed as strings, got "+et(t.item));this._toggleClass(t.item,!0)}),t.forEachRemovedItem(t=>this._toggleClass(t.item,!1))}_applyClasses(t){t&&(Array.isArray(t)||t instanceof Set?t.forEach(t=>this._toggleClass(t,!0)):Object.keys(t).forEach(e=>this._toggleClass(e,!!t[e])))}_removeClasses(t){t&&(Array.isArray(t)||t instanceof Set?t.forEach(t=>this._toggleClass(t,!1)):Object.keys(t).forEach(t=>this._toggleClass(t,!1)))}_toggleClass(t,e){(t=t.trim())&&t.split(/\s+/g).forEach(t=>{e?this._renderer.addClass(this._ngEl.nativeElement,t):this._renderer.removeClass(this._ngEl.nativeElement,t)})}}return t.\u0275fac=function(e){return new(e||t)(jo(ga),jo(_a),jo(Qs),jo(ea))},t.\u0275dir=$t({type:t,selectors:[["","ngClass",""]],inputs:{klass:["class","klass"],ngClass:"ngClass"}}),t})();class Gc{constructor(t,e,n,i){this.$implicit=t,this.ngForOf=e,this.index=n,this.count=i}get first(){return 0===this.index}get last(){return this.index===this.count-1}get even(){return this.index%2==0}get odd(){return!this.even}}let Zc=(()=>{class t{constructor(t,e,n){this._viewContainer=t,this._template=e,this._differs=n,this._ngForOf=null,this._ngForOfDirty=!0,this._differ=null}set ngForOf(t){this._ngForOf=t,this._ngForOfDirty=!0}set ngForTrackBy(t){this._trackByFn=t}get ngForTrackBy(){return this._trackByFn}set ngForTemplate(t){t&&(this._template=t)}ngDoCheck(){if(this._ngForOfDirty){this._ngForOfDirty=!1;const n=this._ngForOf;if(!this._differ&&n)try{this._differ=this._differs.find(n).create(this.ngForTrackBy)}catch(e){throw new Error(`Cannot find a differ supporting object '${n}' of type '${t=n,t.name||typeof t}'. NgFor only supports binding to Iterables such as Arrays.`)}}var t;if(this._differ){const t=this._differ.diff(this._ngForOf);t&&this._applyChanges(t)}}_applyChanges(t){const e=[];t.forEachOperation((t,n,i)=>{if(null==t.previousIndex){const n=this._viewContainer.createEmbeddedView(this._template,new Gc(null,this._ngForOf,-1,-1),null===i?void 0:i),r=new Hc(t,n);e.push(r)}else if(null==i)this._viewContainer.remove(null===n?void 0:n);else if(null!==n){const r=this._viewContainer.get(n);this._viewContainer.move(r,i);const o=new Hc(t,r);e.push(o)}});for(let n=0;n<e.length;n++)this._perViewChange(e[n].view,e[n].record);for(let n=0,i=this._viewContainer.length;n<i;n++){const t=this._viewContainer.get(n);t.context.index=n,t.context.count=i,t.context.ngForOf=this._ngForOf}t.forEachIdentityChange(t=>{this._viewContainer.get(t.currentIndex).context.$implicit=t.item})}_perViewChange(t,e){t.context.$implicit=e.item}static ngTemplateContextGuard(t,e){return!0}}return t.\u0275fac=function(e){return new(e||t)(jo(Da),jo(ka),jo(ga))},t.\u0275dir=$t({type:t,selectors:[["","ngFor","","ngForOf",""]],inputs:{ngForOf:"ngForOf",ngForTrackBy:"ngForTrackBy",ngForTemplate:"ngForTemplate"}}),t})();class Hc{constructor(t,e){this.record=t,this.view=e}}let Wc=(()=>{class t{constructor(t,e){this._viewContainer=t,this._context=new Xc,this._thenTemplateRef=null,this._elseTemplateRef=null,this._thenViewRef=null,this._elseViewRef=null,this._thenTemplateRef=e}set ngIf(t){this._context.$implicit=this._context.ngIf=t,this._updateView()}set ngIfThen(t){Kc("ngIfThen",t),this._thenTemplateRef=t,this._thenViewRef=null,this._updateView()}set ngIfElse(t){Kc("ngIfElse",t),this._elseTemplateRef=t,this._elseViewRef=null,this._updateView()}_updateView(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}static ngTemplateContextGuard(t,e){return!0}}return t.\u0275fac=function(e){return new(e||t)(jo(Da),jo(ka))},t.\u0275dir=$t({type:t,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"}}),t})();class Xc{constructor(){this.$implicit=null,this.ngIf=null}}function Kc(t,e){if(e&&!e.createEmbeddedView)throw new Error(`${t} must be a TemplateRef, but received '${et(e)}'.`)}let Yc=(()=>{class t{constructor(t){this._viewContainerRef=t,this._viewRef=null,this.ngTemplateOutletContext=null,this.ngTemplateOutlet=null}ngOnChanges(t){if(this._shouldRecreateView(t)){const t=this._viewContainerRef;this._viewRef&&t.remove(t.indexOf(this._viewRef)),this._viewRef=this.ngTemplateOutlet?t.createEmbeddedView(this.ngTemplateOutlet,this.ngTemplateOutletContext):null}else this._viewRef&&this.ngTemplateOutletContext&&this._updateExistingContext(this.ngTemplateOutletContext)}_shouldRecreateView(t){const e=t.ngTemplateOutletContext;return!!t.ngTemplateOutlet||e&&this._hasContextShapeChanged(e)}_hasContextShapeChanged(t){const e=Object.keys(t.previousValue||{}),n=Object.keys(t.currentValue||{});if(e.length===n.length){for(let t of n)if(-1===e.indexOf(t))return!0;return!1}return!0}_updateExistingContext(t){for(let e of Object.keys(t))this._viewRef.context[e]=this.ngTemplateOutletContext[e]}}return t.\u0275fac=function(e){return new(e||t)(jo(Da))},t.\u0275dir=$t({type:t,selectors:[["","ngTemplateOutlet",""]],inputs:{ngTemplateOutletContext:"ngTemplateOutletContext",ngTemplateOutlet:"ngTemplateOutlet"},features:[oe]}),t})(),Jc=(()=>{class t{}return t.\u0275mod=jt({type:t}),t.\u0275inj=lt({factory:function(e){return new(e||t)},providers:[{provide:Nc,useClass:jc}]}),t})(),Qc=(()=>{class t{}return t.\u0275prov=at({token:t,providedIn:"root",factory:()=>new tu(ui(wc),window)}),t})();class tu{constructor(t,e){this.document=t,this.window=e,this.offset=()=>[0,0]}setOffset(t){this.offset=Array.isArray(t)?()=>t:t}getScrollPosition(){return this.supportsScrolling()?[this.window.pageXOffset,this.window.pageYOffset]:[0,0]}scrollToPosition(t){this.supportsScrolling()&&this.window.scrollTo(t[0],t[1])}scrollToAnchor(t){var e;if(!this.supportsScrolling())return;const n=null!==(e=this.document.getElementById(t))&&void 0!==e?e:this.document.getElementsByName(t)[0];void 0!==n&&(this.scrollToElement(n),this.attemptFocus(n))}setHistoryScrollRestoration(t){if(this.supportScrollRestoration()){const e=this.window.history;e&&e.scrollRestoration&&(e.scrollRestoration=t)}}scrollToElement(t){const e=t.getBoundingClientRect(),n=e.left+this.window.pageXOffset,i=e.top+this.window.pageYOffset,r=this.offset();this.window.scrollTo(n-r[0],i-r[1])}attemptFocus(t){return t.focus(),this.document.activeElement===t}supportScrollRestoration(){try{if(!this.supportsScrolling())return!1;const t=eu(this.window.history)||eu(Object.getPrototypeOf(this.window.history));return!(!t||!t.writable&&!t.set)}catch(t){return!1}}supportsScrolling(){try{return!!this.window&&!!this.window.scrollTo&&"pageXOffset"in this.window}catch(t){return!1}}}function eu(t){return Object.getOwnPropertyDescriptor(t,"scrollRestoration")}function nu(...t){let e=t[t.length-1];return S(e)?(t.pop(),L(t,e)):$(t)}class iu extends C{constructor(t){super(),this._value=t}get value(){return this.getValue()}_subscribe(t){const e=super._subscribe(t);return e&&!e.closed&&t.next(this._value),e}getValue(){if(this.hasError)throw this.thrownError;if(this.closed)throw new x;return this._value}next(t){super.next(this._value=t)}}class ru extends f{notifyNext(t,e,n,i,r){this.destination.next(e)}notifyError(t,e){this.destination.error(t)}notifyComplete(t){this.destination.complete()}}class ou extends f{constructor(t,e,n){super(),this.parent=t,this.outerValue=e,this.outerIndex=n,this.index=0}_next(t){this.parent.notifyNext(this.outerValue,t,this.outerIndex,this.index++,this)}_error(t){this.parent.notifyError(t,this),this.unsubscribe()}_complete(){this.parent.notifyComplete(this),this.unsubscribe()}}function su(t,e,n,i,r=new ou(t,n,i)){if(!r.closed)return e instanceof y?e.subscribe(r):D(e)(r)}const au={};class lu{constructor(t){this.resultSelector=t}call(t,e){return e.subscribe(new cu(t,this.resultSelector))}}class cu extends ru{constructor(t,e){super(t),this.resultSelector=e,this.active=0,this.values=[],this.observables=[]}_next(t){this.values.push(au),this.observables.push(t)}_complete(){const t=this.observables,e=t.length;if(0===e)this.destination.complete();else{this.active=e,this.toRespond=e;for(let n=0;n<e;n++)this.add(su(this,t[n],void 0,n))}}notifyComplete(t){0==(this.active-=1)&&this.destination.complete()}notifyNext(t,e,n){const i=this.values,r=this.toRespond?i[n]===au?--this.toRespond:this.toRespond:0;i[n]=e,0===r&&(this.resultSelector?this._tryResultSelector(i):this.destination.next(i.slice()))}_tryResultSelector(t){let e;try{e=this.resultSelector.apply(this,t)}catch(n){return void this.destination.error(n)}this.destination.next(e)}}const uu=(()=>{function t(){return Error.call(this),this.message="no elements in sequence",this.name="EmptyError",this}return t.prototype=Object.create(Error.prototype),t})();function hu(...t){return q(1)(nu(...t))}const du=new y(t=>t.complete());function pu(t){return t?function(t){return new y(e=>t.schedule(()=>e.complete()))}(t):du}function fu(t){return new y(e=>{let n;try{n=t()}catch(i){return void e.error(i)}return(n?R(n):pu()).subscribe(e)})}function mu(t,e){return"function"==typeof e?n=>n.pipe(mu((n,i)=>R(t(n,i)).pipe(E((t,r)=>e(n,t,i,r))))):e=>e.lift(new gu(t))}class gu{constructor(t){this.project=t}call(t,e){return e.subscribe(new _u(t,this.project))}}class _u extends B{constructor(t,e){super(t),this.project=e,this.index=0}_next(t){let e;const n=this.index++;try{e=this.project(t,n)}catch(i){return void this.destination.error(i)}this._innerSub(e)}_innerSub(t){const e=this.innerSubscription;e&&e.unsubscribe();const n=new F(this),i=this.destination;i.add(n),this.innerSubscription=V(t,n),this.innerSubscription!==n&&i.add(this.innerSubscription)}_complete(){const{innerSubscription:t}=this;t&&!t.closed||super._complete(),this.unsubscribe()}_unsubscribe(){this.innerSubscription=void 0}notifyComplete(){this.innerSubscription=void 0,this.isStopped&&super._complete()}notifyNext(t){this.destination.next(t)}}const yu=(()=>{function t(){return Error.call(this),this.message="argument out of range",this.name="ArgumentOutOfRangeError",this}return t.prototype=Object.create(Error.prototype),t})();function vu(t){return e=>0===t?pu():e.lift(new xu(t))}class xu{constructor(t){if(this.total=t,this.total<0)throw new yu}call(t,e){return e.subscribe(new bu(t,this.total))}}class bu extends f{constructor(t,e){super(t),this.total=e,this.count=0}_next(t){const e=this.total,n=++this.count;n<=e&&(this.destination.next(t),n===e&&(this.destination.complete(),this.unsubscribe()))}}function wu(...t){const e=t[t.length-1];return S(e)?(t.pop(),n=>hu(t,n,e)):e=>hu(t,e)}function Cu(t,e){let n=!1;return arguments.length>=2&&(n=!0),function(i){return i.lift(new Tu(t,e,n))}}class Tu{constructor(t,e,n=!1){this.accumulator=t,this.seed=e,this.hasSeed=n}call(t,e){return e.subscribe(new Su(t,this.accumulator,this.seed,this.hasSeed))}}class Su extends f{constructor(t,e,n,i){super(t),this.accumulator=e,this._seed=n,this.hasSeed=i,this.index=0}get seed(){return this._seed}set seed(t){this.hasSeed=!0,this._seed=t}_next(t){if(this.hasSeed)return this._tryNext(t);this.seed=t,this.destination.next(t)}_tryNext(t){const e=this.index++;let n;try{n=this.accumulator(this.seed,t,e)}catch(i){this.destination.error(i)}this.seed=n,this.destination.next(n)}}function Eu(t,e){return function(n){return n.lift(new ku(t,e))}}class ku{constructor(t,e){this.predicate=t,this.thisArg=e}call(t,e){return e.subscribe(new Au(t,this.predicate,this.thisArg))}}class Au extends f{constructor(t,e,n){super(t),this.predicate=e,this.thisArg=n,this.count=0}_next(t){let e;try{e=this.predicate.call(this.thisArg,t,this.count++)}catch(n){return void this.destination.error(n)}e&&this.destination.next(t)}}function Iu(t){return function(e){const n=new Pu(t),i=e.lift(n);return n.caught=i}}class Pu{constructor(t){this.selector=t}call(t,e){return e.subscribe(new Mu(t,this.selector,this.caught))}}class Mu extends B{constructor(t,e,n){super(t),this.selector=e,this.caught=n}error(t){if(!this.isStopped){let n;try{n=this.selector(t,this.caught)}catch(e){return void super.error(e)}this._unsubscribeAndRecycle();const i=new F(this);this.add(i);const r=V(n,i);r!==i&&this.add(r)}}}function Ou(t,e){return U(t,e,1)}function zu(t){return function(e){return 0===t?pu():e.lift(new Du(t))}}class Du{constructor(t){if(this.total=t,this.total<0)throw new yu}call(t,e){return e.subscribe(new Lu(t,this.total))}}class Lu extends f{constructor(t,e){super(t),this.total=e,this.ring=new Array,this.count=0}_next(t){const e=this.ring,n=this.total,i=this.count++;e.length<n?e.push(t):e[i%n]=t}_complete(){const t=this.destination;let e=this.count;if(e>0){const n=this.count>=this.total?this.total:this.count,i=this.ring;for(let r=0;r<n;r++){const r=e++%n;t.next(i[r])}}t.complete()}}function Ru(t=Vu){return e=>e.lift(new Fu(t))}class Fu{constructor(t){this.errorFactory=t}call(t,e){return e.subscribe(new Bu(t,this.errorFactory))}}class Bu extends f{constructor(t,e){super(t),this.errorFactory=e,this.hasValue=!1}_next(t){this.hasValue=!0,this.destination.next(t)}_complete(){if(this.hasValue)return this.destination.complete();{let e;try{e=this.errorFactory()}catch(t){e=t}this.destination.error(e)}}}function Vu(){return new uu}function Uu(t=null){return e=>e.lift(new Nu(t))}class Nu{constructor(t){this.defaultValue=t}call(t,e){return e.subscribe(new ju(t,this.defaultValue))}}class ju extends f{constructor(t,e){super(t),this.defaultValue=e,this.isEmpty=!0}_next(t){this.isEmpty=!1,this.destination.next(t)}_complete(){this.isEmpty&&this.destination.next(this.defaultValue),this.destination.complete()}}function qu(t,e){const n=arguments.length>=2;return i=>i.pipe(t?Eu((e,n)=>t(e,n,i)):_,vu(1),n?Uu(e):Ru(()=>new uu))}function $u(){}function Gu(t,e,n){return function(i){return i.lift(new Zu(t,e,n))}}class Zu{constructor(t,e,n){this.nextOrObserver=t,this.error=e,this.complete=n}call(t,e){return e.subscribe(new Hu(t,this.nextOrObserver,this.error,this.complete))}}class Hu extends f{constructor(t,e,n,r){super(t),this._tapNext=$u,this._tapError=$u,this._tapComplete=$u,this._tapError=n||$u,this._tapComplete=r||$u,i(e)?(this._context=this,this._tapNext=e):e&&(this._context=e,this._tapNext=e.next||$u,this._tapError=e.error||$u,this._tapComplete=e.complete||$u)}_next(t){try{this._tapNext.call(this._context,t)}catch(e){return void this.destination.error(e)}this.destination.next(t)}_error(t){try{this._tapError.call(this._context,t)}catch(t){return void this.destination.error(t)}this.destination.error(t)}_complete(){try{this._tapComplete.call(this._context)}catch(t){return void this.destination.error(t)}return this.destination.complete()}}class Wu{constructor(t){this.callback=t}call(t,e){return e.subscribe(new Xu(t,this.callback))}}class Xu extends f{constructor(t,e){super(t),this.add(new h(e))}}class Ku{constructor(t,e){this.id=t,this.url=e}}class Yu extends Ku{constructor(t,e,n="imperative",i=null){super(t,e),this.navigationTrigger=n,this.restoredState=i}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}}class Ju extends Ku{constructor(t,e,n){super(t,e),this.urlAfterRedirects=n}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}}class Qu extends Ku{constructor(t,e,n){super(t,e),this.reason=n}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}}class th extends Ku{constructor(t,e,n){super(t,e),this.error=n}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}}class eh extends Ku{constructor(t,e,n,i){super(t,e),this.urlAfterRedirects=n,this.state=i}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class nh extends Ku{constructor(t,e,n,i){super(t,e),this.urlAfterRedirects=n,this.state=i}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class ih extends Ku{constructor(t,e,n,i,r){super(t,e),this.urlAfterRedirects=n,this.state=i,this.shouldActivate=r}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}}class rh extends Ku{constructor(t,e,n,i){super(t,e),this.urlAfterRedirects=n,this.state=i}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class oh extends Ku{constructor(t,e,n,i){super(t,e),this.urlAfterRedirects=n,this.state=i}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class sh{constructor(t){this.route=t}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}}class ah{constructor(t){this.route=t}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}}class lh{constructor(t){this.snapshot=t}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class ch{constructor(t){this.snapshot=t}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class uh{constructor(t){this.snapshot=t}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class hh{constructor(t){this.snapshot=t}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class dh{constructor(t,e,n){this.routerEvent=t,this.position=e,this.anchor=n}toString(){return`Scroll(anchor: '${this.anchor}', position: '${this.position?`${this.position[0]}, ${this.position[1]}`:null}')`}}class ph{constructor(t){this.params=t||{}}has(t){return Object.prototype.hasOwnProperty.call(this.params,t)}get(t){if(this.has(t)){const e=this.params[t];return Array.isArray(e)?e[0]:e}return null}getAll(t){if(this.has(t)){const e=this.params[t];return Array.isArray(e)?e:[e]}return[]}get keys(){return Object.keys(this.params)}}function fh(t){return new ph(t)}function mh(t){const e=Error("NavigationCancelingError: "+t);return e.ngNavigationCancelingError=!0,e}function gh(t,e,n){const i=n.path.split("/");if(i.length>t.length)return null;if("full"===n.pathMatch&&(e.hasChildren()||i.length<t.length))return null;const r={};for(let o=0;o<i.length;o++){const e=i[o],n=t[o];if(e.startsWith(":"))r[e.substring(1)]=n;else if(e!==n.path)return null}return{consumed:t.slice(0,i.length),posParams:r}}function _h(t,e){const n=Object.keys(t),i=Object.keys(e);if(!n||!i||n.length!=i.length)return!1;let r;for(let o=0;o<n.length;o++)if(r=n[o],!yh(t[r],e[r]))return!1;return!0}function yh(t,e){if(Array.isArray(t)&&Array.isArray(e)){if(t.length!==e.length)return!1;const n=[...t].sort(),i=[...e].sort();return n.every((t,e)=>i[e]===t)}return t===e}function vh(t){return Array.prototype.concat.apply([],t)}function xh(t){return t.length>0?t[t.length-1]:null}function bh(t,e){for(const n in t)t.hasOwnProperty(n)&&e(t[n],n)}function wh(t){return Qo(t)?t:Jo(t)?R(Promise.resolve(t)):nu(t)}function Ch(t,e,n){return n?function(t,e){return _h(t,e)}(t.queryParams,e.queryParams)&&Th(t.root,e.root):function(t,e){return Object.keys(e).length<=Object.keys(t).length&&Object.keys(e).every(n=>yh(t[n],e[n]))}(t.queryParams,e.queryParams)&&Sh(t.root,e.root)}function Th(t,e){if(!Ph(t.segments,e.segments))return!1;if(t.numberOfChildren!==e.numberOfChildren)return!1;for(const n in e.children){if(!t.children[n])return!1;if(!Th(t.children[n],e.children[n]))return!1}return!0}function Sh(t,e){return Eh(t,e,e.segments)}function Eh(t,e,n){if(t.segments.length>n.length)return!!Ph(t.segments.slice(0,n.length),n)&&!e.hasChildren();if(t.segments.length===n.length){if(!Ph(t.segments,n))return!1;for(const n in e.children){if(!t.children[n])return!1;if(!Sh(t.children[n],e.children[n]))return!1}return!0}{const i=n.slice(0,t.segments.length),r=n.slice(t.segments.length);return!!Ph(t.segments,i)&&!!t.children.primary&&Eh(t.children.primary,e,r)}}class kh{constructor(t,e,n){this.root=t,this.queryParams=e,this.fragment=n}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=fh(this.queryParams)),this._queryParamMap}toString(){return zh.serialize(this)}}class Ah{constructor(t,e){this.segments=t,this.children=e,this.parent=null,bh(e,(t,e)=>t.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return Dh(this)}}class Ih{constructor(t,e){this.path=t,this.parameters=e}get parameterMap(){return this._parameterMap||(this._parameterMap=fh(this.parameters)),this._parameterMap}toString(){return Nh(this)}}function Ph(t,e){return t.length===e.length&&t.every((t,n)=>t.path===e[n].path)}class Mh{}class Oh{parse(t){const e=new Zh(t);return new kh(e.parseRootSegment(),e.parseQueryParams(),e.parseFragment())}serialize(t){return`${"/"+Lh(t.root,!0)}${function(t){const e=Object.keys(t).map(e=>{const n=t[e];return Array.isArray(n)?n.map(t=>`${Fh(e)}=${Fh(t)}`).join("&"):`${Fh(e)}=${Fh(n)}`});return e.length?"?"+e.join("&"):""}(t.queryParams)}${"string"==typeof t.fragment?"#"+encodeURI(t.fragment):""}`}}const zh=new Oh;function Dh(t){return t.segments.map(t=>Nh(t)).join("/")}function Lh(t,e){if(!t.hasChildren())return Dh(t);if(e){const e=t.children.primary?Lh(t.children.primary,!1):"",n=[];return bh(t.children,(t,e)=>{"primary"!==e&&n.push(`${e}:${Lh(t,!1)}`)}),n.length>0?`${e}(${n.join("//")})`:e}{const e=function(t,e){let n=[];return bh(t.children,(t,i)=>{"primary"===i&&(n=n.concat(e(t,i)))}),bh(t.children,(t,i)=>{"primary"!==i&&(n=n.concat(e(t,i)))}),n}(t,(e,n)=>"primary"===n?[Lh(t.children.primary,!1)]:[`${n}:${Lh(e,!1)}`]);return 1===Object.keys(t.children).length&&null!=t.children.primary?`${Dh(t)}/${e[0]}`:`${Dh(t)}/(${e.join("//")})`}}function Rh(t){return encodeURIComponent(t).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function Fh(t){return Rh(t).replace(/%3B/gi,";")}function Bh(t){return Rh(t).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function Vh(t){return decodeURIComponent(t)}function Uh(t){return Vh(t.replace(/\+/g,"%20"))}function Nh(t){return`${Bh(t.path)}${e=t.parameters,Object.keys(e).map(t=>`;${Bh(t)}=${Bh(e[t])}`).join("")}`;var e}const jh=/^[^\/()?;=#]+/;function qh(t){const e=t.match(jh);return e?e[0]:""}const $h=/^[^=?&#]+/,Gh=/^[^?&#]+/;class Zh{constructor(t){this.url=t,this.remaining=t}parseRootSegment(){return this.consumeOptional("/"),""===this.remaining||this.peekStartsWith("?")||this.peekStartsWith("#")?new Ah([],{}):new Ah([],this.parseChildren())}parseQueryParams(){const t={};if(this.consumeOptional("?"))do{this.parseQueryParam(t)}while(this.consumeOptional("&"));return t}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(""===this.remaining)return{};this.consumeOptional("/");const t=[];for(this.peekStartsWith("(")||t.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),t.push(this.parseSegment());let e={};this.peekStartsWith("/(")&&(this.capture("/"),e=this.parseParens(!0));let n={};return this.peekStartsWith("(")&&(n=this.parseParens(!1)),(t.length>0||Object.keys(e).length>0)&&(n.primary=new Ah(t,e)),n}parseSegment(){const t=qh(this.remaining);if(""===t&&this.peekStartsWith(";"))throw new Error(`Empty path url segment cannot have parameters: '${this.remaining}'.`);return this.capture(t),new Ih(Vh(t),this.parseMatrixParams())}parseMatrixParams(){const t={};for(;this.consumeOptional(";");)this.parseParam(t);return t}parseParam(t){const e=qh(this.remaining);if(!e)return;this.capture(e);let n="";if(this.consumeOptional("=")){const t=qh(this.remaining);t&&(n=t,this.capture(n))}t[Vh(e)]=Vh(n)}parseQueryParam(t){const e=function(t){const e=t.match($h);return e?e[0]:""}(this.remaining);if(!e)return;this.capture(e);let n="";if(this.consumeOptional("=")){const t=function(t){const e=t.match(Gh);return e?e[0]:""}(this.remaining);t&&(n=t,this.capture(n))}const i=Uh(e),r=Uh(n);if(t.hasOwnProperty(i)){let e=t[i];Array.isArray(e)||(e=[e],t[i]=e),e.push(r)}else t[i]=r}parseParens(t){const e={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){const n=qh(this.remaining),i=this.remaining[n.length];if("/"!==i&&")"!==i&&";"!==i)throw new Error(`Cannot parse url '${this.url}'`);let r=void 0;n.indexOf(":")>-1?(r=n.substr(0,n.indexOf(":")),this.capture(r),this.capture(":")):t&&(r="primary");const o=this.parseChildren();e[r]=1===Object.keys(o).length?o.primary:new Ah([],o),this.consumeOptional("//")}return e}peekStartsWith(t){return this.remaining.startsWith(t)}consumeOptional(t){return!!this.peekStartsWith(t)&&(this.remaining=this.remaining.substring(t.length),!0)}capture(t){if(!this.consumeOptional(t))throw new Error(`Expected "${t}".`)}}class Hh{constructor(t){this._root=t}get root(){return this._root.value}parent(t){const e=this.pathFromRoot(t);return e.length>1?e[e.length-2]:null}children(t){const e=Wh(t,this._root);return e?e.children.map(t=>t.value):[]}firstChild(t){const e=Wh(t,this._root);return e&&e.children.length>0?e.children[0].value:null}siblings(t){const e=Xh(t,this._root);return e.length<2?[]:e[e.length-2].children.map(t=>t.value).filter(e=>e!==t)}pathFromRoot(t){return Xh(t,this._root).map(t=>t.value)}}function Wh(t,e){if(t===e.value)return e;for(const n of e.children){const e=Wh(t,n);if(e)return e}return null}function Xh(t,e){if(t===e.value)return[e];for(const n of e.children){const i=Xh(t,n);if(i.length)return i.unshift(e),i}return[]}class Kh{constructor(t,e){this.value=t,this.children=e}toString(){return`TreeNode(${this.value})`}}function Yh(t){const e={};return t&&t.children.forEach(t=>e[t.value.outlet]=t),e}class Jh extends Hh{constructor(t,e){super(t),this.snapshot=e,rd(this,t)}toString(){return this.snapshot.toString()}}function Qh(t,e){const n=function(t,e){const n=new nd([],{},{},"",{},"primary",e,null,t.root,-1,{});return new id("",new Kh(n,[]))}(t,e),i=new iu([new Ih("",{})]),r=new iu({}),o=new iu({}),s=new iu({}),a=new iu(""),l=new td(i,r,s,a,o,"primary",e,n.root);return l.snapshot=n.root,new Jh(new Kh(l,[]),n)}class td{constructor(t,e,n,i,r,o,s,a){this.url=t,this.params=e,this.queryParams=n,this.fragment=i,this.data=r,this.outlet=o,this.component=s,this._futureSnapshot=a}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=this.params.pipe(E(t=>fh(t)))),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=this.queryParams.pipe(E(t=>fh(t)))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}}function ed(t,e="emptyOnly"){const n=t.pathFromRoot;let i=0;if("always"!==e)for(i=n.length-1;i>=1;){const t=n[i],e=n[i-1];if(t.routeConfig&&""===t.routeConfig.path)i--;else{if(e.component)break;i--}}return function(t){return t.reduce((t,e)=>({params:Object.assign(Object.assign({},t.params),e.params),data:Object.assign(Object.assign({},t.data),e.data),resolve:Object.assign(Object.assign({},t.resolve),e._resolvedData)}),{params:{},data:{},resolve:{}})}(n.slice(i))}class nd{constructor(t,e,n,i,r,o,s,a,l,c,u){this.url=t,this.params=e,this.queryParams=n,this.fragment=i,this.data=r,this.outlet=o,this.component=s,this.routeConfig=a,this._urlSegment=l,this._lastPathIndex=c,this._resolve=u}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=fh(this.params)),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=fh(this.queryParams)),this._queryParamMap}toString(){return`Route(url:'${this.url.map(t=>t.toString()).join("/")}', path:'${this.routeConfig?this.routeConfig.path:""}')`}}class id extends Hh{constructor(t,e){super(e),this.url=t,rd(this,e)}toString(){return od(this._root)}}function rd(t,e){e.value._routerState=t,e.children.forEach(e=>rd(t,e))}function od(t){const e=t.children.length>0?` { ${t.children.map(od).join(", ")} } `:"";return`${t.value}${e}`}function sd(t){if(t.snapshot){const e=t.snapshot,n=t._futureSnapshot;t.snapshot=n,_h(e.queryParams,n.queryParams)||t.queryParams.next(n.queryParams),e.fragment!==n.fragment&&t.fragment.next(n.fragment),_h(e.params,n.params)||t.params.next(n.params),function(t,e){if(t.length!==e.length)return!1;for(let n=0;n<t.length;++n)if(!_h(t[n],e[n]))return!1;return!0}(e.url,n.url)||t.url.next(n.url),_h(e.data,n.data)||t.data.next(n.data)}else t.snapshot=t._futureSnapshot,t.data.next(t._futureSnapshot.data)}function ad(t,e){var n,i;return _h(t.params,e.params)&&Ph(n=t.url,i=e.url)&&n.every((t,e)=>_h(t.parameters,i[e].parameters))&&!(!t.parent!=!e.parent)&&(!t.parent||ad(t.parent,e.parent))}function ld(t,e,n){if(n&&t.shouldReuseRoute(e.value,n.value.snapshot)){const i=n.value;i._futureSnapshot=e.value;const r=function(t,e,n){return e.children.map(e=>{for(const i of n.children)if(t.shouldReuseRoute(e.value,i.value.snapshot))return ld(t,e,i);return ld(t,e)})}(t,e,n);return new Kh(i,r)}{const n=t.retrieve(e.value);if(n){const t=n.route;return cd(e,t),t}{const n=new td(new iu((i=e.value).url),new iu(i.params),new iu(i.queryParams),new iu(i.fragment),new iu(i.data),i.outlet,i.component,i),r=e.children.map(e=>ld(t,e));return new Kh(n,r)}}var i}function cd(t,e){if(t.value.routeConfig!==e.value.routeConfig)throw new Error("Cannot reattach ActivatedRouteSnapshot created from a different route");if(t.children.length!==e.children.length)throw new Error("Cannot reattach ActivatedRouteSnapshot with a different number of children");e.value._futureSnapshot=t.value;for(let n=0;n<t.children.length;++n)cd(t.children[n],e.children[n])}function ud(t){return"object"==typeof t&&null!=t&&!t.outlets&&!t.segmentPath}function hd(t){return"object"==typeof t&&null!=t&&t.outlets}function dd(t,e,n,i,r){let o={};return i&&bh(i,(t,e)=>{o[e]=Array.isArray(t)?t.map(t=>""+t):""+t}),new kh(n.root===t?e:pd(n.root,t,e),o,r)}function pd(t,e,n){const i={};return bh(t.children,(t,r)=>{i[r]=t===e?n:pd(t,e,n)}),new Ah(t.segments,i)}class fd{constructor(t,e,n){if(this.isAbsolute=t,this.numberOfDoubleDots=e,this.commands=n,t&&n.length>0&&ud(n[0]))throw new Error("Root segment cannot have matrix parameters");const i=n.find(hd);if(i&&i!==xh(n))throw new Error("{outlets:{}} has to be the last command")}toRoot(){return this.isAbsolute&&1===this.commands.length&&"/"==this.commands[0]}}class md{constructor(t,e,n){this.segmentGroup=t,this.processChildren=e,this.index=n}}function gd(t,e,n){if(t||(t=new Ah([],{})),0===t.segments.length&&t.hasChildren())return _d(t,e,n);const i=function(t,e,n){let i=0,r=e;const o={match:!1,pathIndex:0,commandIndex:0};for(;r<t.segments.length;){if(i>=n.length)return o;const e=t.segments[r],s=n[i];if(hd(s))break;const a=""+s,l=i<n.length-1?n[i+1]:null;if(r>0&&void 0===a)break;if(a&&l&&"object"==typeof l&&void 0===l.outlets){if(!bd(a,l,e))return o;i+=2}else{if(!bd(a,{},e))return o;i++}r++}return{match:!0,pathIndex:r,commandIndex:i}}(t,e,n),r=n.slice(i.commandIndex);if(i.match&&i.pathIndex<t.segments.length){const e=new Ah(t.segments.slice(0,i.pathIndex),{});return e.children.primary=new Ah(t.segments.slice(i.pathIndex),t.children),_d(e,0,r)}return i.match&&0===r.length?new Ah(t.segments,{}):i.match&&!t.hasChildren()?yd(t,e,n):i.match?_d(t,0,r):yd(t,e,n)}function _d(t,e,n){if(0===n.length)return new Ah(t.segments,{});{const i=function(t){return hd(t[0])?t[0].outlets:{primary:t}}(n),r={};return bh(i,(n,i)=>{"string"==typeof n&&(n=[n]),null!==n&&(r[i]=gd(t.children[i],e,n))}),bh(t.children,(t,e)=>{void 0===i[e]&&(r[e]=t)}),new Ah(t.segments,r)}}function yd(t,e,n){const i=t.segments.slice(0,e);let r=0;for(;r<n.length;){const o=n[r];if(hd(o)){const t=vd(o.outlets);return new Ah(i,t)}if(0===r&&ud(n[0])){i.push(new Ih(t.segments[e].path,n[0])),r++;continue}const s=hd(o)?o.outlets.primary:""+o,a=r<n.length-1?n[r+1]:null;s&&a&&ud(a)?(i.push(new Ih(s,xd(a))),r+=2):(i.push(new Ih(s,{})),r++)}return new Ah(i,{})}function vd(t){const e={};return bh(t,(t,n)=>{"string"==typeof t&&(t=[t]),null!==t&&(e[n]=yd(new Ah([],{}),0,t))}),e}function xd(t){const e={};return bh(t,(t,n)=>e[n]=""+t),e}function bd(t,e,n){return t==n.path&&_h(e,n.parameters)}class wd{constructor(t,e,n,i){this.routeReuseStrategy=t,this.futureState=e,this.currState=n,this.forwardEvent=i}activate(t){const e=this.futureState._root,n=this.currState?this.currState._root:null;this.deactivateChildRoutes(e,n,t),sd(this.futureState.root),this.activateChildRoutes(e,n,t)}deactivateChildRoutes(t,e,n){const i=Yh(e);t.children.forEach(t=>{const e=t.value.outlet;this.deactivateRoutes(t,i[e],n),delete i[e]}),bh(i,(t,e)=>{this.deactivateRouteAndItsChildren(t,n)})}deactivateRoutes(t,e,n){const i=t.value,r=e?e.value:null;if(i===r)if(i.component){const r=n.getContext(i.outlet);r&&this.deactivateChildRoutes(t,e,r.children)}else this.deactivateChildRoutes(t,e,n);else r&&this.deactivateRouteAndItsChildren(e,n)}deactivateRouteAndItsChildren(t,e){this.routeReuseStrategy.shouldDetach(t.value.snapshot)?this.detachAndStoreRouteSubtree(t,e):this.deactivateRouteAndOutlet(t,e)}detachAndStoreRouteSubtree(t,e){const n=e.getContext(t.value.outlet);if(n&&n.outlet){const e=n.outlet.detach(),i=n.children.onOutletDeactivated();this.routeReuseStrategy.store(t.value.snapshot,{componentRef:e,route:t,contexts:i})}}deactivateRouteAndOutlet(t,e){const n=e.getContext(t.value.outlet),i=n&&t.value.component?n.children:e,r=Yh(t);for(const o of Object.keys(r))this.deactivateRouteAndItsChildren(r[o],i);n&&n.outlet&&(n.outlet.deactivate(),n.children.onOutletDeactivated())}activateChildRoutes(t,e,n){const i=Yh(e);t.children.forEach(t=>{this.activateRoutes(t,i[t.value.outlet],n),this.forwardEvent(new hh(t.value.snapshot))}),t.children.length&&this.forwardEvent(new ch(t.value.snapshot))}activateRoutes(t,e,n){const i=t.value,r=e?e.value:null;if(sd(i),i===r)if(i.component){const r=n.getOrCreateContext(i.outlet);this.activateChildRoutes(t,e,r.children)}else this.activateChildRoutes(t,e,n);else if(i.component){const e=n.getOrCreateContext(i.outlet);if(this.routeReuseStrategy.shouldAttach(i.snapshot)){const t=this.routeReuseStrategy.retrieve(i.snapshot);this.routeReuseStrategy.store(i.snapshot,null),e.children.onOutletReAttached(t.contexts),e.attachRef=t.componentRef,e.route=t.route.value,e.outlet&&e.outlet.attach(t.componentRef,t.route.value),Cd(t.route)}else{const n=function(t){for(let e=t.parent;e;e=e.parent){const t=e.routeConfig;if(t&&t._loadedConfig)return t._loadedConfig;if(t&&t.component)return null}return null}(i.snapshot),r=n?n.module.componentFactoryResolver:null;e.attachRef=null,e.route=i,e.resolver=r,e.outlet&&e.outlet.activateWith(i,r),this.activateChildRoutes(t,null,e.children)}}else this.activateChildRoutes(t,null,n)}}function Cd(t){sd(t.value),t.children.forEach(Cd)}class Td{constructor(t,e){this.routes=t,this.module=e}}function Sd(t){return"function"==typeof t}function Ed(t){return t instanceof kh}const kd=Symbol("INITIAL_VALUE");function Ad(){return mu(t=>function(...t){let e=void 0,n=void 0;return S(t[t.length-1])&&(n=t.pop()),"function"==typeof t[t.length-1]&&(e=t.pop()),1===t.length&&l(t[0])&&(t=t[0]),$(t,n).lift(new lu(e))}(t.map(t=>t.pipe(vu(1),wu(kd)))).pipe(Cu((t,e)=>{let n=!1;return e.reduce((t,i,r)=>{if(t!==kd)return t;if(i===kd&&(n=!0),!n){if(!1===i)return i;if(r===e.length-1||Ed(i))return i}return t},t)},kd),Eu(t=>t!==kd),E(t=>Ed(t)?t:!0===t),vu(1)))}let Id=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=Bt({type:t,selectors:[["ng-component"]],decls:1,vars:0,template:function(t,e){1&t&&Ho(0,"router-outlet")},directives:function(){return[Tp]},encapsulation:2}),t})();function Pd(t,e=""){for(let n=0;n<t.length;n++){const i=t[n];Md(i,Od(e,i))}}function Md(t,e){t.children&&Pd(t.children,e)}function Od(t,e){return e?t||e.path?t&&!e.path?t+"/":!t&&e.path?e.path:`${t}/${e.path}`:"":t}function zd(t){const e=t.children&&t.children.map(zd),n=e?Object.assign(Object.assign({},t),{children:e}):Object.assign({},t);return!n.component&&(e||n.loadChildren)&&n.outlet&&"primary"!==n.outlet&&(n.component=Id),n}function Dd(t){return t.outlet||"primary"}function Ld(t,e){const n=t.filter(t=>Dd(t)===e);return n.push(...t.filter(t=>Dd(t)!==e)),n}const Rd={matched:!1,consumedSegments:[],lastChild:0,parameters:{},positionalParamSegments:{}};function Fd(t,e,n){var i;if(""===e.path)return"full"===e.pathMatch&&(t.hasChildren()||n.length>0)?Object.assign({},Rd):{matched:!0,consumedSegments:[],lastChild:0,parameters:{},positionalParamSegments:{}};const r=(e.matcher||gh)(n,t,e);if(!r)return Object.assign({},Rd);const o={};bh(r.posParams,(t,e)=>{o[e]=t.path});const s=r.consumed.length>0?Object.assign(Object.assign({},o),r.consumed[r.consumed.length-1].parameters):o;return{matched:!0,consumedSegments:r.consumed,lastChild:r.consumed.length,parameters:s,positionalParamSegments:null!==(i=r.posParams)&&void 0!==i?i:{}}}function Bd(t,e,n,i,r="corrected"){if(n.length>0&&function(t,e,n){return n.some(n=>Vd(t,e,n)&&"primary"!==Dd(n))}(t,n,i)){const r=new Ah(e,function(t,e,n,i){const r={};r.primary=i,i._sourceSegment=t,i._segmentIndexShift=e.length;for(const o of n)if(""===o.path&&"primary"!==Dd(o)){const n=new Ah([],{});n._sourceSegment=t,n._segmentIndexShift=e.length,r[Dd(o)]=n}return r}(t,e,i,new Ah(n,t.children)));return r._sourceSegment=t,r._segmentIndexShift=e.length,{segmentGroup:r,slicedSegments:[]}}if(0===n.length&&function(t,e,n){return n.some(n=>Vd(t,e,n))}(t,n,i)){const o=new Ah(t.segments,function(t,e,n,i,r,o){const s={};for(const a of i)if(Vd(t,n,a)&&!r[Dd(a)]){const n=new Ah([],{});n._sourceSegment=t,n._segmentIndexShift="legacy"===o?t.segments.length:e.length,s[Dd(a)]=n}return Object.assign(Object.assign({},r),s)}(t,e,n,i,t.children,r));return o._sourceSegment=t,o._segmentIndexShift=e.length,{segmentGroup:o,slicedSegments:n}}const o=new Ah(t.segments,t.children);return o._sourceSegment=t,o._segmentIndexShift=e.length,{segmentGroup:o,slicedSegments:n}}function Vd(t,e,n){return(!(t.hasChildren()||e.length>0)||"full"!==n.pathMatch)&&""===n.path}function Ud(t,e,n,i){return!!(Dd(t)===i||"primary"!==i&&Vd(e,n,t))&&("**"===t.path||Fd(e,t,n).matched)}function Nd(t,e,n){return 0===e.length&&!t.children[n]}class jd{constructor(t){this.segmentGroup=t||null}}class qd{constructor(t){this.urlTree=t}}function $d(t){return new y(e=>e.error(new jd(t)))}function Gd(t){return new y(e=>e.error(new qd(t)))}function Zd(t){return new y(e=>e.error(new Error(`Only absolute redirects can have named outlets. redirectTo: '${t}'`)))}class Hd{constructor(t,e,n,i,r){this.configLoader=e,this.urlSerializer=n,this.urlTree=i,this.config=r,this.allowRedirects=!0,this.ngModule=t.get(Ma)}apply(){const t=Bd(this.urlTree.root,[],[],this.config).segmentGroup,e=new Ah(t.segments,t.children);return this.expandSegmentGroup(this.ngModule,this.config,e,"primary").pipe(E(t=>this.createUrlTree(Wd(t),this.urlTree.queryParams,this.urlTree.fragment))).pipe(Iu(t=>{if(t instanceof qd)return this.allowRedirects=!1,this.match(t.urlTree);if(t instanceof jd)throw this.noMatchError(t);throw t}))}match(t){return this.expandSegmentGroup(this.ngModule,this.config,t.root,"primary").pipe(E(e=>this.createUrlTree(Wd(e),t.queryParams,t.fragment))).pipe(Iu(t=>{if(t instanceof jd)throw this.noMatchError(t);throw t}))}noMatchError(t){return new Error(`Cannot match any routes. URL Segment: '${t.segmentGroup}'`)}createUrlTree(t,e,n){const i=t.segments.length>0?new Ah([],{primary:t}):t;return new kh(i,e,n)}expandSegmentGroup(t,e,n,i){return 0===n.segments.length&&n.hasChildren()?this.expandChildren(t,e,n).pipe(E(t=>new Ah([],t))):this.expandSegment(t,n,e,n.segments,i,!0)}expandChildren(t,e,n){const i=[];for(const r of Object.keys(n.children))"primary"===r?i.unshift(r):i.push(r);return R(i).pipe(Ou(i=>{const r=n.children[i],o=Ld(e,i);return this.expandSegmentGroup(t,o,r,i).pipe(E(t=>({segment:t,outlet:i})))}),Cu((t,e)=>(t[e.outlet]=e.segment,t),{}),function(t,e){const n=arguments.length>=2;return i=>i.pipe(t?Eu((e,n)=>t(e,n,i)):_,zu(1),n?Uu(e):Ru(()=>new uu))}())}expandSegment(t,e,n,i,r,o){return R(n).pipe(Ou(s=>this.expandSegmentAgainstRoute(t,e,n,s,i,r,o).pipe(Iu(t=>{if(t instanceof jd)return nu(null);throw t}))),qu(t=>!!t),Iu((t,n)=>{if(t instanceof uu||"EmptyError"===t.name){if(Nd(e,i,r))return nu(new Ah([],{}));throw new jd(e)}throw t}))}expandSegmentAgainstRoute(t,e,n,i,r,o,s){return Ud(i,e,r,o)?void 0===i.redirectTo?this.matchSegmentAgainstRoute(t,e,i,r,o):s&&this.allowRedirects?this.expandSegmentAgainstRouteUsingRedirect(t,e,n,i,r,o):$d(e):$d(e)}expandSegmentAgainstRouteUsingRedirect(t,e,n,i,r,o){return"**"===i.path?this.expandWildCardWithParamsAgainstRouteUsingRedirect(t,n,i,o):this.expandRegularSegmentAgainstRouteUsingRedirect(t,e,n,i,r,o)}expandWildCardWithParamsAgainstRouteUsingRedirect(t,e,n,i){const r=this.applyRedirectCommands([],n.redirectTo,{});return n.redirectTo.startsWith("/")?Gd(r):this.lineralizeSegments(n,r).pipe(U(n=>{const r=new Ah(n,{});return this.expandSegment(t,r,e,n,i,!1)}))}expandRegularSegmentAgainstRouteUsingRedirect(t,e,n,i,r,o){const{matched:s,consumedSegments:a,lastChild:l,positionalParamSegments:c}=Fd(e,i,r);if(!s)return $d(e);const u=this.applyRedirectCommands(a,i.redirectTo,c);return i.redirectTo.startsWith("/")?Gd(u):this.lineralizeSegments(i,u).pipe(U(i=>this.expandSegment(t,e,n,i.concat(r.slice(l)),o,!1)))}matchSegmentAgainstRoute(t,e,n,i,r){if("**"===n.path)return n.loadChildren?this.configLoader.load(t.injector,n).pipe(E(t=>(n._loadedConfig=t,new Ah(i,{})))):nu(new Ah(i,{}));const{matched:o,consumedSegments:s,lastChild:a}=Fd(e,n,i);if(!o)return $d(e);const l=i.slice(a);return this.getChildConfig(t,n,i).pipe(U(t=>{const i=t.module,o=t.routes,{segmentGroup:a,slicedSegments:c}=Bd(e,s,l,o),u=new Ah(a.segments,a.children);if(0===c.length&&u.hasChildren())return this.expandChildren(i,o,u).pipe(E(t=>new Ah(s,t)));if(0===o.length&&0===c.length)return nu(new Ah(s,{}));const h=Dd(n)===r;return this.expandSegment(i,u,o,c,h?"primary":r,!0).pipe(E(t=>new Ah(s.concat(t.segments),t.children)))}))}getChildConfig(t,e,n){return e.children?nu(new Td(e.children,t)):e.loadChildren?void 0!==e._loadedConfig?nu(e._loadedConfig):this.runCanLoadGuards(t.injector,e,n).pipe(U(n=>n?this.configLoader.load(t.injector,e).pipe(E(t=>(e._loadedConfig=t,t))):function(t){return new y(e=>e.error(mh(`Cannot load children because the guard of the route "path: '${t.path}'" returned false`)))}(e))):nu(new Td([],t))}runCanLoadGuards(t,e,n){const i=e.canLoad;return i&&0!==i.length?nu(i.map(i=>{const r=t.get(i);let o;if(function(t){return t&&Sd(t.canLoad)}(r))o=r.canLoad(e,n);else{if(!Sd(r))throw new Error("Invalid CanLoad guard");o=r(e,n)}return wh(o)})).pipe(Ad(),Gu(t=>{if(!Ed(t))return;const e=mh(`Redirecting to "${this.urlSerializer.serialize(t)}"`);throw e.url=t,e}),E(t=>!0===t)):nu(!0)}lineralizeSegments(t,e){let n=[],i=e.root;for(;;){if(n=n.concat(i.segments),0===i.numberOfChildren)return nu(n);if(i.numberOfChildren>1||!i.children.primary)return Zd(t.redirectTo);i=i.children.primary}}applyRedirectCommands(t,e,n){return this.applyRedirectCreatreUrlTree(e,this.urlSerializer.parse(e),t,n)}applyRedirectCreatreUrlTree(t,e,n,i){const r=this.createSegmentGroup(t,e.root,n,i);return new kh(r,this.createQueryParams(e.queryParams,this.urlTree.queryParams),e.fragment)}createQueryParams(t,e){const n={};return bh(t,(t,i)=>{if("string"==typeof t&&t.startsWith(":")){const r=t.substring(1);n[i]=e[r]}else n[i]=t}),n}createSegmentGroup(t,e,n,i){const r=this.createSegments(t,e.segments,n,i);let o={};return bh(e.children,(e,r)=>{o[r]=this.createSegmentGroup(t,e,n,i)}),new Ah(r,o)}createSegments(t,e,n,i){return e.map(e=>e.path.startsWith(":")?this.findPosParam(t,e,i):this.findOrReturn(e,n))}findPosParam(t,e,n){const i=n[e.path.substring(1)];if(!i)throw new Error(`Cannot redirect to '${t}'. Cannot find '${e.path}'.`);return i}findOrReturn(t,e){let n=0;for(const i of e){if(i.path===t.path)return e.splice(n),i;n++}return t}}function Wd(t){const e={};for(const n of Object.keys(t.children)){const i=Wd(t.children[n]);(i.segments.length>0||i.hasChildren())&&(e[n]=i)}return function(t){if(1===t.numberOfChildren&&t.children.primary){const e=t.children.primary;return new Ah(t.segments.concat(e.segments),e.children)}return t}(new Ah(t.segments,e))}class Xd{constructor(t){this.path=t,this.route=this.path[this.path.length-1]}}class Kd{constructor(t,e){this.component=t,this.route=e}}function Yd(t,e,n){const i=t._root;return Qd(i,e?e._root:null,n,[i.value])}function Jd(t,e,n){const i=function(t){if(!t)return null;for(let e=t.parent;e;e=e.parent){const t=e.routeConfig;if(t&&t._loadedConfig)return t._loadedConfig}return null}(e);return(i?i.module.injector:n).get(t)}function Qd(t,e,n,i,r={canDeactivateChecks:[],canActivateChecks:[]}){const o=Yh(e);return t.children.forEach(t=>{!function(t,e,n,i,r={canDeactivateChecks:[],canActivateChecks:[]}){const o=t.value,s=e?e.value:null,a=n?n.getContext(t.value.outlet):null;if(s&&o.routeConfig===s.routeConfig){const l=function(t,e,n){if("function"==typeof n)return n(t,e);switch(n){case"pathParamsChange":return!Ph(t.url,e.url);case"pathParamsOrQueryParamsChange":return!Ph(t.url,e.url)||!_h(t.queryParams,e.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!ad(t,e)||!_h(t.queryParams,e.queryParams);case"paramsChange":default:return!ad(t,e)}}(s,o,o.routeConfig.runGuardsAndResolvers);l?r.canActivateChecks.push(new Xd(i)):(o.data=s.data,o._resolvedData=s._resolvedData),Qd(t,e,o.component?a?a.children:null:n,i,r),l&&a&&a.outlet&&a.outlet.isActivated&&r.canDeactivateChecks.push(new Kd(a.outlet.component,s))}else s&&tp(e,a,r),r.canActivateChecks.push(new Xd(i)),Qd(t,null,o.component?a?a.children:null:n,i,r)}(t,o[t.value.outlet],n,i.concat([t.value]),r),delete o[t.value.outlet]}),bh(o,(t,e)=>tp(t,n.getContext(e),r)),r}function tp(t,e,n){const i=Yh(t),r=t.value;bh(i,(t,i)=>{tp(t,r.component?e?e.children.getContext(i):null:e,n)}),n.canDeactivateChecks.push(new Kd(r.component&&e&&e.outlet&&e.outlet.isActivated?e.outlet.component:null,r))}class ep{}function np(t){return new y(e=>e.error(t))}class ip{constructor(t,e,n,i,r,o){this.rootComponentType=t,this.config=e,this.urlTree=n,this.url=i,this.paramsInheritanceStrategy=r,this.relativeLinkResolution=o}recognize(){const t=Bd(this.urlTree.root,[],[],this.config.filter(t=>void 0===t.redirectTo),this.relativeLinkResolution).segmentGroup,e=this.processSegmentGroup(this.config,t,"primary");if(null===e)return null;const n=new nd([],Object.freeze({}),Object.freeze(Object.assign({},this.urlTree.queryParams)),this.urlTree.fragment,{},"primary",this.rootComponentType,null,this.urlTree.root,-1,{}),i=new Kh(n,e),r=new id(this.url,i);return this.inheritParamsAndData(r._root),r}inheritParamsAndData(t){const e=t.value,n=ed(e,this.paramsInheritanceStrategy);e.params=Object.freeze(n.params),e.data=Object.freeze(n.data),t.children.forEach(t=>this.inheritParamsAndData(t))}processSegmentGroup(t,e,n){return 0===e.segments.length&&e.hasChildren()?this.processChildren(t,e):this.processSegment(t,e,e.segments,n)}processChildren(t,e){const n=[];for(const r of Object.keys(e.children)){const i=e.children[r],o=Ld(t,r),s=this.processSegmentGroup(o,i,r);if(null===s)return null;n.push(...s)}const i=function(t){const e=[];for(const n of t){if(!rp(n)){e.push(n);continue}const t=e.find(t=>n.value.routeConfig===t.value.routeConfig);void 0!==t?t.children.push(...n.children):e.push(n)}return e}(n);return i.sort((t,e)=>"primary"===t.value.outlet?-1:"primary"===e.value.outlet?1:t.value.outlet.localeCompare(e.value.outlet)),i}processSegment(t,e,n,i){for(const r of t){const t=this.processSegmentAgainstRoute(r,e,n,i);if(null!==t)return t}return Nd(e,n,i)?[]:null}processSegmentAgainstRoute(t,e,n,i){if(t.redirectTo||!Ud(t,e,n,i))return null;let r,o=[],s=[];if("**"===t.path){const i=n.length>0?xh(n).parameters:{};r=new nd(n,i,Object.freeze(Object.assign({},this.urlTree.queryParams)),this.urlTree.fragment,ap(t),Dd(t),t.component,t,op(e),sp(e)+n.length,lp(t))}else{const i=Fd(e,t,n);if(!i.matched)return null;o=i.consumedSegments,s=n.slice(i.lastChild),r=new nd(o,i.parameters,Object.freeze(Object.assign({},this.urlTree.queryParams)),this.urlTree.fragment,ap(t),Dd(t),t.component,t,op(e),sp(e)+o.length,lp(t))}const a=function(t){return t.children?t.children:t.loadChildren?t._loadedConfig.routes:[]}(t),{segmentGroup:l,slicedSegments:c}=Bd(e,o,s,a.filter(t=>void 0===t.redirectTo),this.relativeLinkResolution);if(0===c.length&&l.hasChildren()){const t=this.processChildren(a,l);return null===t?null:[new Kh(r,t)]}if(0===a.length&&0===c.length)return[new Kh(r,[])];const u=Dd(t)===i,h=this.processSegment(a,l,c,u?"primary":i);return null===h?null:[new Kh(r,h)]}}function rp(t){const e=t.value.routeConfig;return e&&""===e.path&&void 0===e.redirectTo}function op(t){let e=t;for(;e._sourceSegment;)e=e._sourceSegment;return e}function sp(t){let e=t,n=e._segmentIndexShift?e._segmentIndexShift:0;for(;e._sourceSegment;)e=e._sourceSegment,n+=e._segmentIndexShift?e._segmentIndexShift:0;return n-1}function ap(t){return t.data||{}}function lp(t){return t.resolve||{}}function cp(t){return mu(e=>{const n=t(e);return n?R(n).pipe(E(()=>e)):nu(e)})}class up extends class{shouldDetach(t){return!1}store(t,e){}shouldAttach(t){return!1}retrieve(t){return null}shouldReuseRoute(t,e){return t.routeConfig===e.routeConfig}}{}const hp=new Nn("ROUTES");class dp{constructor(t,e,n,i){this.loader=t,this.compiler=e,this.onLoadStartListener=n,this.onLoadEndListener=i}load(t,e){return this.onLoadStartListener&&this.onLoadStartListener(e),this.loadModuleFactory(e.loadChildren).pipe(E(n=>{this.onLoadEndListener&&this.onLoadEndListener(e);const i=n.create(t);return new Td(vh(i.injector.get(hp)).map(zd),i)}))}loadModuleFactory(t){return"string"==typeof t?R(this.loader.load(t)):wh(t()).pipe(U(t=>t instanceof Oa?nu(t):R(this.compiler.compileModuleAsync(t))))}}class pp{constructor(){this.outlet=null,this.route=null,this.resolver=null,this.children=new fp,this.attachRef=null}}class fp{constructor(){this.contexts=new Map}onChildOutletCreated(t,e){const n=this.getOrCreateContext(t);n.outlet=e,this.contexts.set(t,n)}onChildOutletDestroyed(t){const e=this.getContext(t);e&&(e.outlet=null)}onOutletDeactivated(){const t=this.contexts;return this.contexts=new Map,t}onOutletReAttached(t){this.contexts=t}getOrCreateContext(t){let e=this.getContext(t);return e||(e=new pp,this.contexts.set(t,e)),e}getContext(t){return this.contexts.get(t)||null}}class mp{shouldProcessUrl(t){return!0}extract(t){return t}merge(t,e){return t}}function gp(t){throw t}function _p(t,e,n){return e.parse("/")}function yp(t,e){return nu(null)}let vp=(()=>{class t{constructor(t,e,n,i,r,o,s,a){this.rootComponentType=t,this.urlSerializer=e,this.rootContexts=n,this.location=i,this.config=a,this.lastSuccessfulNavigation=null,this.currentNavigation=null,this.lastLocationChangeInfo=null,this.navigationId=0,this.isNgZoneEnabled=!1,this.events=new C,this.errorHandler=gp,this.malformedUriErrorHandler=_p,this.navigated=!1,this.lastSuccessfulId=-1,this.hooks={beforePreactivation:yp,afterPreactivation:yp},this.urlHandlingStrategy=new mp,this.routeReuseStrategy=new up,this.onSameUrlNavigation="ignore",this.paramsInheritanceStrategy="emptyOnly",this.urlUpdateStrategy="deferred",this.relativeLinkResolution="corrected",this.ngModule=r.get(Ma),this.console=r.get(Pl);const l=r.get(ql);this.isNgZoneEnabled=l instanceof ql&&ql.isInAngularZone(),this.resetConfig(a),this.currentUrlTree=new kh(new Ah([],{}),{},null),this.rawUrlTree=this.currentUrlTree,this.browserUrlTree=this.currentUrlTree,this.configLoader=new dp(o,s,t=>this.triggerEvent(new sh(t)),t=>this.triggerEvent(new ah(t))),this.routerState=Qh(this.currentUrlTree,this.rootComponentType),this.transitions=new iu({id:0,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,extractedUrl:this.urlHandlingStrategy.extract(this.currentUrlTree),urlAfterRedirects:this.urlHandlingStrategy.extract(this.currentUrlTree),rawUrl:this.currentUrlTree,extras:{},resolve:null,reject:null,promise:Promise.resolve(!0),source:"imperative",restoredState:null,currentSnapshot:this.routerState.snapshot,targetSnapshot:null,currentRouterState:this.routerState,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.navigations=this.setupNavigations(this.transitions),this.processNavigations()}setupNavigations(t){const e=this.events;return t.pipe(Eu(t=>0!==t.id),E(t=>Object.assign(Object.assign({},t),{extractedUrl:this.urlHandlingStrategy.extract(t.rawUrl)})),mu(t=>{let n=!1,i=!1;return nu(t).pipe(Gu(t=>{this.currentNavigation={id:t.id,initialUrl:t.currentRawUrl,extractedUrl:t.extractedUrl,trigger:t.source,extras:t.extras,previousNavigation:this.lastSuccessfulNavigation?Object.assign(Object.assign({},this.lastSuccessfulNavigation),{previousNavigation:null}):null}}),mu(t=>{const n=!this.navigated||t.extractedUrl.toString()!==this.browserUrlTree.toString();if(("reload"===this.onSameUrlNavigation||n)&&this.urlHandlingStrategy.shouldProcessUrl(t.rawUrl))return nu(t).pipe(mu(t=>{const n=this.transitions.getValue();return e.next(new Yu(t.id,this.serializeUrl(t.extractedUrl),t.source,t.restoredState)),n!==this.transitions.getValue()?du:Promise.resolve(t)}),(i=this.ngModule.injector,r=this.configLoader,o=this.urlSerializer,s=this.config,mu(t=>function(t,e,n,i,r){return new Hd(t,e,n,i,r).apply()}(i,r,o,t.extractedUrl,s).pipe(E(e=>Object.assign(Object.assign({},t),{urlAfterRedirects:e}))))),Gu(t=>{this.currentNavigation=Object.assign(Object.assign({},this.currentNavigation),{finalUrl:t.urlAfterRedirects})}),function(t,e,n,i,r){return U(o=>function(t,e,n,i,r="emptyOnly",o="legacy"){try{const s=new ip(t,e,n,i,r,o).recognize();return null===s?np(new ep):nu(s)}catch(s){return np(s)}}(t,e,o.urlAfterRedirects,n(o.urlAfterRedirects),i,r).pipe(E(t=>Object.assign(Object.assign({},o),{targetSnapshot:t}))))}(this.rootComponentType,this.config,t=>this.serializeUrl(t),this.paramsInheritanceStrategy,this.relativeLinkResolution),Gu(t=>{"eager"===this.urlUpdateStrategy&&(t.extras.skipLocationChange||this.setBrowserUrl(t.urlAfterRedirects,!!t.extras.replaceUrl,t.id,t.extras.state),this.browserUrlTree=t.urlAfterRedirects);const n=new eh(t.id,this.serializeUrl(t.extractedUrl),this.serializeUrl(t.urlAfterRedirects),t.targetSnapshot);e.next(n)}));var i,r,o,s;if(n&&this.rawUrlTree&&this.urlHandlingStrategy.shouldProcessUrl(this.rawUrlTree)){const{id:n,extractedUrl:i,source:r,restoredState:o,extras:s}=t,a=new Yu(n,this.serializeUrl(i),r,o);e.next(a);const l=Qh(i,this.rootComponentType).snapshot;return nu(Object.assign(Object.assign({},t),{targetSnapshot:l,urlAfterRedirects:i,extras:Object.assign(Object.assign({},s),{skipLocationChange:!1,replaceUrl:!1})}))}return this.rawUrlTree=t.rawUrl,this.browserUrlTree=t.urlAfterRedirects,t.resolve(null),du}),cp(t=>{const{targetSnapshot:e,id:n,extractedUrl:i,rawUrl:r,extras:{skipLocationChange:o,replaceUrl:s}}=t;return this.hooks.beforePreactivation(e,{navigationId:n,appliedUrlTree:i,rawUrlTree:r,skipLocationChange:!!o,replaceUrl:!!s})}),Gu(t=>{const e=new nh(t.id,this.serializeUrl(t.extractedUrl),this.serializeUrl(t.urlAfterRedirects),t.targetSnapshot);this.triggerEvent(e)}),E(t=>Object.assign(Object.assign({},t),{guards:Yd(t.targetSnapshot,t.currentSnapshot,this.rootContexts)})),function(t,e){return U(n=>{const{targetSnapshot:i,currentSnapshot:r,guards:{canActivateChecks:o,canDeactivateChecks:s}}=n;return 0===s.length&&0===o.length?nu(Object.assign(Object.assign({},n),{guardsResult:!0})):function(t,e,n,i){return R(t).pipe(U(t=>function(t,e,n,i,r){const o=e&&e.routeConfig?e.routeConfig.canDeactivate:null;return o&&0!==o.length?nu(o.map(o=>{const s=Jd(o,e,r);let a;if(function(t){return t&&Sd(t.canDeactivate)}(s))a=wh(s.canDeactivate(t,e,n,i));else{if(!Sd(s))throw new Error("Invalid CanDeactivate guard");a=wh(s(t,e,n,i))}return a.pipe(qu())})).pipe(Ad()):nu(!0)}(t.component,t.route,n,e,i)),qu(t=>!0!==t,!0))}(s,i,r,t).pipe(U(n=>n&&"boolean"==typeof n?function(t,e,n,i){return R(e).pipe(Ou(e=>hu(function(t,e){return null!==t&&e&&e(new lh(t)),nu(!0)}(e.route.parent,i),function(t,e){return null!==t&&e&&e(new uh(t)),nu(!0)}(e.route,i),function(t,e,n){const i=e[e.length-1],r=e.slice(0,e.length-1).reverse().map(t=>function(t){const e=t.routeConfig?t.routeConfig.canActivateChild:null;return e&&0!==e.length?{node:t,guards:e}:null}(t)).filter(t=>null!==t).map(e=>fu(()=>nu(e.guards.map(r=>{const o=Jd(r,e.node,n);let s;if(function(t){return t&&Sd(t.canActivateChild)}(o))s=wh(o.canActivateChild(i,t));else{if(!Sd(o))throw new Error("Invalid CanActivateChild guard");s=wh(o(i,t))}return s.pipe(qu())})).pipe(Ad())));return nu(r).pipe(Ad())}(t,e.path,n),function(t,e,n){const i=e.routeConfig?e.routeConfig.canActivate:null;return i&&0!==i.length?nu(i.map(i=>fu(()=>{const r=Jd(i,e,n);let o;if(function(t){return t&&Sd(t.canActivate)}(r))o=wh(r.canActivate(e,t));else{if(!Sd(r))throw new Error("Invalid CanActivate guard");o=wh(r(e,t))}return o.pipe(qu())}))).pipe(Ad()):nu(!0)}(t,e.route,n))),qu(t=>!0!==t,!0))}(i,o,t,e):nu(n)),E(t=>Object.assign(Object.assign({},n),{guardsResult:t})))})}(this.ngModule.injector,t=>this.triggerEvent(t)),Gu(t=>{if(Ed(t.guardsResult)){const e=mh(`Redirecting to "${this.serializeUrl(t.guardsResult)}"`);throw e.url=t.guardsResult,e}const e=new ih(t.id,this.serializeUrl(t.extractedUrl),this.serializeUrl(t.urlAfterRedirects),t.targetSnapshot,!!t.guardsResult);this.triggerEvent(e)}),Eu(t=>{if(!t.guardsResult){this.resetUrlToCurrentUrlTree();const n=new Qu(t.id,this.serializeUrl(t.extractedUrl),"");return e.next(n),t.resolve(!1),!1}return!0}),cp(t=>{if(t.guards.canActivateChecks.length)return nu(t).pipe(Gu(t=>{const e=new rh(t.id,this.serializeUrl(t.extractedUrl),this.serializeUrl(t.urlAfterRedirects),t.targetSnapshot);this.triggerEvent(e)}),mu(t=>{let n=!1;return nu(t).pipe((i=this.paramsInheritanceStrategy,r=this.ngModule.injector,U(t=>{const{targetSnapshot:e,guards:{canActivateChecks:n}}=t;if(!n.length)return nu(t);let o=0;return R(n).pipe(Ou(t=>function(t,e,n,i){return function(t,e,n,i){const r=Object.keys(t);if(0===r.length)return nu({});const o={};return R(r).pipe(U(r=>function(t,e,n,i){const r=Jd(t,e,i);return wh(r.resolve?r.resolve(e,n):r(e,n))}(t[r],e,n,i).pipe(Gu(t=>{o[r]=t}))),zu(1),U(()=>Object.keys(o).length===r.length?nu(o):du))}(t._resolve,t,e,i).pipe(E(e=>(t._resolvedData=e,t.data=Object.assign(Object.assign({},t.data),ed(t,n).resolve),null)))}(t.route,e,i,r)),Gu(()=>o++),zu(1),U(e=>o===n.length?nu(t):du))})),Gu({next:()=>n=!0,complete:()=>{if(!n){const n=new Qu(t.id,this.serializeUrl(t.extractedUrl),"At least one route resolver didn't emit any value.");e.next(n),t.resolve(!1)}}}));var i,r}),Gu(t=>{const e=new oh(t.id,this.serializeUrl(t.extractedUrl),this.serializeUrl(t.urlAfterRedirects),t.targetSnapshot);this.triggerEvent(e)}))}),cp(t=>{const{targetSnapshot:e,id:n,extractedUrl:i,rawUrl:r,extras:{skipLocationChange:o,replaceUrl:s}}=t;return this.hooks.afterPreactivation(e,{navigationId:n,appliedUrlTree:i,rawUrlTree:r,skipLocationChange:!!o,replaceUrl:!!s})}),E(t=>{const e=function(t,e,n){const i=ld(t,e._root,n?n._root:void 0);return new Jh(i,e)}(this.routeReuseStrategy,t.targetSnapshot,t.currentRouterState);return Object.assign(Object.assign({},t),{targetRouterState:e})}),Gu(t=>{this.currentUrlTree=t.urlAfterRedirects,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,t.rawUrl),this.routerState=t.targetRouterState,"deferred"===this.urlUpdateStrategy&&(t.extras.skipLocationChange||this.setBrowserUrl(this.rawUrlTree,!!t.extras.replaceUrl,t.id,t.extras.state),this.browserUrlTree=t.urlAfterRedirects)}),(o=this.rootContexts,s=this.routeReuseStrategy,a=t=>this.triggerEvent(t),E(t=>(new wd(s,t.targetRouterState,t.currentRouterState,a).activate(o),t))),Gu({next(){n=!0},complete(){n=!0}}),(r=()=>{if(!n&&!i){this.resetUrlToCurrentUrlTree();const n=new Qu(t.id,this.serializeUrl(t.extractedUrl),`Navigation ID ${t.id} is not equal to the current navigation id ${this.navigationId}`);e.next(n),t.resolve(!1)}this.currentNavigation=null},t=>t.lift(new Wu(r))),Iu(n=>{if(i=!0,(r=n)&&r.ngNavigationCancelingError){const i=Ed(n.url);i||(this.navigated=!0,this.resetStateAndUrl(t.currentRouterState,t.currentUrlTree,t.rawUrl));const r=new Qu(t.id,this.serializeUrl(t.extractedUrl),n.message);e.next(r),i?setTimeout(()=>{const e=this.urlHandlingStrategy.merge(n.url,this.rawUrlTree);this.scheduleNavigation(e,"imperative",null,{skipLocationChange:t.extras.skipLocationChange,replaceUrl:"eager"===this.urlUpdateStrategy},{resolve:t.resolve,reject:t.reject,promise:t.promise})},0):t.resolve(!1)}else{this.resetStateAndUrl(t.currentRouterState,t.currentUrlTree,t.rawUrl);const i=new th(t.id,this.serializeUrl(t.extractedUrl),n);e.next(i);try{t.resolve(this.errorHandler(n))}catch(o){t.reject(o)}}var r;return du}));var r,o,s,a}))}resetRootComponentType(t){this.rootComponentType=t,this.routerState.root.component=this.rootComponentType}getTransition(){const t=this.transitions.value;return t.urlAfterRedirects=this.browserUrlTree,t}setTransition(t){this.transitions.next(Object.assign(Object.assign({},this.getTransition()),t))}initialNavigation(){this.setUpLocationChangeListener(),0===this.navigationId&&this.navigateByUrl(this.location.path(!0),{replaceUrl:!0})}setUpLocationChangeListener(){this.locationSubscription||(this.locationSubscription=this.location.subscribe(t=>{const e=this.extractLocationChangeInfoFromEvent(t);this.shouldScheduleNavigation(this.lastLocationChangeInfo,e)&&setTimeout(()=>{const{source:t,state:n,urlTree:i}=e,r={replaceUrl:!0};if(n){const t=Object.assign({},n);delete t.navigationId,0!==Object.keys(t).length&&(r.state=t)}this.scheduleNavigation(i,t,n,r)},0),this.lastLocationChangeInfo=e}))}extractLocationChangeInfoFromEvent(t){var e;return{source:"popstate"===t.type?"popstate":"hashchange",urlTree:this.parseUrl(t.url),state:(null===(e=t.state)||void 0===e?void 0:e.navigationId)?t.state:null,transitionId:this.getTransition().id}}shouldScheduleNavigation(t,e){if(!t)return!0;const n=e.urlTree.toString()===t.urlTree.toString();return!(e.transitionId===t.transitionId&&n&&("hashchange"===e.source&&"popstate"===t.source||"popstate"===e.source&&"hashchange"===t.source))}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.currentNavigation}triggerEvent(t){this.events.next(t)}resetConfig(t){Pd(t),this.config=t.map(zd),this.navigated=!1,this.lastSuccessfulId=-1}ngOnDestroy(){this.dispose()}dispose(){this.locationSubscription&&(this.locationSubscription.unsubscribe(),this.locationSubscription=void 0)}createUrlTree(t,e={}){const{relativeTo:n,queryParams:i,fragment:r,queryParamsHandling:o,preserveFragment:s}=e,a=n||this.routerState.root,l=s?this.currentUrlTree.fragment:r;let c=null;switch(o){case"merge":c=Object.assign(Object.assign({},this.currentUrlTree.queryParams),i);break;case"preserve":c=this.currentUrlTree.queryParams;break;default:c=i||null}return null!==c&&(c=this.removeEmptyProps(c)),function(t,e,n,i,r){if(0===n.length)return dd(e.root,e.root,e,i,r);const o=function(t){if("string"==typeof t[0]&&1===t.length&&"/"===t[0])return new fd(!0,0,t);let e=0,n=!1;const i=t.reduce((t,i,r)=>{if("object"==typeof i&&null!=i){if(i.outlets){const e={};return bh(i.outlets,(t,n)=>{e[n]="string"==typeof t?t.split("/"):t}),[...t,{outlets:e}]}if(i.segmentPath)return[...t,i.segmentPath]}return"string"!=typeof i?[...t,i]:0===r?(i.split("/").forEach((i,r)=>{0==r&&"."===i||(0==r&&""===i?n=!0:".."===i?e++:""!=i&&t.push(i))}),t):[...t,i]},[]);return new fd(n,e,i)}(n);if(o.toRoot())return dd(e.root,new Ah([],{}),e,i,r);const s=function(t,e,n){if(t.isAbsolute)return new md(e.root,!0,0);if(-1===n.snapshot._lastPathIndex){const t=n.snapshot._urlSegment;return new md(t,t===e.root,0)}const i=ud(t.commands[0])?0:1;return function(t,e,n){let i=t,r=e,o=n;for(;o>r;){if(o-=r,i=i.parent,!i)throw new Error("Invalid number of '../'");r=i.segments.length}return new md(i,!1,r-o)}(n.snapshot._urlSegment,n.snapshot._lastPathIndex+i,t.numberOfDoubleDots)}(o,e,t),a=s.processChildren?_d(s.segmentGroup,s.index,o.commands):gd(s.segmentGroup,s.index,o.commands);return dd(s.segmentGroup,a,e,i,r)}(a,this.currentUrlTree,t,c,l)}navigateByUrl(t,e={skipLocationChange:!1}){const n=Ed(t)?t:this.parseUrl(t),i=this.urlHandlingStrategy.merge(n,this.rawUrlTree);return this.scheduleNavigation(i,"imperative",null,e)}navigate(t,e={skipLocationChange:!1}){return function(t){for(let e=0;e<t.length;e++){const n=t[e];if(null==n)throw new Error(`The requested path contains ${n} segment at index ${e}`)}}(t),this.navigateByUrl(this.createUrlTree(t,e),e)}serializeUrl(t){return this.urlSerializer.serialize(t)}parseUrl(t){let e;try{e=this.urlSerializer.parse(t)}catch(n){e=this.malformedUriErrorHandler(n,this.urlSerializer,t)}return e}isActive(t,e){if(Ed(t))return Ch(this.currentUrlTree,t,e);const n=this.parseUrl(t);return Ch(this.currentUrlTree,n,e)}removeEmptyProps(t){return Object.keys(t).reduce((e,n)=>{const i=t[n];return null!=i&&(e[n]=i),e},{})}processNavigations(){this.navigations.subscribe(t=>{this.navigated=!0,this.lastSuccessfulId=t.id,this.events.next(new Ju(t.id,this.serializeUrl(t.extractedUrl),this.serializeUrl(this.currentUrlTree))),this.lastSuccessfulNavigation=this.currentNavigation,this.currentNavigation=null,t.resolve(!0)},t=>{this.console.warn("Unhandled Navigation Error: ")})}scheduleNavigation(t,e,n,i,r){const o=this.getTransition(),s="imperative"!==e&&"imperative"===(null==o?void 0:o.source),a=(this.lastSuccessfulId===o.id||this.currentNavigation?o.rawUrl:o.urlAfterRedirects).toString()===t.toString();if(s&&a)return Promise.resolve(!0);let l,c,u;r?(l=r.resolve,c=r.reject,u=r.promise):u=new Promise((t,e)=>{l=t,c=e});const h=++this.navigationId;return this.setTransition({id:h,source:e,restoredState:n,currentUrlTree:this.currentUrlTree,currentRawUrl:this.rawUrlTree,rawUrl:t,extras:i,resolve:l,reject:c,promise:u,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),u.catch(t=>Promise.reject(t))}setBrowserUrl(t,e,n,i){const r=this.urlSerializer.serialize(t);i=i||{},this.location.isCurrentPathEqualTo(r)||e?this.location.replaceState(r,"",Object.assign(Object.assign({},i),{navigationId:n})):this.location.go(r,"",Object.assign(Object.assign({},i),{navigationId:n}))}resetStateAndUrl(t,e,n){this.routerState=t,this.currentUrlTree=e,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,n),this.resetUrlToCurrentUrlTree()}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",{navigationId:this.lastSuccessfulId})}}return t.\u0275fac=function(e){return new(e||t)(ui(qn),ui(Mh),ui(fp),ui(Fc),ui(Co),ui(dc),ui(Ul),ui(void 0))},t.\u0275prov=at({token:t,factory:t.\u0275fac}),t})(),xp=(()=>{class t{constructor(t,e,n,i,r){this.router=t,this.route=e,this.commands=[],this.onChanges=new C,null==n&&i.setAttribute(r.nativeElement,"tabindex","0")}ngOnChanges(t){this.onChanges.next(this)}set routerLink(t){this.commands=null!=t?Array.isArray(t)?t:[t]:[]}onClick(){const t={skipLocationChange:wp(this.skipLocationChange),replaceUrl:wp(this.replaceUrl),state:this.state};return this.router.navigateByUrl(this.urlTree,t),!0}get urlTree(){return this.router.createUrlTree(this.commands,{relativeTo:this.route,queryParams:this.queryParams,fragment:this.fragment,queryParamsHandling:this.queryParamsHandling,preserveFragment:wp(this.preserveFragment)})}}return t.\u0275fac=function(e){return new(e||t)(jo(vp),jo(td),Vn("tabindex"),jo(ea),jo(Qs))},t.\u0275dir=$t({type:t,selectors:[["","routerLink","",5,"a",5,"area"]],hostBindings:function(t,e){1&t&&ts("click",function(){return e.onClick()})},inputs:{routerLink:"routerLink",queryParams:"queryParams",fragment:"fragment",queryParamsHandling:"queryParamsHandling",preserveFragment:"preserveFragment",skipLocationChange:"skipLocationChange",replaceUrl:"replaceUrl",state:"state"},features:[oe]}),t})(),bp=(()=>{class t{constructor(t,e,n){this.router=t,this.route=e,this.locationStrategy=n,this.commands=[],this.onChanges=new C,this.subscription=t.events.subscribe(t=>{t instanceof Ju&&this.updateTargetUrlAndHref()})}set routerLink(t){this.commands=null!=t?Array.isArray(t)?t:[t]:[]}ngOnChanges(t){this.updateTargetUrlAndHref(),this.onChanges.next(this)}ngOnDestroy(){this.subscription.unsubscribe()}onClick(t,e,n,i,r){if(0!==t||e||n||i||r)return!0;if("string"==typeof this.target&&"_self"!=this.target)return!0;const o={skipLocationChange:wp(this.skipLocationChange),replaceUrl:wp(this.replaceUrl),state:this.state};return this.router.navigateByUrl(this.urlTree,o),!1}updateTargetUrlAndHref(){this.href=this.locationStrategy.prepareExternalUrl(this.router.serializeUrl(this.urlTree))}get urlTree(){return this.router.createUrlTree(this.commands,{relativeTo:this.route,queryParams:this.queryParams,fragment:this.fragment,queryParamsHandling:this.queryParamsHandling,preserveFragment:wp(this.preserveFragment)})}}return t.\u0275fac=function(e){return new(e||t)(jo(vp),jo(td),jo(Oc))},t.\u0275dir=$t({type:t,selectors:[["a","routerLink",""],["area","routerLink",""]],hostVars:2,hostBindings:function(t,e){1&t&&ts("click",function(t){return e.onClick(t.button,t.ctrlKey,t.shiftKey,t.altKey,t.metaKey)}),2&t&&(Ms("href",e.href,_i),Bo("target",e.target))},inputs:{routerLink:"routerLink",target:"target",queryParams:"queryParams",fragment:"fragment",queryParamsHandling:"queryParamsHandling",preserveFragment:"preserveFragment",skipLocationChange:"skipLocationChange",replaceUrl:"replaceUrl",state:"state"},features:[oe]}),t})();function wp(t){return""===t||!!t}let Cp=(()=>{class t{constructor(t,e,n,i,r,o){this.router=t,this.element=e,this.renderer=n,this.cdr=i,this.link=r,this.linkWithHref=o,this.classes=[],this.isActive=!1,this.routerLinkActiveOptions={exact:!1},this.routerEventsSubscription=t.events.subscribe(t=>{t instanceof Ju&&this.update()})}ngAfterContentInit(){nu(this.links.changes,this.linksWithHrefs.changes,nu(null)).pipe(q()).subscribe(t=>{this.update(),this.subscribeToEachLinkOnChanges()})}subscribeToEachLinkOnChanges(){var t;null===(t=this.linkInputChangesSubscription)||void 0===t||t.unsubscribe();const e=[...this.links.toArray(),...this.linksWithHrefs.toArray(),this.link,this.linkWithHref].filter(t=>!!t).map(t=>t.onChanges);this.linkInputChangesSubscription=R(e).pipe(q()).subscribe(t=>{this.isActive!==this.isLinkActive(this.router)(t)&&this.update()})}set routerLinkActive(t){const e=Array.isArray(t)?t:t.split(" ");this.classes=e.filter(t=>!!t)}ngOnChanges(t){this.update()}ngOnDestroy(){var t;this.routerEventsSubscription.unsubscribe(),null===(t=this.linkInputChangesSubscription)||void 0===t||t.unsubscribe()}update(){this.links&&this.linksWithHrefs&&this.router.navigated&&Promise.resolve().then(()=>{const t=this.hasActiveLinks();this.isActive!==t&&(this.isActive=t,this.cdr.markForCheck(),this.classes.forEach(e=>{t?this.renderer.addClass(this.element.nativeElement,e):this.renderer.removeClass(this.element.nativeElement,e)}))})}isLinkActive(t){return e=>t.isActive(e.urlTree,this.routerLinkActiveOptions.exact)}hasActiveLinks(){const t=this.isLinkActive(this.router);return this.link&&t(this.link)||this.linkWithHref&&t(this.linkWithHref)||this.links.some(t)||this.linksWithHrefs.some(t)}}return t.\u0275fac=function(e){return new(e||t)(jo(vp),jo(Qs),jo(ea),jo(wa),jo(xp,8),jo(bp,8))},t.\u0275dir=$t({type:t,selectors:[["","routerLinkActive",""]],contentQueries:function(t,e,n){if(1&t&&(gl(n,xp,!0),gl(n,bp,!0)),2&t){let t;pl(t=_l())&&(e.links=t),pl(t=_l())&&(e.linksWithHrefs=t)}},inputs:{routerLinkActiveOptions:"routerLinkActiveOptions",routerLinkActive:"routerLinkActive"},exportAs:["routerLinkActive"],features:[oe]}),t})(),Tp=(()=>{class t{constructor(t,e,n,i,r){this.parentContexts=t,this.location=e,this.resolver=n,this.changeDetector=r,this.activated=null,this._activatedRoute=null,this.activateEvents=new el,this.deactivateEvents=new el,this.name=i||"primary",t.onChildOutletCreated(this.name,this)}ngOnDestroy(){this.parentContexts.onChildOutletDestroyed(this.name)}ngOnInit(){if(!this.activated){const t=this.parentContexts.getContext(this.name);t&&t.route&&(t.attachRef?this.attach(t.attachRef,t.route):this.activateWith(t.route,t.resolver||null))}}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new Error("Outlet is not activated");return this.activated.instance}get activatedRoute(){if(!this.activated)throw new Error("Outlet is not activated");return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new Error("Outlet is not activated");this.location.detach();const t=this.activated;return this.activated=null,this._activatedRoute=null,t}attach(t,e){this.activated=t,this._activatedRoute=e,this.location.insert(t.hostView)}deactivate(){if(this.activated){const t=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(t)}}activateWith(t,e){if(this.isActivated)throw new Error("Cannot activate an already activated outlet");this._activatedRoute=t;const n=(e=e||this.resolver).resolveComponentFactory(t._futureSnapshot.routeConfig.component),i=this.parentContexts.getOrCreateContext(this.name).children,r=new Sp(t,i,this.location.injector);this.activated=this.location.createComponent(n,this.location.length,r),this.changeDetector.markForCheck(),this.activateEvents.emit(this.activated.instance)}}return t.\u0275fac=function(e){return new(e||t)(jo(fp),jo(Da),jo(Xs),Vn("name"),jo(wa))},t.\u0275dir=$t({type:t,selectors:[["router-outlet"]],outputs:{activateEvents:"activate",deactivateEvents:"deactivate"},exportAs:["outlet"]}),t})();class Sp{constructor(t,e,n){this.route=t,this.childContexts=e,this.parent=n}get(t,e){return t===td?this.route:t===fp?this.childContexts:this.parent.get(t,e)}}class Ep{}class kp{preload(t,e){return nu(null)}}let Ap=(()=>{class t{constructor(t,e,n,i,r){this.router=t,this.injector=i,this.preloadingStrategy=r,this.loader=new dp(e,n,e=>t.triggerEvent(new sh(e)),e=>t.triggerEvent(new ah(e)))}setUpPreloading(){this.subscription=this.router.events.pipe(Eu(t=>t instanceof Ju),Ou(()=>this.preload())).subscribe(()=>{})}preload(){const t=this.injector.get(Ma);return this.processRoutes(t,this.router.config)}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}processRoutes(t,e){const n=[];for(const i of e)if(i.loadChildren&&!i.canLoad&&i._loadedConfig){const t=i._loadedConfig;n.push(this.processRoutes(t.module,t.routes))}else i.loadChildren&&!i.canLoad?n.push(this.preloadConfig(t,i)):i.children&&n.push(this.processRoutes(t,i.children));return R(n).pipe(q(),E(t=>{}))}preloadConfig(t,e){return this.preloadingStrategy.preload(e,()=>this.loader.load(t.injector,e).pipe(U(t=>(e._loadedConfig=t,this.processRoutes(t.module,t.routes)))))}}return t.\u0275fac=function(e){return new(e||t)(ui(vp),ui(dc),ui(Ul),ui(Co),ui(Ep))},t.\u0275prov=at({token:t,factory:t.\u0275fac}),t})(),Ip=(()=>{class t{constructor(t,e,n={}){this.router=t,this.viewportScroller=e,this.options=n,this.lastId=0,this.lastSource="imperative",this.restoredId=0,this.store={},n.scrollPositionRestoration=n.scrollPositionRestoration||"disabled",n.anchorScrolling=n.anchorScrolling||"disabled"}init(){"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.setHistoryScrollRestoration("manual"),this.routerEventsSubscription=this.createScrollEvents(),this.scrollEventsSubscription=this.consumeScrollEvents()}createScrollEvents(){return this.router.events.subscribe(t=>{t instanceof Yu?(this.store[this.lastId]=this.viewportScroller.getScrollPosition(),this.lastSource=t.navigationTrigger,this.restoredId=t.restoredState?t.restoredState.navigationId:0):t instanceof Ju&&(this.lastId=t.id,this.scheduleScrollEvent(t,this.router.parseUrl(t.urlAfterRedirects).fragment))})}consumeScrollEvents(){return this.router.events.subscribe(t=>{t instanceof dh&&(t.position?"top"===this.options.scrollPositionRestoration?this.viewportScroller.scrollToPosition([0,0]):"enabled"===this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition(t.position):t.anchor&&"enabled"===this.options.anchorScrolling?this.viewportScroller.scrollToAnchor(t.anchor):"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition([0,0]))})}scheduleScrollEvent(t,e){this.router.triggerEvent(new dh(t,"popstate"===this.lastSource?this.store[this.restoredId]:null,e))}ngOnDestroy(){this.routerEventsSubscription&&this.routerEventsSubscription.unsubscribe(),this.scrollEventsSubscription&&this.scrollEventsSubscription.unsubscribe()}}return t.\u0275fac=function(e){return new(e||t)(ui(vp),ui(Qc),ui(void 0))},t.\u0275prov=at({token:t,factory:t.\u0275fac}),t})();const Pp=new Nn("ROUTER_CONFIGURATION"),Mp=new Nn("ROUTER_FORROOT_GUARD"),Op=[Fc,{provide:Mh,useClass:Oh},{provide:vp,useFactory:function(t,e,n,i,r,o,s,a={},l,c){const u=new vp(null,t,e,n,i,r,o,vh(s));if(l&&(u.urlHandlingStrategy=l),c&&(u.routeReuseStrategy=c),function(t,e){t.errorHandler&&(e.errorHandler=t.errorHandler),t.malformedUriErrorHandler&&(e.malformedUriErrorHandler=t.malformedUriErrorHandler),t.onSameUrlNavigation&&(e.onSameUrlNavigation=t.onSameUrlNavigation),t.paramsInheritanceStrategy&&(e.paramsInheritanceStrategy=t.paramsInheritanceStrategy),t.relativeLinkResolution&&(e.relativeLinkResolution=t.relativeLinkResolution),t.urlUpdateStrategy&&(e.urlUpdateStrategy=t.urlUpdateStrategy)}(a,u),a.enableTracing){const t=bc();u.events.subscribe(e=>{t.logGroup("Router Event: "+e.constructor.name),t.log(e.toString()),t.log(e),t.logGroupEnd()})}return u},deps:[Mh,fp,Fc,Co,dc,Ul,hp,Pp,[class{},new Qn],[class{},new Qn]]},fp,{provide:td,useFactory:function(t){return t.routerState.root},deps:[vp]},{provide:dc,useClass:mc},Ap,kp,class{preload(t,e){return e().pipe(Iu(()=>nu(null)))}},{provide:Pp,useValue:{enableTracing:!1}}];function zp(){return new oc("Router",vp)}let Dp=(()=>{class t{constructor(t,e){}static forRoot(e,n){return{ngModule:t,providers:[Op,Bp(e),{provide:Mp,useFactory:Fp,deps:[[vp,new Qn,new ei]]},{provide:Pp,useValue:n||{}},{provide:Oc,useFactory:Rp,deps:[Cc,[new Jn(Dc),new Qn],Pp]},{provide:Ip,useFactory:Lp,deps:[vp,Qc,Pp]},{provide:Ep,useExisting:n&&n.preloadingStrategy?n.preloadingStrategy:kp},{provide:oc,multi:!0,useFactory:zp},[Vp,{provide:wl,multi:!0,useFactory:Up,deps:[Vp]},{provide:jp,useFactory:Np,deps:[Vp]},{provide:Il,multi:!0,useExisting:jp}]]}}static forChild(e){return{ngModule:t,providers:[Bp(e)]}}}return t.\u0275mod=jt({type:t}),t.\u0275inj=lt({factory:function(e){return new(e||t)(ui(Mp,8),ui(vp,8))}}),t})();function Lp(t,e,n){return n.scrollOffset&&e.setOffset(n.scrollOffset),new Ip(t,e,n)}function Rp(t,e,n={}){return n.useHash?new Rc(t,e):new Lc(t,e)}function Fp(t){return"guarded"}function Bp(t){return[{provide:jn,multi:!0,useValue:t},{provide:hp,multi:!0,useValue:t}]}let Vp=(()=>{class t{constructor(t){this.injector=t,this.initNavigation=!1,this.resultOfPreactivationDone=new C}appInitializer(){return this.injector.get(Sc,Promise.resolve(null)).then(()=>{let t=null;const e=new Promise(e=>t=e),n=this.injector.get(vp),i=this.injector.get(Pp);return"disabled"===i.initialNavigation?(n.setUpLocationChangeListener(),t(!0)):"enabled"===i.initialNavigation||"enabledBlocking"===i.initialNavigation?(n.hooks.afterPreactivation=()=>this.initNavigation?nu(null):(this.initNavigation=!0,t(!0),this.resultOfPreactivationDone),n.initialNavigation()):t(!0),e})}bootstrapListener(t){const e=this.injector.get(Pp),n=this.injector.get(Ap),i=this.injector.get(Ip),r=this.injector.get(vp),o=this.injector.get(uc);t===o.components[0]&&("enabledNonBlocking"!==e.initialNavigation&&void 0!==e.initialNavigation||r.initialNavigation(),n.setUpPreloading(),i.init(),r.resetRootComponentType(o.componentTypes[0]),this.resultOfPreactivationDone.next(null),this.resultOfPreactivationDone.complete())}}return t.\u0275fac=function(e){return new(e||t)(ui(Co))},t.\u0275prov=at({token:t,factory:t.\u0275fac}),t})();function Up(t){return t.appInitializer.bind(t)}function Np(t){return t.bootstrapListener.bind(t)}const jp=new Nn("Router Initializer");class qp extends class extends class{}{constructor(){super()}supportsDOMEvents(){return!0}}{static makeCurrent(){var t;t=new qp,xc||(xc=t)}getProperty(t,e){return t[e]}log(t){window.console&&window.console.log&&window.console.log(t)}logGroup(t){window.console&&window.console.group&&window.console.group(t)}logGroupEnd(){window.console&&window.console.groupEnd&&window.console.groupEnd()}onAndCancel(t,e,n){return t.addEventListener(e,n,!1),()=>{t.removeEventListener(e,n,!1)}}dispatchEvent(t,e){t.dispatchEvent(e)}remove(t){return t.parentNode&&t.parentNode.removeChild(t),t}getValue(t){return t.value}createElement(t,e){return(e=e||this.getDefaultDocument()).createElement(t)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(t){return t.nodeType===Node.ELEMENT_NODE}isShadowRoot(t){return t instanceof DocumentFragment}getGlobalEventTarget(t,e){return"window"===e?window:"document"===e?t:"body"===e?t.body:null}getHistory(){return window.history}getLocation(){return window.location}getBaseHref(t){const e=Gp||(Gp=document.querySelector("base"),Gp)?Gp.getAttribute("href"):null;return null==e?null:(n=e,$p||($p=document.createElement("a")),$p.setAttribute("href",n),"/"===$p.pathname.charAt(0)?$p.pathname:"/"+$p.pathname);var n}resetBaseElement(){Gp=null}getUserAgent(){return window.navigator.userAgent}performanceNow(){return window.performance&&window.performance.now?window.performance.now():(new Date).getTime()}supportsCookies(){return!0}getCookie(t){return qc(document.cookie,t)}}let $p,Gp=null;const Zp=new Nn("TRANSITION_ID"),Hp=[{provide:wl,useFactory:function(t,e,n){return()=>{n.get(Cl).donePromise.then(()=>{const n=bc();Array.prototype.slice.apply(e.querySelectorAll("style[ng-transition]")).filter(e=>e.getAttribute("ng-transition")===t).forEach(t=>n.remove(t))})}},deps:[Zp,wc,Co],multi:!0}];class Wp{static init(){var t;t=new Wp,tc=t}addToWindow(t){kt.getAngularTestability=(e,n=!0)=>{const i=t.findTestabilityInTree(e,n);if(null==i)throw new Error("Could not find testability for element.");return i},kt.getAllAngularTestabilities=()=>t.getAllTestabilities(),kt.getAllAngularRootElements=()=>t.getAllRootElements(),kt.frameworkStabilizers||(kt.frameworkStabilizers=[]),kt.frameworkStabilizers.push(t=>{const e=kt.getAllAngularTestabilities();let n=e.length,i=!1;const r=function(e){i=i||e,n--,0==n&&t(i)};e.forEach(function(t){t.whenStable(r)})})}findTestabilityInTree(t,e,n){if(null==e)return null;const i=t.getTestability(e);return null!=i?i:n?bc().isShadowRoot(e)?this.findTestabilityInTree(t,e.host,!0):this.findTestabilityInTree(t,e.parentElement,!0):null}}const Xp=new Nn("EventManagerPlugins");let Kp=(()=>{class t{constructor(t,e){this._zone=e,this._eventNameToPlugin=new Map,t.forEach(t=>t.manager=this),this._plugins=t.slice().reverse()}addEventListener(t,e,n){return this._findPluginFor(e).addEventListener(t,e,n)}addGlobalEventListener(t,e,n){return this._findPluginFor(e).addGlobalEventListener(t,e,n)}getZone(){return this._zone}_findPluginFor(t){const e=this._eventNameToPlugin.get(t);if(e)return e;const n=this._plugins;for(let i=0;i<n.length;i++){const e=n[i];if(e.supports(t))return this._eventNameToPlugin.set(t,e),e}throw new Error("No event manager plugin found for event "+t)}}return t.\u0275fac=function(e){return new(e||t)(ui(Xp),ui(ql))},t.\u0275prov=at({token:t,factory:t.\u0275fac}),t})();class Yp{constructor(t){this._doc=t}addGlobalEventListener(t,e,n){const i=bc().getGlobalEventTarget(this._doc,t);if(!i)throw new Error(`Unsupported event target ${i} for event ${e}`);return this.addEventListener(i,e,n)}}let Jp=(()=>{class t{constructor(){this._stylesSet=new Set}addStyles(t){const e=new Set;t.forEach(t=>{this._stylesSet.has(t)||(this._stylesSet.add(t),e.add(t))}),this.onStylesAdded(e)}onStylesAdded(t){}getAllStyles(){return Array.from(this._stylesSet)}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=at({token:t,factory:t.\u0275fac}),t})(),Qp=(()=>{class t extends Jp{constructor(t){super(),this._doc=t,this._hostNodes=new Set,this._styleNodes=new Set,this._hostNodes.add(t.head)}_addStylesToHost(t,e){t.forEach(t=>{const n=this._doc.createElement("style");n.textContent=t,this._styleNodes.add(e.appendChild(n))})}addHost(t){this._addStylesToHost(this._stylesSet,t),this._hostNodes.add(t)}removeHost(t){this._hostNodes.delete(t)}onStylesAdded(t){this._hostNodes.forEach(e=>this._addStylesToHost(t,e))}ngOnDestroy(){this._styleNodes.forEach(t=>bc().remove(t))}}return t.\u0275fac=function(e){return new(e||t)(ui(wc))},t.\u0275prov=at({token:t,factory:t.\u0275fac}),t})();const tf={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"},ef=/%COMP%/g;function nf(t,e,n){for(let i=0;i<e.length;i++){let r=e[i];Array.isArray(r)?nf(t,r,n):(r=r.replace(ef,t),n.push(r))}return n}function rf(t){return e=>{if("__ngUnwrap__"===e)return t;!1===t(e)&&(e.preventDefault(),e.returnValue=!1)}}let of=(()=>{class t{constructor(t,e,n){this.eventManager=t,this.sharedStylesHost=e,this.appId=n,this.rendererByCompId=new Map,this.defaultRenderer=new sf(t)}createRenderer(t,e){if(!t||!e)return this.defaultRenderer;switch(e.encapsulation){case wt.Emulated:{let n=this.rendererByCompId.get(e.id);return n||(n=new af(this.eventManager,this.sharedStylesHost,e,this.appId),this.rendererByCompId.set(e.id,n)),n.applyToHost(t),n}case 1:case wt.ShadowDom:return new lf(this.eventManager,this.sharedStylesHost,t,e);default:if(!this.rendererByCompId.has(e.id)){const t=nf(e.id,e.styles,[]);this.sharedStylesHost.addStyles(t),this.rendererByCompId.set(e.id,this.defaultRenderer)}return this.defaultRenderer}}begin(){}end(){}}return t.\u0275fac=function(e){return new(e||t)(ui(Kp),ui(Qp),ui(Tl))},t.\u0275prov=at({token:t,factory:t.\u0275fac}),t})();class sf{constructor(t){this.eventManager=t,this.data=Object.create(null)}destroy(){}createElement(t,e){return e?document.createElementNS(tf[e]||e,t):document.createElement(t)}createComment(t){return document.createComment(t)}createText(t){return document.createTextNode(t)}appendChild(t,e){t.appendChild(e)}insertBefore(t,e,n){t&&t.insertBefore(e,n)}removeChild(t,e){t&&t.removeChild(e)}selectRootElement(t,e){let n="string"==typeof t?document.querySelector(t):t;if(!n)throw new Error(`The selector "${t}" did not match any elements`);return e||(n.textContent=""),n}parentNode(t){return t.parentNode}nextSibling(t){return t.nextSibling}setAttribute(t,e,n,i){if(i){e=i+":"+e;const r=tf[i];r?t.setAttributeNS(r,e,n):t.setAttribute(e,n)}else t.setAttribute(e,n)}removeAttribute(t,e,n){if(n){const i=tf[n];i?t.removeAttributeNS(i,e):t.removeAttribute(`${n}:${e}`)}else t.removeAttribute(e)}addClass(t,e){t.classList.add(e)}removeClass(t,e){t.classList.remove(e)}setStyle(t,e,n,i){i&(Si.DashCase|Si.Important)?t.style.setProperty(e,n,i&Si.Important?"important":""):t.style[e]=n}removeStyle(t,e,n){n&Si.DashCase?t.style.removeProperty(e):t.style[e]=""}setProperty(t,e,n){t[e]=n}setValue(t,e){t.nodeValue=e}listen(t,e,n){return"string"==typeof t?this.eventManager.addGlobalEventListener(t,e,rf(n)):this.eventManager.addEventListener(t,e,rf(n))}}class af extends sf{constructor(t,e,n,i){super(t),this.component=n;const r=nf(i+"-"+n.id,n.styles,[]);e.addStyles(r),this.contentAttr="_ngcontent-%COMP%".replace(ef,i+"-"+n.id),this.hostAttr="_nghost-%COMP%".replace(ef,i+"-"+n.id)}applyToHost(t){super.setAttribute(t,this.hostAttr,"")}createElement(t,e){const n=super.createElement(t,e);return super.setAttribute(n,this.contentAttr,""),n}}class lf extends sf{constructor(t,e,n,i){super(t),this.sharedStylesHost=e,this.hostEl=n,this.shadowRoot=n.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);const r=nf(i.id,i.styles,[]);for(let o=0;o<r.length;o++){const t=document.createElement("style");t.textContent=r[o],this.shadowRoot.appendChild(t)}}nodeOrShadowRoot(t){return t===this.hostEl?this.shadowRoot:t}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}appendChild(t,e){return super.appendChild(this.nodeOrShadowRoot(t),e)}insertBefore(t,e,n){return super.insertBefore(this.nodeOrShadowRoot(t),e,n)}removeChild(t,e){return super.removeChild(this.nodeOrShadowRoot(t),e)}parentNode(t){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(t)))}}let cf=(()=>{class t extends Yp{constructor(t){super(t)}supports(t){return!0}addEventListener(t,e,n){return t.addEventListener(e,n,!1),()=>this.removeEventListener(t,e,n)}removeEventListener(t,e,n){return t.removeEventListener(e,n)}}return t.\u0275fac=function(e){return new(e||t)(ui(wc))},t.\u0275prov=at({token:t,factory:t.\u0275fac}),t})();const uf=["alt","control","meta","shift"],hf={"\b":"Backspace","\t":"Tab","\x7f":"Delete","\x1b":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},df={A:"1",B:"2",C:"3",D:"4",E:"5",F:"6",G:"7",H:"8",I:"9",J:"*",K:"+",M:"-",N:".",O:"/","`":"0","\x90":"NumLock"},pf={alt:t=>t.altKey,control:t=>t.ctrlKey,meta:t=>t.metaKey,shift:t=>t.shiftKey};let ff=(()=>{class t extends Yp{constructor(t){super(t)}supports(e){return null!=t.parseEventName(e)}addEventListener(e,n,i){const r=t.parseEventName(n),o=t.eventCallback(r.fullKey,i,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>bc().onAndCancel(e,r.domEventName,o))}static parseEventName(e){const n=e.toLowerCase().split("."),i=n.shift();if(0===n.length||"keydown"!==i&&"keyup"!==i)return null;const r=t._normalizeKey(n.pop());let o="";if(uf.forEach(t=>{const e=n.indexOf(t);e>-1&&(n.splice(e,1),o+=t+".")}),o+=r,0!=n.length||0===r.length)return null;const s={};return s.domEventName=i,s.fullKey=o,s}static getEventFullKey(t){let e="",n=function(t){let e=t.key;if(null==e){if(e=t.keyIdentifier,null==e)return"Unidentified";e.startsWith("U+")&&(e=String.fromCharCode(parseInt(e.substring(2),16)),3===t.location&&df.hasOwnProperty(e)&&(e=df[e]))}return hf[e]||e}(t);return n=n.toLowerCase()," "===n?n="space":"."===n&&(n="dot"),uf.forEach(i=>{i!=n&&(0,pf[i])(t)&&(e+=i+".")}),e+=n,e}static eventCallback(e,n,i){return r=>{t.getEventFullKey(r)===e&&i.runGuarded(()=>n(r))}}static _normalizeKey(t){switch(t){case"esc":return"escape";default:return t}}}return t.\u0275fac=function(e){return new(e||t)(ui(wc))},t.\u0275prov=at({token:t,factory:t.\u0275fac}),t})();const mf=sc(_c,"browser",[{provide:Al,useValue:"browser"},{provide:kl,useValue:function(){qp.makeCurrent(),Wp.init()},multi:!0},{provide:wc,useFactory:function(){return function(t){ue=t}(document),document},deps:[]}]),gf=[[],{provide:lo,useValue:"root"},{provide:bi,useFactory:function(){return new bi},deps:[]},{provide:Xp,useClass:cf,multi:!0,deps:[wc,ql,Al]},{provide:Xp,useClass:ff,multi:!0,deps:[wc]},[],{provide:of,useClass:of,deps:[Kp,Qp,Tl]},{provide:ta,useExisting:of},{provide:Jp,useExisting:Qp},{provide:Qp,useClass:Qp,deps:[wc]},{provide:Kl,useClass:Kl,deps:[ql]},{provide:Kp,useClass:Kp,deps:[Xp,ql]},[]];let _f=(()=>{class t{constructor(t){if(t)throw new Error("BrowserModule has already been loaded. If you need access to common directives such as NgIf and NgFor from a lazy loaded module, import CommonModule instead.")}static withServerTransition(e){return{ngModule:t,providers:[{provide:Tl,useValue:e.appId},{provide:Zp,useExisting:Tl},Hp]}}}return t.\u0275mod=jt({type:t}),t.\u0275inj=lt({factory:function(e){return new(e||t)(ui(t,12))},providers:gf,imports:[Jc,vc]}),t})();"undefined"!=typeof window&&window;class yf{static valor(t){var e=t.value;return"n"==String(e).charAt(0)||e<=0?{valor:!0}:null}}function vf(t,e){return new y(n=>{const i=t.length;if(0===i)return void n.complete();const r=new Array(i);let o=0,s=0;for(let a=0;a<i;a++){const l=R(t[a]);let c=!1;n.add(l.subscribe({next:t=>{c||(c=!0,s++),r[a]=t},error:t=>n.error(t),complete:()=>{o++,o!==i&&c||(s===i&&n.next(e?e.reduce((t,e,n)=>(t[e]=r[n],t),{}):r),n.complete())}}))}})}const xf=new Nn("NgValueAccessor"),bf={provide:xf,useExisting:rt(()=>wf),multi:!0};let wf=(()=>{class t{constructor(t,e){this._renderer=t,this._elementRef=e,this.onChange=t=>{},this.onTouched=()=>{}}writeValue(t){this._renderer.setProperty(this._elementRef.nativeElement,"checked",t)}registerOnChange(t){this.onChange=t}registerOnTouched(t){this.onTouched=t}setDisabledState(t){this._renderer.setProperty(this._elementRef.nativeElement,"disabled",t)}}return t.\u0275fac=function(e){return new(e||t)(jo(ea),jo(Qs))},t.\u0275dir=$t({type:t,selectors:[["input","type","checkbox","formControlName",""],["input","type","checkbox","formControl",""],["input","type","checkbox","ngModel",""]],hostBindings:function(t,e){1&t&&ts("change",function(t){return e.onChange(t.target.checked)})("blur",function(){return e.onTouched()})},features:[Zs([bf])]}),t})();const Cf={provide:xf,useExisting:rt(()=>Sf),multi:!0},Tf=new Nn("CompositionEventMode");let Sf=(()=>{class t{constructor(t,e,n){this._renderer=t,this._elementRef=e,this._compositionMode=n,this.onChange=t=>{},this.onTouched=()=>{},this._composing=!1,null==this._compositionMode&&(this._compositionMode=!function(){const t=bc()?bc().getUserAgent():"";return/android (\d+)/.test(t.toLowerCase())}())}writeValue(t){this._renderer.setProperty(this._elementRef.nativeElement,"value",null==t?"":t)}registerOnChange(t){this.onChange=t}registerOnTouched(t){this.onTouched=t}setDisabledState(t){this._renderer.setProperty(this._elementRef.nativeElement,"disabled",t)}_handleInput(t){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(t)}_compositionStart(){this._composing=!0}_compositionEnd(t){this._composing=!1,this._compositionMode&&this.onChange(t)}}return t.\u0275fac=function(e){return new(e||t)(jo(ea),jo(Qs),jo(Tf,8))},t.\u0275dir=$t({type:t,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function(t,e){1&t&&ts("input",function(t){return e._handleInput(t.target.value)})("blur",function(){return e.onTouched()})("compositionstart",function(){return e._compositionStart()})("compositionend",function(t){return e._compositionEnd(t.target.value)})},features:[Zs([Cf])]}),t})();function Ef(t){return null==t||0===t.length}function kf(t){return null!=t&&"number"==typeof t.length}const Af=new Nn("NgValidators"),If=new Nn("NgAsyncValidators"),Pf=/^(?=.{1,254}$)(?=.{1,64}@)[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+)*@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/;class Mf{static min(t){return e=>{if(Ef(e.value)||Ef(t))return null;const n=parseFloat(e.value);return!isNaN(n)&&n<t?{min:{min:t,actual:e.value}}:null}}static max(t){return e=>{if(Ef(e.value)||Ef(t))return null;const n=parseFloat(e.value);return!isNaN(n)&&n>t?{max:{max:t,actual:e.value}}:null}}static required(t){return Ef(t.value)?{required:!0}:null}static requiredTrue(t){return!0===t.value?null:{required:!0}}static email(t){return Ef(t.value)||Pf.test(t.value)?null:{email:!0}}static minLength(t){return e=>Ef(e.value)||!kf(e.value)?null:e.value.length<t?{minlength:{requiredLength:t,actualLength:e.value.length}}:null}static maxLength(t){return e=>kf(e.value)&&e.value.length>t?{maxlength:{requiredLength:t,actualLength:e.value.length}}:null}static pattern(t){if(!t)return Mf.nullValidator;let e,n;return"string"==typeof t?(n="","^"!==t.charAt(0)&&(n+="^"),n+=t,"$"!==t.charAt(t.length-1)&&(n+="$"),e=new RegExp(n)):(n=t.toString(),e=t),t=>{if(Ef(t.value))return null;const i=t.value;return e.test(i)?null:{pattern:{requiredPattern:n,actualValue:i}}}}static nullValidator(t){return null}static compose(t){if(!t)return null;const e=t.filter(Of);return 0==e.length?null:function(t){return Df(Lf(t,e))}}static composeAsync(t){if(!t)return null;const e=t.filter(Of);return 0==e.length?null:function(t){return function(...t){if(1===t.length){const e=t[0];if(l(e))return vf(e,null);if(c(e)&&Object.getPrototypeOf(e)===Object.prototype){const t=Object.keys(e);return vf(t.map(t=>e[t]),t)}}if("function"==typeof t[t.length-1]){const e=t.pop();return vf(t=1===t.length&&l(t[0])?t[0]:t,null).pipe(E(t=>e(...t)))}return vf(t,null)}(Lf(t,e).map(zf)).pipe(E(Df))}}}function Of(t){return null!=t}function zf(t){const e=Jo(t)?R(t):t;return Qo(e),e}function Df(t){let e={};return t.forEach(t=>{e=null!=t?Object.assign(Object.assign({},e),t):e}),0===Object.keys(e).length?null:e}function Lf(t,e){return e.map(e=>e(t))}function Rf(t){return t.map(t=>function(t){return!t.validate}(t)?t:e=>t.validate(e))}function Ff(t){return null!=t?Mf.compose(Rf(t)):null}function Bf(t){return null!=t?Mf.composeAsync(Rf(t)):null}function Vf(t,e){return null===t?[e]:Array.isArray(t)?[...t,e]:[t,e]}function Uf(t){return t._rawValidators}function Nf(t){return t._rawAsyncValidators}let jf=(()=>{class t{constructor(){this._rawValidators=[],this._rawAsyncValidators=[],this._onDestroyCallbacks=[]}get value(){return this.control?this.control.value:null}get valid(){return this.control?this.control.valid:null}get invalid(){return this.control?this.control.invalid:null}get pending(){return this.control?this.control.pending:null}get disabled(){return this.control?this.control.disabled:null}get enabled(){return this.control?this.control.enabled:null}get errors(){return this.control?this.control.errors:null}get pristine(){return this.control?this.control.pristine:null}get dirty(){return this.control?this.control.dirty:null}get touched(){return this.control?this.control.touched:null}get status(){return this.control?this.control.status:null}get untouched(){return this.control?this.control.untouched:null}get statusChanges(){return this.control?this.control.statusChanges:null}get valueChanges(){return this.control?this.control.valueChanges:null}get path(){return null}_setValidators(t){this._rawValidators=t||[],this._composedValidatorFn=Ff(this._rawValidators)}_setAsyncValidators(t){this._rawAsyncValidators=t||[],this._composedAsyncValidatorFn=Bf(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn||null}get asyncValidator(){return this._composedAsyncValidatorFn||null}_registerOnDestroy(t){this._onDestroyCallbacks.push(t)}_invokeOnDestroyCallbacks(){this._onDestroyCallbacks.forEach(t=>t()),this._onDestroyCallbacks=[]}reset(t){this.control&&this.control.reset(t)}hasError(t,e){return!!this.control&&this.control.hasError(t,e)}getError(t,e){return this.control?this.control.getError(t,e):null}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275dir=$t({type:t}),t})(),qf=(()=>{class t extends jf{get formDirective(){return null}get path(){return null}}return t.\u0275fac=function(e){return $f(e||t)},t.\u0275dir=$t({type:t,features:[So]}),t})();const $f=Bn(qf);class Gf extends jf{constructor(){super(...arguments),this._parent=null,this.name=null,this.valueAccessor=null}}class Zf{constructor(t){this._cd=t}get ngClassUntouched(){var t,e,n;return null!==(n=null===(e=null===(t=this._cd)||void 0===t?void 0:t.control)||void 0===e?void 0:e.untouched)&&void 0!==n&&n}get ngClassTouched(){var t,e,n;return null!==(n=null===(e=null===(t=this._cd)||void 0===t?void 0:t.control)||void 0===e?void 0:e.touched)&&void 0!==n&&n}get ngClassPristine(){var t,e,n;return null!==(n=null===(e=null===(t=this._cd)||void 0===t?void 0:t.control)||void 0===e?void 0:e.pristine)&&void 0!==n&&n}get ngClassDirty(){var t,e,n;return null!==(n=null===(e=null===(t=this._cd)||void 0===t?void 0:t.control)||void 0===e?void 0:e.dirty)&&void 0!==n&&n}get ngClassValid(){var t,e,n;return null!==(n=null===(e=null===(t=this._cd)||void 0===t?void 0:t.control)||void 0===e?void 0:e.valid)&&void 0!==n&&n}get ngClassInvalid(){var t,e,n;return null!==(n=null===(e=null===(t=this._cd)||void 0===t?void 0:t.control)||void 0===e?void 0:e.invalid)&&void 0!==n&&n}get ngClassPending(){var t,e,n;return null!==(n=null===(e=null===(t=this._cd)||void 0===t?void 0:t.control)||void 0===e?void 0:e.pending)&&void 0!==n&&n}}let Hf=(()=>{class t extends Zf{constructor(t){super(t)}}return t.\u0275fac=function(e){return new(e||t)(jo(Gf,2))},t.\u0275dir=$t({type:t,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function(t,e){2&t&&gs("ng-untouched",e.ngClassUntouched)("ng-touched",e.ngClassTouched)("ng-pristine",e.ngClassPristine)("ng-dirty",e.ngClassDirty)("ng-valid",e.ngClassValid)("ng-invalid",e.ngClassInvalid)("ng-pending",e.ngClassPending)},features:[So]}),t})(),Wf=(()=>{class t extends Zf{constructor(t){super(t)}}return t.\u0275fac=function(e){return new(e||t)(jo(qf,10))},t.\u0275dir=$t({type:t,selectors:[["","formGroupName",""],["","formArrayName",""],["","ngModelGroup",""],["","formGroup",""],["form",3,"ngNoForm",""],["","ngForm",""]],hostVars:14,hostBindings:function(t,e){2&t&&gs("ng-untouched",e.ngClassUntouched)("ng-touched",e.ngClassTouched)("ng-pristine",e.ngClassPristine)("ng-dirty",e.ngClassDirty)("ng-valid",e.ngClassValid)("ng-invalid",e.ngClassInvalid)("ng-pending",e.ngClassPending)},features:[So]}),t})();const Xf={provide:xf,useExisting:rt(()=>Kf),multi:!0};let Kf=(()=>{class t{constructor(t,e){this._renderer=t,this._elementRef=e,this.onChange=t=>{},this.onTouched=()=>{}}writeValue(t){this._renderer.setProperty(this._elementRef.nativeElement,"value",null==t?"":t)}registerOnChange(t){this.onChange=e=>{t(""==e?null:parseFloat(e))}}registerOnTouched(t){this.onTouched=t}setDisabledState(t){this._renderer.setProperty(this._elementRef.nativeElement,"disabled",t)}}return t.\u0275fac=function(e){return new(e||t)(jo(ea),jo(Qs))},t.\u0275dir=$t({type:t,selectors:[["input","type","number","formControlName",""],["input","type","number","formControl",""],["input","type","number","ngModel",""]],hostBindings:function(t,e){1&t&&ts("input",function(t){return e.onChange(t.target.value)})("blur",function(){return e.onTouched()})},features:[Zs([Xf])]}),t})();const Yf={provide:xf,useExisting:rt(()=>Qf),multi:!0};let Jf=(()=>{class t{constructor(){this._accessors=[]}add(t,e){this._accessors.push([t,e])}remove(t){for(let e=this._accessors.length-1;e>=0;--e)if(this._accessors[e][1]===t)return void this._accessors.splice(e,1)}select(t){this._accessors.forEach(e=>{this._isSameGroup(e,t)&&e[1]!==t&&e[1].fireUncheck(t.value)})}_isSameGroup(t,e){return!!t[0].control&&t[0]._parent===e._control._parent&&t[1].name===e.name}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=at({token:t,factory:t.\u0275fac}),t})(),Qf=(()=>{class t{constructor(t,e,n,i){this._renderer=t,this._elementRef=e,this._registry=n,this._injector=i,this.onChange=()=>{},this.onTouched=()=>{}}ngOnInit(){this._control=this._injector.get(Gf),this._checkName(),this._registry.add(this._control,this)}ngOnDestroy(){this._registry.remove(this)}writeValue(t){this._state=t===this.value,this._renderer.setProperty(this._elementRef.nativeElement,"checked",this._state)}registerOnChange(t){this._fn=t,this.onChange=()=>{t(this.value),this._registry.select(this)}}fireUncheck(t){this.writeValue(t)}registerOnTouched(t){this.onTouched=t}setDisabledState(t){this._renderer.setProperty(this._elementRef.nativeElement,"disabled",t)}_checkName(){!this.name&&this.formControlName&&(this.name=this.formControlName)}}return t.\u0275fac=function(e){return new(e||t)(jo(ea),jo(Qs),jo(Jf),jo(Co))},t.\u0275dir=$t({type:t,selectors:[["input","type","radio","formControlName",""],["input","type","radio","formControl",""],["input","type","radio","ngModel",""]],hostBindings:function(t,e){1&t&&ts("change",function(){return e.onChange()})("blur",function(){return e.onTouched()})},inputs:{name:"name",formControlName:"formControlName",value:"value"},features:[Zs([Yf])]}),t})();const tm={provide:xf,useExisting:rt(()=>em),multi:!0};let em=(()=>{class t{constructor(t,e){this._renderer=t,this._elementRef=e,this.onChange=t=>{},this.onTouched=()=>{}}writeValue(t){this._renderer.setProperty(this._elementRef.nativeElement,"value",parseFloat(t))}registerOnChange(t){this.onChange=e=>{t(""==e?null:parseFloat(e))}}registerOnTouched(t){this.onTouched=t}setDisabledState(t){this._renderer.setProperty(this._elementRef.nativeElement,"disabled",t)}}return t.\u0275fac=function(e){return new(e||t)(jo(ea),jo(Qs))},t.\u0275dir=$t({type:t,selectors:[["input","type","range","formControlName",""],["input","type","range","formControl",""],["input","type","range","ngModel",""]],hostBindings:function(t,e){1&t&&ts("change",function(t){return e.onChange(t.target.value)})("input",function(t){return e.onChange(t.target.value)})("blur",function(){return e.onTouched()})},features:[Zs([tm])]}),t})();const nm={provide:xf,useExisting:rt(()=>rm),multi:!0};function im(t,e){return null==t?""+e:(e&&"object"==typeof e&&(e="Object"),`${t}: ${e}`.slice(0,50))}let rm=(()=>{class t{constructor(t,e){this._renderer=t,this._elementRef=e,this._optionMap=new Map,this._idCounter=0,this.onChange=t=>{},this.onTouched=()=>{},this._compareWith=Object.is}set compareWith(t){this._compareWith=t}writeValue(t){this.value=t;const e=this._getOptionId(t);null==e&&this._renderer.setProperty(this._elementRef.nativeElement,"selectedIndex",-1);const n=im(e,t);this._renderer.setProperty(this._elementRef.nativeElement,"value",n)}registerOnChange(t){this.onChange=e=>{this.value=this._getOptionValue(e),t(this.value)}}registerOnTouched(t){this.onTouched=t}setDisabledState(t){this._renderer.setProperty(this._elementRef.nativeElement,"disabled",t)}_registerOption(){return(this._idCounter++).toString()}_getOptionId(t){for(const e of Array.from(this._optionMap.keys()))if(this._compareWith(this._optionMap.get(e),t))return e;return null}_getOptionValue(t){const e=function(t){return t.split(":")[0]}(t);return this._optionMap.has(e)?this._optionMap.get(e):t}}return t.\u0275fac=function(e){return new(e||t)(jo(ea),jo(Qs))},t.\u0275dir=$t({type:t,selectors:[["select","formControlName","",3,"multiple",""],["select","formControl","",3,"multiple",""],["select","ngModel","",3,"multiple",""]],hostBindings:function(t,e){1&t&&ts("change",function(t){return e.onChange(t.target.value)})("blur",function(){return e.onTouched()})},inputs:{compareWith:"compareWith"},features:[Zs([nm])]}),t})(),om=(()=>{class t{constructor(t,e,n){this._element=t,this._renderer=e,this._select=n,this._select&&(this.id=this._select._registerOption())}set ngValue(t){null!=this._select&&(this._select._optionMap.set(this.id,t),this._setElementValue(im(this.id,t)),this._select.writeValue(this._select.value))}set value(t){this._setElementValue(t),this._select&&this._select.writeValue(this._select.value)}_setElementValue(t){this._renderer.setProperty(this._element.nativeElement,"value",t)}ngOnDestroy(){this._select&&(this._select._optionMap.delete(this.id),this._select.writeValue(this._select.value))}}return t.\u0275fac=function(e){return new(e||t)(jo(Qs),jo(ea),jo(rm,9))},t.\u0275dir=$t({type:t,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"}}),t})();const sm={provide:xf,useExisting:rt(()=>lm),multi:!0};function am(t,e){return null==t?""+e:("string"==typeof e&&(e=`'${e}'`),e&&"object"==typeof e&&(e="Object"),`${t}: ${e}`.slice(0,50))}let lm=(()=>{class t{constructor(t,e){this._renderer=t,this._elementRef=e,this._optionMap=new Map,this._idCounter=0,this.onChange=t=>{},this.onTouched=()=>{},this._compareWith=Object.is}set compareWith(t){this._compareWith=t}writeValue(t){let e;if(this.value=t,Array.isArray(t)){const n=t.map(t=>this._getOptionId(t));e=(t,e)=>{t._setSelected(n.indexOf(e.toString())>-1)}}else e=(t,e)=>{t._setSelected(!1)};this._optionMap.forEach(e)}registerOnChange(t){this.onChange=e=>{const n=[];if(void 0!==e.selectedOptions){const t=e.selectedOptions;for(let e=0;e<t.length;e++){const i=t.item(e),r=this._getOptionValue(i.value);n.push(r)}}else{const t=e.options;for(let e=0;e<t.length;e++){const i=t.item(e);if(i.selected){const t=this._getOptionValue(i.value);n.push(t)}}}this.value=n,t(n)}}registerOnTouched(t){this.onTouched=t}setDisabledState(t){this._renderer.setProperty(this._elementRef.nativeElement,"disabled",t)}_registerOption(t){const e=(this._idCounter++).toString();return this._optionMap.set(e,t),e}_getOptionId(t){for(const e of Array.from(this._optionMap.keys()))if(this._compareWith(this._optionMap.get(e)._value,t))return e;return null}_getOptionValue(t){const e=function(t){return t.split(":")[0]}(t);return this._optionMap.has(e)?this._optionMap.get(e)._value:t}}return t.\u0275fac=function(e){return new(e||t)(jo(ea),jo(Qs))},t.\u0275dir=$t({type:t,selectors:[["select","multiple","","formControlName",""],["select","multiple","","formControl",""],["select","multiple","","ngModel",""]],hostBindings:function(t,e){1&t&&ts("change",function(t){return e.onChange(t.target)})("blur",function(){return e.onTouched()})},inputs:{compareWith:"compareWith"},features:[Zs([sm])]}),t})(),cm=(()=>{class t{constructor(t,e,n){this._element=t,this._renderer=e,this._select=n,this._select&&(this.id=this._select._registerOption(this))}set ngValue(t){null!=this._select&&(this._value=t,this._setElementValue(am(this.id,t)),this._select.writeValue(this._select.value))}set value(t){this._select?(this._value=t,this._setElementValue(am(this.id,t)),this._select.writeValue(this._select.value)):this._setElementValue(t)}_setElementValue(t){this._renderer.setProperty(this._element.nativeElement,"value",t)}_setSelected(t){this._renderer.setProperty(this._element.nativeElement,"selected",t)}ngOnDestroy(){this._select&&(this._select._optionMap.delete(this.id),this._select.writeValue(this._select.value))}}return t.\u0275fac=function(e){return new(e||t)(jo(Qs),jo(ea),jo(lm,9))},t.\u0275dir=$t({type:t,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"}}),t})();function um(t,e){return[...e.path,t]}function hm(t,e){pm(t,e,!0),e.valueAccessor.writeValue(t.value),function(t,e){e.valueAccessor.registerOnChange(n=>{t._pendingValue=n,t._pendingChange=!0,t._pendingDirty=!0,"change"===t.updateOn&&mm(t,e)})}(t,e),function(t,e){const n=(t,n)=>{e.valueAccessor.writeValue(t),n&&e.viewToModelUpdate(t)};t.registerOnChange(n),e._registerOnDestroy(()=>{t._unregisterOnChange(n)})}(t,e),function(t,e){e.valueAccessor.registerOnTouched(()=>{t._pendingTouched=!0,"blur"===t.updateOn&&t._pendingChange&&mm(t,e),"submit"!==t.updateOn&&t.markAsTouched()})}(t,e),function(t,e){if(e.valueAccessor.setDisabledState){const n=t=>{e.valueAccessor.setDisabledState(t)};t.registerOnDisabledChange(n),e._registerOnDestroy(()=>{t._unregisterOnDisabledChange(n)})}}(t,e)}function dm(t,e){t.forEach(t=>{t.registerOnValidatorChange&&t.registerOnValidatorChange(e)})}function pm(t,e,n){const i=Uf(t);null!==e.validator?t.setValidators(Vf(i,e.validator)):"function"==typeof i&&t.setValidators([i]);const r=Nf(t);if(null!==e.asyncValidator?t.setAsyncValidators(Vf(r,e.asyncValidator)):"function"==typeof r&&t.setAsyncValidators([r]),n){const n=()=>t.updateValueAndValidity();dm(e._rawValidators,n),dm(e._rawAsyncValidators,n)}}function fm(t,e,n){if(null!==t){if(null!==e.validator){const n=Uf(t);Array.isArray(n)&&n.length>0&&t.setValidators(n.filter(t=>t!==e.validator))}if(null!==e.asyncValidator){const n=Nf(t);Array.isArray(n)&&n.length>0&&t.setAsyncValidators(n.filter(t=>t!==e.asyncValidator))}}if(n){const t=()=>{};dm(e._rawValidators,t),dm(e._rawAsyncValidators,t)}}function mm(t,e){t._pendingDirty&&t.markAsDirty(),t.setValue(t._pendingValue,{emitModelToViewChange:!1}),e.viewToModelUpdate(t._pendingValue),t._pendingChange=!1}function gm(t,e){pm(t,e,!1)}function _m(t,e){if(!t.hasOwnProperty("model"))return!1;const n=t.model;return!!n.isFirstChange()||!Object.is(e,n.currentValue)}const ym=[wf,em,Kf,rm,lm,Qf];function vm(t,e){if(!e)return null;Array.isArray(e);let n=void 0,i=void 0,r=void 0;return e.forEach(t=>{var e;t.constructor===Sf?n=t:(e=t,ym.some(t=>e.constructor===t)?i=t:r=t)}),r||i||n||null}function xm(t,e){const n=t.indexOf(e);n>-1&&t.splice(n,1)}function bm(t){return(Sm(t)?t.validators:t)||null}function wm(t){return Array.isArray(t)?Ff(t):t||null}function Cm(t,e){return(Sm(e)?e.asyncValidators:t)||null}function Tm(t){return Array.isArray(t)?Bf(t):t||null}function Sm(t){return null!=t&&!Array.isArray(t)&&"object"==typeof t}class Em{constructor(t,e){this._hasOwnPendingAsyncValidator=!1,this._onCollectionChange=()=>{},this._parent=null,this.pristine=!0,this.touched=!1,this._onDisabledChange=[],this._rawValidators=t,this._rawAsyncValidators=e,this._composedValidatorFn=wm(this._rawValidators),this._composedAsyncValidatorFn=Tm(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn}set validator(t){this._rawValidators=this._composedValidatorFn=t}get asyncValidator(){return this._composedAsyncValidatorFn}set asyncValidator(t){this._rawAsyncValidators=this._composedAsyncValidatorFn=t}get parent(){return this._parent}get valid(){return"VALID"===this.status}get invalid(){return"INVALID"===this.status}get pending(){return"PENDING"==this.status}get disabled(){return"DISABLED"===this.status}get enabled(){return"DISABLED"!==this.status}get dirty(){return!this.pristine}get untouched(){return!this.touched}get updateOn(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}setValidators(t){this._rawValidators=t,this._composedValidatorFn=wm(t)}setAsyncValidators(t){this._rawAsyncValidators=t,this._composedAsyncValidatorFn=Tm(t)}clearValidators(){this.validator=null}clearAsyncValidators(){this.asyncValidator=null}markAsTouched(t={}){this.touched=!0,this._parent&&!t.onlySelf&&this._parent.markAsTouched(t)}markAllAsTouched(){this.markAsTouched({onlySelf:!0}),this._forEachChild(t=>t.markAllAsTouched())}markAsUntouched(t={}){this.touched=!1,this._pendingTouched=!1,this._forEachChild(t=>{t.markAsUntouched({onlySelf:!0})}),this._parent&&!t.onlySelf&&this._parent._updateTouched(t)}markAsDirty(t={}){this.pristine=!1,this._parent&&!t.onlySelf&&this._parent.markAsDirty(t)}markAsPristine(t={}){this.pristine=!0,this._pendingDirty=!1,this._forEachChild(t=>{t.markAsPristine({onlySelf:!0})}),this._parent&&!t.onlySelf&&this._parent._updatePristine(t)}markAsPending(t={}){this.status="PENDING",!1!==t.emitEvent&&this.statusChanges.emit(this.status),this._parent&&!t.onlySelf&&this._parent.markAsPending(t)}disable(t={}){const e=this._parentMarkedDirty(t.onlySelf);this.status="DISABLED",this.errors=null,this._forEachChild(e=>{e.disable(Object.assign(Object.assign({},t),{onlySelf:!0}))}),this._updateValue(),!1!==t.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors(Object.assign(Object.assign({},t),{skipPristineCheck:e})),this._onDisabledChange.forEach(t=>t(!0))}enable(t={}){const e=this._parentMarkedDirty(t.onlySelf);this.status="VALID",this._forEachChild(e=>{e.enable(Object.assign(Object.assign({},t),{onlySelf:!0}))}),this.updateValueAndValidity({onlySelf:!0,emitEvent:t.emitEvent}),this._updateAncestors(Object.assign(Object.assign({},t),{skipPristineCheck:e})),this._onDisabledChange.forEach(t=>t(!1))}_updateAncestors(t){this._parent&&!t.onlySelf&&(this._parent.updateValueAndValidity(t),t.skipPristineCheck||this._parent._updatePristine(),this._parent._updateTouched())}setParent(t){this._parent=t}updateValueAndValidity(t={}){this._setInitialStatus(),this._updateValue(),this.enabled&&(this._cancelExistingSubscription(),this.errors=this._runValidator(),this.status=this._calculateStatus(),"VALID"!==this.status&&"PENDING"!==this.status||this._runAsyncValidator(t.emitEvent)),!1!==t.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!t.onlySelf&&this._parent.updateValueAndValidity(t)}_updateTreeValidity(t={emitEvent:!0}){this._forEachChild(e=>e._updateTreeValidity(t)),this.updateValueAndValidity({onlySelf:!0,emitEvent:t.emitEvent})}_setInitialStatus(){this.status=this._allControlsDisabled()?"DISABLED":"VALID"}_runValidator(){return this.validator?this.validator(this):null}_runAsyncValidator(t){if(this.asyncValidator){this.status="PENDING",this._hasOwnPendingAsyncValidator=!0;const e=zf(this.asyncValidator(this));this._asyncValidationSubscription=e.subscribe(e=>{this._hasOwnPendingAsyncValidator=!1,this.setErrors(e,{emitEvent:t})})}}_cancelExistingSubscription(){this._asyncValidationSubscription&&(this._asyncValidationSubscription.unsubscribe(),this._hasOwnPendingAsyncValidator=!1)}setErrors(t,e={}){this.errors=t,this._updateControlsErrors(!1!==e.emitEvent)}get(t){return function(t,e,n){if(null==e)return null;if(Array.isArray(e)||(e=e.split(".")),Array.isArray(e)&&0===e.length)return null;let i=t;return e.forEach(t=>{i=i instanceof Am?i.controls.hasOwnProperty(t)?i.controls[t]:null:i instanceof Im&&i.at(t)||null}),i}(this,t)}getError(t,e){const n=e?this.get(e):this;return n&&n.errors?n.errors[t]:null}hasError(t,e){return!!this.getError(t,e)}get root(){let t=this;for(;t._parent;)t=t._parent;return t}_updateControlsErrors(t){this.status=this._calculateStatus(),t&&this.statusChanges.emit(this.status),this._parent&&this._parent._updateControlsErrors(t)}_initObservables(){this.valueChanges=new el,this.statusChanges=new el}_calculateStatus(){return this._allControlsDisabled()?"DISABLED":this.errors?"INVALID":this._hasOwnPendingAsyncValidator||this._anyControlsHaveStatus("PENDING")?"PENDING":this._anyControlsHaveStatus("INVALID")?"INVALID":"VALID"}_anyControlsHaveStatus(t){return this._anyControls(e=>e.status===t)}_anyControlsDirty(){return this._anyControls(t=>t.dirty)}_anyControlsTouched(){return this._anyControls(t=>t.touched)}_updatePristine(t={}){this.pristine=!this._anyControlsDirty(),this._parent&&!t.onlySelf&&this._parent._updatePristine(t)}_updateTouched(t={}){this.touched=this._anyControlsTouched(),this._parent&&!t.onlySelf&&this._parent._updateTouched(t)}_isBoxedValue(t){return"object"==typeof t&&null!==t&&2===Object.keys(t).length&&"value"in t&&"disabled"in t}_registerOnCollectionChange(t){this._onCollectionChange=t}_setUpdateStrategy(t){Sm(t)&&null!=t.updateOn&&(this._updateOn=t.updateOn)}_parentMarkedDirty(t){return!t&&!(!this._parent||!this._parent.dirty)&&!this._parent._anyControlsDirty()}}class km extends Em{constructor(t=null,e,n){super(bm(e),Cm(n,e)),this._onChange=[],this._applyFormState(t),this._setUpdateStrategy(e),this._initObservables(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!n})}setValue(t,e={}){this.value=this._pendingValue=t,this._onChange.length&&!1!==e.emitModelToViewChange&&this._onChange.forEach(t=>t(this.value,!1!==e.emitViewToModelChange)),this.updateValueAndValidity(e)}patchValue(t,e={}){this.setValue(t,e)}reset(t=null,e={}){this._applyFormState(t),this.markAsPristine(e),this.markAsUntouched(e),this.setValue(this.value,e),this._pendingChange=!1}_updateValue(){}_anyControls(t){return!1}_allControlsDisabled(){return this.disabled}registerOnChange(t){this._onChange.push(t)}_unregisterOnChange(t){xm(this._onChange,t)}registerOnDisabledChange(t){this._onDisabledChange.push(t)}_unregisterOnDisabledChange(t){xm(this._onDisabledChange,t)}_forEachChild(t){}_syncPendingControls(){return!("submit"!==this.updateOn||(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),!this._pendingChange)||(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),0))}_applyFormState(t){this._isBoxedValue(t)?(this.value=this._pendingValue=t.value,t.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=t}}class Am extends Em{constructor(t,e,n){super(bm(e),Cm(n,e)),this.controls=t,this._initObservables(),this._setUpdateStrategy(e),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!n})}registerControl(t,e){return this.controls[t]?this.controls[t]:(this.controls[t]=e,e.setParent(this),e._registerOnCollectionChange(this._onCollectionChange),e)}addControl(t,e){this.registerControl(t,e),this.updateValueAndValidity(),this._onCollectionChange()}removeControl(t){this.controls[t]&&this.controls[t]._registerOnCollectionChange(()=>{}),delete this.controls[t],this.updateValueAndValidity(),this._onCollectionChange()}setControl(t,e){this.controls[t]&&this.controls[t]._registerOnCollectionChange(()=>{}),delete this.controls[t],e&&this.registerControl(t,e),this.updateValueAndValidity(),this._onCollectionChange()}contains(t){return this.controls.hasOwnProperty(t)&&this.controls[t].enabled}setValue(t,e={}){this._checkAllValuesPresent(t),Object.keys(t).forEach(n=>{this._throwIfControlMissing(n),this.controls[n].setValue(t[n],{onlySelf:!0,emitEvent:e.emitEvent})}),this.updateValueAndValidity(e)}patchValue(t,e={}){Object.keys(t).forEach(n=>{this.controls[n]&&this.controls[n].patchValue(t[n],{onlySelf:!0,emitEvent:e.emitEvent})}),this.updateValueAndValidity(e)}reset(t={},e={}){this._forEachChild((n,i)=>{n.reset(t[i],{onlySelf:!0,emitEvent:e.emitEvent})}),this._updatePristine(e),this._updateTouched(e),this.updateValueAndValidity(e)}getRawValue(){return this._reduceChildren({},(t,e,n)=>(t[n]=e instanceof km?e.value:e.getRawValue(),t))}_syncPendingControls(){let t=this._reduceChildren(!1,(t,e)=>!!e._syncPendingControls()||t);return t&&this.updateValueAndValidity({onlySelf:!0}),t}_throwIfControlMissing(t){if(!Object.keys(this.controls).length)throw new Error("\n        There are no form controls registered with this group yet. If you're using ngModel,\n        you may want to check next tick (e.g. use setTimeout).\n      ");if(!this.controls[t])throw new Error(`Cannot find form control with name: ${t}.`)}_forEachChild(t){Object.keys(this.controls).forEach(e=>t(this.controls[e],e))}_setUpControls(){this._forEachChild(t=>{t.setParent(this),t._registerOnCollectionChange(this._onCollectionChange)})}_updateValue(){this.value=this._reduceValue()}_anyControls(t){for(const e of Object.keys(this.controls)){const n=this.controls[e];if(this.contains(e)&&t(n))return!0}return!1}_reduceValue(){return this._reduceChildren({},(t,e,n)=>((e.enabled||this.disabled)&&(t[n]=e.value),t))}_reduceChildren(t,e){let n=t;return this._forEachChild((t,i)=>{n=e(n,t,i)}),n}_allControlsDisabled(){for(const t of Object.keys(this.controls))if(this.controls[t].enabled)return!1;return Object.keys(this.controls).length>0||this.disabled}_checkAllValuesPresent(t){this._forEachChild((e,n)=>{if(void 0===t[n])throw new Error(`Must supply a value for form control with name: '${n}'.`)})}}class Im extends Em{constructor(t,e,n){super(bm(e),Cm(n,e)),this.controls=t,this._initObservables(),this._setUpdateStrategy(e),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!n})}at(t){return this.controls[t]}push(t){this.controls.push(t),this._registerControl(t),this.updateValueAndValidity(),this._onCollectionChange()}insert(t,e){this.controls.splice(t,0,e),this._registerControl(e),this.updateValueAndValidity()}removeAt(t){this.controls[t]&&this.controls[t]._registerOnCollectionChange(()=>{}),this.controls.splice(t,1),this.updateValueAndValidity()}setControl(t,e){this.controls[t]&&this.controls[t]._registerOnCollectionChange(()=>{}),this.controls.splice(t,1),e&&(this.controls.splice(t,0,e),this._registerControl(e)),this.updateValueAndValidity(),this._onCollectionChange()}get length(){return this.controls.length}setValue(t,e={}){this._checkAllValuesPresent(t),t.forEach((t,n)=>{this._throwIfControlMissing(n),this.at(n).setValue(t,{onlySelf:!0,emitEvent:e.emitEvent})}),this.updateValueAndValidity(e)}patchValue(t,e={}){t.forEach((t,n)=>{this.at(n)&&this.at(n).patchValue(t,{onlySelf:!0,emitEvent:e.emitEvent})}),this.updateValueAndValidity(e)}reset(t=[],e={}){this._forEachChild((n,i)=>{n.reset(t[i],{onlySelf:!0,emitEvent:e.emitEvent})}),this._updatePristine(e),this._updateTouched(e),this.updateValueAndValidity(e)}getRawValue(){return this.controls.map(t=>t instanceof km?t.value:t.getRawValue())}clear(){this.controls.length<1||(this._forEachChild(t=>t._registerOnCollectionChange(()=>{})),this.controls.splice(0),this.updateValueAndValidity())}_syncPendingControls(){let t=this.controls.reduce((t,e)=>!!e._syncPendingControls()||t,!1);return t&&this.updateValueAndValidity({onlySelf:!0}),t}_throwIfControlMissing(t){if(!this.controls.length)throw new Error("\n        There are no form controls registered with this array yet. If you're using ngModel,\n        you may want to check next tick (e.g. use setTimeout).\n      ");if(!this.at(t))throw new Error("Cannot find form control at index "+t)}_forEachChild(t){this.controls.forEach((e,n)=>{t(e,n)})}_updateValue(){this.value=this.controls.filter(t=>t.enabled||this.disabled).map(t=>t.value)}_anyControls(t){return this.controls.some(e=>e.enabled&&t(e))}_setUpControls(){this._forEachChild(t=>this._registerControl(t))}_checkAllValuesPresent(t){this._forEachChild((e,n)=>{if(void 0===t[n])throw new Error(`Must supply a value for form control at index: ${n}.`)})}_allControlsDisabled(){for(const t of this.controls)if(t.enabled)return!1;return this.controls.length>0||this.disabled}_registerControl(t){t.setParent(this),t._registerOnCollectionChange(this._onCollectionChange)}}const Pm={provide:Gf,useExisting:rt(()=>Om)},Mm=(()=>Promise.resolve(null))();let Om=(()=>{class t extends Gf{constructor(t,e,n,i){super(),this.control=new km,this._registered=!1,this.update=new el,this._parent=t,this._setValidators(e),this._setAsyncValidators(n),this.valueAccessor=vm(0,i)}ngOnChanges(t){this._checkForErrors(),this._registered||this._setUpControl(),"isDisabled"in t&&this._updateDisabled(t),_m(t,this.viewModel)&&(this._updateValue(this.model),this.viewModel=this.model)}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}get path(){return this._parent?um(this.name,this._parent):[this.name]}get formDirective(){return this._parent?this._parent.formDirective:null}viewToModelUpdate(t){this.viewModel=t,this.update.emit(t)}_setUpControl(){this._setUpdateStrategy(),this._isStandalone()?this._setUpStandalone():this.formDirective.addControl(this),this._registered=!0}_setUpdateStrategy(){this.options&&null!=this.options.updateOn&&(this.control._updateOn=this.options.updateOn)}_isStandalone(){return!this._parent||!(!this.options||!this.options.standalone)}_setUpStandalone(){hm(this.control,this),this.control.updateValueAndValidity({emitEvent:!1})}_checkForErrors(){this._isStandalone()||this._checkParentType(),this._checkName()}_checkParentType(){}_checkName(){this.options&&this.options.name&&(this.name=this.options.name),this._isStandalone()}_updateValue(t){Mm.then(()=>{this.control.setValue(t,{emitViewToModelChange:!1})})}_updateDisabled(t){const e=t.isDisabled.currentValue,n=""===e||e&&"false"!==e;Mm.then(()=>{n&&!this.control.disabled?this.control.disable():!n&&this.control.disabled&&this.control.enable()})}}return t.\u0275fac=function(e){return new(e||t)(jo(qf,9),jo(Af,10),jo(If,10),jo(xf,10))},t.\u0275dir=$t({type:t,selectors:[["","ngModel","",3,"formControlName","",3,"formControl",""]],inputs:{name:"name",isDisabled:["disabled","isDisabled"],model:["ngModel","model"],options:["ngModelOptions","options"]},outputs:{update:"ngModelChange"},exportAs:["ngModel"],features:[Zs([Pm]),So,oe]}),t})(),zm=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275dir=$t({type:t,selectors:[["form",3,"ngNoForm","",3,"ngNativeValidate",""]],hostAttrs:["novalidate",""]}),t})();const Dm=new Nn("NgModelWithFormControlWarning"),Lm={provide:qf,useExisting:rt(()=>Rm)};let Rm=(()=>{class t extends qf{constructor(t,e){super(),this.validators=t,this.asyncValidators=e,this.submitted=!1,this.directives=[],this.form=null,this.ngSubmit=new el,this._setValidators(t),this._setAsyncValidators(e)}ngOnChanges(t){this._checkFormPresent(),t.hasOwnProperty("form")&&(this._updateValidators(),this._updateDomValue(),this._updateRegistrations(),this._oldForm=this.form)}get formDirective(){return this}get control(){return this.form}get path(){return[]}addControl(t){const e=this.form.get(t.path);return hm(e,t),e.updateValueAndValidity({emitEvent:!1}),this.directives.push(t),e}getControl(t){return this.form.get(t.path)}removeControl(t){xm(this.directives,t)}addFormGroup(t){const e=this.form.get(t.path);gm(e,t),e.updateValueAndValidity({emitEvent:!1})}removeFormGroup(t){}getFormGroup(t){return this.form.get(t.path)}addFormArray(t){const e=this.form.get(t.path);gm(e,t),e.updateValueAndValidity({emitEvent:!1})}removeFormArray(t){}getFormArray(t){return this.form.get(t.path)}updateModel(t,e){this.form.get(t.path).setValue(e)}onSubmit(t){return this.submitted=!0,e=this.directives,this.form._syncPendingControls(),e.forEach(t=>{const e=t.control;"submit"===e.updateOn&&e._pendingChange&&(t.viewToModelUpdate(e._pendingValue),e._pendingChange=!1)}),this.ngSubmit.emit(t),!1;var e}onReset(){this.resetForm()}resetForm(t){this.form.reset(t),this.submitted=!1}_updateDomValue(){this.directives.forEach(t=>{const e=this.form.get(t.path);t.control!==e&&(function(t,e){const n=()=>{};e.valueAccessor.registerOnChange(n),e.valueAccessor.registerOnTouched(n),fm(t,e,!0),t&&(e._invokeOnDestroyCallbacks(),t._registerOnCollectionChange(()=>{}))}(t.control||null,t),e&&hm(e,t),t.control=e)}),this.form._updateTreeValidity({emitEvent:!1})}_updateRegistrations(){this.form._registerOnCollectionChange(()=>this._updateDomValue()),this._oldForm&&this._oldForm._registerOnCollectionChange(()=>{})}_updateValidators(){pm(this.form,this,!1),this._oldForm&&fm(this._oldForm,this,!1)}_checkFormPresent(){}}return t.\u0275fac=function(e){return new(e||t)(jo(Af,10),jo(If,10))},t.\u0275dir=$t({type:t,selectors:[["","formGroup",""]],hostBindings:function(t,e){1&t&&ts("submit",function(t){return e.onSubmit(t)})("reset",function(){return e.onReset()})},inputs:{form:["formGroup","form"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],features:[Zs([Lm]),So,oe]}),t})();const Fm={provide:Gf,useExisting:rt(()=>Bm)};let Bm=(()=>{class t extends Gf{constructor(t,e,n,i,r){super(),this._ngModelWarningConfig=r,this._added=!1,this.update=new el,this._ngModelWarningSent=!1,this._parent=t,this._setValidators(e),this._setAsyncValidators(n),this.valueAccessor=vm(0,i)}set isDisabled(t){}ngOnChanges(t){this._added||this._setUpControl(),_m(t,this.viewModel)&&(this.viewModel=this.model,this.formDirective.updateModel(this,this.model))}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}viewToModelUpdate(t){this.viewModel=t,this.update.emit(t)}get path(){return um(null==this.name?this.name:this.name.toString(),this._parent)}get formDirective(){return this._parent?this._parent.formDirective:null}_checkParentType(){}_setUpControl(){this._checkParentType(),this.control=this.formDirective.addControl(this),this.control.disabled&&this.valueAccessor.setDisabledState&&this.valueAccessor.setDisabledState(!0),this._added=!0}}return t.\u0275fac=function(e){return new(e||t)(jo(qf,13),jo(Af,10),jo(If,10),jo(xf,10),jo(Dm,8))},t.\u0275dir=$t({type:t,selectors:[["","formControlName",""]],inputs:{isDisabled:["disabled","isDisabled"],name:["formControlName","name"],model:["ngModel","model"]},outputs:{update:"ngModelChange"},features:[Zs([Fm]),So,oe]}),t._ngModelWarningSentOnce=!1,t})();const Vm={provide:Af,useExisting:rt(()=>Um),multi:!0};let Um=(()=>{class t{constructor(){this._validator=Mf.nullValidator}ngOnChanges(t){"maxlength"in t&&(this._createValidator(),this._onChange&&this._onChange())}validate(t){return null!=this.maxlength?this._validator(t):null}registerOnValidatorChange(t){this._onChange=t}_createValidator(){this._validator=Mf.maxLength("number"==typeof this.maxlength?this.maxlength:parseInt(this.maxlength,10))}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275dir=$t({type:t,selectors:[["","maxlength","","formControlName",""],["","maxlength","","formControl",""],["","maxlength","","ngModel",""]],hostVars:1,hostBindings:function(t,e){2&t&&Bo("maxlength",e.maxlength?e.maxlength:null)},inputs:{maxlength:"maxlength"},features:[Zs([Vm]),oe]}),t})(),Nm=(()=>{class t{}return t.\u0275mod=jt({type:t}),t.\u0275inj=lt({factory:function(e){return new(e||t)}}),t})(),jm=(()=>{class t{group(t,e=null){const n=this._reduceControls(t);let i=null,r=null,o=void 0;return null!=e&&(function(t){return void 0!==t.asyncValidators||void 0!==t.validators||void 0!==t.updateOn}(e)?(i=null!=e.validators?e.validators:null,r=null!=e.asyncValidators?e.asyncValidators:null,o=null!=e.updateOn?e.updateOn:void 0):(i=null!=e.validator?e.validator:null,r=null!=e.asyncValidator?e.asyncValidator:null)),new Am(n,{asyncValidators:r,updateOn:o,validators:i})}control(t,e,n){return new km(t,e,n)}array(t,e,n){const i=t.map(t=>this._createControl(t));return new Im(i,e,n)}_reduceControls(t){const e={};return Object.keys(t).forEach(n=>{e[n]=this._createControl(t[n])}),e}_createControl(t){return t instanceof km||t instanceof Am||t instanceof Im?t:Array.isArray(t)?this.control(t[0],t.length>1?t[1]:null,t.length>2?t[2]:null):this.control(t)}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=at({token:t,factory:t.\u0275fac}),t})(),qm=(()=>{class t{}return t.\u0275mod=jt({type:t}),t.\u0275inj=lt({factory:function(e){return new(e||t)},providers:[Jf],imports:[Nm]}),t})(),$m=(()=>{class t{static withConfig(e){return{ngModule:t,providers:[{provide:Dm,useValue:e.warnOnNgModelWithFormControl}]}}}return t.\u0275mod=jt({type:t}),t.\u0275inj=lt({factory:function(e){return new(e||t)},providers:[jm,Jf],imports:[Nm]}),t})();var Gm=n("PSD3"),Zm=n.n(Gm);function Hm(t){return e=>e.lift(new Wm(t))}class Wm{constructor(t){this.notifier=t}call(t,e){const n=new Xm(t),i=V(this.notifier,new F(n));return i&&!n.seenValue?(n.add(i),e.subscribe(n)):n}}class Xm extends B{constructor(t){super(t),this.seenValue=!1}notifyNext(){this.seenValue=!0,this.complete()}notifyComplete(){}}class Km extends h{constructor(t,e){super()}schedule(t,e=0){return this}}class Ym extends Km{constructor(t,e){super(t,e),this.scheduler=t,this.work=e,this.pending=!1}schedule(t,e=0){if(this.closed)return this;this.state=t;const n=this.id,i=this.scheduler;return null!=n&&(this.id=this.recycleAsyncId(i,n,e)),this.pending=!0,this.delay=e,this.id=this.id||this.requestAsyncId(i,this.id,e),this}requestAsyncId(t,e,n=0){return setInterval(t.flush.bind(t,this),n)}recycleAsyncId(t,e,n=0){if(null!==n&&this.delay===n&&!1===this.pending)return e;clearInterval(e)}execute(t,e){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;const n=this._execute(t,e);if(n)return n;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(t,e){let n=!1,i=void 0;try{this.work(t)}catch(r){n=!0,i=!!r&&r||new Error(r)}if(n)return this.unsubscribe(),i}_unsubscribe(){const t=this.id,e=this.scheduler,n=e.actions,i=n.indexOf(this);this.work=null,this.state=null,this.pending=!1,this.scheduler=null,-1!==i&&n.splice(i,1),null!=t&&(this.id=this.recycleAsyncId(e,t,null)),this.delay=null}}let Jm=(()=>{class t{constructor(e,n=t.now){this.SchedulerAction=e,this.now=n}schedule(t,e=0,n){return new this.SchedulerAction(this,t).schedule(n,e)}}return t.now=()=>Date.now(),t})();class Qm extends Jm{constructor(t,e=Jm.now){super(t,()=>Qm.delegate&&Qm.delegate!==this?Qm.delegate.now():e()),this.actions=[],this.active=!1,this.scheduled=void 0}schedule(t,e=0,n){return Qm.delegate&&Qm.delegate!==this?Qm.delegate.schedule(t,e,n):super.schedule(t,e,n)}flush(t){const{actions:e}=this;if(this.active)return void e.push(t);let n;this.active=!0;do{if(n=t.execute(t.state,t.delay))break}while(t=e.shift());if(this.active=!1,n){for(;t=e.shift();)t.unsubscribe();throw n}}}const tg=new Qm(Ym);class eg{constructor(t){this.durationSelector=t}call(t,e){return e.subscribe(new ng(t,this.durationSelector))}}class ng extends B{constructor(t,e){super(t),this.durationSelector=e,this.hasValue=!1}_next(t){if(this.value=t,this.hasValue=!0,!this.throttled){let n;try{const{durationSelector:e}=this;n=e(t)}catch(e){return this.destination.error(e)}const i=V(n,new F(this));!i||i.closed?this.clearThrottle():this.add(this.throttled=i)}}clearThrottle(){const{value:t,hasValue:e,throttled:n}=this;n&&(this.remove(n),this.throttled=void 0,n.unsubscribe()),e&&(this.value=void 0,this.hasValue=!1,this.destination.next(t))}notifyNext(){this.clearThrottle()}notifyComplete(){this.clearThrottle()}}function ig(t){return!l(t)&&t-parseFloat(t)+1>=0}function rg(t=0,e,n){let i=-1;return ig(e)?i=Number(e)<1?1:Number(e):S(e)&&(n=e),S(n)||(n=tg),new y(e=>{const r=ig(t)?t:+t-n.now();return n.schedule(og,r,{index:0,period:i,subscriber:e})})}function og(t){const{index:e,period:n,subscriber:i}=t;if(i.next(e),!i.closed){if(-1===n)return i.complete();t.index=e+1,this.schedule(t,n)}}class sg{constructor(t,e){this.dueTime=t,this.scheduler=e}call(t,e){return e.subscribe(new ag(t,this.dueTime,this.scheduler))}}class ag extends f{constructor(t,e,n){super(t),this.dueTime=e,this.scheduler=n,this.debouncedSubscription=null,this.lastValue=null,this.hasValue=!1}_next(t){this.clearDebounce(),this.lastValue=t,this.hasValue=!0,this.add(this.debouncedSubscription=this.scheduler.schedule(lg,this.dueTime,this))}_complete(){this.debouncedNext(),this.destination.complete()}debouncedNext(){if(this.clearDebounce(),this.hasValue){const{lastValue:t}=this;this.lastValue=null,this.hasValue=!1,this.destination.next(t)}}clearDebounce(){const t=this.debouncedSubscription;null!==t&&(this.remove(t),t.unsubscribe(),this.debouncedSubscription=null)}}function lg(t){t.debouncedNext()}class cg extends Ym{constructor(t,e){super(t,e),this.scheduler=t,this.work=e}requestAsyncId(t,e,n=0){return null!==n&&n>0?super.requestAsyncId(t,e,n):(t.actions.push(this),t.scheduled||(t.scheduled=requestAnimationFrame(()=>t.flush(null))))}recycleAsyncId(t,e,n=0){if(null!==n&&n>0||null===n&&this.delay>0)return super.recycleAsyncId(t,e,n);0===t.actions.length&&(cancelAnimationFrame(e),t.scheduled=void 0)}}class ug extends Qm{flush(t){this.active=!0,this.scheduled=void 0;const{actions:e}=this;let n,i=-1,r=e.length;t=t||e.shift();do{if(n=t.execute(t.state,t.delay))break}while(++i<r&&(t=e.shift()));if(this.active=!1,n){for(;++i<r&&(t=e.shift());)t.unsubscribe();throw n}}}const hg=new ug(cg);let dg=1;const pg=(()=>Promise.resolve())(),fg={};function mg(t){return t in fg&&(delete fg[t],!0)}const gg={setImmediate(t){const e=dg++;return fg[e]=!0,pg.then(()=>mg(e)&&t()),e},clearImmediate(t){mg(t)}};class _g extends Ym{constructor(t,e){super(t,e),this.scheduler=t,this.work=e}requestAsyncId(t,e,n=0){return null!==n&&n>0?super.requestAsyncId(t,e,n):(t.actions.push(this),t.scheduled||(t.scheduled=gg.setImmediate(t.flush.bind(t,null))))}recycleAsyncId(t,e,n=0){if(null!==n&&n>0||null===n&&this.delay>0)return super.recycleAsyncId(t,e,n);0===t.actions.length&&(gg.clearImmediate(e),t.scheduled=void 0)}}class yg extends Qm{flush(t){this.active=!0,this.scheduled=void 0;const{actions:e}=this;let n,i=-1,r=e.length;t=t||e.shift();do{if(n=t.execute(t.state,t.delay))break}while(++i<r&&(t=e.shift()));if(this.active=!1,n){for(;++i<r&&(t=e.shift());)t.unsubscribe();throw n}}}const vg=new yg(_g);function xg(t,e,n,r){return i(n)&&(r=n,n=void 0),r?xg(t,e,n).pipe(E(t=>l(t)?r(...t):r(t))):new y(i=>{bg(t,e,function(t){i.next(arguments.length>1?Array.prototype.slice.call(arguments):t)},i,n)})}function bg(t,e,n,i,r){let o;if(function(t){return t&&"function"==typeof t.addEventListener&&"function"==typeof t.removeEventListener}(t)){const i=t;t.addEventListener(e,n,r),o=()=>i.removeEventListener(e,n,r)}else if(function(t){return t&&"function"==typeof t.on&&"function"==typeof t.off}(t)){const i=t;t.on(e,n),o=()=>i.off(e,n)}else if(function(t){return t&&"function"==typeof t.addListener&&"function"==typeof t.removeListener}(t)){const i=t;t.addListener(e,n),o=()=>i.removeListener(e,n)}else{if(!t||!t.length)throw new TypeError("Invalid event target");for(let o=0,s=t.length;o<s;o++)bg(t[o],e,n,i,r)}i.add(o)}const wg=["content"],Cg=["scroll"],Tg=["padding"],Sg=function(t){return{searchTerm:t}};function Eg(t,e){if(1&t&&(Go(0,"div",6),Ko(1,7),Zo()),2&t){const t=is();ur(1),qo("ngTemplateOutlet",t.headerTemplate)("ngTemplateOutletContext",Ka(2,Sg,t.filterValue))}}function kg(t,e){if(1&t&&(Go(0,"div",8),Ko(1,7),Zo()),2&t){const t=is();ur(1),qo("ngTemplateOutlet",t.footerTemplate)("ngTemplateOutletContext",Ka(2,Sg,t.filterValue))}}const Ag=["*"],Ig=["searchInput"];function Pg(t,e){if(1&t){const t=Yo();Go(0,"span",15),ts("click",function(){Ie(t);const e=is().$implicit;return is(2).unselect(e)}),ks(1,"\xd7"),Zo(),Ho(2,"span",16)}if(2&t){const t=is().$implicit,e=is(2);ur(2),qo("ngItemLabel",t.label)("escape",e.escapeHTML)}}function Mg(t,e){}const Og=function(t,e,n){return{item:t,clear:e,label:n}};function zg(t,e){if(1&t&&(Go(0,"div",12),Uo(1,Pg,3,2,"ng-template",null,13,bl),Uo(3,Mg,0,0,"ng-template",14),Zo()),2&t){const t=e.$implicit,l=No(2),c=is(2);gs("ng-value-disabled",t.disabled),ur(3),qo("ngTemplateOutlet",c.labelTemplate||l)("ngTemplateOutletContext",(n=4,i=Og,r=t.value,o=c.clearItem,s=t.label,function(t,e,n,i,r,o,s,a){const l=e+n;return function(t,e,n,i,r){const o=Fo(t,e,n,i);return Ro(t,e+2,r)||o}(t,l,r,o,s)?Lo(t,l+3,a?i.call(a,r,o,s):i(r,o,s)):Ya(t,l+3)}(ke(),Fe(),n,i,r,o,s,a)))}var n,i,r,o,s,a}function Dg(t,e){if(1&t&&(Wo(0),Uo(1,zg,4,8,"div",11),Xo()),2&t){const t=is();ur(1),qo("ngForOf",t.selectedItems)("ngForTrackBy",t.trackByOption)}}function Lg(t,e){}const Rg=function(t,e){return{items:t,clear:e}};function Fg(t,e){if(1&t&&Uo(0,Lg,0,0,"ng-template",14),2&t){const t=is();qo("ngTemplateOutlet",t.multiLabelTemplate)("ngTemplateOutletContext",(2,n=Rg,i=t.selectedValues,r=t.clearItem,Ja(ke(),Fe(),2,n,i,r,undefined)))}var n,i,r}function Bg(t,e){1&t&&Ho(0,"div",19)}function Vg(t,e){}function Ug(t,e){if(1&t&&(Wo(0),Uo(1,Bg,1,0,"ng-template",null,17,bl),Uo(3,Vg,0,0,"ng-template",18),Xo()),2&t){const t=No(2),e=is();ur(3),qo("ngTemplateOutlet",e.loadingSpinnerTemplate||t)}}function Ng(t,e){1&t&&(Go(0,"span",20),Go(1,"span",21),ks(2,"\xd7"),Zo(),Zo()),2&t&&as("title",is().clearAllText)}function jg(t,e){if(1&t&&Ho(0,"span",27),2&t){const t=is().$implicit,e=is(2);qo("ngItemLabel",t.label)("escape",e.escapeHTML)}}function qg(t,e){}const $g=function(t,e,n,i){return{item:t,item$:e,index:n,searchTerm:i}};function Gg(t,e){if(1&t){const t=Yo();Go(0,"div",25),ts("click",function(){Ie(t);const n=e.$implicit;return is(2).toggleItem(n)})("mouseover",function(){Ie(t);const n=e.$implicit;return is(2).onItemHover(n)}),Uo(1,jg,1,2,"ng-template",null,26,bl),Uo(3,qg,0,0,"ng-template",14),Zo()}if(2&t){const t=e.$implicit,c=No(2),u=is(2);gs("ng-option-disabled",t.disabled)("ng-option-selected",t.selected)("ng-optgroup",t.children)("ng-option",!t.children)("ng-option-child",!!t.parent)("ng-option-marked",t===u.itemsList.markedItem),Bo("role",t.children?"group":"option")("aria-selected",t.selected)("id",null==t?null:t.htmlId),ur(3),qo("ngTemplateOutlet",t.children?u.optgroupTemplate||c:u.optionTemplate||c)("ngTemplateOutletContext",(n=17,i=$g,r=t.value,o=t,s=t.index,a=u.searchTerm,function(t,e,n,i,r,o,s,a,l){const c=e+n;return function(t,e,n,i,r,o){const s=Fo(t,e,n,i);return Fo(t,e+2,r,o)||s}(t,c,r,o,s,a)?Lo(t,c+4,l?i.call(l,r,o,s,a):i(r,o,s,a)):Ya(t,c+4)}(ke(),Fe(),n,i,r,o,s,a,l)))}var n,i,r,o,s,a,l}function Zg(t,e){if(1&t&&(Go(0,"span"),Go(1,"span",30),ks(2),Zo(),ks(3),Zo()),2&t){const t=is(3);ur(2),As(t.addTagText),ur(1),Is('"',t.searchTerm,'"')}}function Hg(t,e){}function Wg(t,e){if(1&t){const t=Yo();Go(0,"div",28),ts("mouseover",function(){return Ie(t),is(2).itemsList.unmarkItem()})("click",function(){return Ie(t),is(2).selectTag()}),Uo(1,Zg,4,2,"ng-template",null,29,bl),Uo(3,Hg,0,0,"ng-template",14),Zo()}if(2&t){const t=No(2),e=is(2);gs("ng-option-marked",!e.itemsList.markedItem),ur(3),qo("ngTemplateOutlet",e.tagTemplate||t)("ngTemplateOutletContext",Ka(4,Sg,e.searchTerm))}}function Xg(t,e){if(1&t&&(Go(0,"div",32),ks(1),Zo()),2&t){const t=is(3);ur(1),As(t.notFoundText)}}function Kg(t,e){}function Yg(t,e){if(1&t&&(Wo(0),Uo(1,Xg,2,1,"ng-template",null,31,bl),Uo(3,Kg,0,0,"ng-template",14),Xo()),2&t){const t=No(2),e=is(2);ur(3),qo("ngTemplateOutlet",e.notFoundTemplate||t)("ngTemplateOutletContext",Ka(2,Sg,e.searchTerm))}}function Jg(t,e){if(1&t&&(Go(0,"div",32),ks(1),Zo()),2&t){const t=is(3);ur(1),As(t.typeToSearchText)}}function Qg(t,e){}function t_(t,e){if(1&t&&(Wo(0),Uo(1,Jg,2,1,"ng-template",null,33,bl),Uo(3,Qg,0,0,"ng-template",18),Xo()),2&t){const t=No(2),e=is(2);ur(3),qo("ngTemplateOutlet",e.typeToSearchTemplate||t)}}function e_(t,e){if(1&t&&(Go(0,"div",32),ks(1),Zo()),2&t){const t=is(3);ur(1),As(t.loadingText)}}function n_(t,e){}function i_(t,e){if(1&t&&(Wo(0),Uo(1,e_,2,1,"ng-template",null,34,bl),Uo(3,n_,0,0,"ng-template",14),Xo()),2&t){const t=No(2),e=is(2);ur(3),qo("ngTemplateOutlet",e.loadingTextTemplate||t)("ngTemplateOutletContext",Ka(2,Sg,e.searchTerm))}}function r_(t,e){if(1&t){const t=Yo();Go(0,"ng-dropdown-panel",22),ts("update",function(e){return Ie(t),is().viewPortItems=e})("scroll",function(e){return Ie(t),is().scroll.emit(e)})("scrollToEnd",function(e){return Ie(t),is().scrollToEnd.emit(e)})("outsideClick",function(){return Ie(t),is().close()}),Wo(1),Uo(2,Gg,4,22,"div",23),Uo(3,Wg,4,6,"div",24),Xo(),Uo(4,Yg,4,4,"ng-container",3),Uo(5,t_,4,1,"ng-container",3),Uo(6,i_,4,4,"ng-container",3),Zo()}if(2&t){const t=is();gs("ng-select-multiple",t.multiple),qo("virtualScroll",t.virtualScroll)("bufferAmount",t.bufferAmount)("appendTo",t.appendTo)("position",t.dropdownPosition)("headerTemplate",t.headerTemplate)("footerTemplate",t.footerTemplate)("filterValue",t.searchTerm)("items",t.itemsList.filteredItems)("markedItem",t.itemsList.markedItem)("ngClass",t.appendTo?t.classes:null)("id",t.dropdownId),ur(2),qo("ngForOf",t.viewPortItems)("ngForTrackBy",t.trackByOption),ur(1),qo("ngIf",t.showAddTag),ur(1),qo("ngIf",t.showNoItemsFound()),ur(1),qo("ngIf",t.showTypeToSearch()),ur(1),qo("ngIf",t.loading&&0===t.itemsList.filteredItems.length)}}const o_=/[&<>"']/g,s_=RegExp(o_.source),a_={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"};function l_(t){return null!=t}function c_(t){return"object"==typeof t&&l_(t)}function u_(t){return t instanceof Function}let h_=(()=>{class t{constructor(t){this.element=t,this.escape=!0}ngOnChanges(t){var e;this.element.nativeElement.innerHTML=this.escape?(e=this.ngItemLabel)&&s_.test(e)?e.replace(o_,t=>a_[t]):e:this.ngItemLabel}}return t.\u0275fac=function(e){return new(e||t)(jo(Qs))},t.\u0275dir=$t({type:t,selectors:[["","ngItemLabel",""]],inputs:{escape:"escape",ngItemLabel:"ngItemLabel"},features:[oe]}),t})(),d_=(()=>{class t{constructor(t){this.template=t}}return t.\u0275fac=function(e){return new(e||t)(jo(ka))},t.\u0275dir=$t({type:t,selectors:[["","ng-option-tmp",""]]}),t})(),p_=(()=>{class t{constructor(t){this.template=t}}return t.\u0275fac=function(e){return new(e||t)(jo(ka))},t.\u0275dir=$t({type:t,selectors:[["","ng-optgroup-tmp",""]]}),t})(),f_=(()=>{class t{constructor(t){this.template=t}}return t.\u0275fac=function(e){return new(e||t)(jo(ka))},t.\u0275dir=$t({type:t,selectors:[["","ng-label-tmp",""]]}),t})(),m_=(()=>{class t{constructor(t){this.template=t}}return t.\u0275fac=function(e){return new(e||t)(jo(ka))},t.\u0275dir=$t({type:t,selectors:[["","ng-multi-label-tmp",""]]}),t})(),g_=(()=>{class t{constructor(t){this.template=t}}return t.\u0275fac=function(e){return new(e||t)(jo(ka))},t.\u0275dir=$t({type:t,selectors:[["","ng-header-tmp",""]]}),t})(),__=(()=>{class t{constructor(t){this.template=t}}return t.\u0275fac=function(e){return new(e||t)(jo(ka))},t.\u0275dir=$t({type:t,selectors:[["","ng-footer-tmp",""]]}),t})(),y_=(()=>{class t{constructor(t){this.template=t}}return t.\u0275fac=function(e){return new(e||t)(jo(ka))},t.\u0275dir=$t({type:t,selectors:[["","ng-notfound-tmp",""]]}),t})(),v_=(()=>{class t{constructor(t){this.template=t}}return t.\u0275fac=function(e){return new(e||t)(jo(ka))},t.\u0275dir=$t({type:t,selectors:[["","ng-typetosearch-tmp",""]]}),t})(),x_=(()=>{class t{constructor(t){this.template=t}}return t.\u0275fac=function(e){return new(e||t)(jo(ka))},t.\u0275dir=$t({type:t,selectors:[["","ng-loadingtext-tmp",""]]}),t})(),b_=(()=>{class t{constructor(t){this.template=t}}return t.\u0275fac=function(e){return new(e||t)(jo(ka))},t.\u0275dir=$t({type:t,selectors:[["","ng-tag-tmp",""]]}),t})(),w_=(()=>{class t{constructor(t){this.template=t}}return t.\u0275fac=function(e){return new(e||t)(jo(ka))},t.\u0275dir=$t({type:t,selectors:[["","ng-loadingspinner-tmp",""]]}),t})(),C_=(()=>{class t{warn(t){console.warn(t)}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=at({factory:function(){return new t},token:t,providedIn:"root"}),t})();function T_(){return"axxxxxxxxxxx".replace(/[x]/g,function(t){return(16*Math.random()|0).toString(16)})}const S_={"\u24b6":"A",\uff21:"A",\u00c0:"A",\u00c1:"A",\u00c2:"A",\u1ea6:"A",\u1ea4:"A",\u1eaa:"A",\u1ea8:"A",\u00c3:"A",\u0100:"A",\u0102:"A",\u1eb0:"A",\u1eae:"A",\u1eb4:"A",\u1eb2:"A",\u0226:"A",\u01e0:"A",\u00c4:"A",\u01de:"A",\u1ea2:"A",\u00c5:"A",\u01fa:"A",\u01cd:"A",\u0200:"A",\u0202:"A",\u1ea0:"A",\u1eac:"A",\u1eb6:"A",\u1e00:"A",\u0104:"A",\u023a:"A",\u2c6f:"A",\ua732:"AA",\u00c6:"AE",\u01fc:"AE",\u01e2:"AE",\ua734:"AO",\ua736:"AU",\ua738:"AV",\ua73a:"AV",\ua73c:"AY","\u24b7":"B",\uff22:"B",\u1e02:"B",\u1e04:"B",\u1e06:"B",\u0243:"B",\u0182:"B",\u0181:"B","\u24b8":"C",\uff23:"C",\u0106:"C",\u0108:"C",\u010a:"C",\u010c:"C",\u00c7:"C",\u1e08:"C",\u0187:"C",\u023b:"C",\ua73e:"C","\u24b9":"D",\uff24:"D",\u1e0a:"D",\u010e:"D",\u1e0c:"D",\u1e10:"D",\u1e12:"D",\u1e0e:"D",\u0110:"D",\u018b:"D",\u018a:"D",\u0189:"D",\ua779:"D",\u01f1:"DZ",\u01c4:"DZ",\u01f2:"Dz",\u01c5:"Dz","\u24ba":"E",\uff25:"E",\u00c8:"E",\u00c9:"E",\u00ca:"E",\u1ec0:"E",\u1ebe:"E",\u1ec4:"E",\u1ec2:"E",\u1ebc:"E",\u0112:"E",\u1e14:"E",\u1e16:"E",\u0114:"E",\u0116:"E",\u00cb:"E",\u1eba:"E",\u011a:"E",\u0204:"E",\u0206:"E",\u1eb8:"E",\u1ec6:"E",\u0228:"E",\u1e1c:"E",\u0118:"E",\u1e18:"E",\u1e1a:"E",\u0190:"E",\u018e:"E","\u24bb":"F",\uff26:"F",\u1e1e:"F",\u0191:"F",\ua77b:"F","\u24bc":"G",\uff27:"G",\u01f4:"G",\u011c:"G",\u1e20:"G",\u011e:"G",\u0120:"G",\u01e6:"G",\u0122:"G",\u01e4:"G",\u0193:"G",\ua7a0:"G",\ua77d:"G",\ua77e:"G","\u24bd":"H",\uff28:"H",\u0124:"H",\u1e22:"H",\u1e26:"H",\u021e:"H",\u1e24:"H",\u1e28:"H",\u1e2a:"H",\u0126:"H",\u2c67:"H",\u2c75:"H",\ua78d:"H","\u24be":"I",\uff29:"I",\u00cc:"I",\u00cd:"I",\u00ce:"I",\u0128:"I",\u012a:"I",\u012c:"I",\u0130:"I",\u00cf:"I",\u1e2e:"I",\u1ec8:"I",\u01cf:"I",\u0208:"I",\u020a:"I",\u1eca:"I",\u012e:"I",\u1e2c:"I",\u0197:"I","\u24bf":"J",\uff2a:"J",\u0134:"J",\u0248:"J","\u24c0":"K",\uff2b:"K",\u1e30:"K",\u01e8:"K",\u1e32:"K",\u0136:"K",\u1e34:"K",\u0198:"K",\u2c69:"K",\ua740:"K",\ua742:"K",\ua744:"K",\ua7a2:"K","\u24c1":"L",\uff2c:"L",\u013f:"L",\u0139:"L",\u013d:"L",\u1e36:"L",\u1e38:"L",\u013b:"L",\u1e3c:"L",\u1e3a:"L",\u0141:"L",\u023d:"L",\u2c62:"L",\u2c60:"L",\ua748:"L",\ua746:"L",\ua780:"L",\u01c7:"LJ",\u01c8:"Lj","\u24c2":"M",\uff2d:"M",\u1e3e:"M",\u1e40:"M",\u1e42:"M",\u2c6e:"M",\u019c:"M","\u24c3":"N",\uff2e:"N",\u01f8:"N",\u0143:"N",\u00d1:"N",\u1e44:"N",\u0147:"N",\u1e46:"N",\u0145:"N",\u1e4a:"N",\u1e48:"N",\u0220:"N",\u019d:"N",\ua790:"N",\ua7a4:"N",\u01ca:"NJ",\u01cb:"Nj","\u24c4":"O",\uff2f:"O",\u00d2:"O",\u00d3:"O",\u00d4:"O",\u1ed2:"O",\u1ed0:"O",\u1ed6:"O",\u1ed4:"O",\u00d5:"O",\u1e4c:"O",\u022c:"O",\u1e4e:"O",\u014c:"O",\u1e50:"O",\u1e52:"O",\u014e:"O",\u022e:"O",\u0230:"O",\u00d6:"O",\u022a:"O",\u1ece:"O",\u0150:"O",\u01d1:"O",\u020c:"O",\u020e:"O",\u01a0:"O",\u1edc:"O",\u1eda:"O",\u1ee0:"O",\u1ede:"O",\u1ee2:"O",\u1ecc:"O",\u1ed8:"O",\u01ea:"O",\u01ec:"O",\u00d8:"O",\u01fe:"O",\u0186:"O",\u019f:"O",\ua74a:"O",\ua74c:"O",\u01a2:"OI",\ua74e:"OO",\u0222:"OU","\u24c5":"P",\uff30:"P",\u1e54:"P",\u1e56:"P",\u01a4:"P",\u2c63:"P",\ua750:"P",\ua752:"P",\ua754:"P","\u24c6":"Q",\uff31:"Q",\ua756:"Q",\ua758:"Q",\u024a:"Q","\u24c7":"R",\uff32:"R",\u0154:"R",\u1e58:"R",\u0158:"R",\u0210:"R",\u0212:"R",\u1e5a:"R",\u1e5c:"R",\u0156:"R",\u1e5e:"R",\u024c:"R",\u2c64:"R",\ua75a:"R",\ua7a6:"R",\ua782:"R","\u24c8":"S",\uff33:"S",\u1e9e:"S",\u015a:"S",\u1e64:"S",\u015c:"S",\u1e60:"S",\u0160:"S",\u1e66:"S",\u1e62:"S",\u1e68:"S",\u0218:"S",\u015e:"S",\u2c7e:"S",\ua7a8:"S",\ua784:"S","\u24c9":"T",\uff34:"T",\u1e6a:"T",\u0164:"T",\u1e6c:"T",\u021a:"T",\u0162:"T",\u1e70:"T",\u1e6e:"T",\u0166:"T",\u01ac:"T",\u01ae:"T",\u023e:"T",\ua786:"T",\ua728:"TZ","\u24ca":"U",\uff35:"U",\u00d9:"U",\u00da:"U",\u00db:"U",\u0168:"U",\u1e78:"U",\u016a:"U",\u1e7a:"U",\u016c:"U",\u00dc:"U",\u01db:"U",\u01d7:"U",\u01d5:"U",\u01d9:"U",\u1ee6:"U",\u016e:"U",\u0170:"U",\u01d3:"U",\u0214:"U",\u0216:"U",\u01af:"U",\u1eea:"U",\u1ee8:"U",\u1eee:"U",\u1eec:"U",\u1ef0:"U",\u1ee4:"U",\u1e72:"U",\u0172:"U",\u1e76:"U",\u1e74:"U",\u0244:"U","\u24cb":"V",\uff36:"V",\u1e7c:"V",\u1e7e:"V",\u01b2:"V",\ua75e:"V",\u0245:"V",\ua760:"VY","\u24cc":"W",\uff37:"W",\u1e80:"W",\u1e82:"W",\u0174:"W",\u1e86:"W",\u1e84:"W",\u1e88:"W",\u2c72:"W","\u24cd":"X",\uff38:"X",\u1e8a:"X",\u1e8c:"X","\u24ce":"Y",\uff39:"Y",\u1ef2:"Y",\u00dd:"Y",\u0176:"Y",\u1ef8:"Y",\u0232:"Y",\u1e8e:"Y",\u0178:"Y",\u1ef6:"Y",\u1ef4:"Y",\u01b3:"Y",\u024e:"Y",\u1efe:"Y","\u24cf":"Z",\uff3a:"Z",\u0179:"Z",\u1e90:"Z",\u017b:"Z",\u017d:"Z",\u1e92:"Z",\u1e94:"Z",\u01b5:"Z",\u0224:"Z",\u2c7f:"Z",\u2c6b:"Z",\ua762:"Z","\u24d0":"a",\uff41:"a",\u1e9a:"a",\u00e0:"a",\u00e1:"a",\u00e2:"a",\u1ea7:"a",\u1ea5:"a",\u1eab:"a",\u1ea9:"a",\u00e3:"a",\u0101:"a",\u0103:"a",\u1eb1:"a",\u1eaf:"a",\u1eb5:"a",\u1eb3:"a",\u0227:"a",\u01e1:"a",\u00e4:"a",\u01df:"a",\u1ea3:"a",\u00e5:"a",\u01fb:"a",\u01ce:"a",\u0201:"a",\u0203:"a",\u1ea1:"a",\u1ead:"a",\u1eb7:"a",\u1e01:"a",\u0105:"a",\u2c65:"a",\u0250:"a",\ua733:"aa",\u00e6:"ae",\u01fd:"ae",\u01e3:"ae",\ua735:"ao",\ua737:"au",\ua739:"av",\ua73b:"av",\ua73d:"ay","\u24d1":"b",\uff42:"b",\u1e03:"b",\u1e05:"b",\u1e07:"b",\u0180:"b",\u0183:"b",\u0253:"b","\u24d2":"c",\uff43:"c",\u0107:"c",\u0109:"c",\u010b:"c",\u010d:"c",\u00e7:"c",\u1e09:"c",\u0188:"c",\u023c:"c",\ua73f:"c",\u2184:"c","\u24d3":"d",\uff44:"d",\u1e0b:"d",\u010f:"d",\u1e0d:"d",\u1e11:"d",\u1e13:"d",\u1e0f:"d",\u0111:"d",\u018c:"d",\u0256:"d",\u0257:"d",\ua77a:"d",\u01f3:"dz",\u01c6:"dz","\u24d4":"e",\uff45:"e",\u00e8:"e",\u00e9:"e",\u00ea:"e",\u1ec1:"e",\u1ebf:"e",\u1ec5:"e",\u1ec3:"e",\u1ebd:"e",\u0113:"e",\u1e15:"e",\u1e17:"e",\u0115:"e",\u0117:"e",\u00eb:"e",\u1ebb:"e",\u011b:"e",\u0205:"e",\u0207:"e",\u1eb9:"e",\u1ec7:"e",\u0229:"e",\u1e1d:"e",\u0119:"e",\u1e19:"e",\u1e1b:"e",\u0247:"e",\u025b:"e",\u01dd:"e","\u24d5":"f",\uff46:"f",\u1e1f:"f",\u0192:"f",\ua77c:"f","\u24d6":"g",\uff47:"g",\u01f5:"g",\u011d:"g",\u1e21:"g",\u011f:"g",\u0121:"g",\u01e7:"g",\u0123:"g",\u01e5:"g",\u0260:"g",\ua7a1:"g",\u1d79:"g",\ua77f:"g","\u24d7":"h",\uff48:"h",\u0125:"h",\u1e23:"h",\u1e27:"h",\u021f:"h",\u1e25:"h",\u1e29:"h",\u1e2b:"h",\u1e96:"h",\u0127:"h",\u2c68:"h",\u2c76:"h",\u0265:"h",\u0195:"hv","\u24d8":"i",\uff49:"i",\u00ec:"i",\u00ed:"i",\u00ee:"i",\u0129:"i",\u012b:"i",\u012d:"i",\u00ef:"i",\u1e2f:"i",\u1ec9:"i",\u01d0:"i",\u0209:"i",\u020b:"i",\u1ecb:"i",\u012f:"i",\u1e2d:"i",\u0268:"i",\u0131:"i","\u24d9":"j",\uff4a:"j",\u0135:"j",\u01f0:"j",\u0249:"j","\u24da":"k",\uff4b:"k",\u1e31:"k",\u01e9:"k",\u1e33:"k",\u0137:"k",\u1e35:"k",\u0199:"k",\u2c6a:"k",\ua741:"k",\ua743:"k",\ua745:"k",\ua7a3:"k","\u24db":"l",\uff4c:"l",\u0140:"l",\u013a:"l",\u013e:"l",\u1e37:"l",\u1e39:"l",\u013c:"l",\u1e3d:"l",\u1e3b:"l",\u017f:"l",\u0142:"l",\u019a:"l",\u026b:"l",\u2c61:"l",\ua749:"l",\ua781:"l",\ua747:"l",\u01c9:"lj","\u24dc":"m",\uff4d:"m",\u1e3f:"m",\u1e41:"m",\u1e43:"m",\u0271:"m",\u026f:"m","\u24dd":"n",\uff4e:"n",\u01f9:"n",\u0144:"n",\u00f1:"n",\u1e45:"n",\u0148:"n",\u1e47:"n",\u0146:"n",\u1e4b:"n",\u1e49:"n",\u019e:"n",\u0272:"n",\u0149:"n",\ua791:"n",\ua7a5:"n",\u01cc:"nj","\u24de":"o",\uff4f:"o",\u00f2:"o",\u00f3:"o",\u00f4:"o",\u1ed3:"o",\u1ed1:"o",\u1ed7:"o",\u1ed5:"o",\u00f5:"o",\u1e4d:"o",\u022d:"o",\u1e4f:"o",\u014d:"o",\u1e51:"o",\u1e53:"o",\u014f:"o",\u022f:"o",\u0231:"o",\u00f6:"o",\u022b:"o",\u1ecf:"o",\u0151:"o",\u01d2:"o",\u020d:"o",\u020f:"o",\u01a1:"o",\u1edd:"o",\u1edb:"o",\u1ee1:"o",\u1edf:"o",\u1ee3:"o",\u1ecd:"o",\u1ed9:"o",\u01eb:"o",\u01ed:"o",\u00f8:"o",\u01ff:"o",\u0254:"o",\ua74b:"o",\ua74d:"o",\u0275:"o",\u01a3:"oi",\u0223:"ou",\ua74f:"oo","\u24df":"p",\uff50:"p",\u1e55:"p",\u1e57:"p",\u01a5:"p",\u1d7d:"p",\ua751:"p",\ua753:"p",\ua755:"p","\u24e0":"q",\uff51:"q",\u024b:"q",\ua757:"q",\ua759:"q","\u24e1":"r",\uff52:"r",\u0155:"r",\u1e59:"r",\u0159:"r",\u0211:"r",\u0213:"r",\u1e5b:"r",\u1e5d:"r",\u0157:"r",\u1e5f:"r",\u024d:"r",\u027d:"r",\ua75b:"r",\ua7a7:"r",\ua783:"r","\u24e2":"s",\uff53:"s",\u00df:"s",\u015b:"s",\u1e65:"s",\u015d:"s",\u1e61:"s",\u0161:"s",\u1e67:"s",\u1e63:"s",\u1e69:"s",\u0219:"s",\u015f:"s",\u023f:"s",\ua7a9:"s",\ua785:"s",\u1e9b:"s","\u24e3":"t",\uff54:"t",\u1e6b:"t",\u1e97:"t",\u0165:"t",\u1e6d:"t",\u021b:"t",\u0163:"t",\u1e71:"t",\u1e6f:"t",\u0167:"t",\u01ad:"t",\u0288:"t",\u2c66:"t",\ua787:"t",\ua729:"tz","\u24e4":"u",\uff55:"u",\u00f9:"u",\u00fa:"u",\u00fb:"u",\u0169:"u",\u1e79:"u",\u016b:"u",\u1e7b:"u",\u016d:"u",\u00fc:"u",\u01dc:"u",\u01d8:"u",\u01d6:"u",\u01da:"u",\u1ee7:"u",\u016f:"u",\u0171:"u",\u01d4:"u",\u0215:"u",\u0217:"u",\u01b0:"u",\u1eeb:"u",\u1ee9:"u",\u1eef:"u",\u1eed:"u",\u1ef1:"u",\u1ee5:"u",\u1e73:"u",\u0173:"u",\u1e77:"u",\u1e75:"u",\u0289:"u","\u24e5":"v",\uff56:"v",\u1e7d:"v",\u1e7f:"v",\u028b:"v",\ua75f:"v",\u028c:"v",\ua761:"vy","\u24e6":"w",\uff57:"w",\u1e81:"w",\u1e83:"w",\u0175:"w",\u1e87:"w",\u1e85:"w",\u1e98:"w",\u1e89:"w",\u2c73:"w","\u24e7":"x",\uff58:"x",\u1e8b:"x",\u1e8d:"x","\u24e8":"y",\uff59:"y",\u1ef3:"y",\u00fd:"y",\u0177:"y",\u1ef9:"y",\u0233:"y",\u1e8f:"y",\u00ff:"y",\u1ef7:"y",\u1e99:"y",\u1ef5:"y",\u01b4:"y",\u024f:"y",\u1eff:"y","\u24e9":"z",\uff5a:"z",\u017a:"z",\u1e91:"z",\u017c:"z",\u017e:"z",\u1e93:"z",\u1e95:"z",\u01b6:"z",\u0225:"z",\u0240:"z",\u2c6c:"z",\ua763:"z",\u0386:"\u0391",\u0388:"\u0395",\u0389:"\u0397",\u038a:"\u0399",\u03aa:"\u0399",\u038c:"\u039f",\u038e:"\u03a5",\u03ab:"\u03a5",\u038f:"\u03a9",\u03ac:"\u03b1",\u03ad:"\u03b5",\u03ae:"\u03b7",\u03af:"\u03b9",\u03ca:"\u03b9",\u0390:"\u03b9",\u03cc:"\u03bf",\u03cd:"\u03c5",\u03cb:"\u03c5",\u03b0:"\u03c5",\u03c9:"\u03c9",\u03c2:"\u03c3"};function E_(t){return t.replace(/[^\u0000-\u007E]/g,t=>S_[t]||t)}class k_{constructor(t,e){this._ngSelect=t,this._selectionModel=e,this._items=[],this._filteredItems=[],this._markedIndex=-1}get items(){return this._items}get filteredItems(){return this._filteredItems}get markedIndex(){return this._markedIndex}get selectedItems(){return this._selectionModel.value}get markedItem(){return this._filteredItems[this._markedIndex]}get noItemsToSelect(){return this._ngSelect.hideSelected&&this._items.length===this.selectedItems.length}get maxItemsSelected(){return this._ngSelect.multiple&&this._ngSelect.maxSelectedItems<=this.selectedItems.length}get lastSelectedItem(){let t=this.selectedItems.length-1;for(;t>=0;t--){let e=this.selectedItems[t];if(!e.disabled)return e}return null}setItems(t){this._items=t.map((t,e)=>this.mapItem(t,e)),this._ngSelect.groupBy?(this._groups=this._groupBy(this._items,this._ngSelect.groupBy),this._items=this._flatten(this._groups)):(this._groups=new Map,this._groups.set(void 0,this._items)),this._filteredItems=[...this._items]}select(t){if(t.selected||this.maxItemsSelected)return;const e=this._ngSelect.multiple;e||this.clearSelected(),this._selectionModel.select(t,e,this._ngSelect.selectableGroupAsModel),this._ngSelect.hideSelected&&this._hideSelected(t)}unselect(t){t.selected&&(this._selectionModel.unselect(t,this._ngSelect.multiple),this._ngSelect.hideSelected&&l_(t.index)&&this._ngSelect.multiple&&this._showSelected(t))}findItem(t){let e;return e=this._ngSelect.compareWith?e=>this._ngSelect.compareWith(e.value,t):this._ngSelect.bindValue?e=>!e.children&&this.resolveNested(e.value,this._ngSelect.bindValue)===t:e=>e.value===t||!e.children&&e.label&&e.label===this.resolveNested(t,this._ngSelect.bindLabel),this._items.find(t=>e(t))}addItem(t){const e=this.mapItem(t,this._items.length);return this._items.push(e),this._filteredItems.push(e),e}clearSelected(t=!1){this._selectionModel.clear(t),this._items.forEach(e=>{e.selected=t&&e.selected&&e.disabled,e.marked=!1}),this._ngSelect.hideSelected&&this.resetFilteredItems()}findByLabel(t){return t=E_(t).toLocaleLowerCase(),this.filteredItems.find(e=>E_(e.label).toLocaleLowerCase().substr(0,t.length)===t)}filter(t){if(!t)return void this.resetFilteredItems();this._filteredItems=[],t=this._ngSelect.searchFn?t:E_(t).toLocaleLowerCase();const e=this._ngSelect.searchFn||this._defaultSearchFn,n=this._ngSelect.hideSelected;for(const i of Array.from(this._groups.keys())){const r=[];for(const o of this._groups.get(i))n&&(o.parent&&o.parent.selected||o.selected)||e(t,this._ngSelect.searchFn?o.value:o)&&r.push(o);if(r.length>0){const[t]=r.slice(-1);if(t.parent){const e=this._items.find(e=>e===t.parent);this._filteredItems.push(e)}this._filteredItems.push(...r)}}}resetFilteredItems(){this._filteredItems.length!==this._items.length&&(this._filteredItems=this._ngSelect.hideSelected&&this.selectedItems.length>0?this._items.filter(t=>!t.selected):this._items)}unmarkItem(){this._markedIndex=-1}markNextItem(){this._stepToItem(1)}markPreviousItem(){this._stepToItem(-1)}markItem(t){this._markedIndex=this._filteredItems.indexOf(t)}markSelectedOrDefault(t){if(0===this._filteredItems.length)return;const e=this._getLastMarkedIndex();this._markedIndex=e>-1?e:t?this.filteredItems.findIndex(t=>!t.disabled):-1}resolveNested(t,e){if(!c_(t))return t;if(-1===e.indexOf("."))return t[e];{let n=e.split("."),i=t;for(let t=0,e=n.length;t<e;++t){if(null==i)return null;i=i[n[t]]}return i}}mapItem(t,e){const n=l_(t.$ngOptionLabel)?t.$ngOptionLabel:this.resolveNested(t,this._ngSelect.bindLabel),i=l_(t.$ngOptionValue)?t.$ngOptionValue:t;return{index:e,label:l_(n)?n.toString():"",value:i,disabled:t.disabled,htmlId:`${this._ngSelect.dropdownId}-${e}`}}mapSelectedItems(){const t=this._ngSelect.multiple;for(const e of this.selectedItems){const n=this._ngSelect.bindValue?this.resolveNested(e.value,this._ngSelect.bindValue):e.value,i=l_(n)?this.findItem(n):null;this._selectionModel.unselect(e,t),this._selectionModel.select(i||e,t,this._ngSelect.selectableGroupAsModel)}this._ngSelect.hideSelected&&(this._filteredItems=this.filteredItems.filter(t=>-1===this.selectedItems.indexOf(t)))}_showSelected(t){if(this._filteredItems.push(t),t.parent){const e=t.parent;this._filteredItems.find(t=>t===e)||this._filteredItems.push(e)}else if(t.children)for(const e of t.children)e.selected=!1,this._filteredItems.push(e);this._filteredItems=[...this._filteredItems.sort((t,e)=>t.index-e.index)]}_hideSelected(t){this._filteredItems=this._filteredItems.filter(e=>e!==t),t.parent?t.parent.children.every(t=>t.selected)&&(this._filteredItems=this._filteredItems.filter(e=>e!==t.parent)):t.children&&(this._filteredItems=this.filteredItems.filter(e=>e.parent!==t))}_defaultSearchFn(t,e){return E_(e.label).toLocaleLowerCase().indexOf(t)>-1}_getNextItemIndex(t){return t>0?this._markedIndex>=this._filteredItems.length-1?0:this._markedIndex+1:this._markedIndex<=0?this._filteredItems.length-1:this._markedIndex-1}_stepToItem(t){0===this._filteredItems.length||this._filteredItems.every(t=>t.disabled)||(this._markedIndex=this._getNextItemIndex(t),this.markedItem.disabled&&this._stepToItem(t))}_getLastMarkedIndex(){if(this._ngSelect.hideSelected)return-1;if(this._markedIndex>-1&&void 0===this.markedItem)return-1;const t=this._filteredItems.indexOf(this.lastSelectedItem);return this.lastSelectedItem&&t<0?-1:Math.max(this.markedIndex,t)}_groupBy(t,e){const n=new Map;if(0===t.length)return n;if(Array.isArray(t[0].value[e])){for(const i of t){const t=(i.value[e]||[]).map((t,e)=>this.mapItem(t,e));n.set(i,t)}return n}const i=u_(this._ngSelect.groupBy),r=t=>{let n=i?e(t.value):t.value[e];return l_(n)?n:void 0};for(const o of t){let t=r(o);const e=n.get(t);e?e.push(o):n.set(t,[o])}return n}_flatten(t){const e=u_(this._ngSelect.groupBy),n=[];for(const i of Array.from(t.keys())){let r=n.length;if(void 0===i){const e=t.get(void 0)||[];n.push(...e.map(t=>(t.index=r++,t)));continue}const o=c_(i),s={label:o?"":String(i),children:void 0,parent:null,index:r++,disabled:!this._ngSelect.selectableGroup,htmlId:T_()},a=e?this._ngSelect.bindLabel:this._ngSelect.groupBy,l=this._ngSelect.groupValue||(()=>o?i.value:{[a]:i}),c=t.get(i).map(t=>(t.parent=s,t.children=void 0,t.index=r++,t));s.children=c,s.value=l(i,c.map(t=>t.value)),n.push(s),n.push(...c)}return n}}var A_=function(t){return t[t.Tab=9]="Tab",t[t.Enter=13]="Enter",t[t.Esc=27]="Esc",t[t.Space=32]="Space",t[t.ArrowUp=38]="ArrowUp",t[t.ArrowDown=40]="ArrowDown",t[t.Backspace=8]="Backspace",t}({});let I_=(()=>{class t{constructor(){this._dimensions={itemHeight:0,panelHeight:0,itemsPerViewport:0}}get dimensions(){return this._dimensions}calculateItems(t,e,n){const i=this._dimensions,r=i.itemHeight*e,o=Math.max(0,t)/r*e;let s=Math.min(e,Math.ceil(o)+(i.itemsPerViewport+1));const a=Math.max(0,s-i.itemsPerViewport);let l=Math.min(a,Math.floor(o)),c=i.itemHeight*Math.ceil(l)-i.itemHeight*Math.min(l,n);return c=isNaN(c)?0:c,l=isNaN(l)?-1:l,s=isNaN(s)?-1:s,l-=n,l=Math.max(0,l),s+=n,s=Math.min(e,s),{topPadding:c,scrollHeight:r,start:l,end:s}}setDimensions(t,e){const n=Math.max(1,Math.floor(e/t));this._dimensions={itemHeight:t,panelHeight:e,itemsPerViewport:n}}getScrollTo(t,e,n){const{panelHeight:i}=this.dimensions,r=t+e,o=n+i;return i>=r&&n===t?null:r>o?n+r-o:t<=n?t:null}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=at({token:t,factory:t.\u0275fac}),t})();const P_="undefined"!=typeof requestAnimationFrame?hg:vg;let M_=(()=>{class t{constructor(t,e,n,i,r){this._renderer=t,this._zone=e,this._panelService=n,this._document=r,this.items=[],this.position="auto",this.virtualScroll=!1,this.filterValue=null,this.update=new el,this.scroll=new el,this.scrollToEnd=new el,this.outsideClick=new el,this._destroy$=new C,this._scrollToEndFired=!1,this._updateScrollHeight=!1,this._lastScrollPosition=0,this._dropdown=i.nativeElement}get currentPosition(){return this._currentPosition}get itemsLength(){return this._itemsLength}set itemsLength(t){t!==this._itemsLength&&(this._itemsLength=t,this._onItemsLengthChanged())}get _startOffset(){if(this.markedItem){const{itemHeight:t,panelHeight:e}=this._panelService.dimensions,n=this.markedItem.index*t;return e>n?0:n}return 0}ngOnInit(){this._select=this._dropdown.parentElement,this._virtualPadding=this.paddingElementRef.nativeElement,this._scrollablePanel=this.scrollElementRef.nativeElement,this._contentPanel=this.contentElementRef.nativeElement,this._handleScroll(),this._handleOutsideClick(),this._appendDropdown(),this._setupMousedownListener()}ngOnChanges(t){if(t.items){const e=t.items;this._onItemsChange(e.currentValue,e.firstChange)}}ngOnDestroy(){this._destroy$.next(),this._destroy$.complete(),this._destroy$.unsubscribe(),this.appendTo&&this._renderer.removeChild(this._dropdown.parentNode,this._dropdown)}scrollTo(t,e=!1){if(!t)return;const n=this.items.indexOf(t);if(n<0||n>=this.itemsLength)return;let i;if(this.virtualScroll){const t=this._panelService.dimensions.itemHeight;i=this._panelService.getScrollTo(n*t,t,this._lastScrollPosition)}else{const n=this._dropdown.querySelector("#"+t.htmlId);i=this._panelService.getScrollTo(n.offsetTop,n.clientHeight,e?n.offsetTop:this._lastScrollPosition)}l_(i)&&(this._scrollablePanel.scrollTop=i)}scrollToTag(){const t=this._scrollablePanel;t.scrollTop=t.scrollHeight-t.clientHeight}adjustPosition(){this._updateYPosition()}_handleDropdownPosition(){this._currentPosition=this._calculateCurrentPosition(this._dropdown),"top"===this._currentPosition?(this._renderer.addClass(this._dropdown,"ng-select-top"),this._renderer.removeClass(this._dropdown,"ng-select-bottom"),this._renderer.addClass(this._select,"ng-select-top"),this._renderer.removeClass(this._select,"ng-select-bottom")):(this._renderer.addClass(this._dropdown,"ng-select-bottom"),this._renderer.removeClass(this._dropdown,"ng-select-top"),this._renderer.addClass(this._select,"ng-select-bottom"),this._renderer.removeClass(this._select,"ng-select-top")),this.appendTo&&this._updateYPosition(),this._dropdown.style.opacity="1"}_handleScroll(){this._zone.runOutsideAngular(()=>{xg(this.scrollElementRef.nativeElement,"scroll").pipe(Hm(this._destroy$),function(t,e=tg){return n=()=>rg(t,e),function(t){return t.lift(new eg(n))};var n}(0,P_)).subscribe(t=>{const e=t.path||t.composedPath&&t.composedPath();this._onContentScrolled(e&&0!==e.length?e[0].scrollTop:t.target.scrollTop)})})}_handleOutsideClick(){this._document&&this._zone.runOutsideAngular(()=>{G(xg(this._document,"touchstart",{capture:!0}),xg(this._document,"mousedown",{capture:!0})).pipe(Hm(this._destroy$)).subscribe(t=>this._checkToClose(t))})}_checkToClose(t){if(this._select.contains(t.target)||this._dropdown.contains(t.target))return;const e=t.path||t.composedPath&&t.composedPath();t.target&&t.target.shadowRoot&&e&&e[0]&&this._select.contains(e[0])||this._zone.run(()=>this.outsideClick.emit())}_onItemsChange(t,e){this.items=t||[],this._scrollToEndFired=!1,this.itemsLength=t.length,this.virtualScroll?this._updateItemsRange(e):(this._setVirtualHeight(),this._updateItems(e))}_updateItems(t){this.update.emit(this.items),!1!==t&&this._zone.runOutsideAngular(()=>{Promise.resolve().then(()=>{this._panelService.setDimensions(0,this._scrollablePanel.clientHeight),this._handleDropdownPosition(),this.scrollTo(this.markedItem,t)})})}_updateItemsRange(t){this._zone.runOutsideAngular(()=>{this._measureDimensions().then(()=>{t?(this._renderItemsRange(this._startOffset),this._handleDropdownPosition()):this._renderItemsRange()})})}_onContentScrolled(t){this.virtualScroll&&this._renderItemsRange(t),this._lastScrollPosition=t,this._fireScrollToEnd(t)}_updateVirtualHeight(t){this._updateScrollHeight&&(this._virtualPadding.style.height=t+"px",this._updateScrollHeight=!1)}_setVirtualHeight(){this._virtualPadding&&(this._virtualPadding.style.height="0px")}_onItemsLengthChanged(){this._updateScrollHeight=!0}_renderItemsRange(t=null){if(t&&this._lastScrollPosition===t)return;const e=this._panelService.calculateItems(t=t||this._scrollablePanel.scrollTop,this.itemsLength,this.bufferAmount);this._updateVirtualHeight(e.scrollHeight),this._contentPanel.style.transform=`translateY(${e.topPadding}px)`,this._zone.run(()=>{this.update.emit(this.items.slice(e.start,e.end)),this.scroll.emit({start:e.start,end:e.end})}),l_(t)&&0===this._lastScrollPosition&&(this._scrollablePanel.scrollTop=t,this._lastScrollPosition=t)}_measureDimensions(){if(this._panelService.dimensions.itemHeight>0||0===this.itemsLength)return Promise.resolve(this._panelService.dimensions);const[t]=this.items;return this.update.emit([t]),Promise.resolve().then(()=>{const e=this._dropdown.querySelector("#"+t.htmlId).clientHeight;return this._virtualPadding.style.height=e*this.itemsLength+"px",this._panelService.setDimensions(e,this._scrollablePanel.clientHeight),this._panelService.dimensions})}_fireScrollToEnd(t){this._scrollToEndFired||0===t||t+this._dropdown.clientHeight>=(this.virtualScroll?this._virtualPadding:this._contentPanel).clientHeight-1&&(this._zone.run(()=>this.scrollToEnd.emit()),this._scrollToEndFired=!0)}_calculateCurrentPosition(t){if("auto"!==this.position)return this.position;const e=this._select.getBoundingClientRect(),n=document.documentElement.scrollTop||document.body.scrollTop;return e.top+window.pageYOffset+e.height+t.getBoundingClientRect().height>n+document.documentElement.clientHeight?"top":"bottom"}_appendDropdown(){if(this.appendTo){if(this._parent=document.querySelector(this.appendTo),!this._parent)throw new Error(`appendTo selector ${this.appendTo} did not found any parent element`);this._updateXPosition(),this._parent.appendChild(this._dropdown)}}_updateXPosition(){const t=this._select.getBoundingClientRect(),e=this._parent.getBoundingClientRect();this._dropdown.style.left=t.left-e.left+"px",this._dropdown.style.width=t.width+"px",this._dropdown.style.minWidth=t.width+"px"}_updateYPosition(){const t=this._select.getBoundingClientRect(),e=this._parent.getBoundingClientRect(),n=t.height;"top"===this._currentPosition?(this._dropdown.style.bottom=e.bottom-t.bottom+n+"px",this._dropdown.style.top="auto"):"bottom"===this._currentPosition&&(this._dropdown.style.top=t.top-e.top+n+"px",this._dropdown.style.bottom="auto")}_setupMousedownListener(){this._zone.runOutsideAngular(()=>{xg(this._dropdown,"mousedown").pipe(Hm(this._destroy$)).subscribe(t=>{"INPUT"!==t.target.tagName&&t.preventDefault()})})}}return t.\u0275fac=function(e){return new(e||t)(jo(ea),jo(ql),jo(I_),jo(Qs),jo(wc,8))},t.\u0275cmp=Bt({type:t,selectors:[["ng-dropdown-panel"]],viewQuery:function(t,e){if(1&t&&(fl(wg,!0,Qs),fl(Cg,!0,Qs),fl(Tg,!0,Qs)),2&t){let t;pl(t=_l())&&(e.contentElementRef=t.first),pl(t=_l())&&(e.scrollElementRef=t.first),pl(t=_l())&&(e.paddingElementRef=t.first)}},inputs:{items:"items",position:"position",virtualScroll:"virtualScroll",filterValue:"filterValue",markedItem:"markedItem",appendTo:"appendTo",bufferAmount:"bufferAmount",headerTemplate:"headerTemplate",footerTemplate:"footerTemplate"},outputs:{update:"update",scroll:"scroll",scrollToEnd:"scrollToEnd",outsideClick:"outsideClick"},features:[oe],ngContentSelectors:Ag,decls:9,vars:6,consts:[["class","ng-dropdown-header",4,"ngIf"],[1,"ng-dropdown-panel-items","scroll-host"],["scroll",""],["padding",""],["content",""],["class","ng-dropdown-footer",4,"ngIf"],[1,"ng-dropdown-header"],[3,"ngTemplateOutlet","ngTemplateOutletContext"],[1,"ng-dropdown-footer"]],template:function(t,e){1&t&&(os(),Uo(0,Eg,2,4,"div",0),Go(1,"div",1,2),Ho(3,"div",null,3),Go(5,"div",null,4),ss(7),Zo(),Zo(),Uo(8,kg,2,4,"div",5)),2&t&&(qo("ngIf",e.headerTemplate),ur(3),gs("total-padding",e.virtualScroll),ur(2),gs("scrollable-content",e.virtualScroll&&e.items.length),ur(3),qo("ngIf",e.footerTemplate))},directives:[Wc,Yc],encapsulation:2,changeDetection:0}),t})(),O_=(()=>{class t{constructor(t){this.elementRef=t,this.stateChange$=new C,this._disabled=!1}get disabled(){return this._disabled}set disabled(t){this._disabled=this._isDisabled(t)}get label(){return(this.elementRef.nativeElement.textContent||"").trim()}ngOnChanges(t){t.disabled&&this.stateChange$.next({value:this.value,disabled:this._disabled})}ngAfterViewChecked(){this.label!==this._previousLabel&&(this._previousLabel=this.label,this.stateChange$.next({value:this.value,disabled:this._disabled,label:this.elementRef.nativeElement.innerHTML}))}ngOnDestroy(){this.stateChange$.complete()}_isDisabled(t){return null!=t&&""+t!="false"}}return t.\u0275fac=function(e){return new(e||t)(jo(Qs))},t.\u0275cmp=Bt({type:t,selectors:[["ng-option"]],inputs:{disabled:"disabled",value:"value"},features:[oe],ngContentSelectors:Ag,decls:1,vars:0,template:function(t,e){1&t&&(os(),ss(0))},encapsulation:2,changeDetection:0}),t})(),z_=(()=>{class t{constructor(){this.notFoundText="No items found",this.typeToSearchText="Type to search",this.addTagText="Add item",this.loadingText="Loading...",this.clearAllText="Clear all",this.disableVirtualScroll=!0,this.openOnEnter=!0,this.appearance="underline"}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=at({factory:function(){return new t},token:t,providedIn:"root"}),t})();const D_=new Nn("ng-select-selection-model");let L_=(()=>{class t{constructor(t,e,n,i,r,o,s){this.classes=t,this.autoFocus=e,this._cd=o,this._console=s,this.markFirst=!0,this.dropdownPosition="auto",this.loading=!1,this.closeOnSelect=!0,this.hideSelected=!1,this.selectOnTab=!1,this.bufferAmount=4,this.selectableGroup=!1,this.selectableGroupAsModel=!0,this.searchFn=null,this.trackByFn=null,this.clearOnBackspace=!0,this.labelForId=null,this.inputAttrs={},this.readonly=!1,this.searchWhileComposing=!0,this.minTermLength=0,this.editableSearchTerm=!1,this.keyDownFn=t=>!0,this.multiple=!1,this.addTag=!1,this.searchable=!0,this.clearable=!0,this.isOpen=!1,this.blurEvent=new el,this.focusEvent=new el,this.changeEvent=new el,this.openEvent=new el,this.closeEvent=new el,this.searchEvent=new el,this.clearEvent=new el,this.addEvent=new el,this.removeEvent=new el,this.scroll=new el,this.scrollToEnd=new el,this.viewPortItems=[],this.searchTerm=null,this.dropdownId=T_(),this.escapeHTML=!0,this.useDefaultClass=!0,this._items=[],this._defaultLabel="label",this._pressedKeys=[],this._isComposing=!1,this._destroy$=new C,this._keyPress$=new C,this._onChange=t=>{},this._onTouched=()=>{},this.clearItem=t=>{const e=this.selectedItems.find(e=>e.value===t);this.unselect(e)},this.trackByOption=(t,e)=>this.trackByFn?this.trackByFn(e.value):e,this._mergeGlobalConfig(n),this.itemsList=new k_(this,i()),this.element=r.nativeElement}get items(){return this._items}set items(t){null===t&&(t=[]),this._itemsAreUsed=!0,this._items=t}get compareWith(){return this._compareWith}set compareWith(t){if(null!=t&&!u_(t))throw Error("`compareWith` must be a function.");this._compareWith=t}get clearSearchOnAdd(){return l_(this._clearSearchOnAdd)?this._clearSearchOnAdd:this.closeOnSelect}set clearSearchOnAdd(t){this._clearSearchOnAdd=t}get disabled(){return this.readonly||this._disabled}get filtered(){return!!this.searchTerm&&this.searchable||this._isComposing}get _editableSearchTerm(){return this.editableSearchTerm&&!this.multiple}get selectedItems(){return this.itemsList.selectedItems}get selectedValues(){return this.selectedItems.map(t=>t.value)}get hasValue(){return this.selectedItems.length>0}get currentPanelPosition(){if(this.dropdownPanel)return this.dropdownPanel.currentPosition}ngOnInit(){this._handleKeyPresses(),this._setInputAttributes()}ngOnChanges(t){t.multiple&&this.itemsList.clearSelected(),t.items&&this._setItems(t.items.currentValue||[]),t.isOpen&&(this._manualOpen=l_(t.isOpen.currentValue))}ngAfterViewInit(){this._itemsAreUsed||(this.escapeHTML=!1,this._setItemsFromNgOptions()),l_(this.autoFocus)&&this.focus()}ngOnDestroy(){this._destroy$.next(),this._destroy$.complete()}handleKeyDown(t){if(A_[t.which]){if(!1===this.keyDownFn(t))return;this.handleKeyCode(t)}else t.key&&1===t.key.length&&this._keyPress$.next(t.key.toLocaleLowerCase())}handleKeyCode(t){switch(t.which){case A_.ArrowDown:this._handleArrowDown(t);break;case A_.ArrowUp:this._handleArrowUp(t);break;case A_.Space:this._handleSpace(t);break;case A_.Enter:this._handleEnter(t);break;case A_.Tab:this._handleTab(t);break;case A_.Esc:this.close(),t.preventDefault();break;case A_.Backspace:this._handleBackspace()}}handleMousedown(t){const e=t.target;"INPUT"!==e.tagName&&t.preventDefault(),e.classList.contains("ng-clear-wrapper")?this.handleClearClick():e.classList.contains("ng-arrow-wrapper")?this.handleArrowClick():e.classList.contains("ng-value-icon")||(this.focused||this.focus(),this.searchable?this.open():this.toggle())}handleArrowClick(){this.isOpen?this.close():this.open()}handleClearClick(){this.hasValue&&(this.itemsList.clearSelected(!0),this._updateNgModel()),this._clearSearch(),this.focus(),this.clearEvent.emit(),this._onSelectionChanged()}clearModel(){this.clearable&&(this.itemsList.clearSelected(),this._updateNgModel())}writeValue(t){this.itemsList.clearSelected(),this._handleWriteValue(t),this._cd.markForCheck()}registerOnChange(t){this._onChange=t}registerOnTouched(t){this._onTouched=t}setDisabledState(t){this._disabled=t,this._cd.markForCheck()}toggle(){this.isOpen?this.close():this.open()}open(){this.disabled||this.isOpen||this.itemsList.maxItemsSelected||this._manualOpen||(this._isTypeahead||this.addTag||!this.itemsList.noItemsToSelect)&&(this.isOpen=!0,this.itemsList.markSelectedOrDefault(this.markFirst),this.openEvent.emit(),this.searchTerm||this.focus(),this.detectChanges())}close(){this.isOpen&&!this._manualOpen&&(this.isOpen=!1,this._isComposing=!1,this._editableSearchTerm?this.itemsList.resetFilteredItems():this._clearSearch(),this.itemsList.unmarkItem(),this._onTouched(),this.closeEvent.emit(),this._cd.markForCheck())}toggleItem(t){!t||t.disabled||this.disabled||(this.multiple&&t.selected?this.unselect(t):this.select(t),this._editableSearchTerm&&this._setSearchTermFromItems(),this._onSelectionChanged())}select(t){t.selected||(this.itemsList.select(t),this.clearSearchOnAdd&&!this._editableSearchTerm&&this._clearSearch(),this._updateNgModel(),this.multiple&&this.addEvent.emit(t.value)),(this.closeOnSelect||this.itemsList.noItemsToSelect)&&this.close()}focus(){this.searchInput.nativeElement.focus()}blur(){this.searchInput.nativeElement.blur()}unselect(t){t&&(this.itemsList.unselect(t),this.focus(),this._updateNgModel(),this.removeEvent.emit(t))}selectTag(){let t;t=u_(this.addTag)?this.addTag(this.searchTerm):this._primitive?this.searchTerm:{[this.bindLabel]:this.searchTerm};const e=t=>this._isTypeahead||!this.isOpen?this.itemsList.mapItem(t,null):this.itemsList.addItem(t);t instanceof Promise?t.then(t=>this.select(e(t))).catch(()=>{}):t&&this.select(e(t))}showClear(){return this.clearable&&(this.hasValue||this.searchTerm)&&!this.disabled}get showAddTag(){if(!this._validTerm)return!1;const t=this.searchTerm.toLowerCase().trim();return this.addTag&&!this.itemsList.filteredItems.some(e=>e.label.toLowerCase()===t)&&(!this.hideSelected&&this.isOpen||!this.selectedItems.some(e=>e.label.toLowerCase()===t))&&!this.loading}showNoItemsFound(){const t=0===this.itemsList.filteredItems.length;return(t&&!this._isTypeahead&&!this.loading||t&&this._isTypeahead&&this._validTerm&&!this.loading)&&!this.showAddTag}showTypeToSearch(){return 0===this.itemsList.filteredItems.length&&this._isTypeahead&&!this._validTerm&&!this.loading}onCompositionStart(){this._isComposing=!0}onCompositionEnd(t){this._isComposing=!1,this.searchWhileComposing||this.filter(t)}filter(t){this._isComposing&&!this.searchWhileComposing||(this.searchTerm=t,this._isTypeahead&&(this._validTerm||0===this.minTermLength)&&this.typeahead.next(t),this._isTypeahead||(this.itemsList.filter(this.searchTerm),this.isOpen&&this.itemsList.markSelectedOrDefault(this.markFirst)),this.searchEvent.emit({term:t,items:this.itemsList.filteredItems.map(t=>t.value)}),this.open())}onInputFocus(t){this.focused||(this._editableSearchTerm&&this._setSearchTermFromItems(),this.element.classList.add("ng-select-focused"),this.focusEvent.emit(t),this.focused=!0)}onInputBlur(t){this.element.classList.remove("ng-select-focused"),this.blurEvent.emit(t),this.isOpen||this.disabled||this._onTouched(),this._editableSearchTerm&&this._setSearchTermFromItems(),this.focused=!1}onItemHover(t){t.disabled||this.itemsList.markItem(t)}detectChanges(){this._cd.destroyed||this._cd.detectChanges()}_setSearchTermFromItems(){const t=this.selectedItems&&this.selectedItems[0];this.searchTerm=t&&t.label||null}_setItems(t){const e=t[0];this.bindLabel=this.bindLabel||this._defaultLabel,this._primitive=l_(e)?!c_(e):this._primitive||this.bindLabel===this._defaultLabel,this.itemsList.setItems(t),t.length>0&&this.hasValue&&this.itemsList.mapSelectedItems(),this.isOpen&&l_(this.searchTerm)&&!this._isTypeahead&&this.itemsList.filter(this.searchTerm),(this._isTypeahead||this.isOpen)&&this.itemsList.markSelectedOrDefault(this.markFirst)}_setItemsFromNgOptions(){const t=t=>{this.items=t.map(t=>({$ngOptionValue:t.value,$ngOptionLabel:t.elementRef.nativeElement.innerHTML,disabled:t.disabled})),this.itemsList.setItems(this.items),this.hasValue&&this.itemsList.mapSelectedItems(),this.detectChanges()},e=()=>{const t=G(this.ngOptions.changes,this._destroy$);G(...this.ngOptions.map(t=>t.stateChange$)).pipe(Hm(t)).subscribe(t=>{const e=this.itemsList.findItem(t.value);e.disabled=t.disabled,e.label=t.label||e.label,this._cd.detectChanges()})};this.ngOptions.changes.pipe(wu(this.ngOptions),Hm(this._destroy$)).subscribe(n=>{this.bindLabel=this._defaultLabel,t(n),e()})}_isValidWriteValue(t){if(!l_(t)||this.multiple&&""===t||Array.isArray(t)&&0===t.length)return!1;const e=t=>!(!l_(this.compareWith)&&c_(t)&&this.bindValue&&(this._console.warn(`Setting object(${JSON.stringify(t)}) as your model with bindValue is not allowed unless [compareWith] is used.`),1));return this.multiple?Array.isArray(t)?t.every(t=>e(t)):(this._console.warn("Multiple select ngModel should be array."),!1):e(t)}_handleWriteValue(t){if(!this._isValidWriteValue(t))return;const e=t=>{let e=this.itemsList.findItem(t);if(e)this.itemsList.select(e);else{const n=c_(t),i=!n&&!this.bindValue;n||i?this.itemsList.select(this.itemsList.mapItem(t,null)):this.bindValue&&(e={[this.bindLabel]:null,[this.bindValue]:t},this.itemsList.select(this.itemsList.mapItem(e,null)))}};this.multiple?t.forEach(t=>e(t)):e(t)}_handleKeyPresses(){this.searchable||this._keyPress$.pipe(Hm(this._destroy$),Gu(t=>this._pressedKeys.push(t)),function(t,e=tg){return n=>n.lift(new sg(t,e))}(200),Eu(()=>this._pressedKeys.length>0),E(()=>this._pressedKeys.join(""))).subscribe(t=>{const e=this.itemsList.findByLabel(t);e&&(this.isOpen?(this.itemsList.markItem(e),this._scrollToMarked(),this._cd.markForCheck()):this.select(e)),this._pressedKeys=[]})}_setInputAttributes(){const t=this.searchInput.nativeElement,e=Object.assign({type:"text",autocorrect:"off",autocapitalize:"off",autocomplete:this.labelForId?"off":this.dropdownId},this.inputAttrs);for(const n of Object.keys(e))t.setAttribute(n,e[n])}_updateNgModel(){const t=[];for(const n of this.selectedItems)if(this.bindValue){let e=null;e=n.children?n.value[(this.groupValue?this.bindValue:this.groupBy)||this.groupBy]:this.itemsList.resolveNested(n.value,this.bindValue),t.push(e)}else t.push(n.value);const e=this.selectedItems.map(t=>t.value);this.multiple?(this._onChange(t),this.changeEvent.emit(e)):(this._onChange(l_(t[0])?t[0]:null),this.changeEvent.emit(e[0])),this._cd.markForCheck()}_clearSearch(){this.searchTerm&&(this._changeSearch(null),this.itemsList.resetFilteredItems())}_changeSearch(t){this.searchTerm=t,this._isTypeahead&&this.typeahead.next(t)}_scrollToMarked(){this.isOpen&&this.dropdownPanel&&this.dropdownPanel.scrollTo(this.itemsList.markedItem)}_scrollToTag(){this.isOpen&&this.dropdownPanel&&this.dropdownPanel.scrollToTag()}_onSelectionChanged(){this.isOpen&&this.multiple&&this.appendTo&&(this._cd.detectChanges(),this.dropdownPanel.adjustPosition())}_handleTab(t){(!1!==this.isOpen||this.addTag)&&(this.selectOnTab?this.itemsList.markedItem?(this.toggleItem(this.itemsList.markedItem),t.preventDefault()):this.showAddTag?(this.selectTag(),t.preventDefault()):this.close():this.close())}_handleEnter(t){if(this.isOpen||this._manualOpen)this.itemsList.markedItem?this.toggleItem(this.itemsList.markedItem):this.showAddTag&&this.selectTag();else{if(!this.openOnEnter)return;this.open()}t.preventDefault()}_handleSpace(t){this.isOpen||this._manualOpen||(this.open(),t.preventDefault())}_handleArrowDown(t){this._nextItemIsTag(1)?(this.itemsList.unmarkItem(),this._scrollToTag()):(this.itemsList.markNextItem(),this._scrollToMarked()),this.open(),t.preventDefault()}_handleArrowUp(t){this.isOpen&&(this._nextItemIsTag(-1)?(this.itemsList.unmarkItem(),this._scrollToTag()):(this.itemsList.markPreviousItem(),this._scrollToMarked()),t.preventDefault())}_nextItemIsTag(t){const e=this.itemsList.markedIndex+t;return this.addTag&&this.searchTerm&&this.itemsList.markedItem&&(e<0||e===this.itemsList.filteredItems.length)}_handleBackspace(){!this.searchTerm&&this.clearable&&this.clearOnBackspace&&this.hasValue&&(this.multiple?this.unselect(this.itemsList.lastSelectedItem):this.clearModel())}get _isTypeahead(){return this.typeahead&&this.typeahead.observers.length>0}get _validTerm(){const t=this.searchTerm&&this.searchTerm.trim();return t&&t.length>=this.minTermLength}_mergeGlobalConfig(t){this.placeholder=this.placeholder||t.placeholder,this.notFoundText=this.notFoundText||t.notFoundText,this.typeToSearchText=this.typeToSearchText||t.typeToSearchText,this.addTagText=this.addTagText||t.addTagText,this.loadingText=this.loadingText||t.loadingText,this.clearAllText=this.clearAllText||t.clearAllText,this.virtualScroll=l_(this.virtualScroll)?this.virtualScroll:!!l_(t.disableVirtualScroll)&&!t.disableVirtualScroll,this.openOnEnter=l_(this.openOnEnter)?this.openOnEnter:t.openOnEnter,this.appendTo=this.appendTo||t.appendTo,this.bindValue=this.bindValue||t.bindValue,this.bindLabel=this.bindLabel||t.bindLabel,this.appearance=this.appearance||t.appearance}}return t.\u0275fac=function(e){return new(e||t)(Vn("class"),Vn("autofocus"),jo(z_),jo(D_),jo(Qs),jo(wa),jo(C_))},t.\u0275cmp=Bt({type:t,selectors:[["ng-select"]],contentQueries:function(t,e,n){if(1&t&&(gl(n,d_,!0,ka),gl(n,p_,!0,ka),gl(n,f_,!0,ka),gl(n,m_,!0,ka),gl(n,g_,!0,ka),gl(n,__,!0,ka),gl(n,y_,!0,ka),gl(n,v_,!0,ka),gl(n,x_,!0,ka),gl(n,b_,!0,ka),gl(n,w_,!0,ka),gl(n,O_,!0)),2&t){let t;pl(t=_l())&&(e.optionTemplate=t.first),pl(t=_l())&&(e.optgroupTemplate=t.first),pl(t=_l())&&(e.labelTemplate=t.first),pl(t=_l())&&(e.multiLabelTemplate=t.first),pl(t=_l())&&(e.headerTemplate=t.first),pl(t=_l())&&(e.footerTemplate=t.first),pl(t=_l())&&(e.notFoundTemplate=t.first),pl(t=_l())&&(e.typeToSearchTemplate=t.first),pl(t=_l())&&(e.loadingTextTemplate=t.first),pl(t=_l())&&(e.tagTemplate=t.first),pl(t=_l())&&(e.loadingSpinnerTemplate=t.first),pl(t=_l())&&(e.ngOptions=t)}},viewQuery:function(t,e){if(1&t&&(n=M_,!0,ml(Ae(),ke(),n,true,undefined,!1),fl(Ig,!0)),2&t){let t;pl(t=_l())&&(e.dropdownPanel=t.first),pl(t=_l())&&(e.searchInput=t.first)}var n},hostVars:20,hostBindings:function(t,e){1&t&&ts("keydown",function(t){return e.handleKeyDown(t)}),2&t&&gs("ng-select",e.useDefaultClass)("ng-select-single",!e.multiple)("ng-select-multiple",e.multiple)("ng-select-taggable",e.addTag)("ng-select-searchable",e.searchable)("ng-select-clearable",e.clearable)("ng-select-opened",e.isOpen)("ng-select-disabled",e.disabled)("ng-select-filtered",e.filtered)("ng-select-typeahead",e.typeahead)},inputs:{markFirst:"markFirst",dropdownPosition:"dropdownPosition",loading:"loading",closeOnSelect:"closeOnSelect",hideSelected:"hideSelected",selectOnTab:"selectOnTab",bufferAmount:"bufferAmount",selectableGroup:"selectableGroup",selectableGroupAsModel:"selectableGroupAsModel",searchFn:"searchFn",trackByFn:"trackByFn",clearOnBackspace:"clearOnBackspace",labelForId:"labelForId",inputAttrs:"inputAttrs",readonly:"readonly",searchWhileComposing:"searchWhileComposing",minTermLength:"minTermLength",editableSearchTerm:"editableSearchTerm",keyDownFn:"keyDownFn",multiple:"multiple",addTag:"addTag",searchable:"searchable",clearable:"clearable",isOpen:"isOpen",items:"items",compareWith:"compareWith",clearSearchOnAdd:"clearSearchOnAdd",bindLabel:"bindLabel",placeholder:"placeholder",notFoundText:"notFoundText",typeToSearchText:"typeToSearchText",addTagText:"addTagText",loadingText:"loadingText",clearAllText:"clearAllText",virtualScroll:"virtualScroll",openOnEnter:"openOnEnter",appendTo:"appendTo",bindValue:"bindValue",appearance:"appearance",maxSelectedItems:"maxSelectedItems",groupBy:"groupBy",groupValue:"groupValue",tabIndex:"tabIndex",typeahead:"typeahead"},outputs:{blurEvent:"blur",focusEvent:"focus",changeEvent:"change",openEvent:"open",closeEvent:"close",searchEvent:"search",clearEvent:"clear",addEvent:"add",removeEvent:"remove",scroll:"scroll",scrollToEnd:"scrollToEnd"},features:[Zs([{provide:xf,useExisting:rt(()=>t),multi:!0},I_]),oe],decls:14,vars:19,consts:[[1,"ng-select-container",3,"mousedown"],[1,"ng-value-container"],[1,"ng-placeholder"],[4,"ngIf"],["role","combobox","aria-haspopup","listbox",1,"ng-input"],["aria-autocomplete","list",3,"readOnly","disabled","value","input","compositionstart","compositionend","focus","blur","change"],["searchInput",""],["class","ng-clear-wrapper",3,"title",4,"ngIf"],[1,"ng-arrow-wrapper"],[1,"ng-arrow"],["class","ng-dropdown-panel","role","listbox","aria-label","Options list",3,"virtualScroll","bufferAmount","appendTo","position","headerTemplate","footerTemplate","filterValue","items","markedItem","ng-select-multiple","ngClass","id","update","scroll","scrollToEnd","outsideClick",4,"ngIf"],["class","ng-value",3,"ng-value-disabled",4,"ngFor","ngForOf","ngForTrackBy"],[1,"ng-value"],["defaultLabelTemplate",""],[3,"ngTemplateOutlet","ngTemplateOutletContext"],["aria-hidden","true",1,"ng-value-icon","left",3,"click"],[1,"ng-value-label",3,"ngItemLabel","escape"],["defaultLoadingSpinnerTemplate",""],[3,"ngTemplateOutlet"],[1,"ng-spinner-loader"],[1,"ng-clear-wrapper",3,"title"],["aria-hidden","true",1,"ng-clear"],["role","listbox","aria-label","Options list",1,"ng-dropdown-panel",3,"virtualScroll","bufferAmount","appendTo","position","headerTemplate","footerTemplate","filterValue","items","markedItem","ngClass","id","update","scroll","scrollToEnd","outsideClick"],["class","ng-option",3,"ng-option-disabled","ng-option-selected","ng-optgroup","ng-option","ng-option-child","ng-option-marked","click","mouseover",4,"ngFor","ngForOf","ngForTrackBy"],["class","ng-option","role","option",3,"ng-option-marked","mouseover","click",4,"ngIf"],[1,"ng-option",3,"click","mouseover"],["defaultOptionTemplate",""],[1,"ng-option-label",3,"ngItemLabel","escape"],["role","option",1,"ng-option",3,"mouseover","click"],["defaultTagTemplate",""],[1,"ng-tag-label"],["defaultNotFoundTemplate",""],[1,"ng-option","ng-option-disabled"],["defaultTypeToSearchTemplate",""],["defaultLoadingTextTemplate",""]],template:function(t,e){if(1&t){const t=Yo();Go(0,"div",0),ts("mousedown",function(t){return e.handleMousedown(t)}),Go(1,"div",1),Go(2,"div",2),ks(3),Zo(),Uo(4,Dg,2,2,"ng-container",3),Uo(5,Fg,1,5,void 0,3),Go(6,"div",4),Go(7,"input",5,6),ts("input",function(){Ie(t);const n=No(8);return e.filter(n.value)})("compositionstart",function(){return e.onCompositionStart()})("compositionend",function(){Ie(t);const n=No(8);return e.onCompositionEnd(n.value)})("focus",function(t){return e.onInputFocus(t)})("blur",function(t){return e.onInputBlur(t)})("change",function(t){return t.stopPropagation()}),Zo(),Zo(),Zo(),Uo(9,Ug,4,1,"ng-container",3),Uo(10,Ng,3,1,"span",7),Go(11,"span",8),Ho(12,"span",9),Zo(),Zo(),Uo(13,r_,7,19,"ng-dropdown-panel",10)}2&t&&(gs("ng-appearance-outline","outline"===e.appearance)("ng-has-value",e.hasValue),ur(3),As(e.placeholder),ur(1),qo("ngIf",(!e.multiLabelTemplate||!e.multiple)&&e.selectedItems.length>0),ur(1),qo("ngIf",e.multiple&&e.multiLabelTemplate&&e.selectedValues.length>0),ur(1),Bo("aria-expanded",e.isOpen)("aria-owns",e.isOpen?e.dropdownId:null),ur(1),qo("readOnly",!e.searchable||e.itemsList.maxItemsSelected)("disabled",e.disabled)("value",e.searchTerm?e.searchTerm:""),Bo("id",e.labelForId)("tabindex",e.tabIndex)("aria-activedescendant",e.isOpen?null==e.itemsList||null==e.itemsList.markedItem?null:e.itemsList.markedItem.htmlId:null)("aria-controls",e.isOpen?e.dropdownId:null),ur(2),qo("ngIf",e.loading),ur(1),qo("ngIf",e.showClear()),ur(3),qo("ngIf",e.isOpen))},directives:[Wc,Zc,Yc,h_,M_,$c],styles:['.ng-select{position:relative;display:block}.ng-select,.ng-select div,.ng-select input,.ng-select span{box-sizing:border-box}.ng-select [hidden]{display:none}.ng-select.ng-select-searchable .ng-select-container .ng-value-container .ng-input{opacity:1}.ng-select.ng-select-opened .ng-select-container{z-index:1001}.ng-select.ng-select-disabled .ng-select-container .ng-value-container .ng-placeholder,.ng-select.ng-select-disabled .ng-select-container .ng-value-container .ng-value{-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;cursor:default}.ng-select.ng-select-disabled .ng-arrow-wrapper{cursor:default}.ng-select.ng-select-filtered .ng-placeholder{display:none}.ng-select .ng-select-container{cursor:default;display:flex;outline:none;overflow:hidden;position:relative;width:100%}.ng-select .ng-select-container .ng-value-container{display:flex;flex:1}.ng-select .ng-select-container .ng-value-container .ng-input{opacity:0}.ng-select .ng-select-container .ng-value-container .ng-input>input{box-sizing:content-box;background:none transparent;border:0;box-shadow:none;outline:none;padding:0;cursor:default;width:100%}.ng-select .ng-select-container .ng-value-container .ng-input>input::-ms-clear{display:none}.ng-select .ng-select-container .ng-value-container .ng-input>input[readonly]{-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;width:0;padding:0}.ng-select.ng-select-single.ng-select-filtered .ng-select-container .ng-value-container .ng-value{visibility:hidden}.ng-select.ng-select-single .ng-select-container .ng-value-container,.ng-select.ng-select-single .ng-select-container .ng-value-container .ng-value{white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.ng-select.ng-select-single .ng-select-container .ng-value-container .ng-value .ng-value-icon{display:none}.ng-select.ng-select-single .ng-select-container .ng-value-container .ng-input{position:absolute;left:0;width:100%}.ng-select.ng-select-multiple.ng-select-disabled>.ng-select-container .ng-value-container .ng-value .ng-value-icon{display:none}.ng-select.ng-select-multiple .ng-select-container .ng-value-container{flex-wrap:wrap}.ng-select.ng-select-multiple .ng-select-container .ng-value-container .ng-placeholder{position:absolute}.ng-select.ng-select-multiple .ng-select-container .ng-value-container .ng-value{white-space:nowrap}.ng-select.ng-select-multiple .ng-select-container .ng-value-container .ng-value.ng-value-disabled .ng-value-icon{display:none}.ng-select.ng-select-multiple .ng-select-container .ng-value-container .ng-value .ng-value-icon{cursor:pointer}.ng-select.ng-select-multiple .ng-select-container .ng-value-container .ng-input{flex:1;z-index:2}.ng-select.ng-select-multiple .ng-select-container .ng-value-container .ng-placeholder{z-index:1}.ng-select .ng-clear-wrapper{cursor:pointer;position:relative;width:17px;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.ng-select .ng-clear-wrapper .ng-clear{display:inline-block;font-size:18px;line-height:1;pointer-events:none}.ng-select .ng-spinner-loader{border-radius:50%;width:17px;height:17px;margin-right:5px;font-size:10px;position:relative;text-indent:-9999em;border:2px solid rgba(66,66,66,.2);border-left-color:#424242;transform:translateZ(0);-webkit-animation:load8 .8s linear infinite;animation:load8 .8s linear infinite}.ng-select .ng-spinner-loader:after{border-radius:50%;width:17px;height:17px}@-webkit-keyframes load8{0%{transform:rotate(0deg)}to{transform:rotate(1turn)}}@keyframes load8{0%{transform:rotate(0deg)}to{transform:rotate(1turn)}}.ng-select .ng-arrow-wrapper{cursor:pointer;position:relative;text-align:center;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.ng-select .ng-arrow-wrapper .ng-arrow{pointer-events:none;display:inline-block;height:0;width:0;position:relative}.ng-dropdown-panel{box-sizing:border-box;position:absolute;opacity:0;width:100%;z-index:1050;-webkit-overflow-scrolling:touch}.ng-dropdown-panel .ng-dropdown-panel-items{display:block;height:auto;box-sizing:border-box;max-height:240px;overflow-y:auto}.ng-dropdown-panel .ng-dropdown-panel-items .ng-optgroup,.ng-dropdown-panel .ng-dropdown-panel-items .ng-option{white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.ng-dropdown-panel .ng-dropdown-panel-items .ng-option{box-sizing:border-box;cursor:pointer;display:block}.ng-dropdown-panel .ng-dropdown-panel-items .ng-option .ng-option-label:empty:before{content:"\\200b"}.ng-dropdown-panel .ng-dropdown-panel-items .ng-option .highlighted{font-weight:700;text-decoration:underline}.ng-dropdown-panel .ng-dropdown-panel-items .ng-option.disabled{cursor:default}.ng-dropdown-panel .scroll-host{overflow:hidden;overflow-y:auto;position:relative;display:block;-webkit-overflow-scrolling:touch}.ng-dropdown-panel .scrollable-content{top:0;left:0;width:100%;height:100%;position:absolute}.ng-dropdown-panel .total-padding{width:1px;opacity:0}'],encapsulation:2,changeDetection:0}),t})();class R_{constructor(){this._selected=[]}get value(){return this._selected}select(t,e,n){if(t.selected=!0,(!t.children||!e&&n)&&this._selected.push(t),e)if(t.parent){const e=t.parent.children.length,n=t.parent.children.filter(t=>t.selected).length;t.parent.selected=e===n}else t.children&&(this._setChildrenSelectedState(t.children,!0),this._removeChildren(t),this._selected=n&&this._activeChildren(t)?[...this._selected.filter(e=>e.parent!==t),t]:[...this._selected,...t.children.filter(t=>!t.disabled)])}unselect(t,e){if(this._selected=this._selected.filter(e=>e!==t),t.selected=!1,e)if(t.parent&&t.parent.selected){const e=t.parent.children;this._removeParent(t.parent),this._removeChildren(t.parent),this._selected.push(...e.filter(e=>e!==t&&!e.disabled)),t.parent.selected=!1}else t.children&&(this._setChildrenSelectedState(t.children,!1),this._removeChildren(t))}clear(t){this._selected=t?this._selected.filter(t=>t.disabled):[]}_setChildrenSelectedState(t,e){for(const n of t)n.disabled||(n.selected=e)}_removeChildren(t){this._selected=[...this._selected.filter(e=>e.parent!==t),...t.children.filter(e=>e.parent===t&&e.disabled&&e.selected)]}_removeParent(t){this._selected=this._selected.filter(e=>e!==t)}_activeChildren(t){return t.children.every(t=>!t.disabled||t.selected)}}const F_=function(){return new R_};let B_=(()=>{class t{}return t.\u0275mod=jt({type:t}),t.\u0275inj=lt({factory:function(e){return new(e||t)},providers:[{provide:D_,useValue:F_}],imports:[[Jc]]}),t})();class V_{}class U_{}class N_{constructor(t){this.normalizedNames=new Map,this.lazyUpdate=null,t?this.lazyInit="string"==typeof t?()=>{this.headers=new Map,t.split("\n").forEach(t=>{const e=t.indexOf(":");if(e>0){const n=t.slice(0,e),i=n.toLowerCase(),r=t.slice(e+1).trim();this.maybeSetNormalizedName(n,i),this.headers.has(i)?this.headers.get(i).push(r):this.headers.set(i,[r])}})}:()=>{this.headers=new Map,Object.keys(t).forEach(e=>{let n=t[e];const i=e.toLowerCase();"string"==typeof n&&(n=[n]),n.length>0&&(this.headers.set(i,n),this.maybeSetNormalizedName(e,i))})}:this.headers=new Map}has(t){return this.init(),this.headers.has(t.toLowerCase())}get(t){this.init();const e=this.headers.get(t.toLowerCase());return e&&e.length>0?e[0]:null}keys(){return this.init(),Array.from(this.normalizedNames.values())}getAll(t){return this.init(),this.headers.get(t.toLowerCase())||null}append(t,e){return this.clone({name:t,value:e,op:"a"})}set(t,e){return this.clone({name:t,value:e,op:"s"})}delete(t,e){return this.clone({name:t,value:e,op:"d"})}maybeSetNormalizedName(t,e){this.normalizedNames.has(e)||this.normalizedNames.set(e,t)}init(){this.lazyInit&&(this.lazyInit instanceof N_?this.copyFrom(this.lazyInit):this.lazyInit(),this.lazyInit=null,this.lazyUpdate&&(this.lazyUpdate.forEach(t=>this.applyUpdate(t)),this.lazyUpdate=null))}copyFrom(t){t.init(),Array.from(t.headers.keys()).forEach(e=>{this.headers.set(e,t.headers.get(e)),this.normalizedNames.set(e,t.normalizedNames.get(e))})}clone(t){const e=new N_;return e.lazyInit=this.lazyInit&&this.lazyInit instanceof N_?this.lazyInit:this,e.lazyUpdate=(this.lazyUpdate||[]).concat([t]),e}applyUpdate(t){const e=t.name.toLowerCase();switch(t.op){case"a":case"s":let n=t.value;if("string"==typeof n&&(n=[n]),0===n.length)return;this.maybeSetNormalizedName(t.name,e);const i=("a"===t.op?this.headers.get(e):void 0)||[];i.push(...n),this.headers.set(e,i);break;case"d":const r=t.value;if(r){let t=this.headers.get(e);if(!t)return;t=t.filter(t=>-1===r.indexOf(t)),0===t.length?(this.headers.delete(e),this.normalizedNames.delete(e)):this.headers.set(e,t)}else this.headers.delete(e),this.normalizedNames.delete(e)}}forEach(t){this.init(),Array.from(this.normalizedNames.keys()).forEach(e=>t(this.normalizedNames.get(e),this.headers.get(e)))}}class j_{encodeKey(t){return q_(t)}encodeValue(t){return q_(t)}decodeKey(t){return decodeURIComponent(t)}decodeValue(t){return decodeURIComponent(t)}}function q_(t){return encodeURIComponent(t).replace(/%40/gi,"@").replace(/%3A/gi,":").replace(/%24/gi,"$").replace(/%2C/gi,",").replace(/%3B/gi,";").replace(/%2B/gi,"+").replace(/%3D/gi,"=").replace(/%3F/gi,"?").replace(/%2F/gi,"/")}class $_{constructor(t={}){if(this.updates=null,this.cloneFrom=null,this.encoder=t.encoder||new j_,t.fromString){if(t.fromObject)throw new Error("Cannot specify both fromString and fromObject.");this.map=function(t,e){const n=new Map;return t.length>0&&t.split("&").forEach(t=>{const i=t.indexOf("="),[r,o]=-1==i?[e.decodeKey(t),""]:[e.decodeKey(t.slice(0,i)),e.decodeValue(t.slice(i+1))],s=n.get(r)||[];s.push(o),n.set(r,s)}),n}(t.fromString,this.encoder)}else t.fromObject?(this.map=new Map,Object.keys(t.fromObject).forEach(e=>{const n=t.fromObject[e];this.map.set(e,Array.isArray(n)?n:[n])})):this.map=null}has(t){return this.init(),this.map.has(t)}get(t){this.init();const e=this.map.get(t);return e?e[0]:null}getAll(t){return this.init(),this.map.get(t)||null}keys(){return this.init(),Array.from(this.map.keys())}append(t,e){return this.clone({param:t,value:e,op:"a"})}set(t,e){return this.clone({param:t,value:e,op:"s"})}delete(t,e){return this.clone({param:t,value:e,op:"d"})}toString(){return this.init(),this.keys().map(t=>{const e=this.encoder.encodeKey(t);return this.map.get(t).map(t=>e+"="+this.encoder.encodeValue(t)).join("&")}).filter(t=>""!==t).join("&")}clone(t){const e=new $_({encoder:this.encoder});return e.cloneFrom=this.cloneFrom||this,e.updates=(this.updates||[]).concat([t]),e}init(){null===this.map&&(this.map=new Map),null!==this.cloneFrom&&(this.cloneFrom.init(),this.cloneFrom.keys().forEach(t=>this.map.set(t,this.cloneFrom.map.get(t))),this.updates.forEach(t=>{switch(t.op){case"a":case"s":const e=("a"===t.op?this.map.get(t.param):void 0)||[];e.push(t.value),this.map.set(t.param,e);break;case"d":if(void 0===t.value){this.map.delete(t.param);break}{let e=this.map.get(t.param)||[];const n=e.indexOf(t.value);-1!==n&&e.splice(n,1),e.length>0?this.map.set(t.param,e):this.map.delete(t.param)}}}),this.cloneFrom=this.updates=null)}}function G_(t){return"undefined"!=typeof ArrayBuffer&&t instanceof ArrayBuffer}function Z_(t){return"undefined"!=typeof Blob&&t instanceof Blob}function H_(t){return"undefined"!=typeof FormData&&t instanceof FormData}class W_{constructor(t,e,n,i){let r;if(this.url=e,this.body=null,this.reportProgress=!1,this.withCredentials=!1,this.responseType="json",this.method=t.toUpperCase(),function(t){switch(t){case"DELETE":case"GET":case"HEAD":case"OPTIONS":case"JSONP":return!1;default:return!0}}(this.method)||i?(this.body=void 0!==n?n:null,r=i):r=n,r&&(this.reportProgress=!!r.reportProgress,this.withCredentials=!!r.withCredentials,r.responseType&&(this.responseType=r.responseType),r.headers&&(this.headers=r.headers),r.params&&(this.params=r.params)),this.headers||(this.headers=new N_),this.params){const t=this.params.toString();if(0===t.length)this.urlWithParams=e;else{const n=e.indexOf("?");this.urlWithParams=e+(-1===n?"?":n<e.length-1?"&":"")+t}}else this.params=new $_,this.urlWithParams=e}serializeBody(){return null===this.body?null:G_(this.body)||Z_(this.body)||H_(this.body)||"string"==typeof this.body?this.body:this.body instanceof $_?this.body.toString():"object"==typeof this.body||"boolean"==typeof this.body||Array.isArray(this.body)?JSON.stringify(this.body):this.body.toString()}detectContentTypeHeader(){return null===this.body||H_(this.body)?null:Z_(this.body)?this.body.type||null:G_(this.body)?null:"string"==typeof this.body?"text/plain":this.body instanceof $_?"application/x-www-form-urlencoded;charset=UTF-8":"object"==typeof this.body||"number"==typeof this.body||Array.isArray(this.body)?"application/json":null}clone(t={}){const e=t.method||this.method,n=t.url||this.url,i=t.responseType||this.responseType,r=void 0!==t.body?t.body:this.body,o=void 0!==t.withCredentials?t.withCredentials:this.withCredentials,s=void 0!==t.reportProgress?t.reportProgress:this.reportProgress;let a=t.headers||this.headers,l=t.params||this.params;return void 0!==t.setHeaders&&(a=Object.keys(t.setHeaders).reduce((e,n)=>e.set(n,t.setHeaders[n]),a)),t.setParams&&(l=Object.keys(t.setParams).reduce((e,n)=>e.set(n,t.setParams[n]),l)),new W_(e,n,r,{params:l,headers:a,reportProgress:s,responseType:i,withCredentials:o})}}var X_=function(t){return t[t.Sent=0]="Sent",t[t.UploadProgress=1]="UploadProgress",t[t.ResponseHeader=2]="ResponseHeader",t[t.DownloadProgress=3]="DownloadProgress",t[t.Response=4]="Response",t[t.User=5]="User",t}({});class K_{constructor(t,e=200,n="OK"){this.headers=t.headers||new N_,this.status=void 0!==t.status?t.status:e,this.statusText=t.statusText||n,this.url=t.url||null,this.ok=this.status>=200&&this.status<300}}class Y_ extends K_{constructor(t={}){super(t),this.type=X_.ResponseHeader}clone(t={}){return new Y_({headers:t.headers||this.headers,status:void 0!==t.status?t.status:this.status,statusText:t.statusText||this.statusText,url:t.url||this.url||void 0})}}class J_ extends K_{constructor(t={}){super(t),this.type=X_.Response,this.body=void 0!==t.body?t.body:null}clone(t={}){return new J_({body:void 0!==t.body?t.body:this.body,headers:t.headers||this.headers,status:void 0!==t.status?t.status:this.status,statusText:t.statusText||this.statusText,url:t.url||this.url||void 0})}}class Q_ extends K_{constructor(t){super(t,0,"Unknown Error"),this.name="HttpErrorResponse",this.ok=!1,this.message=this.status>=200&&this.status<300?"Http failure during parsing for "+(t.url||"(unknown url)"):`Http failure response for ${t.url||"(unknown url)"}: ${t.status} ${t.statusText}`,this.error=t.error||null}}function ty(t,e){return{body:e,headers:t.headers,observe:t.observe,params:t.params,reportProgress:t.reportProgress,responseType:t.responseType,withCredentials:t.withCredentials}}let ey=(()=>{class t{constructor(t){this.handler=t}request(t,e,n={}){let i;if(t instanceof W_)i=t;else{let r=void 0;r=n.headers instanceof N_?n.headers:new N_(n.headers);let o=void 0;n.params&&(o=n.params instanceof $_?n.params:new $_({fromObject:n.params})),i=new W_(t,e,void 0!==n.body?n.body:null,{headers:r,params:o,reportProgress:n.reportProgress,responseType:n.responseType||"json",withCredentials:n.withCredentials})}const r=nu(i).pipe(Ou(t=>this.handler.handle(t)));if(t instanceof W_||"events"===n.observe)return r;const o=r.pipe(Eu(t=>t instanceof J_));switch(n.observe||"body"){case"body":switch(i.responseType){case"arraybuffer":return o.pipe(E(t=>{if(null!==t.body&&!(t.body instanceof ArrayBuffer))throw new Error("Response is not an ArrayBuffer.");return t.body}));case"blob":return o.pipe(E(t=>{if(null!==t.body&&!(t.body instanceof Blob))throw new Error("Response is not a Blob.");return t.body}));case"text":return o.pipe(E(t=>{if(null!==t.body&&"string"!=typeof t.body)throw new Error("Response is not a string.");return t.body}));case"json":default:return o.pipe(E(t=>t.body))}case"response":return o;default:throw new Error(`Unreachable: unhandled observe type ${n.observe}}`)}}delete(t,e={}){return this.request("DELETE",t,e)}get(t,e={}){return this.request("GET",t,e)}head(t,e={}){return this.request("HEAD",t,e)}jsonp(t,e){return this.request("JSONP",t,{params:(new $_).append(e,"JSONP_CALLBACK"),observe:"body",responseType:"json"})}options(t,e={}){return this.request("OPTIONS",t,e)}patch(t,e,n={}){return this.request("PATCH",t,ty(n,e))}post(t,e,n={}){return this.request("POST",t,ty(n,e))}put(t,e,n={}){return this.request("PUT",t,ty(n,e))}}return t.\u0275fac=function(e){return new(e||t)(ui(V_))},t.\u0275prov=at({token:t,factory:t.\u0275fac}),t})();class ny{constructor(t,e){this.next=t,this.interceptor=e}handle(t){return this.interceptor.intercept(t,this.next)}}const iy=new Nn("HTTP_INTERCEPTORS");let ry=(()=>{class t{intercept(t,e){return e.handle(t)}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=at({token:t,factory:t.\u0275fac}),t})();const oy=/^\)\]\}',?\n/;class sy{}let ay=(()=>{class t{constructor(){}build(){return new XMLHttpRequest}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=at({token:t,factory:t.\u0275fac}),t})(),ly=(()=>{class t{constructor(t){this.xhrFactory=t}handle(t){if("JSONP"===t.method)throw new Error("Attempted to construct Jsonp request without HttpClientJsonpModule installed.");return new y(e=>{const n=this.xhrFactory.build();if(n.open(t.method,t.urlWithParams),t.withCredentials&&(n.withCredentials=!0),t.headers.forEach((t,e)=>n.setRequestHeader(t,e.join(","))),t.headers.has("Accept")||n.setRequestHeader("Accept","application/json, text/plain, */*"),!t.headers.has("Content-Type")){const e=t.detectContentTypeHeader();null!==e&&n.setRequestHeader("Content-Type",e)}if(t.responseType){const e=t.responseType.toLowerCase();n.responseType="json"!==e?e:"text"}const i=t.serializeBody();let r=null;const o=()=>{if(null!==r)return r;const e=1223===n.status?204:n.status,i=n.statusText||"OK",o=new N_(n.getAllResponseHeaders()),s=function(t){return"responseURL"in t&&t.responseURL?t.responseURL:/^X-Request-URL:/m.test(t.getAllResponseHeaders())?t.getResponseHeader("X-Request-URL"):null}(n)||t.url;return r=new Y_({headers:o,status:e,statusText:i,url:s}),r},s=()=>{let{headers:i,status:r,statusText:s,url:a}=o(),l=null;204!==r&&(l=void 0===n.response?n.responseText:n.response),0===r&&(r=l?200:0);let c=r>=200&&r<300;if("json"===t.responseType&&"string"==typeof l){const t=l;l=l.replace(oy,"");try{l=""!==l?JSON.parse(l):null}catch(u){l=t,c&&(c=!1,l={error:u,text:l})}}c?(e.next(new J_({body:l,headers:i,status:r,statusText:s,url:a||void 0})),e.complete()):e.error(new Q_({error:l,headers:i,status:r,statusText:s,url:a||void 0}))},a=t=>{const{url:i}=o(),r=new Q_({error:t,status:n.status||0,statusText:n.statusText||"Unknown Error",url:i||void 0});e.error(r)};let l=!1;const c=i=>{l||(e.next(o()),l=!0);let r={type:X_.DownloadProgress,loaded:i.loaded};i.lengthComputable&&(r.total=i.total),"text"===t.responseType&&n.responseText&&(r.partialText=n.responseText),e.next(r)},u=t=>{let n={type:X_.UploadProgress,loaded:t.loaded};t.lengthComputable&&(n.total=t.total),e.next(n)};return n.addEventListener("load",s),n.addEventListener("error",a),t.reportProgress&&(n.addEventListener("progress",c),null!==i&&n.upload&&n.upload.addEventListener("progress",u)),n.send(i),e.next({type:X_.Sent}),()=>{n.removeEventListener("error",a),n.removeEventListener("load",s),t.reportProgress&&(n.removeEventListener("progress",c),null!==i&&n.upload&&n.upload.removeEventListener("progress",u)),n.readyState!==n.DONE&&n.abort()}})}}return t.\u0275fac=function(e){return new(e||t)(ui(sy))},t.\u0275prov=at({token:t,factory:t.\u0275fac}),t})();const cy=new Nn("XSRF_COOKIE_NAME"),uy=new Nn("XSRF_HEADER_NAME");class hy{}let dy=(()=>{class t{constructor(t,e,n){this.doc=t,this.platform=e,this.cookieName=n,this.lastCookieString="",this.lastToken=null,this.parseCount=0}getToken(){if("server"===this.platform)return null;const t=this.doc.cookie||"";return t!==this.lastCookieString&&(this.parseCount++,this.lastToken=qc(t,this.cookieName),this.lastCookieString=t),this.lastToken}}return t.\u0275fac=function(e){return new(e||t)(ui(wc),ui(Al),ui(cy))},t.\u0275prov=at({token:t,factory:t.\u0275fac}),t})(),py=(()=>{class t{constructor(t,e){this.tokenService=t,this.headerName=e}intercept(t,e){const n=t.url.toLowerCase();if("GET"===t.method||"HEAD"===t.method||n.startsWith("http://")||n.startsWith("https://"))return e.handle(t);const i=this.tokenService.getToken();return null===i||t.headers.has(this.headerName)||(t=t.clone({headers:t.headers.set(this.headerName,i)})),e.handle(t)}}return t.\u0275fac=function(e){return new(e||t)(ui(hy),ui(uy))},t.\u0275prov=at({token:t,factory:t.\u0275fac}),t})(),fy=(()=>{class t{constructor(t,e){this.backend=t,this.injector=e,this.chain=null}handle(t){if(null===this.chain){const t=this.injector.get(iy,[]);this.chain=t.reduceRight((t,e)=>new ny(t,e),this.backend)}return this.chain.handle(t)}}return t.\u0275fac=function(e){return new(e||t)(ui(U_),ui(Co))},t.\u0275prov=at({token:t,factory:t.\u0275fac}),t})(),my=(()=>{class t{static disable(){return{ngModule:t,providers:[{provide:py,useClass:ry}]}}static withOptions(e={}){return{ngModule:t,providers:[e.cookieName?{provide:cy,useValue:e.cookieName}:[],e.headerName?{provide:uy,useValue:e.headerName}:[]]}}}return t.\u0275mod=jt({type:t}),t.\u0275inj=lt({factory:function(e){return new(e||t)},providers:[py,{provide:iy,useExisting:py,multi:!0},{provide:hy,useClass:dy},{provide:cy,useValue:"XSRF-TOKEN"},{provide:uy,useValue:"X-XSRF-TOKEN"}]}),t})(),gy=(()=>{class t{}return t.\u0275mod=jt({type:t}),t.\u0275inj=lt({factory:function(e){return new(e||t)},providers:[ey,{provide:V_,useClass:fy},ly,{provide:U_,useExisting:ly},ay,{provide:sy,useExisting:ay}],imports:[[my.withOptions({cookieName:"XSRF-TOKEN",headerName:"X-XSRF-TOKEN"})]]}),t})(),_y=(()=>{class t{constructor(t){this.http=t,this.api="http://raphaelrod-001-site1.itempurl.com/api/detalleCategorias/",this.apiProductor="http://raphaelrod-001-site1.itempurl.com/api/productores/",this.apiProductos="http://raphaelrod-001-site1.itempurl.com/api/productos/"}nuevo(t){return this.http.post(this.api,t)}listar(){return this.http.get(this.api)}listarProductor(){return this.http.get(this.apiProductor)}listarProductos(){return this.http.get(this.apiProductos)}eliminar(t){return this.http.delete(this.api+t)}cargar(t){return this.http.get(this.api+t)}editar(t,e){return this.http.put(this.api+t,e)}buscar(t){var e=(new $_).append("busqueda",t);return this.http.get(this.api+"buscador",{params:e})}}return t.\u0275fac=function(e){return new(e||t)(ui(ey))},t.\u0275prov=at({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();function yy(t,e){if(1&t&&(Go(0,"ng-option",24),ks(1),Zo()),2&t){const t=e.$implicit;qo("value",t.idProductores),ur(1),Ps(" ",t.nombres," ",t.apellidos," ")}}function vy(t,e){if(1&t&&(Go(0,"ng-option",24),ks(1),Zo()),2&t){const t=e.$implicit;qo("value",t.idProductos),ur(1),Is(" ",t.nombreProducto," ")}}let xy=(()=>{class t{constructor(t,e,n,i){this.config=t,this.detalleCategoria=e,this.ra=n,this.router=i,this.proved=new Am({idProductos:new km(null,Mf.required),stock:new km("",[yf.valor]),precioUnidad:new km("",[yf.valor]),idProductores:new km(null,Mf.required)}),this.productorObj=[],this.productosObj=[],this.idDetalle=0,this.numero=1,this.config.notFoundText="Sin Coincidencias",this.config.clearAllText="eliminar"}ngOnInit(){this.idDetalle=this.ra.snapshot.params.id,this.listarProductor(),this.listarProductos(),null!=this.idDetalle&&this.cargar(this.idDetalle)}guardar(t){this.proved.invalid?Zm.a.fire("Productos-Proveedores","Todos los campos son requeridos","warning"):null==this.idDetalle?this.detalleCategoria.nuevo(t).subscribe(t=>{Zm.a.fire({position:"center",icon:"success",title:"Guardado con exito",showConfirmButton:!1,timer:1500}),this.router.navigate(["menu/listarDetalle"])},t=>{console.log(t)}):(t.idDetalleCategorias=this.idDetalle,this.detalleCategoria.editar(this.idDetalle,t).subscribe(t=>{Zm.a.fire({position:"center",icon:"success",title:"Editado con exito",showConfirmButton:!1,timer:1500}),this.router.navigate(["/menu/listarDetalle"])},t=>console.log(t)))}listarProductos(){this.detalleCategoria.listarProductos().subscribe(t=>{this.productosObj=t},t=>{alert(t)})}listarProductor(){this.detalleCategoria.listarProductor().subscribe(t=>{this.productorObj=t},t=>{alert(t)})}cargar(t){this.detalleCategoria.cargar(t).subscribe(t=>{this.proved.patchValue(Object.assign({},t))})}}return t.\u0275fac=function(e){return new(e||t)(jo(z_),jo(_y),jo(td),jo(vp))},t.\u0275cmp=Bt({type:t,selectors:[["app-nuevo-detalle-productos"]],decls:39,vars:18,consts:[["charset","UTF-8"],["http-equiv","X-UA-Compatible","content","IE=edge"],["name","viewport","content","width=device-width, initial-scale=1.0"],["name","viewport","content","width=device-width"],[1,"row"],[1,"col"],[3,"formGroup","ngSubmit"],[1,"card","me-auto","ms-auto","col","col-sm",2,"width","30rem","margin-top","2em","margin-bottom","2em","margin-left","em"],[1,"card-header"],[1,"text-center"],[1,"card-body","me-auto","ms-auto","w-75"],[1,"col-12"],["formControlName","idProductores","bindLabel","label","placeholder","--Seleccione un Productor-- "],[3,"value",4,"ngFor","ngForOf"],[1,"col","mt-4"],["formControlName","idProductos","bindLabel","label","placeholder","--Seleccione un Producto-- ",1,"opcion"],[1,"row","mt-3"],[1,"col-6"],["for","exampleInputEmail1",1,"text-black-50","fw-bold","fst-italic"],["maxlength","10","formControlName","stock","type","number",1,"form-control","mb-2"],["maxlength","10","formControlName","precioUnidad","type","number",1,"form-control","mb-2"],[1,"text-center","mt-3"],["type","submit",1,"btn","btn-primary","mt-3","me-5","col-5"],[1,"btn","btn-secondary","mt-3","col-5",3,"routerLink"],[3,"value"]],template:function(t,e){if(1&t&&(Go(0,"html"),Go(1,"head"),Ho(2,"meta",0),Ho(3,"meta",1),Ho(4,"meta",2),Go(5,"title"),ks(6,"Document"),Zo(),Ho(7,"meta",3),Zo(),Go(8,"div",4),Go(9,"div",5),Go(10,"form",6),ts("ngSubmit",function(){return e.guardar(e.proved.value)}),Go(11,"div",7),Go(12,"div",8),Go(13,"div",9),Go(14,"h3"),ks(15,"Nuevo"),Zo(),Zo(),Zo(),Go(16,"div",10),Go(17,"div",4),Go(18,"div",11),Go(19,"ng-select",12),Uo(20,yy,2,3,"ng-option",13),Zo(),Zo(),Zo(),Go(21,"div",4),Go(22,"div",14),Go(23,"ng-select",15),Uo(24,vy,2,2,"ng-option",13),Zo(),Zo(),Zo(),Go(25,"div",16),Go(26,"div",17),Go(27,"label",18),ks(28,"Cantidad"),Zo(),Ho(29,"input",19),Zo(),Go(30,"div",17),Go(31,"label",18),ks(32,"$ Unidad"),Zo(),Ho(33,"input",20),Zo(),Zo(),Go(34,"div",21),Go(35,"button",22),ks(36,"Guardar"),Zo(),Go(37,"button",23),ks(38,"Atras"),Zo(),Zo(),Zo(),Zo(),Zo(),Zo(),Zo(),Zo()),2&t){let t=null,n=null,i=null,r=null,o=null,s=null,a=null;ur(10),qo("formGroup",e.proved),ur(9),gs("color",e.proved.get("idProductores").touched&&(null==(t=e.proved.get("idProductores"))?null:t.invalid))("colorS",e.proved.get("idProductores").touched&&(null==(n=e.proved.get("idProductores   "))?null:n.valid)),ur(1),qo("ngForOf",e.productorObj),ur(3),gs("color",e.proved.get("idProductos").touched&&(null==(i=e.proved.get("idProductos"))?null:i.invalid)),ur(1),qo("ngForOf",e.productosObj),ur(5),gs("border-danger",e.proved.get("stock").touched&&(null==(r=e.proved.get("stock"))?null:r.invalid))("border-success",e.proved.get("stock").touched&&(null==(o=e.proved.get("stock"))?null:o.valid)),ur(4),gs("border-danger",e.proved.get("precioUnidad").touched&&(null==(s=e.proved.get("precioUnidad"))?null:s.invalid))("border-success",e.proved.get("precioUnidad").touched&&(null==(a=e.proved.get("precioUnidad"))?null:a.valid)),ur(4),qo("routerLink","/menu/listarDetalle/")}},directives:[zm,Wf,Rm,L_,Hf,Bm,Zc,Sf,Kf,Um,xp,O_],styles:[".color{border-radius:5%;border:1px solid red}  .colorS{border-radius:5%;background-color:green;border:1px solid green}"]}),t})();const by=function(t){return["/menu/editarDetalle/",t]};function wy(t,e){if(1&t){const t=Yo();Go(0,"tbody"),Ho(1,"tr",22),Go(2,"tr",22),Go(3,"td"),Go(4,"strong"),ks(5),Zo(),Zo(),Go(6,"td"),ks(7),Zo(),Go(8,"td"),ks(9),Zo(),Go(10,"td"),ks(11),Zo(),Go(12,"td"),ks(13),Zo(),Go(14,"td",8),Go(15,"div",23),Go(16,"button",24),ks(17," Opciones "),Zo(),Go(18,"ul",25),Go(19,"li"),Go(20,"a",26),ks(21,"Editar"),Zo(),Zo(),Go(22,"li"),Go(23,"a",27),ts("click",function(){Ie(t);const n=e.$implicit;return is(2).eliminar(n.idDetalleCategorias)}),ks(24,"Eliminar"),Zo(),Zo(),Zo(),Zo(),Zo(),Zo(),Zo()}if(2&t){const t=e.$implicit,n=e.index;ur(5),As(n+1),ur(2),As(t.productos.nombreProducto),ur(2),Is("",t.stock," "),ur(2),As(t.precioUnidad),ur(2),Ps("",t.productores.nombres," ",t.productores.apellidos,""),ur(7),qo("routerLink",Ka(7,by,t.idDetalleCategorias))}}function Cy(t,e){1&t&&(Go(0,"tbody"),Go(1,"tr"),Go(2,"td",28),ks(3,"No existen Registros "),Zo(),Zo(),Zo())}function Ty(t,e){if(1&t&&(Go(0,"div",17),Go(1,"table",18),Go(2,"thead",19),Go(3,"tr"),Go(4,"td"),ks(5,"#"),Zo(),Go(6,"td"),ks(7,"Producto"),Zo(),Go(8,"td"),ks(9,"Cantidad"),Zo(),Go(10,"td"),ks(11,"P.V.P Unidad"),Zo(),Go(12,"td"),ks(13,"Productor"),Zo(),Go(14,"td"),ks(15,"Opciones"),Zo(),Zo(),Zo(),Uo(16,wy,25,9,"tbody",20),Uo(17,Cy,4,0,"tbody",21),Zo(),Zo()),2&t){const t=is();ur(16),qo("ngForOf",t.detalleCategoriaList),ur(1),qo("ngIf",0==t.detalleCategoriaList.length)}}function Sy(t,e){1&t&&(Go(0,"div",29),Ho(1,"div",30),Zo())}const Ey=function(){return["/menu/nuevoDetalle"]};let ky=(()=>{class t{constructor(t){this.detalleCategoria=t,this.detalleCategoriaList=[],this.spinner=0}ngOnInit(){this.listar()}buscar(t){this.detalleCategoria.buscar(t).subscribe(t=>{this.detalleCategoriaList=t},t=>alert("Error al conectar con el servidor"))}listar(){this.spinner=1,this.detalleCategoria.listar().subscribe(t=>{this.detalleCategoriaList=t,this.spinner=0},t=>{alert(t),this.spinner=1})}eliminar(t){Zm.a.fire({title:"\xbfEsta seguro que desea eliminar?",text:" este registro se eliminar\xe1 permanentemente",icon:"warning",showCancelButton:!0,confirmButtonColor:"#29A05B",cancelButtonColor:"#d33",cancelButtonText:"Cancelar",confirmButtonText:"Aceptar"}).then(e=>{e.isConfirmed&&this.detalleCategoria.eliminar(t).subscribe(t=>{this.listar(),Zm.a.fire("Producto","Registro Eliminado exitosamente ","success")},t=>alert("error al eliminar el registro"))})}}return t.\u0275fac=function(e){return new(e||t)(jo(_y))},t.\u0275cmp=Bt({type:t,selectors:[["app-listar-detalle-productos"]],decls:27,vars:5,consts:[["lang","en"],["charset","UTF-8"],["name","viewport","content","width=device-width, initial-scale=1.0"],[1,"container"],[1,"text-uppercase","text-center","pb-2"],[2,"font-weight","bold"],[1,"container-fluid","col-8","col-sm-6","col-lg-4"],[1,"row"],[1,"text-center"],[1,"btn","btn-primary","col-5","col-sm-3",3,"routerLink"],[1,"form-group","ms-auto","me-auto","col-4"],[1,"col","mt-4"],[1,"fa","fa-search"],["on","","type","text","aria-describedby","helpId","placeholder","",1,"form-control",3,"keyup"],[1,"text-center","mt-3",2,"color","green","font-size","1.2rem"],["class","table-responsive mt-4    container","style","height: 400px;",4,"ngIf"],["class","text-center  ","style","margin-top: 10em;",4,"ngIf"],[1,"table-responsive","mt-4","container",2,"height","400px"],[1,"table","table-bordered","table-sm","text-center"],[1,"bg-dark","text-white"],[4,"ngFor","ngForOf"],[4,"ngIf"],[1,"text-dark"],[1,"btn-group"],["type","button","data-bs-toggle","dropdown","aria-expanded","false",1,"btn","btn-primary","dropdown-toggle"],[1,"dropdown-menu"],[1,"dropdown-item",3,"routerLink"],[1,"dropdown-item",3,"click"],["colspan","7",1,"text-center"],[1,"text-center",2,"margin-top","10em"],["role","status",1,"spinner-border","text-primary"]],template:function(t,e){1&t&&(Go(0,"html",0),Go(1,"head"),Ho(2,"meta",1),Ho(3,"meta",2),Go(4,"title"),ks(5,"Listar Proveedores"),Zo(),Zo(),Go(6,"div",3),Go(7,"div",4),Go(8,"h3",5),ks(9,"Asignacion de Productos"),Zo(),Zo(),Zo(),Go(10,"div",6),Ho(11,"div",7),Zo(),Go(12,"div",8),Go(13,"a",9),ks(14,"Nuevo"),Zo(),Zo(),Go(15,"div",10),Go(16,"div",11),Go(17,"span"),Ho(18,"i",12),Zo(),Go(19,"input",13),ts("keyup",function(t){return e.buscar(t.target.value)}),Zo(),Zo(),Zo(),Go(20,"div",14),Go(21,"label"),ks(22,"Total "),Zo(),Go(23,"strong"),ks(24),Zo(),Zo(),Uo(25,Ty,18,2,"div",15),Uo(26,Sy,2,0,"div",16),Zo()),2&t&&(ur(13),qo("routerLink",Xa(4,Ey)),ur(11),Is(" ",e.detalleCategoriaList.length," "),ur(1),qo("ngIf",0==e.spinner),ur(1),qo("ngIf",1==e.spinner))},directives:[bp,Wc,Zc],styles:["span[_ngcontent-%COMP%]{position:absolute;margin-left:5px;height:25px;display:flex;align-items:center;margin-top:5px}input[_ngcontent-%COMP%]{padding-left:25px}"]}),t})(),Ay=(()=>{class t{constructor(t){this.router=t}canActivate(t,e){return null!=sessionStorage.getItem("sesion")||(this.router.navigate(["/login"]),!1)}}return t.\u0275fac=function(e){return new(e||t)(ui(vp))},t.\u0275prov=at({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();class Iy{call(t,e){return e.subscribe(new Py(t))}}class Py extends ru{constructor(t){super(t),this.hasFirst=!1,this.observables=[],this.subscriptions=[]}_next(t){this.observables.push(t)}_complete(){const t=this.observables,e=t.length;if(0===e)this.destination.complete();else{for(let n=0;n<e&&!this.hasFirst;n++){const e=su(this,t[n],void 0,n);this.subscriptions&&this.subscriptions.push(e),this.add(e)}this.observables=null}}notifyNext(t,e,n){if(!this.hasFirst){this.hasFirst=!0;for(let t=0;t<this.subscriptions.length;t++)if(t!==n){let e=this.subscriptions[t];e.unsubscribe(),this.remove(e)}this.subscriptions=null}this.destination.next(e)}}function My(...t){const e=t[t.length-1];return"function"==typeof e&&t.pop(),$(t,void 0).lift(new Oy(e))}class Oy{constructor(t){this.resultSelector=t}call(t,e){return e.subscribe(new zy(t,this.resultSelector))}}class zy extends f{constructor(t,e,n=Object.create(null)){super(t),this.resultSelector=e,this.iterators=[],this.active=0,this.resultSelector="function"==typeof e?e:void 0}_next(t){const e=this.iterators;l(t)?e.push(new Ly(t)):e.push("function"==typeof t[M]?new Dy(t[M]()):new Ry(this.destination,this,t))}_complete(){const t=this.iterators,e=t.length;if(this.unsubscribe(),0!==e){this.active=e;for(let n=0;n<e;n++){let e=t[n];e.stillUnsubscribed?this.destination.add(e.subscribe()):this.active--}}else this.destination.complete()}notifyInactive(){this.active--,0===this.active&&this.destination.complete()}checkIterators(){const t=this.iterators,e=t.length,n=this.destination;for(let o=0;o<e;o++){let e=t[o];if("function"==typeof e.hasValue&&!e.hasValue())return}let i=!1;const r=[];for(let o=0;o<e;o++){let e=t[o],s=e.next();if(e.hasCompleted()&&(i=!0),s.done)return void n.complete();r.push(s.value)}this.resultSelector?this._tryresultSelector(r):n.next(r),i&&n.complete()}_tryresultSelector(t){let e;try{e=this.resultSelector.apply(this,t)}catch(n){return void this.destination.error(n)}this.destination.next(e)}}class Dy{constructor(t){this.iterator=t,this.nextResult=t.next()}hasValue(){return!0}next(){const t=this.nextResult;return this.nextResult=this.iterator.next(),t}hasCompleted(){const t=this.nextResult;return Boolean(t&&t.done)}}class Ly{constructor(t){this.array=t,this.index=0,this.length=0,this.length=t.length}[M](){return this}next(t){const e=this.index++;return e<this.length?{value:this.array[e],done:!1}:{value:null,done:!0}}hasValue(){return this.array.length>this.index}hasCompleted(){return this.array.length===this.index}}class Ry extends B{constructor(t,e,n){super(t),this.parent=e,this.observable=n,this.stillUnsubscribed=!0,this.buffer=[],this.isComplete=!1}[M](){return this}next(){const t=this.buffer;return 0===t.length&&this.isComplete?{value:null,done:!0}:{value:t.shift(),done:!1}}hasValue(){return this.buffer.length>0}hasCompleted(){return 0===this.buffer.length&&this.isComplete}notifyComplete(){this.buffer.length>0?(this.isComplete=!0,this.parent.notifyInactive()):this.destination.complete()}notifyNext(t){this.buffer.push(t),this.parent.checkIterators()}subscribe(){return V(this.observable,new F(this))}}function Fy(...t){return e=>{let n;return"function"==typeof t[t.length-1]&&(n=t.pop()),e.lift(new By(t,n))}}class By{constructor(t,e){this.observables=t,this.project=e}call(t,e){return e.subscribe(new Vy(t,this.observables,this.project))}}class Vy extends ru{constructor(t,e,n){super(t),this.observables=e,this.project=n,this.toRespond=[];const i=e.length;this.values=new Array(i);for(let r=0;r<i;r++)this.toRespond.push(r);for(let r=0;r<i;r++)this.add(su(this,e[r],void 0,r))}notifyNext(t,e,n){this.values[n]=e;const i=this.toRespond;if(i.length>0){const t=i.indexOf(n);-1!==t&&i.splice(t,1)}}notifyComplete(){}_next(t){if(0===this.toRespond.length){const e=[t,...this.values];this.project?this._tryProject(e):this.destination.next(e)}}_tryProject(t){let e;try{e=this.project.apply(this,t)}catch(n){return void this.destination.error(n)}this.destination.next(e)}}const Uy=["*"],Ny=["dialog"];function jy(t){return null!=t}function qy(t){return(t||document.body).getBoundingClientRect()}"undefined"==typeof Element||Element.prototype.closest||(Element.prototype.matches||(Element.prototype.matches=Element.prototype.msMatchesSelector||Element.prototype.webkitMatchesSelector),Element.prototype.closest=function(t){let e=this;if(!document.documentElement.contains(e))return null;do{if(e.matches(t))return e;e=e.parentElement||e.parentNode}while(null!==e&&1===e.nodeType);return null});const $y={animation:!0,transitionTimerDelayMs:5};let Gy=(()=>{class t{constructor(){this.animation=$y.animation}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=at({factory:function(){return new t},token:t,providedIn:"root"}),t})();const Zy=()=>{},{transitionTimerDelayMs:Hy}=$y,Wy=new Map,Xy=(t,e,n,i)=>{let r=i.context||{};const o=Wy.get(e);if(o)switch(i.runningTransition){case"continue":return du;case"stop":t.run(()=>o.transition$.complete()),r=Object.assign(o.context,r),Wy.delete(e)}const s=n(e,i.animation,r)||Zy;if(!i.animation||"none"===window.getComputedStyle(e).transitionProperty)return t.run(()=>s()),nu(void 0).pipe(function(t){return e=>new y(n=>e.subscribe(e=>t.run(()=>n.next(e)),e=>t.run(()=>n.error(e)),()=>t.run(()=>n.complete())))}(t));const a=new C,c=new C,u=a.pipe(function(...t){return e=>hu(e,nu(...t))}(!0));Wy.set(e,{transition$:a,complete:()=>{c.next(),c.complete()},context:r});const h=function(t){const{transitionDelay:e,transitionDuration:n}=window.getComputedStyle(t);return 1e3*(parseFloat(e)+parseFloat(n))}(e);return t.runOutsideAngular(()=>{const n=xg(e,"transitionend").pipe(Hm(u),Eu(({target:t})=>t===e));(function(...t){if(1===t.length){if(!l(t[0]))return t[0];t=t[0]}return $(t,void 0).lift(new Iy)})(rg(h+Hy).pipe(Hm(u)),n,c).pipe(Hm(u)).subscribe(()=>{Wy.delete(e),t.run(()=>{s(),a.next(),a.complete()})})}),a.asObservable()};let Ky=(()=>{class t{}return t.\u0275mod=jt({type:t}),t.\u0275inj=lt({factory:function(e){return new(e||t)},imports:[[Jc]]}),t})(),Yy=(()=>{class t{}return t.\u0275mod=jt({type:t}),t.\u0275inj=lt({factory:function(e){return new(e||t)},imports:[[Jc]]}),t})(),Jy=(()=>{class t{}return t.\u0275mod=jt({type:t}),t.\u0275inj=lt({factory:function(e){return new(e||t)}}),t})(),Qy=(()=>{class t{}return t.\u0275mod=jt({type:t}),t.\u0275inj=lt({factory:function(e){return new(e||t)},imports:[[Jc]]}),t})(),tv=(()=>{class t{}return t.\u0275mod=jt({type:t}),t.\u0275inj=lt({factory:function(e){return new(e||t)}}),t})();var ev=function(t){return t[t.Tab=9]="Tab",t[t.Enter=13]="Enter",t[t.Escape=27]="Escape",t[t.Space=32]="Space",t[t.PageUp=33]="PageUp",t[t.PageDown=34]="PageDown",t[t.End=35]="End",t[t.Home=36]="Home",t[t.ArrowLeft=37]="ArrowLeft",t[t.ArrowUp=38]="ArrowUp",t[t.ArrowRight=39]="ArrowRight",t[t.ArrowDown=40]="ArrowDown",t}({});"undefined"!=typeof navigator&&navigator.userAgent&&(/iPad|iPhone|iPod/.test(navigator.userAgent)||/Macintosh/.test(navigator.userAgent)&&navigator.maxTouchPoints&&navigator.maxTouchPoints>2||/Android/.test(navigator.userAgent));const nv=["a[href]","button:not([disabled])",'input:not([disabled]):not([type="hidden"])',"select:not([disabled])","textarea:not([disabled])","[contenteditable]",'[tabindex]:not([tabindex="-1"])'].join(", ");function iv(t){const e=Array.from(t.querySelectorAll(nv)).filter(t=>-1!==t.tabIndex);return[e[0],e[e.length-1]]}new class{getAllStyles(t){return window.getComputedStyle(t)}getStyle(t,e){return this.getAllStyles(t)[e]}isStaticPositioned(t){return"static"===(this.getStyle(t,"position")||"static")}offsetParent(t){let e=t.offsetParent||document.documentElement;for(;e&&e!==document.documentElement&&this.isStaticPositioned(e);)e=e.offsetParent;return e||document.documentElement}position(t,e=!0){let n,i={width:0,height:0,top:0,bottom:0,left:0,right:0};if("fixed"===this.getStyle(t,"position"))n=t.getBoundingClientRect(),n={top:n.top,bottom:n.bottom,left:n.left,right:n.right,height:n.height,width:n.width};else{const e=this.offsetParent(t);n=this.offset(t,!1),e!==document.documentElement&&(i=this.offset(e,!1)),i.top+=e.clientTop,i.left+=e.clientLeft}return n.top-=i.top,n.bottom-=i.top,n.left-=i.left,n.right-=i.left,e&&(n.top=Math.round(n.top),n.bottom=Math.round(n.bottom),n.left=Math.round(n.left),n.right=Math.round(n.right)),n}offset(t,e=!0){const n=t.getBoundingClientRect(),i=window.pageYOffset-document.documentElement.clientTop,r=window.pageXOffset-document.documentElement.clientLeft;let o={height:n.height||t.offsetHeight,width:n.width||t.offsetWidth,top:n.top+i,bottom:n.bottom+i,left:n.left+r,right:n.right+r};return e&&(o.height=Math.round(o.height),o.width=Math.round(o.width),o.top=Math.round(o.top),o.bottom=Math.round(o.bottom),o.left=Math.round(o.left),o.right=Math.round(o.right)),o}positionElements(t,e,n,i){const[r="top",o="center"]=n.split("-"),s=i?this.offset(t,!1):this.position(t,!1),a=this.getAllStyles(e),l=parseFloat(a.marginTop),c=parseFloat(a.marginBottom),u=parseFloat(a.marginLeft),h=parseFloat(a.marginRight);let d=0,p=0;switch(r){case"top":d=s.top-(e.offsetHeight+l+c);break;case"bottom":d=s.top+s.height;break;case"left":p=s.left-(e.offsetWidth+u+h);break;case"right":p=s.left+s.width}switch(o){case"top":d=s.top;break;case"bottom":d=s.top+s.height-e.offsetHeight;break;case"left":p=s.left;break;case"right":p=s.left+s.width-e.offsetWidth;break;case"center":"top"===r||"bottom"===r?p=s.left+s.width/2-e.offsetWidth/2:d=s.top+s.height/2-e.offsetHeight/2}e.style.transform=`translate(${Math.round(p)}px, ${Math.round(d)}px)`;const f=e.getBoundingClientRect(),m=document.documentElement,g=window.innerHeight||m.clientHeight,_=window.innerWidth||m.clientWidth;return f.left>=0&&f.top>=0&&f.right<=_&&f.bottom<=g}},new Date(1882,10,12),new Date(2174,10,25);let rv=(()=>{class t{}return t.\u0275mod=jt({type:t}),t.\u0275inj=lt({factory:function(e){return new(e||t)},imports:[[Jc,qm]]}),t})(),ov=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275dir=$t({type:t,selectors:[["",8,"navbar"]]}),t})(),sv=(()=>{class t{}return t.\u0275mod=jt({type:t}),t.\u0275inj=lt({factory:function(e){return new(e||t)}}),t})(),av=(()=>{class t{constructor(t){this._ngbConfig=t,this.backdrop=!0,this.keyboard=!0}get animation(){return void 0===this._animation?this._ngbConfig.animation:this._animation}set animation(t){this._animation=t}}return t.\u0275fac=function(e){return new(e||t)(ui(Gy))},t.\u0275prov=at({factory:function(){return new t(ui(Gy))},token:t,providedIn:"root"}),t})();class lv{constructor(t,e,n){this.nodes=t,this.viewRef=e,this.componentRef=n}}const cv=()=>{};let uv=(()=>{class t{constructor(t){this._document=t}compensate(){const t=this._getWidth();return this._isPresent(t)?this._adjustBody(t):cv}_adjustBody(t){const e=this._document.body,n=e.style.paddingRight,i=parseFloat(window.getComputedStyle(e)["padding-right"]);return e.style["padding-right"]=i+t+"px",()=>e.style["padding-right"]=n}_isPresent(t){const e=this._document.body.getBoundingClientRect();return window.innerWidth-(e.left+e.right)>=t-.1*t}_getWidth(){const t=this._document.createElement("div");t.className="modal-scrollbar-measure";const e=this._document.body;e.appendChild(t);const n=t.getBoundingClientRect().width-t.clientWidth;return e.removeChild(t),n}}return t.\u0275fac=function(e){return new(e||t)(ui(wc))},t.\u0275prov=at({factory:function(){return new t(ui(wc))},token:t,providedIn:"root"}),t})(),hv=(()=>{class t{constructor(t,e){this._el=t,this._zone=e}ngOnInit(){this._zone.onStable.asObservable().pipe(vu(1)).subscribe(()=>{Xy(this._zone,this._el.nativeElement,(t,e)=>{e&&qy(t),t.classList.add("show")},{animation:this.animation,runningTransition:"continue"})})}hide(){return Xy(this._zone,this._el.nativeElement,({classList:t})=>t.remove("show"),{animation:this.animation,runningTransition:"stop"})}}return t.\u0275fac=function(e){return new(e||t)(jo(Qs),jo(ql))},t.\u0275cmp=Bt({type:t,selectors:[["ngb-modal-backdrop"]],hostAttrs:[2,"z-index","1050"],hostVars:6,hostBindings:function(t,e){2&t&&(_s("modal-backdrop"+(e.backdropClass?" "+e.backdropClass:"")),gs("show",!e.animation)("fade",e.animation))},inputs:{animation:"animation",backdropClass:"backdropClass"},decls:0,vars:0,template:function(t,e){},encapsulation:2}),t})();class dv{close(t){}dismiss(t){}}class pv{constructor(t,e,n,i){this._windowCmptRef=t,this._contentRef=e,this._backdropCmptRef=n,this._beforeDismiss=i,this._closed=new C,this._dismissed=new C,this._hidden=new C,t.instance.dismissEvent.subscribe(t=>{this.dismiss(t)}),this.result=new Promise((t,e)=>{this._resolve=t,this._reject=e}),this.result.then(null,()=>{})}get componentInstance(){if(this._contentRef&&this._contentRef.componentRef)return this._contentRef.componentRef.instance}get closed(){return this._closed.asObservable().pipe(Hm(this._hidden))}get dismissed(){return this._dismissed.asObservable().pipe(Hm(this._hidden))}get hidden(){return this._hidden.asObservable()}get shown(){return this._windowCmptRef.instance.shown.asObservable()}close(t){this._windowCmptRef&&(this._closed.next(t),this._resolve(t),this._removeModalElements())}_dismiss(t){this._dismissed.next(t),this._reject(t),this._removeModalElements()}dismiss(t){if(this._windowCmptRef)if(this._beforeDismiss){const e=this._beforeDismiss();e&&e.then?e.then(e=>{!1!==e&&this._dismiss(t)},()=>{}):!1!==e&&this._dismiss(t)}else this._dismiss(t)}_removeModalElements(){const t=this._windowCmptRef.instance.hide(),e=this._backdropCmptRef?this._backdropCmptRef.instance.hide():nu(void 0);t.subscribe(()=>{const{nativeElement:t}=this._windowCmptRef.location;t.parentNode.removeChild(t),this._windowCmptRef.destroy(),this._contentRef&&this._contentRef.viewRef&&this._contentRef.viewRef.destroy(),this._windowCmptRef=null,this._contentRef=null}),e.subscribe(()=>{if(this._backdropCmptRef){const{nativeElement:t}=this._backdropCmptRef.location;t.parentNode.removeChild(t),this._backdropCmptRef.destroy(),this._backdropCmptRef=null}}),My(t,e).subscribe(()=>{this._hidden.next(),this._hidden.complete()})}}var fv=function(t){return t[t.BACKDROP_CLICK=0]="BACKDROP_CLICK",t[t.ESC=1]="ESC",t}({});let mv=(()=>{class t{constructor(t,e,n){this._document=t,this._elRef=e,this._zone=n,this._closed$=new C,this._elWithFocus=null,this.backdrop=!0,this.keyboard=!0,this.dismissEvent=new el,this.shown=new C,this.hidden=new C}dismiss(t){this.dismissEvent.emit(t)}ngOnInit(){this._elWithFocus=this._document.activeElement}ngAfterViewInit(){this._show()}ngOnDestroy(){this._disableEventHandling()}hide(){const{nativeElement:t}=this._elRef,e={animation:this.animation,runningTransition:"stop"},n=My(Xy(this._zone,t,()=>t.classList.remove("show"),e),Xy(this._zone,this._dialogEl.nativeElement,()=>{},e));return n.subscribe(()=>{this.hidden.next(),this.hidden.complete()}),this._disableEventHandling(),this._restoreFocus(),n}_show(){const t={animation:this.animation,runningTransition:"continue"};My(Xy(this._zone,this._elRef.nativeElement,(t,e)=>{e&&qy(t),t.classList.add("show")},t),Xy(this._zone,this._dialogEl.nativeElement,()=>{},t)).subscribe(()=>{this.shown.next(),this.shown.complete()}),this._enableEventHandling(),this._setFocus()}_enableEventHandling(){const{nativeElement:t}=this._elRef;this._zone.runOutsideAngular(()=>{xg(t,"keydown").pipe(Hm(this._closed$),Eu(t=>t.which===ev.Escape)).subscribe(t=>{this.keyboard?requestAnimationFrame(()=>{t.defaultPrevented||this._zone.run(()=>this.dismiss(fv.ESC))}):"static"===this.backdrop&&this._bumpBackdrop()});let e=!1;xg(this._dialogEl.nativeElement,"mousedown").pipe(Hm(this._closed$),Gu(()=>e=!1),mu(()=>xg(t,"mouseup").pipe(Hm(this._closed$),vu(1))),Eu(({target:e})=>t===e)).subscribe(()=>{e=!0}),xg(t,"click").pipe(Hm(this._closed$)).subscribe(({target:n})=>{t===n&&("static"===this.backdrop?this._bumpBackdrop():!0!==this.backdrop||e||this._zone.run(()=>this.dismiss(fv.BACKDROP_CLICK))),e=!1})})}_disableEventHandling(){this._closed$.next()}_setFocus(){const{nativeElement:t}=this._elRef;if(!t.contains(document.activeElement)){const e=t.querySelector("[ngbAutofocus]"),n=iv(t)[0];(e||n||t).focus()}}_restoreFocus(){const t=this._document.body,e=this._elWithFocus;let n;n=e&&e.focus&&t.contains(e)?e:t,this._zone.runOutsideAngular(()=>{setTimeout(()=>n.focus()),this._elWithFocus=null})}_bumpBackdrop(){"static"===this.backdrop&&Xy(this._zone,this._elRef.nativeElement,({classList:t})=>(t.add("modal-static"),()=>t.remove("modal-static")),{animation:this.animation,runningTransition:"continue"})}}return t.\u0275fac=function(e){return new(e||t)(jo(wc),jo(Qs),jo(ql))},t.\u0275cmp=Bt({type:t,selectors:[["ngb-modal-window"]],viewQuery:function(t,e){if(1&t&&fl(Ny,!0),2&t){let t;pl(t=_l())&&(e._dialogEl=t.first)}},hostAttrs:["role","dialog","tabindex","-1"],hostVars:7,hostBindings:function(t,e){2&t&&(Bo("aria-modal",!0)("aria-labelledby",e.ariaLabelledBy)("aria-describedby",e.ariaDescribedBy),_s("modal d-block"+(e.windowClass?" "+e.windowClass:"")),gs("fade",e.animation))},inputs:{backdrop:"backdrop",keyboard:"keyboard",animation:"animation",ariaLabelledBy:"ariaLabelledBy",ariaDescribedBy:"ariaDescribedBy",centered:"centered",scrollable:"scrollable",size:"size",windowClass:"windowClass",modalDialogClass:"modalDialogClass"},outputs:{dismissEvent:"dismiss"},ngContentSelectors:Uy,decls:4,vars:2,consts:[["role","document"],["dialog",""],[1,"modal-content"]],template:function(t,e){1&t&&(os(),Go(0,"div",0,1),Go(2,"div",2),ss(3),Zo(),Zo()),2&t&&_s("modal-dialog"+(e.size?" modal-"+e.size:"")+(e.centered?" modal-dialog-centered":"")+(e.scrollable?" modal-dialog-scrollable":"")+(e.modalDialogClass?" "+e.modalDialogClass:""))},styles:["ngb-modal-window .component-host-scrollable{display:flex;flex-direction:column;overflow:hidden}"],encapsulation:2}),t})(),gv=(()=>{class t{constructor(t,e,n,i,r,o){this._applicationRef=t,this._injector=e,this._document=n,this._scrollBar=i,this._rendererFactory=r,this._ngZone=o,this._activeWindowCmptHasChanged=new C,this._ariaHiddenValues=new Map,this._backdropAttributes=["animation","backdropClass"],this._modalRefs=[],this._windowAttributes=["animation","ariaLabelledBy","ariaDescribedBy","backdrop","centered","keyboard","scrollable","size","windowClass"],this._windowCmpts=[],this._activeInstances=new el,this._activeWindowCmptHasChanged.subscribe(()=>{if(this._windowCmpts.length){const t=this._windowCmpts[this._windowCmpts.length-1];((t,e,n,i=!1)=>{this._ngZone.runOutsideAngular(()=>{const t=xg(e,"focusin").pipe(Hm(n),E(t=>t.target));xg(e,"keydown").pipe(Hm(n),Eu(t=>t.which===ev.Tab),Fy(t)).subscribe(([t,n])=>{const[i,r]=iv(e);n!==i&&n!==e||!t.shiftKey||(r.focus(),t.preventDefault()),n!==r||t.shiftKey||(i.focus(),t.preventDefault())}),i&&xg(e,"click").pipe(Hm(n),Fy(t),E(t=>t[1])).subscribe(t=>t.focus())})})(0,t.location.nativeElement,this._activeWindowCmptHasChanged),this._revertAriaHidden(),this._setAriaHidden(t.location.nativeElement)}})}open(t,e,n,i){const r=i.container instanceof HTMLElement?i.container:jy(i.container)?this._document.querySelector(i.container):this._document.body,o=this._rendererFactory.createRenderer(null,null),s=this._scrollBar.compensate(),a=()=>{this._modalRefs.length||(o.removeClass(this._document.body,"modal-open"),this._revertAriaHidden())};if(!r)throw new Error(`The specified modal container "${i.container||"body"}" was not found in the DOM.`);const l=new dv,c=this._getContentRef(t,i.injector||e,n,l,i);let u=!1!==i.backdrop?this._attachBackdrop(t,r):void 0,h=this._attachWindowComponent(t,r,c),d=new pv(h,c,u,i.beforeDismiss);return this._registerModalRef(d),this._registerWindowCmpt(h),d.result.then(s,s),d.result.then(a,a),l.close=t=>{d.close(t)},l.dismiss=t=>{d.dismiss(t)},this._applyWindowOptions(h.instance,i),1===this._modalRefs.length&&o.addClass(this._document.body,"modal-open"),u&&u.instance&&this._applyBackdropOptions(u.instance,i),d}get activeInstances(){return this._activeInstances}dismissAll(t){this._modalRefs.forEach(e=>e.dismiss(t))}hasOpenModals(){return this._modalRefs.length>0}_attachBackdrop(t,e){let n=t.resolveComponentFactory(hv).create(this._injector);return this._applicationRef.attachView(n.hostView),e.appendChild(n.location.nativeElement),n}_attachWindowComponent(t,e,n){let i=t.resolveComponentFactory(mv).create(this._injector,n.nodes);return this._applicationRef.attachView(i.hostView),e.appendChild(i.location.nativeElement),i}_applyWindowOptions(t,e){this._windowAttributes.forEach(n=>{jy(e[n])&&(t[n]=e[n])})}_applyBackdropOptions(t,e){this._backdropAttributes.forEach(n=>{jy(e[n])&&(t[n]=e[n])})}_getContentRef(t,e,n,i,r){return n?n instanceof ka?this._createFromTemplateRef(n,i):"string"==typeof n?this._createFromString(n):this._createFromComponent(t,e,n,i,r):new lv([])}_createFromTemplateRef(t,e){const n=t.createEmbeddedView({$implicit:e,close(t){e.close(t)},dismiss(t){e.dismiss(t)}});return this._applicationRef.attachView(n),new lv([n.rootNodes],n)}_createFromString(t){const e=this._document.createTextNode(""+t);return new lv([[e]])}_createFromComponent(t,e,n,i,r){const o=t.resolveComponentFactory(n),s=Co.create({providers:[{provide:dv,useValue:i}],parent:e}),a=o.create(s),l=a.location.nativeElement;return r.scrollable&&l.classList.add("component-host-scrollable"),this._applicationRef.attachView(a.hostView),new lv([[l]],a.hostView,a)}_setAriaHidden(t){const e=t.parentElement;e&&t!==this._document.body&&(Array.from(e.children).forEach(e=>{e!==t&&"SCRIPT"!==e.nodeName&&(this._ariaHiddenValues.set(e,e.getAttribute("aria-hidden")),e.setAttribute("aria-hidden","true"))}),this._setAriaHidden(e))}_revertAriaHidden(){this._ariaHiddenValues.forEach((t,e)=>{t?e.setAttribute("aria-hidden",t):e.removeAttribute("aria-hidden")}),this._ariaHiddenValues.clear()}_registerModalRef(t){const e=()=>{const e=this._modalRefs.indexOf(t);e>-1&&(this._modalRefs.splice(e,1),this._activeInstances.emit(this._modalRefs))};this._modalRefs.push(t),this._activeInstances.emit(this._modalRefs),t.result.then(e,e)}_registerWindowCmpt(t){this._windowCmpts.push(t),this._activeWindowCmptHasChanged.next(),t.onDestroy(()=>{const e=this._windowCmpts.indexOf(t);e>-1&&(this._windowCmpts.splice(e,1),this._activeWindowCmptHasChanged.next())})}}return t.\u0275fac=function(e){return new(e||t)(ui(uc),ui(Co),ui(wc),ui(uv),ui(ta),ui(ql))},t.\u0275prov=at({factory:function(){return new t(ui(uc),ui(so),ui(wc),ui(uv),ui(ta),ui(ql))},token:t,providedIn:"root"}),t})(),_v=(()=>{class t{constructor(t,e,n,i){this._moduleCFR=t,this._injector=e,this._modalStack=n,this._config=i}open(t,e={}){const n=Object.assign(Object.assign(Object.assign({},this._config),{animation:this._config.animation}),e);return this._modalStack.open(this._moduleCFR,this._injector,t,n)}get activeInstances(){return this._modalStack.activeInstances}dismissAll(t){this._modalStack.dismissAll(t)}hasOpenModals(){return this._modalStack.hasOpenModals()}}return t.\u0275fac=function(e){return new(e||t)(ui(Xs),ui(Co),ui(gv),ui(av))},t.\u0275prov=at({factory:function(){return new t(ui(Xs),ui(so),ui(gv),ui(av))},token:t,providedIn:"root"}),t})(),yv=(()=>{class t{}return t.\u0275mod=jt({type:t}),t.\u0275inj=lt({factory:function(e){return new(e||t)},providers:[_v]}),t})(),vv=(()=>{class t{}return t.\u0275mod=jt({type:t}),t.\u0275inj=lt({factory:function(e){return new(e||t)},imports:[[Jc]]}),t})(),xv=(()=>{class t{}return t.\u0275mod=jt({type:t}),t.\u0275inj=lt({factory:function(e){return new(e||t)},imports:[[Jc]]}),t})(),bv=(()=>{class t{}return t.\u0275mod=jt({type:t}),t.\u0275inj=lt({factory:function(e){return new(e||t)},imports:[[Jc]]}),t})(),wv=(()=>{class t{}return t.\u0275mod=jt({type:t}),t.\u0275inj=lt({factory:function(e){return new(e||t)},imports:[[Jc]]}),t})(),Cv=(()=>{class t{}return t.\u0275mod=jt({type:t}),t.\u0275inj=lt({factory:function(e){return new(e||t)},imports:[[Jc]]}),t})(),Tv=(()=>{class t{}return t.\u0275mod=jt({type:t}),t.\u0275inj=lt({factory:function(e){return new(e||t)},imports:[[Jc]]}),t})(),Sv=(()=>{class t{}return t.\u0275mod=jt({type:t}),t.\u0275inj=lt({factory:function(e){return new(e||t)},imports:[[Jc]]}),t})(),Ev=(()=>{class t{}return t.\u0275mod=jt({type:t}),t.\u0275inj=lt({factory:function(e){return new(e||t)}}),t})();new Nn("live announcer delay",{providedIn:"root",factory:function(){return 100}});let kv=(()=>{class t{}return t.\u0275mod=jt({type:t}),t.\u0275inj=lt({factory:function(e){return new(e||t)},imports:[[Jc]]}),t})();const Av=[Ky,Yy,Jy,Qy,tv,rv,sv,yv,vv,xv,bv,wv,Cv,Tv,Sv,Ev,kv];let Iv=(()=>{class t{}return t.\u0275mod=jt({type:t}),t.\u0275inj=lt({factory:function(e){return new(e||t)},imports:[Av,Ky,Yy,Jy,Qy,tv,rv,sv,yv,vv,xv,bv,wv,Cv,Tv,Sv,Ev,kv]}),t})();const Pv=function(t){return{active:t}},Mv=function(){return["listarUsuario"]},Ov=function(){return["active"]},zv=function(){return["productos"]},Dv=function(){return["listarProveedor"]},Lv=function(){return["listarDetalle"]};let Rv=(()=>{class t{constructor(t){this.router=t}ngOnInit(){this.sesion=JSON.parse(sessionStorage.getItem("sesion"))}salir(){sessionStorage.clear(),localStorage.clear(),this.router.navigate(["/login"]),location.reload()}}return t.\u0275fac=function(e){return new(e||t)(jo(vp))},t.\u0275cmp=Bt({type:t,selectors:[["app-menu"]],decls:84,vars:20,consts:[[1,"wrapper"],["id","sidebar",1,"sidebar","js-sidebar"],[1,"sidebar-content","js-simplebar"],["href","index.html",1,"sidebar-brand","text-center"],[1,"align-middle"],["src","../../../assets/img/logo-completo.png","width","90","alt","MOCHA"],[1,"sidebar-nav"],[1,"sidebar-header"],[1,"sidebar-item",3,"ngClass"],[1,"sidebar-link",3,"routerLink"],["routerLink","/menu/editarUsuario/","routerLinkActive","",2,"display","none"],["editarUsuario","routerLinkActive"],["routerLink","/menu/listarUsuario/","routerLinkActive","",2,"display","none"],["listarUsuario","routerLinkActive"],["routerLink","/menu/nuevoUsuario/","routerLinkActive","",2,"display","none"],["nuevoUsuario","routerLinkActive"],["data-feather","users",1,"align-middle"],[1,"sidebar-item",3,"routerLinkActive"],["data-feather","check-square",1,"align-middle"],["data-feather","user",1,"align-middle"],["routerLink","/menu/editarProveedor/","routerLinkActive","",2,"display","none"],["editarProveedor","routerLinkActive"],["routerLink","/menu/listarProveedor/","routerLinkActive","",2,"display","none"],["listarProveedor","routerLinkActive"],["routerLink","/menu/nuevoProveedor/","routerLinkActive","",2,"display","none"],["nuevoProveedor","routerLinkActive"],["data-feather","user-plus",1,"align-middle"],["routerLink","/menu/listarDetalle/","routerLinkActive","",2,"display","none"],["editarDetalle","routerLinkActive"],["routerLink","/menu/editarDetalle/","routerLinkActive","",2,"display","none"],["listarDetalle","routerLinkActive"],["routerLink","/menu/nuevoDetalle/","routerLinkActive","",2,"display","none"],["nuevoDetalle","routerLinkActive"],[1,"main"],[1,"navbar","navbar-expand","navbar-light","navbar-bg"],[1,"sidebar-toggle","js-sidebar-toggle"],[1,"hamburger","align-self-center"],[1,"navbar-collapse","collapse"],[1,"navbar-nav","navbar-align"],[1,"nav-item","dropdown"],["href","#","data-bs-toggle","dropdown",1,"nav-icon","dropdown-toggle","d-inline-block","d-sm-none"],["data-feather","settings",1,"align-middle"],["href","#","data-bs-toggle","dropdown",1,"nav-link","dropdown-toggle","d-none","d-sm-inline-block"],["src","../../../assets/img/nuevo_user.png","alt","Charles Hall",1,"avatar","img-fluid","rounded","me-1"],[1,"text-dark"],[1,"dropdown-menu","dropdown-menu-end"],[1,"dropdown-item",3,"click"],["data-feather","log-out",1,"align-middle","me-1"],[1,"content"],[1,"footer","bg-white","shadow"],[1,"container-fluid"],[1,"row","text-muted"],[1,"col-6","text-start"],[1,"mb-0"],["href","http://www.municipiomocha.gob.ec/gadmocha/","target","_blank",1,"text-muted"],[2,"font-size","0.60rem"],[1,"text-mocha1"],[1,"text-mocha2"],[1,"text-mocha3"]],template:function(t,e){if(1&t&&(Go(0,"div",0),Go(1,"nav",1),Go(2,"div",2),Go(3,"a",3),Go(4,"span",4),Ho(5,"img",5),Zo(),Zo(),Go(6,"ul",6),Go(7,"li",7),ks(8," Administracion "),Zo(),Go(9,"li",8),Go(10,"a",9),Ho(11,"a",10,11),Ho(13,"a",12,13),Ho(15,"a",14,15),Ho(17,"i",16),Go(18,"span",4),ks(19,"Usuarios"),Zo(),Zo(),Zo(),Go(20,"li",7),ks(21," Productos "),Zo(),Go(22,"li",17),Go(23,"a",9),Ho(24,"i",18),Go(25,"span",4),ks(26,"Nuevo Producto"),Zo(),Zo(),Zo(),Go(27,"li",7),ks(28," Productores "),Zo(),Go(29,"li",8),Go(30,"a",9),Ho(31,"i",19),Go(32,"span",4),ks(33,"Nuevo Productor"),Zo(),Ho(34,"a",20,21),Ho(36,"a",22,23),Ho(38,"a",24,25),Zo(),Zo(),Go(40,"li",8),Go(41,"a",9),Ho(42,"i",26),Go(43,"span",4),ks(44,"Asignar Producto"),Zo(),Ho(45,"a",27,28),Ho(47,"a",29,30),Ho(49,"a",31,32),Zo(),Zo(),Zo(),Zo(),Zo(),Go(51,"div",33),Go(52,"nav",34),Go(53,"a",35),Ho(54,"i",36),Zo(),Go(55,"div",37),Go(56,"ul",38),Go(57,"li",39),Go(58,"a",40),Ho(59,"i",41),Zo(),Go(60,"a",42),Ho(61,"img",43),Go(62,"span",44),ks(63),Zo(),Zo(),Go(64,"div",45),Go(65,"a",46),ts("click",function(){return e.salir()}),Ho(66,"i",47),ks(67,"Salir"),Zo(),Zo(),Zo(),Zo(),Zo(),Zo(),Go(68,"main",48),Ho(69,"router-outlet"),Zo(),Go(70,"footer",49),Go(71,"div",50),Go(72,"div",51),Go(73,"div",52),Go(74,"p",53),Go(75,"a",54),Go(76,"strong",55),Go(77,"span",56),ks(78,"GAD"),Zo(),Go(79,"span",57),ks(80,"MOCHA"),Zo(),Go(81,"span",58),ks(82,"2021"),Zo(),Zo(),Zo(),ks(83," \xa9 "),Zo(),Zo(),Zo(),Zo(),Zo(),Zo(),Zo()),2&t){const t=No(12),n=No(14),i=No(16),r=No(35),o=No(37),s=No(39),a=No(46),l=No(48),c=No(50);ur(9),qo("ngClass",Ka(9,Pv,t.isActive||n.isActive||i.isActive)),ur(1),qo("routerLink",Xa(11,Mv)),ur(12),qo("routerLinkActive",Xa(12,Ov)),ur(1),qo("routerLink",Xa(13,zv)),ur(6),qo("ngClass",Ka(14,Pv,r.isActive||o.isActive||s.isActive)),ur(1),qo("routerLink",Xa(16,Dv)),ur(10),qo("ngClass",Ka(17,Pv,a.isActive||l.isActive||c.isActive)),ur(1),qo("routerLink",Xa(19,Lv)),ur(22),As(e.sesion[0].usuario)}},directives:[$c,bp,Cp,ov,Tp],styles:[""]}),t})();function Fv(t,e,n,i){return new(n||(n=Promise))(function(r,o){function s(t){try{l(i.next(t))}catch(e){o(e)}}function a(t){try{l(i.throw(t))}catch(e){o(e)}}function l(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(s,a)}l((i=i.apply(t,e||[])).next())})}let Bv=(()=>{class t{constructor(t){this.http=t,this.api="http://raphaelrod-001-site1.itempurl.com/api/usuarios/"}login(t,e){const n=(new $_).set("usu",t).set("contra",e);return this.http.get(this.api+"login",{params:n})}nuevo(t){return this.http.post(this.api,t)}buscar(t){var e=(new $_).append("busqueda",t);return this.http.get(this.api+"buscador",{params:e})}listar(){return this.http.get(this.api)}eliminar(t){return this.http.delete(this.api+t)}cargar(t){return this.http.get(this.api+t)}editar(t,e){return this.http.put(this.api+t,e)}cedula(t){const e=(new $_).set("cedula",t);return this.http.get(this.api+"cedulaCliente",{params:e})}}return t.\u0275fac=function(e){return new(e||t)(ui(ey))},t.\u0275prov=at({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();function Vv(t,e){1&t&&(Go(0,"div",24),Go(1,"button",25),ks(2," Ingresar "),Zo(),Zo())}function Uv(t,e){1&t&&(Go(0,"div",24),Go(1,"button",26),ks(2," Espere.. "),Zo(),Zo())}let Nv=(()=>{class t{constructor(t,e){this.router=t,this.clientes=e,this.login=new Am({usuario:new km("",Mf.required),contrasena:new km("",Mf.required)}),this.spinner=0}ngOnInit(){}logueo(t){return Fv(this,void 0,void 0,function*(){this.spinner=1,this.clientes.login(t.usuario,t.contrasena).subscribe(t=>{if(""==t)return Zm.a.fire({icon:"warning",title:"Login",text:"Credenciales Incorrectas",showConfirmButton:!0,confirmButtonText:"Aceptar",confirmButtonColor:"#29A05B"}),void(this.spinner=0);this.spinner=0,sessionStorage.setItem("sesion",JSON.stringify(t)),this.router.navigate(["/menu"]),setTimeout(()=>{window.location.reload()},100)},t=>{alert("Error al iniciar sesion"),this.spinner=1}).add(()=>{})})}}return t.\u0275fac=function(e){return new(e||t)(jo(vp),jo(Bv))},t.\u0275cmp=Bt({type:t,selectors:[["app-login"]],decls:28,vars:3,consts:[["lang","en"],["charset","utf-8"],["http-equiv","X-UA-Compatible","content","IE=edge"],["name","viewport","content","width=device-width, initial-scale=1.0"],["name","description","content",""],["name","author","content",""],[2,"background-color","#FFFFFF","background-color","#3f3f3f","height","100vh","overflow","hidden"],[1,"container"],[1,"row",2,"height","15rem"],[1,"ms-auto","me-auto",2,"width","30rem"],[1,"card","o-hidden","border-0","shadow-lg",2,"top","50%"],[1,"card-body","p-0"],[1,"row"],[1,"col-lg-9","ms-auto","me-auto"],[1,"p-3"],["href","index.html",1,"sidebar-brand","text-center","mb-4"],[1,"align-middle"],["src","../../../assets/img/logo-completo.png","width","120","alt","MOCHA"],[1,"user",3,"formGroup","ngSubmit"],[1,"form-group"],["formControlName","usuario","type","email","id","exampleInputEmail","aria-describedby","emailHelp","placeholder","Ingrese el nombre de Usuario",1,"form-control","form-control-user"],[1,"form-group","mt-4"],["formControlName","contrasena","type","password","id","exampleInputPassword","placeholder","Ingrese la Contrase\xf1a",1,"form-control","form-control-user"],["class","form-group mt-4 text-center mb-3 ",4,"ngIf"],[1,"form-group","mt-4","text-center","mb-3"],[1,"btn","btn-primary","btn-user","btn-block"],["disabled","",1,"btn","btn-primary","btn-user","btn-block"]],template:function(t,e){1&t&&(Go(0,"html",0),Go(1,"head"),Ho(2,"meta",1),Ho(3,"meta",2),Ho(4,"meta",3),Ho(5,"meta",4),Ho(6,"meta",5),Go(7,"title"),ks(8,"SB Admin 2 - Login"),Zo(),Zo(),Go(9,"body",6),Go(10,"div",7),Go(11,"div",8),Go(12,"div",9),Go(13,"div",10),Go(14,"div",11),Go(15,"div",12),Go(16,"div",13),Go(17,"div",14),Go(18,"a",15),Go(19,"span",16),Ho(20,"img",17),Zo(),Zo(),Go(21,"form",18),ts("ngSubmit",function(){return e.logueo(e.login.value)}),Go(22,"div",19),Ho(23,"input",20),Zo(),Go(24,"div",21),Ho(25,"input",22),Zo(),Uo(26,Vv,3,0,"div",23),Uo(27,Uv,3,0,"div",23),Zo(),Zo(),Zo(),Zo(),Zo(),Zo(),Zo(),Zo(),Zo(),Zo(),Zo()),2&t&&(ur(21),qo("formGroup",e.login),ur(5),qo("ngIf",0==e.spinner),ur(1),qo("ngIf",1==e.spinner))},directives:[zm,Wf,Rm,Sf,Hf,Bm,Wc],styles:[""]}),t})(),jv=(()=>{class t{constructor(t){this.http=t,this.api="http://raphaelrod-001-site1.itempurl.com/api/categorias/"}listar(){return this.http.get(this.api)}}return t.\u0275fac=function(e){return new(e||t)(ui(ey))},t.\u0275prov=at({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();function qv(t,e){if(1&t){const t=Yo();Go(0,"tr",17),Go(1,"td"),Go(2,"strong"),ks(3),Zo(),Zo(),Go(4,"td"),ks(5),Zo(),Go(6,"td",19),Go(7,"div",20),Go(8,"div",21),Go(9,"button",22),ks(10," Opciones "),Zo(),Go(11,"ul",23),Go(12,"li"),Go(13,"a",24),ts("click",function(){Ie(t);const n=e.$implicit,i=is(2),r=No(19);return i.cargar(n),i.openModal(r)}),ks(14,"Editar"),Zo(),Zo(),Go(15,"li"),Go(16,"a",24),ts("click",function(){Ie(t);const n=e.$implicit;return is(2).eliminar(n.idCategorias)}),ks(17,"Eliminar"),Zo(),Zo(),Zo(),Zo(),Zo(),Zo(),Zo()}if(2&t){const t=e.$implicit,n=e.index;ur(3),As(n+1),ur(2),As(t.detalle)}}function $v(t,e){if(1&t&&(Go(0,"div",14),Go(1,"table",15),Go(2,"thead",16),Go(3,"tr"),Go(4,"td"),ks(5,"#"),Zo(),Go(6,"td"),ks(7,"Detalle"),Zo(),Go(8,"td"),ks(9,"Opciones"),Zo(),Zo(),Zo(),Go(10,"tbody"),Ho(11,"tr",17),Uo(12,qv,18,2,"tr",18),Zo(),Zo(),Zo()),2&t){const t=is();ur(12),qo("ngForOf",t.categoriaObj)}}function Gv(t,e){1&t&&(Go(0,"div",25),Ho(1,"div",26),Zo())}function Zv(t,e){if(1&t){const t=Yo();Go(0,"div",27),Go(1,"h4",28),ks(2,"Nueva Categoria"),Zo(),Go(3,"button",29),ts("click",function(){return e.$implicit.dismiss("Cross click")}),Go(4,"span",30),ks(5,"\xd7"),Zo(),Zo(),Zo(),Go(6,"div",31),Go(7,"h5"),ks(8,"Nombre"),Zo(),Go(9,"input",32),ts("ngModelChange",function(e){return Ie(t),is().NewDetalleCategoria=e}),Zo(),Zo(),Go(10,"div",33),Go(11,"button",34),ts("click",function(){Ie(t);const n=e.$implicit;return is().guardar(),n.close("Close click")}),ks(12,"Guardar"),Zo(),Go(13,"button",35),ts("click",function(){return e.$implicit.close("Close click")}),ks(14,"Cancelar"),Zo(),Zo()}if(2&t){const t=is();ur(9),qo("ngModel",t.NewDetalleCategoria)}}function Hv(t,e){if(1&t){const t=Yo();Go(0,"div",27),Go(1,"h4",28),ks(2,"Editar Categoria"),Zo(),Go(3,"button",29),ts("click",function(){return e.$implicit.dismiss("Cross click")}),Go(4,"span",30),ks(5,"\xd7"),Zo(),Zo(),Zo(),Go(6,"div",31),Go(7,"h5"),ks(8,"Nombre"),Zo(),Go(9,"input",32),ts("ngModelChange",function(e){return Ie(t),is().UpdateDetalleCategoria=e}),Zo(),Zo(),Go(10,"div",33),Go(11,"button",34),ts("click",function(){Ie(t);const n=e.$implicit;return is().editar(),n.close("Close click")}),ks(12,"Editar"),Zo(),Go(13,"button",35),ts("click",function(){return e.$implicit.close("Close click")}),ks(14,"Cancelar"),Zo(),Zo()}if(2&t){const t=is();ur(9),qo("ngModel",t.UpdateDetalleCategoria)}}let Wv=(()=>{class t{constructor(t,e){this.categoriaService=t,this.modalService=e,this.categoriaObj=[],this.spinner=0}ngOnInit(){this.mostrar()}mostrar(){this.spinner=1,this.categoriaService.listar().subscribe(t=>{this.categoriaObj=t,this.spinner=0},t=>{alert("Error al listar"),this.spinner=0})}cargar(t){this.IDCategoria=t.idCategorias}}return t.\u0275fac=function(e){return new(e||t)(jo(jv),jo(_v))},t.\u0275cmp=Bt({type:t,selectors:[["app-listar-categoria"]],decls:20,vars:2,consts:[["lang","en"],["charset","UTF-8"],["name","viewport","content","width=device-width, initial-scale=1.0"],[1,"container"],[1,"text-uppercase","text-center","pt-3","pb-2"],[2,"font-weight","bold"],[2,"background-color","#F8F9FC"],[1,"container-fluid","col-8","col-sm-6","col-lg-4","mt-3"],[1,"row"],[1,"text-center","mt-4"],["class","table-responsive mt-4    container","style","height: 505px;",4,"ngIf"],["class","text-center  ","style","margin-top: 10em;",4,"ngIf"],["nuevo",""],["actualizar",""],[1,"table-responsive","mt-4","container",2,"height","505px"],[1,"table","table-bordered","table-sm","text-center"],[1,"bg-dark","text-white"],[1,"text-dark"],["class","text-dark webkit-scrollbar,","class","text-dark",4,"ngFor","ngForOf"],[1,"text-center"],["role","group","aria-label","Button group with nested dropdown",1,"btn-group","dropdown"],["role","group",1,"btn-group"],["data-toggle","dropdown","id","dropdownMenuButton","type","button","aria-haspopup","true","aria-expanded","false",1,"btn","btn-primary","dropdown-toggle"],["aria-labelledby","btnGroupDrop1",1,"dropdown-menu"],[1,"dropdown-item",3,"click"],[1,"text-center",2,"margin-top","10em"],["role","status",1,"spinner-border","text-primary"],[1,"modal-header"],[1,"modal-title"],["type","button","aria-label","Close",1,"close",3,"click"],["aria-hidden","true"],[1,"modal-body"],["aria-describedby","emailHelp",1,"form-control",3,"ngModel","ngModelChange"],[1,"modal-footer"],["type","button",1,"btn","btn-primary",3,"click"],["type","button",1,"btn","btn-light",3,"click"]],template:function(t,e){1&t&&(Go(0,"html",0),Go(1,"head"),Ho(2,"meta",1),Ho(3,"meta",2),Go(4,"title"),ks(5,"Lista de Categorias"),Zo(),Zo(),Go(6,"div",3),Go(7,"div",4),Go(8,"h3",5),ks(9,"Categorias"),Zo(),Zo(),Zo(),Go(10,"body",6),Go(11,"div",7),Ho(12,"div",8),Zo(),Ho(13,"div",9),Uo(14,$v,13,1,"div",10),Uo(15,Gv,2,0,"div",11),Zo(),Uo(16,Zv,15,1,"ng-template",null,12,bl),Uo(18,Hv,15,1,"ng-template",null,13,bl),Zo()),2&t&&(ur(14),qo("ngIf",0==e.spinner),ur(1),qo("ngIf",1==e.spinner))},directives:[Wc,Zc,Sf,Hf,Om],styles:["span[_ngcontent-%COMP%]{position:absolute;margin-left:5px;height:25px;display:flex;align-items:center;margin-top:5px}input[_ngcontent-%COMP%]{padding-left:25px}"]}),t})(),Xv=(()=>{class t{constructor(t){this.http=t,this.apiCategoria="http://raphaelrod-001-site1.itempurl.com/api/categorias/",this.apiProducto="http://raphaelrod-001-site1.itempurl.com/api/productos/",this.apiProveedor="http://raphaelrod-001-site1.itempurl.com/api/proveedores/"}nuevoProducto(t){return this.http.post(this.apiProducto,t)}listarProductos(){return this.http.get(this.apiProducto)}eliminarProducto(t){return this.http.delete(this.apiProducto+t)}editarProducto(t,e){return this.http.put(this.apiProducto+t,e)}}return t.\u0275fac=function(e){return new(e||t)(ui(ey))},t.\u0275prov=at({token:t,factory:t.\u0275fac,providedIn:"root"}),t})(),Kv=(()=>{class t{constructor(t){this.http=t,this.api="http://raphaelrod-001-site1.itempurl.com/api/tipoProductores/"}listar(){return this.http.get(this.api)}}return t.\u0275fac=function(e){return new(e||t)(ui(ey))},t.\u0275prov=at({token:t,factory:t.\u0275fac,providedIn:"root"}),t})(),Yv=(()=>{class t{transform(e,n){return n&&e?t.filter(e,n):e}static filter(t,e){const n=e.toLowerCase();function i(t,e){for(let r in t)if(null!==t[r]&&null!=t[r]){if("object"==typeof t[r]&&i(t[r],e))return!0;if(t[r].toString().toLowerCase().includes(n))return!0}return!1}return t.filter(function(t){return i(t,e)})}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275pipe={type:(e={name:"filter",type:t,pure:!1}).type,name:e.name,factory:null,pure:!1!==e.pure,onDestroy:e.type.prototype.ngOnDestroy||null},t.\u0275prov=at({token:t,factory:t.\u0275fac}),t;var e})(),Jv=(()=>{class t{}return t.\u0275mod=jt({type:t}),t.\u0275inj=lt({factory:function(e){return new(e||t)}}),t})();const Qv=function(){return{standalone:!0}};function tx(t,e){if(1&t){const t=Yo();Go(0,"div",32),Go(1,"div",33),Go(2,"span"),Ho(3,"i",34),Zo(),Go(4,"input",35),ts("ngModelChange",function(e){return Ie(t),is(2).busqueda=e}),Zo(),Zo(),Zo()}if(2&t){const t=is(2);ur(4),qo("ngModel",t.busqueda)("ngModelOptions",Xa(2,Qv))}}function ex(t,e){if(1&t&&(Go(0,"div",36),Go(1,"label"),ks(2,"Total "),Zo(),Go(3,"strong"),ks(4),Zo(),Zo()),2&t){const t=is(2);ur(4),Is(" ",t.productoObj.length,"")}}function nx(t,e){1&t&&(Go(0,"div",36),Go(1,"label"),ks(2,"Total "),Zo(),Go(3,"strong"),ks(4," 0"),Zo(),Zo())}function ix(t,e){1&t&&(Go(0,"thead",42),Go(1,"tr"),Go(2,"td"),ks(3,"#"),Zo(),Go(4,"td"),ks(5,"Nombre"),Zo(),Go(6,"td"),ks(7,"Unidad"),Zo(),Go(8,"td"),ks(9,"Descripcion"),Zo(),Go(10,"td"),ks(11,"Opciones"),Zo(),Zo(),Zo())}function rx(t,e){if(1&t){const t=Yo();Go(0,"tr",39),Go(1,"td"),Go(2,"strong"),ks(3),Zo(),Zo(),Go(4,"td"),ks(5),Zo(),Go(6,"td"),ks(7),Zo(),Go(8,"td"),ks(9),Zo(),Go(10,"td",6),Go(11,"div",43),Go(12,"button",44),ks(13," Opciones "),Zo(),Go(14,"ul",45),Go(15,"li"),Go(16,"a",46),ts("click",function(){Ie(t);const n=e.$implicit;return is(3).llenarCampos(n)}),ks(17,"Editar"),Zo(),Zo(),Go(18,"li"),Go(19,"a",47),ts("click",function(){Ie(t);const n=e.$implicit;return is(3).elimiarProd(n.idProductos)}),ks(20,"Eliminar"),Zo(),Zo(),Zo(),Zo(),Zo(),Zo()}if(2&t){const t=e.$implicit,n=e.index;ur(3),As(n+1),ur(2),As(t.nombreProducto),ur(2),As(t.unidad),ur(2),Ps("",t.nombreProducto," ",t.descripcion,"")}}function ox(t,e){1&t&&(Go(0,"td",48),Go(1,"div"),Go(2,"h5",6),ks(3,"No Existen Registros"),Zo(),Zo(),Zo())}function sx(t,e){if(1&t&&(Go(0,"table",37),Uo(1,ix,12,0,"thead",38),Qa(2,"filter"),Go(3,"tbody"),Ho(4,"tr",39),Uo(5,rx,21,5,"tr",40),Qa(6,"filter"),Go(7,"tr"),Uo(8,ox,4,0,"td",41),Qa(9,"filter"),Zo(),Zo(),Zo()),2&t){const t=is(2);ur(1),qo("ngIf",0!=tl(2,3,t.productoObj,t.busqueda).length),ur(4),qo("ngForOf",tl(6,6,t.productoObj,t.busqueda)),ur(3),qo("ngIf",0==tl(9,9,t.productoObj,t.busqueda).length)}}function ax(t,e){if(1&t&&(Go(0,"div",27),Uo(1,tx,5,3,"div",28),Uo(2,ex,5,1,"div",29),Qa(3,"filter"),Uo(4,nx,5,0,"div",29),Qa(5,"filter"),Go(6,"div",30),Uo(7,sx,10,12,"table",31),Zo(),Zo()),2&t){const t=is();ur(1),qo("ngIf",t.productoObj.length>0),ur(1),qo("ngIf",0!=tl(3,4,t.productoObj,t.busqueda).length),ur(2),qo("ngIf",0==tl(5,7,t.productoObj,t.busqueda).length),ur(3),qo("ngIf",t.productoObj.length>0)}}function lx(t,e){1&t&&(Go(0,"div",49),Ho(1,"div",50),Zo())}function cx(t,e){if(1&t&&(Go(0,"option",51),ks(1),Zo()),2&t){const t=e.$implicit;as("value",t.idTipoProductores),ur(1),Is(" ",t.nombre," ")}}function ux(t,e){if(1&t&&(Go(0,"option",51),ks(1),Zo()),2&t){const t=is().$implicit;as("value",t.idCategorias),ur(1),Is(" ",t.nombre," ")}}function hx(t,e){if(1&t&&(Go(0,"option",51),ks(1),Zo()),2&t){const t=is().$implicit;as("value",t.idCategorias),ur(1),Ps(" ",t.nombre," - ",t.descripcion," ")}}function dx(t,e){if(1&t&&(Wo(0),Uo(1,ux,2,2,"option",52),Uo(2,hx,2,3,"option",52),Xo()),2&t){const t=e.$implicit;ur(1),qo("ngIf",null==t.descripcion),ur(1),qo("ngIf",null!=t.descripcion)}}function px(t,e){if(1&t&&(Go(0,"option",51),ks(1),Zo()),2&t){const t=e.$implicit;as("value",e.index),ur(1),As(t)}}function fx(t,e){if(1&t){const t=Yo();Go(0,"div"),Go(1,"p"),ks(2,"Razas"),Zo(),Go(3,"select",53),ts("ngModelChange",function(e){return Ie(t),is().descripcionNew=e}),Uo(4,px,2,2,"option",18),Zo(),Zo()}if(2&t){const t=is();ur(3),qo("ngModel",t.descripcionNew),ur(1),qo("ngForOf",t.razas)}}function mx(t,e){if(1&t&&(Go(0,"option",51),ks(1),Zo()),2&t){const t=e.$implicit;as("value",e.index),ur(1),As(t)}}function gx(t,e){if(1&t){const t=Yo();Go(0,"div"),Go(1,"p"),ks(2,"Entrega"),Zo(),Go(3,"select",53),ts("ngModelChange",function(e){return Ie(t),is().entregaNew=e}),Uo(4,mx,2,2,"option",18),Zo(),Zo()}if(2&t){const t=is();ur(3),qo("ngModel",t.entregaNew),ur(1),qo("ngForOf",t.entregas)}}function _x(t,e){if(1&t){const t=Yo();Go(0,"div"),Go(1,"p"),ks(2,"Talla"),Zo(),Go(3,"input",21),ts("ngModelChange",function(e){return Ie(t),is().tallaNew=e}),Zo(),Ho(4,"br"),Zo()}if(2&t){const t=is();ur(3),gs("border-danger",1==t.checkTalla),qo("ngModel",t.tallaNew)}}function yx(t,e){if(1&t&&(Go(0,"option",51),ks(1),Zo()),2&t){const t=e.$implicit;as("value",t.idTipoProductores),ur(1),Is(" ",t.nombre," ")}}function vx(t,e){if(1&t&&(Go(0,"option",51),ks(1),Zo()),2&t){const t=is().$implicit;as("value",t.idCategorias),ur(1),Is(" ",t.nombre," ")}}function xx(t,e){if(1&t&&(Go(0,"option",51),ks(1),Zo()),2&t){const t=is().$implicit;as("value",t.idCategorias),ur(1),Ps(" ",t.nombre," - ",t.descripcion," ")}}function bx(t,e){if(1&t&&(Wo(0),Uo(1,vx,2,2,"option",52),Uo(2,xx,2,3,"option",52),Xo()),2&t){const t=e.$implicit;ur(1),qo("ngIf",null==t.descripcion),ur(1),qo("ngIf",null!=t.descripcion)}}function wx(t,e){if(1&t&&(Go(0,"option",51),ks(1),Zo()),2&t){const t=e.$implicit;as("value",e.index),ur(1),As(t)}}function Cx(t,e){if(1&t){const t=Yo();Go(0,"div"),Go(1,"p"),ks(2,"Razas"),Zo(),Go(3,"select",53),ts("ngModelChange",function(e){return Ie(t),is().descripcionNew=e}),Uo(4,wx,2,2,"option",18),Zo(),Zo()}if(2&t){const t=is();ur(3),qo("ngModel",t.descripcionNew),ur(1),qo("ngForOf",t.razas)}}function Tx(t,e){if(1&t&&(Go(0,"option",51),ks(1),Zo()),2&t){const t=e.$implicit;as("value",e.index),ur(1),As(t)}}function Sx(t,e){if(1&t){const t=Yo();Go(0,"div"),Go(1,"p"),ks(2,"Entrega"),Zo(),Go(3,"select",53),ts("ngModelChange",function(e){return Ie(t),is().entregaNew=e}),Uo(4,Tx,2,2,"option",18),Zo(),Zo()}if(2&t){const t=is();ur(3),qo("ngModel",t.entregaNew),ur(1),qo("ngForOf",t.entregas)}}function Ex(t,e){if(1&t){const t=Yo();Go(0,"div"),Go(1,"p"),ks(2,"Talla"),Zo(),Go(3,"input",21),ts("ngModelChange",function(e){return Ie(t),is().tallaUpdate=e}),Zo(),Ho(4,"br"),Zo()}if(2&t){const t=is();ur(3),gs("border-danger",1==t.checkTalla),qo("ngModel",t.tallaUpdate)}}let kx=(()=>{class t{constructor(t,e,n,i,r){this.productosService=t,this.modalService=e,this.tipoProductoresService=n,this.categoriaService=i,this.elementRef=r,this.checkProductor=!1,this.checkCategoria=!1,this.checkNombre=!1,this.checkUnidad=!1,this.checkTalla=!1,this.productoObj=[],this.categoriaObj=[],this.categoriaFiltradoObj=[],this.tipoProductoresObj=[],this.razas=["Holstein Friesianz","Brow Swiss","Jersey","F1 o Mestiza"],this.entregas=["Centro de acopio","Recolector","Consumo"],this.tallaCheck=!1,this.razaCheck=!1,this.spinner=0,this.tipoProductorIdNew=0,this.categoriaIdNew=0,this.descripcionNew=0,this.entregaNew=0,this.tallaNew="",this.IDProducto=0,this.tallaUpdate=null}ngOnInit(){this.mostrar(),this.llenarTipoProductores(),this.llenarCategorias()}mostrar(){this.productosService.listarProductos().subscribe(t=>{this.productoObj=t},t=>alert("Error al listar Productos"))}llenarCategorias(){this.categoriaService.listar().subscribe(t=>{this.categoriaObj=t},t=>alert("Error al listar Categorias"))}llenarTipoProductores(){this.tipoProductoresService.listar().subscribe(t=>{this.tipoProductoresObj=t},t=>alert("Error al listar los Tipos de Productores"))}filtrarCategorias(t){this.tallaNew=null,this.tallaUpdate=null,this.categoriaIdNew=0,this.categoriaFiltradoObj=[];for(let e of this.categoriaObj)e.idTipoProductores==this.tipoProductorIdNew&&this.categoriaFiltradoObj.push(e);this.comprobarTalla()}comprobarTalla(){let t;for(let e of this.tipoProductoresObj)e.idTipoProductores==this.tipoProductorIdNew&&(t=e);this.tallaCheck="ARTESANO"==t.nombre||"artesano"==t.nombre||"ARTESANOS"==t.nombre||"artesanos"==t.nombre||"Artesanos"==t.nombre||"Artesano"==t.nombre}comprobarRaza(t){let e;0!=this.categoriaIdNew&&null!=this.categoriaIdNew||(this.razaCheck=!1);for(let n of this.categoriaFiltradoObj)n.idCategorias==this.categoriaIdNew&&(e=n);this.razaCheck="LECHE"==e.descripcion||"leche"==e.descripcion||"Leche"==e.descripcion}guardar(){return Fv(this,void 0,void 0,function*(){if(!(0!=this.categoriaIdNew&&null!=this.categoriaIdNew||0!=this.tipoProductorIdNew&&null!=this.tipoProductorIdNew))return this.checkProductor=!0,void(this.checkCategoria=!0);if(this.checkProductor=!1,this.checkCategoria=!1,0==this.tipoProductorIdNew||null==this.tipoProductorIdNew)return void(this.checkProductor=!0);if(this.checkProductor=!1,0==this.categoriaIdNew||null==this.categoriaIdNew)return void(this.checkCategoria=!0);this.checkCategoria=!1;let t={idProductos:void 0,nombreProducto:this.nombreNew,unidad:this.unidadNew,descripcion:this.razas[this.descripcionNew],talla:this.tallaNew,idCategorias:this.categoriaIdNew,categorias:null,entrega:this.entregas[this.entregaNew]};if(0==this.razaCheck&&(t.descripcion=null,t.entrega=null),!(""!=t.nombreProducto&&null!=t.nombreProducto||""!=t.unidad&&null!=t.unidad))return this.checkUnidad=!0,void(this.checkNombre=!0);if(this.checkUnidad=!1,this.checkNombre=!1,""!=t.nombreProducto&&null!=t.nombreProducto)if(this.checkNombre=!1,""!=t.unidad&&null!=t.unidad){if(this.checkUnidad=!1,1==this.tallaCheck){if(t.descripcion=null,t.entrega=null,""==t.talla||null==t.talla)return void(this.checkTalla=!0);this.checkTalla=!1,yield this.productosService.nuevoProducto(t).subscribe(t=>{Zm.a.fire({position:"center",icon:"success",title:"Guardado con exito",showConfirmButton:!1,timer:1500})},t=>{console.log("Error al guardar")},()=>{this.mostrar()})}else t.talla=null,this.productosService.nuevoProducto(t).subscribe(t=>{Zm.a.fire({position:"center",icon:"success",title:"Guardado con exito",showConfirmButton:!1,timer:1500})},t=>{console.log("Error al guardar")},()=>{this.mostrar()});this.elementRef.nativeElement.querySelector("#cancelar").click()}else this.checkUnidad=!0;else this.checkNombre=!0})}llenarCampos(t){this.IDProducto=0,this.nombreUpdate=null,this.unidadUpdate=null,this.descripcionNew=0,this.entregaNew=0,this.tallaUpdate=null,this.tallaCheck=null!=t.talla&&null!=t.talla&&""!=t.talla;let e=t.idCategorias;for(let n of this.categoriaObj)if(n.idCategorias==e){this.tipoProductorIdNew=n.idTipoProductores;break}this.filtrarCategorias(""),this.categoriaIdNew=e,this.IDProducto=t.idProductos,this.nombreUpdate=t.nombreProducto,this.unidadUpdate=t.unidad;for(let n=0;n<this.razas.length;n++)if(this.razas[n]==t.descripcion){this.descripcionNew=n;break}for(let n=0;n<this.entregas.length;n++)if(this.entregas[n]==t.entrega){this.entregaNew=n;break}this.tallaUpdate=t.talla,this.comprobarRaza("")}actualizarProd(){if(!(0!=this.categoriaIdNew&&null!=this.categoriaIdNew||0!=this.tipoProductorIdNew&&null!=this.tipoProductorIdNew))return this.checkProductor=!0,void(this.checkCategoria=!0);if(this.checkProductor=!1,this.checkCategoria=!1,0==this.tipoProductorIdNew||null==this.tipoProductorIdNew)return void(this.checkProductor=!0);if(this.checkProductor=!1,0==this.categoriaIdNew||null==this.categoriaIdNew)return void(this.checkCategoria=!0);this.checkCategoria=!1;let t={idProductos:this.IDProducto,nombreProducto:this.nombreUpdate,unidad:this.unidadUpdate,descripcion:this.razas[this.descripcionNew],talla:this.tallaUpdate,idCategorias:this.categoriaIdNew,categorias:null,entrega:this.entregas[this.entregaNew]};if(0==this.razaCheck&&(t.descripcion=null,t.entrega=null),!(""!=t.nombreProducto&&null!=t.nombreProducto||""!=t.unidad&&null!=t.unidad))return this.checkUnidad=!0,void(this.checkNombre=!0);if(this.checkUnidad=!1,this.checkNombre=!1,""!=t.nombreProducto&&null!=t.nombreProducto)if(this.checkNombre=!1,""!=t.unidad&&null!=t.unidad){if(this.checkUnidad=!1,1==this.tallaCheck){if(t.descripcion=null,t.entrega=null,""==t.talla||null==t.talla)return void(this.checkTalla=!0);this.checkTalla=!1,this.productosService.editarProducto(t.idProductos,t).subscribe(t=>{Zm.a.fire({position:"center",icon:"success",title:"Actualizacion exitosa",showConfirmButton:!1,timer:1500})},t=>{console.log("Error al actualizar")},()=>{this.mostrar()})}else t.talla=null,this.productosService.editarProducto(t.idProductos,t).subscribe(t=>{Zm.a.fire({position:"center",icon:"success",title:"Actualizacion exitosa",showConfirmButton:!1,timer:1500})},t=>{console.log("Error al actualizar")},()=>{this.mostrar()});this.elementRef.nativeElement.querySelector("#cancelar2").click()}else this.checkUnidad=!0;else this.checkNombre=!0}limpiar(){this.nombreNew=null,this.unidadNew=null,this.descripcionNew=0,this.entregaNew=0,this.tipoProductorIdNew=0,this.categoriaIdNew=0,this.tallaNew=null,this.tallaCheck=!1,this.razaCheck=!1}elimiarProd(t){alert(),Zm.a.fire({title:"\xbfEsta seguro que desea eliminar?",text:" este registro se eliminar\xe1 permanentemente",icon:"warning",confirmButtonColor:"#29A05B",showCancelButton:!0,cancelButtonColor:"#d33",cancelButtonText:"Cancelar",confirmButtonText:"Aceptar"}).then(e=>{e.isConfirmed&&this.productosService.eliminarProducto(t).subscribe(t=>{Zm.a.fire("Productos","Registro Eliminado exitosamente ","success"),this.mostrar()})},t=>{alert("Error al eliminar")})}openModal(t){this.checkProductor=!1,this.checkCategoria=!1,this.checkNombre=!1,this.checkUnidad=!1,this.checkTalla=!1,this.limpiar(),this.tipoProductorIdNew=0,this.categoriaIdNew=0,this.modalReference=this.modalService.open(t),this.modalReference.result.then(t=>{this.closeResult="Closed with: "+t},t=>{this.closeResult="Dismissed "+this.getDismissReason(t)})}getDismissReason(t){return t===fv.ESC?"by pressing ESC":t===fv.BACKDROP_CLICK?"by clicking on a backdrop":"with: "+t}errorDatos(){Zm.a.fire({position:"center",icon:"warning",title:"Porfavor llene todos los campos",showConfirmButton:!1,timer:3e3})}}return t.\u0275fac=function(e){return new(e||t)(jo(Xv),jo(_v),jo(Kv),jo(jv),jo(Qs))},t.\u0275cmp=Bt({type:t,selectors:[["app-productos"]],decls:93,vars:36,consts:[["lang","en"],["charset","UTF-8"],["name","viewport","content","width=device-width, initial-scale=1.0"],[1,"container"],[1,"text-uppercase","text-center","pb-2"],[2,"font-weight","bold"],[1,"text-center"],["type","button","data-bs-toggle","modal","data-bs-target","#staticBackdrop",1,"btn","btn-primary","col-5","col-sm-3",3,"click"],["class","table-responsive    container","style","height: 530 px;",4,"ngIf"],["class","text-center  ","style","margin-top: 10em;",4,"ngIf"],["id","staticBackdrop","name","staticBackdrop","data-bs-backdrop","static","data-bs-keyboard","false","tabindex","-1","aria-labelledby","staticBackdropLabel","aria-hidden","true",1,"modal","fade"],[1,"modal-dialog"],[1,"modal-content"],[1,"modal-header"],["id","staticBackdropLabel",1,"modal-title"],[1,"modal-body"],[1,"form-select",3,"ngModel","ngModelChange","change"],["value","0","selected","","disabled","","hidden",""],[3,"value",4,"ngFor","ngForOf"],[4,"ngFor","ngForOf"],[4,"ngIf"],["type","text",1,"form-control",3,"ngModel","ngModelChange"],[1,"modal-footer"],["type","button",1,"btn","btn-primary",3,"click"],["type","button","data-bs-dismiss","modal","id","cancelar","name","cancelar",1,"btn","btn-secondary"],["id","staticBackdrop2","data-bs-backdrop","static","data-bs-keyboard","false","tabindex","-1","aria-labelledby","staticBackdropLabel","aria-hidden","true",1,"modal","fade"],["type","button","data-bs-dismiss","modal","id","cancelar2","name","cancelar2",1,"btn","btn-secondary"],[1,"table-responsive","container",2,"height","530 px"],["class","form-group ms-auto me-auto col-4 ",4,"ngIf"],["class","text-center mt-3 mb-2","style","color: green; font-size: 1.2rem;",4,"ngIf"],[1,"table-responsive","mt-4","container",2,"height","400px"],["class","table table-bordered table-sm text-center",4,"ngIf"],[1,"form-group","ms-auto","me-auto","col-4"],[1,"col","mt-3"],[1,"fa","fa-search"],[1,"form-control",3,"ngModel","ngModelOptions","ngModelChange"],[1,"text-center","mt-3","mb-2",2,"color","green","font-size","1.2rem"],[1,"table","table-bordered","table-sm","text-center"],["class","bg-dark text-white ",4,"ngIf"],[1,"text-dark"],["class","text-dark webkit-scrollbar,","class","text-dark",4,"ngFor","ngForOf"],["colspan","5",4,"ngIf"],[1,"bg-dark","text-white"],[1,"btn-group"],["type","button","data-bs-toggle","dropdown","aria-expanded","false",1,"btn","btn-primary","dropdown-toggle"],[1,"dropdown-menu"],["data-bs-toggle","modal","data-bs-target","#staticBackdrop2",1,"dropdown-item",3,"click"],[1,"dropdown-item",3,"click"],["colspan","5"],[1,"text-center",2,"margin-top","10em"],["role","status",1,"spinner-border","text-primary"],[3,"value"],[3,"value",4,"ngIf"],[1,"form-select",3,"ngModel","ngModelChange"]],template:function(t,e){1&t&&(Go(0,"html",0),Go(1,"head"),Ho(2,"meta",1),Ho(3,"meta",2),Go(4,"title"),ks(5,"Lista de Productos"),Zo(),Zo(),Go(6,"div",3),Go(7,"div",4),Go(8,"h3",5),ks(9,"Productos"),Zo(),Zo(),Zo(),Go(10,"div",6),Go(11,"a",7),ts("click",function(){return e.limpiar()}),ks(12,"Nuevo"),Zo(),Zo(),Uo(13,ax,8,10,"div",8),Uo(14,lx,2,0,"div",9),Go(15,"div",10),Go(16,"div",11),Go(17,"div",12),Go(18,"div",13),Go(19,"h3",14),ks(20,"Nuevo Producto"),Zo(),Zo(),Go(21,"div",15),Go(22,"p"),ks(23,"Tipo Productor"),Zo(),Go(24,"select",16),ts("ngModelChange",function(t){return e.tipoProductorIdNew=t})("change",function(t){return e.filtrarCategorias(t.target.value)}),Go(25,"option",17),ks(26,"Seleccione una Opcion"),Zo(),Uo(27,cx,2,2,"option",18),Zo(),Ho(28,"br"),Go(29,"p"),ks(30,"Categoria"),Zo(),Go(31,"select",16),ts("ngModelChange",function(t){return e.categoriaIdNew=t})("change",function(t){return e.comprobarRaza(t.target.value)}),Go(32,"option",17),ks(33,"Seleccione una Opcion"),Zo(),Uo(34,dx,3,2,"ng-container",19),Zo(),Ho(35,"br"),Uo(36,fx,5,2,"div",20),Ho(37,"br"),Uo(38,gx,5,2,"div",20),Ho(39,"br"),Go(40,"p"),ks(41,"Nombre"),Zo(),Go(42,"input",21),ts("ngModelChange",function(t){return e.nombreNew=t}),Zo(),Ho(43,"br"),Go(44,"p"),ks(45,"Unidad"),Zo(),Go(46,"input",21),ts("ngModelChange",function(t){return e.unidadNew=t}),Zo(),Ho(47,"br"),Uo(48,_x,5,3,"div",20),Zo(),Go(49,"div",22),Go(50,"button",23),ts("click",function(){return e.guardar()}),ks(51,"Guardar"),Zo(),Go(52,"button",24),ks(53,"Cancelar"),Zo(),Zo(),Zo(),Zo(),Zo(),Go(54,"div",25),Go(55,"div",11),Go(56,"div",12),Go(57,"div",13),Go(58,"h3",14),ks(59,"Editar Producto"),Zo(),Zo(),Go(60,"div",15),Go(61,"p"),ks(62,"Tipo Productor"),Zo(),Go(63,"select",16),ts("ngModelChange",function(t){return e.tipoProductorIdNew=t})("change",function(t){return e.filtrarCategorias(t.target.value),e.comprobarRaza("")}),Go(64,"option",17),ks(65,"Seleccione una Opcion"),Zo(),Uo(66,yx,2,2,"option",18),Zo(),Ho(67,"br"),Go(68,"p"),ks(69,"Categoria"),Zo(),Go(70,"select",16),ts("ngModelChange",function(t){return e.categoriaIdNew=t})("change",function(t){return e.comprobarRaza(t.target.value)}),Go(71,"option",17),ks(72,"Seleccione una Opcion"),Zo(),Uo(73,bx,3,2,"ng-container",19),Zo(),Ho(74,"br"),Uo(75,Cx,5,2,"div",20),Ho(76,"br"),Uo(77,Sx,5,2,"div",20),Ho(78,"br"),Go(79,"p"),ks(80,"Nombre"),Zo(),Go(81,"input",21),ts("ngModelChange",function(t){return e.nombreUpdate=t}),Zo(),Ho(82,"br"),Go(83,"p"),ks(84,"Unidad"),Zo(),Go(85,"input",21),ts("ngModelChange",function(t){return e.unidadUpdate=t}),Zo(),Ho(86,"br"),Uo(87,Ex,5,3,"div",20),Zo(),Go(88,"div",22),Go(89,"button",23),ts("click",function(){return e.actualizarProd()}),ks(90,"Guardar"),Zo(),Go(91,"button",26),ks(92,"Cancelar"),Zo(),Zo(),Zo(),Zo(),Zo(),Zo()),2&t&&(ur(13),qo("ngIf",0==e.spinner),ur(1),qo("ngIf",1==e.spinner),ur(10),gs("border-danger",1==e.checkProductor),qo("ngModel",e.tipoProductorIdNew),ur(3),qo("ngForOf",e.tipoProductoresObj),ur(4),gs("border-danger",1==e.checkCategoria),qo("ngModel",e.categoriaIdNew),ur(3),qo("ngForOf",e.categoriaFiltradoObj),ur(2),qo("ngIf",1==e.razaCheck),ur(2),qo("ngIf",1==e.razaCheck),ur(4),gs("border-danger",1==e.checkNombre),qo("ngModel",e.nombreNew),ur(4),gs("border-danger",1==e.checkUnidad),qo("ngModel",e.unidadNew),ur(2),qo("ngIf",1==e.tallaCheck),ur(15),gs("border-danger",1==e.checkProductor),qo("ngModel",e.tipoProductorIdNew),ur(3),qo("ngForOf",e.tipoProductoresObj),ur(4),gs("border-danger",1==e.checkCategoria),qo("ngModel",e.categoriaIdNew),ur(3),qo("ngForOf",e.categoriaFiltradoObj),ur(2),qo("ngIf",1==e.razaCheck),ur(2),qo("ngIf",1==e.razaCheck),ur(4),gs("border-danger",1==e.checkNombre),qo("ngModel",e.nombreUpdate),ur(4),gs("border-danger",1==e.checkUnidad),qo("ngModel",e.unidadUpdate),ur(2),qo("ngIf",1==e.tallaCheck))},directives:[Wc,rm,Hf,Om,om,cm,Zc,Sf],pipes:[Yv],styles:["span[_ngcontent-%COMP%]{position:absolute;margin-left:5px;height:25px;display:flex;align-items:center;margin-top:4px}input[_ngcontent-%COMP%]{padding-left:25px}.modal[_ngcontent-%COMP%]{position:fixed;top:0;left:0;z-index:1060;display:none;width:100%;height:100%;overflow-x:hidden;overflow-y:auto;outline:0}.modal-dialog[_ngcontent-%COMP%]{position:relative;width:auto;margin:.5rem;pointer-events:none}.modal.fade[_ngcontent-%COMP%]   .modal-dialog[_ngcontent-%COMP%]{transition:transform .3s ease-out;transform:translateY(-50px)}@media (prefers-reduced-motion:reduce){.modal.fade[_ngcontent-%COMP%]   .modal-dialog[_ngcontent-%COMP%]{transition:none}}.modal.show[_ngcontent-%COMP%]   .modal-dialog[_ngcontent-%COMP%]{transform:none}.modal.modal-static[_ngcontent-%COMP%]   .modal-dialog[_ngcontent-%COMP%]{transform:scale(1.02)}.modal-dialog-scrollable[_ngcontent-%COMP%]{height:calc(100% - 1rem)}.modal-dialog-scrollable[_ngcontent-%COMP%]   .modal-content[_ngcontent-%COMP%]{max-height:100%;overflow:hidden}.modal-dialog-scrollable[_ngcontent-%COMP%]   .modal-body[_ngcontent-%COMP%]{overflow-y:auto}.modal-dialog-centered[_ngcontent-%COMP%]{display:flex;align-items:center;min-height:calc(100% - 1rem)}.modal-content[_ngcontent-%COMP%]{position:relative;display:flex;flex-direction:column;width:100%;pointer-events:auto;background-color:#fff;background-clip:padding-box;border:1px solid rgba(0,0,0,.2);border-radius:.3rem;outline:0}.modal-backdrop[_ngcontent-%COMP%]{position:fixed;top:0;left:0;z-index:1040;width:100vw;height:100vh;background-color:#000}.modal-backdrop.fade[_ngcontent-%COMP%]{opacity:0}.modal-backdrop.show[_ngcontent-%COMP%]{opacity:.5}.modal-header[_ngcontent-%COMP%]{display:flex;flex-shrink:0;align-items:center;justify-content:space-between;padding:1rem;border-bottom:1px solid #dee2e6;border-top-left-radius:calc(.3rem - 1px);border-top-right-radius:calc(.3rem - 1px)}.modal-header[_ngcontent-%COMP%]   .btn-close[_ngcontent-%COMP%]{padding:.5rem;margin:-.5rem -.5rem -.5rem auto}.modal-title[_ngcontent-%COMP%]{margin-bottom:0;line-height:1.5}.modal-body[_ngcontent-%COMP%]{position:relative;flex:1 1 auto;padding:1rem}.modal-footer[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;flex-shrink:0;align-items:center;justify-content:flex-end;padding:.75rem;border-top:1px solid #dee2e6;border-bottom-right-radius:calc(.3rem - 1px);border-bottom-left-radius:calc(.3rem - 1px)}.modal-footer[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{margin:.25rem}@media (min-width:576px){.modal-dialog[_ngcontent-%COMP%]{max-width:500px;margin:1.75rem auto}.modal-dialog-scrollable[_ngcontent-%COMP%]{height:calc(100% - 3.5rem)}.modal-dialog-centered[_ngcontent-%COMP%]{min-height:calc(100% - 3.5rem)}.modal-sm[_ngcontent-%COMP%]{max-width:300px}}@media (min-width:992px){.modal-lg[_ngcontent-%COMP%], .modal-xl[_ngcontent-%COMP%]{max-width:800px}}@media (min-width:1200px){.modal-xl[_ngcontent-%COMP%]{max-width:1140px}}.modal-fullscreen[_ngcontent-%COMP%]{width:100vw;max-width:none;height:100%;margin:0}.modal-fullscreen[_ngcontent-%COMP%]   .modal-content[_ngcontent-%COMP%]{height:100%;border:0;border-radius:0}.modal-fullscreen[_ngcontent-%COMP%]   .modal-header[_ngcontent-%COMP%]{border-radius:0}.modal-fullscreen[_ngcontent-%COMP%]   .modal-body[_ngcontent-%COMP%]{overflow-y:auto}.modal-fullscreen[_ngcontent-%COMP%]   .modal-footer[_ngcontent-%COMP%]{border-radius:0}@media (max-width:575.98px){.modal-fullscreen-sm-down[_ngcontent-%COMP%]{width:100vw;max-width:none;height:100%;margin:0}.modal-fullscreen-sm-down[_ngcontent-%COMP%]   .modal-content[_ngcontent-%COMP%]{height:100%;border:0;border-radius:0}.modal-fullscreen-sm-down[_ngcontent-%COMP%]   .modal-header[_ngcontent-%COMP%]{border-radius:0}.modal-fullscreen-sm-down[_ngcontent-%COMP%]   .modal-body[_ngcontent-%COMP%]{overflow-y:auto}.modal-fullscreen-sm-down[_ngcontent-%COMP%]   .modal-footer[_ngcontent-%COMP%]{border-radius:0}}@media (max-width:767.98px){.modal-fullscreen-md-down[_ngcontent-%COMP%]{width:100vw;max-width:none;height:100%;margin:0}.modal-fullscreen-md-down[_ngcontent-%COMP%]   .modal-content[_ngcontent-%COMP%]{height:100%;border:0;border-radius:0}.modal-fullscreen-md-down[_ngcontent-%COMP%]   .modal-header[_ngcontent-%COMP%]{border-radius:0}.modal-fullscreen-md-down[_ngcontent-%COMP%]   .modal-body[_ngcontent-%COMP%]{overflow-y:auto}.modal-fullscreen-md-down[_ngcontent-%COMP%]   .modal-footer[_ngcontent-%COMP%]{border-radius:0}}@media (max-width:991.98px){.modal-fullscreen-lg-down[_ngcontent-%COMP%]{width:100vw;max-width:none;height:100%;margin:0}.modal-fullscreen-lg-down[_ngcontent-%COMP%]   .modal-content[_ngcontent-%COMP%]{height:100%;border:0;border-radius:0}.modal-fullscreen-lg-down[_ngcontent-%COMP%]   .modal-header[_ngcontent-%COMP%]{border-radius:0}.modal-fullscreen-lg-down[_ngcontent-%COMP%]   .modal-body[_ngcontent-%COMP%]{overflow-y:auto}.modal-fullscreen-lg-down[_ngcontent-%COMP%]   .modal-footer[_ngcontent-%COMP%]{border-radius:0}}@media (max-width:1199.98px){.modal-fullscreen-xl-down[_ngcontent-%COMP%]{width:100vw;max-width:none;height:100%;margin:0}.modal-fullscreen-xl-down[_ngcontent-%COMP%]   .modal-content[_ngcontent-%COMP%]{height:100%;border:0;border-radius:0}.modal-fullscreen-xl-down[_ngcontent-%COMP%]   .modal-header[_ngcontent-%COMP%]{border-radius:0}.modal-fullscreen-xl-down[_ngcontent-%COMP%]   .modal-body[_ngcontent-%COMP%]{overflow-y:auto}.modal-fullscreen-xl-down[_ngcontent-%COMP%]   .modal-footer[_ngcontent-%COMP%]{border-radius:0}}@media (max-width:1399.98px){.modal-fullscreen-xxl-down[_ngcontent-%COMP%]{width:100vw;max-width:none;height:100%;margin:0}.modal-fullscreen-xxl-down[_ngcontent-%COMP%]   .modal-content[_ngcontent-%COMP%]{height:100%;border:0;border-radius:0}.modal-fullscreen-xxl-down[_ngcontent-%COMP%]   .modal-header[_ngcontent-%COMP%]{border-radius:0}.modal-fullscreen-xxl-down[_ngcontent-%COMP%]   .modal-body[_ngcontent-%COMP%]{overflow-y:auto}.modal-fullscreen-xxl-down[_ngcontent-%COMP%]   .modal-footer[_ngcontent-%COMP%]{border-radius:0}}"]}),t})();const Ax=function(){return["/login"]};let Ix=(()=>{class t{constructor(){}ngOnInit(){const t=document.querySelector(".scrollToTop-btn");window.addEventListener("scroll",function(){t.classList.toggle("active",window.scrollY>500)}),t.addEventListener("click",()=>{document.body.scrollTop=0,document.documentElement.scrollTop=0}),window.addEventListener("scroll",function(){for(var t=document.querySelectorAll(".reveal"),e=0;e<t.length;e++){var n=window.innerHeight;t[e].getBoundingClientRect().top<n-50&&t[e].classList.add("active")}})}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=Bt({type:t,selectors:[["app-nosotros"]],decls:155,vars:2,consts:[["lang","en","dir","ltr"],["charset","utf-8"],["name","viewport","content","width=device-width, initial-scale=1.0"],["rel","stylesheet","href",(e="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.2/css/all.min.css",function(t){var e;return(null===(e=function(){if(void 0===si&&(si=null,kt.trustedTypes))try{si=kt.trustedTypes.createPolicy("angular",{createHTML:t=>t,createScript:t=>t,createScriptURL:t=>t})}catch(e){}return si}())||void 0===e?void 0:e.createScriptURL(t))||t}(e))],["id","scrollToTop-btn","name","scrollToTop-btn",1,"scrollToTop-btn"],[1,"fas","fa-angle-up"],["id","main",1,"main"],[1,"content"],[1,"animated-text"],[1,"btn",3,"routerLink"],[1,"media-icons"],["href","https://www.facebook.com/GadMocha"],[1,"fab","fa-facebook-f"],["href","https://www.instagram.com/gadmocha/"],[1,"fab","fa-instagram"],["href","https://twitter.com/gadmocha"],[1,"fab","fa-twitter"],["id","about",1,"about"],[1,"title","reveal"],[1,"section-title"],[1,"column","col-left","reveal"],[1,"img-card"],["src","../.././../assets/images/alcalde.jpg","alt",""],[1,"column","col-right","reveal"],[1,"content-title"],[1,"paragraph-text"],["id","skills",1,"skills"],["id","services",1,"services"],[1,"card","reveal"],[1,"service-icon"],[1,"fas","fa-user-friends"],[1,"info"],[1,"fas","fa-seedling"],[1,"fas","fa-chart-line"],["id","work",1,"work"],[1,"card-img"],["src","../../../assets/images/productos.jpg","alt",""],["id","contact",1,"contact"],[1,"row"],[1,"contact-icon"],[1,"fas","fa-map-marker-alt"],[1,"fas","fa-phone"],[1,"fas","fa-envelope"],[1,"fas","fa-stopwatch"],[1,"footer"],[1,"footer-title"]],template:function(t,e){1&t&&(Go(0,"html",0),Go(1,"head"),Ho(2,"meta",1),Ho(3,"meta",2),Go(4,"title"),ks(5,"GADMM"),Zo(),Ho(6,"link",3),Zo(),Go(7,"div",4),Ho(8,"i",5),Zo(),Go(9,"section",6),Go(10,"div",7),Go(11,"h2"),ks(12,"El Imperio Escondido de Los Andes"),Ho(13,"br"),Zo(),Go(14,"div",8),Go(15,"h3"),ks(16,"Productores"),Zo(),Go(17,"h3"),ks(18,"Los mejores productos"),Zo(),Go(19,"h3"),ks(20,"Informaci\xf3n"),Zo(),Zo(),Go(21,"a",9),ks(22,"Iniciar Sesion"),Zo(),Go(23,"div",10),Go(24,"a",11),Ho(25,"i",12),Zo(),Go(26,"a",13),Ho(27,"i",14),Zo(),Go(28,"a",15),Ho(29,"i",16),Zo(),Zo(),Zo(),Zo(),Go(30,"section",17),Go(31,"div",18),Go(32,"h2",19),ks(33,"Alcalde"),Zo(),Zo(),Go(34,"div",7),Go(35,"div",20),Go(36,"div",21),Ho(37,"img",22),Zo(),Zo(),Go(38,"div",23),Go(39,"h2",24),ks(40,"Ing. Danilo Patricio Ortiz Ortiz"),Zo(),Go(41,"p",25),ks(42," \u2022Ingeniero Agronomo, graduado en la UTA "),Ho(43,"br"),ks(44," \u2022Alcalde del Cant\xf3n Mocha "),Ho(45,"br"),ks(46," \u2022Administraci\xf3n 2019 - 2023 "),Zo(),Zo(),Zo(),Zo(),Go(47,"section",26),Go(48,"div",18),Go(49,"h2",19),ks(50,"Sobre nosotros"),Zo(),Zo(),Go(51,"div",7),Go(52,"div",20),Go(53,"h2",24),ks(54,"Misi\xf3n"),Zo(),Go(55,"p"),ks(56,"Fortalecer la instituci\xf3n municipal para promover procesos de eficiencia administrativa que permita la atenci\xf3n a las necesidades de la ciudadan\xeda de manera eficaz coherente y accesible. "),Zo(),Zo(),Go(57,"div",20),Go(58,"h2",24),ks(59,"Visi\xf3n"),Zo(),Go(60,"p"),ks(61," El Gobierno Municipal de Mocha se constituir\xe1 en la mejor Instituci\xf3n p\xfablica de la regi\xf3n, basada en la honestidad, eficiencia, transparencia, equidad y responsabilidad, comprometida con el desarrollo integral del cant\xf3n, garantizando la calidad de vida de la poblaci\xf3n. "),Zo(),Zo(),Zo(),Zo(),Go(62,"section",27),Go(63,"div",18),Go(64,"h2",19),ks(65,"Sistema"),Zo(),Zo(),Go(66,"div",7),Go(67,"div",28),Go(68,"div",29),Ho(69,"i",30),Zo(),Go(70,"div",31),Go(71,"h3"),ks(72,"Productores"),Zo(),Go(73,"p"),ks(74,"600 productores pertenecientes al GAD Municipal del cant\xf3n Mocha"),Zo(),Zo(),Zo(),Go(75,"div",28),Go(76,"div",29),Ho(77,"i",32),Zo(),Go(78,"div",31),Go(79,"h3"),ks(80,"Productos"),Zo(),Go(81,"p"),ks(82,"Los mejores productos de Tungurahua."),Zo(),Zo(),Zo(),Go(83,"div",28),Go(84,"div",29),Ho(85,"i",33),Zo(),Go(86,"div",31),Go(87,"h3"),ks(88,"Crecimiento"),Zo(),Go(89,"p"),ks(90,"Mejora en publicidad de productos."),Zo(),Zo(),Zo(),Zo(),Zo(),Go(91,"section",34),Go(92,"div",18),Go(93,"h2",19),ks(94,"Productos"),Zo(),Zo(),Go(95,"div",7),Go(96,"div",28),Go(97,"div",35),Ho(98,"img",36),Zo(),Zo(),Go(99,"div",28),Go(100,"div",35),Ho(101,"img",36),Zo(),Zo(),Go(102,"div",28),Go(103,"div",35),Ho(104,"img",36),Zo(),Zo(),Go(105,"div",28),Go(106,"div",35),Ho(107,"img",36),Zo(),Zo(),Go(108,"div",28),Go(109,"div",35),Ho(110,"img",36),Zo(),Zo(),Go(111,"div",28),Go(112,"div",35),Ho(113,"img",36),Zo(),Zo(),Zo(),Zo(),Go(114,"section",37),Go(115,"div",18),Go(116,"h2",19),ks(117,"Contactos"),Zo(),Zo(),Go(118,"div",7),Go(119,"div",38),Go(120,"div",28),Go(121,"div",39),Ho(122,"i",40),Zo(),Go(123,"div",31),Go(124,"h3"),ks(125,"Direcci\xf3n"),Zo(),Go(126,"span"),ks(127,"Calle Alonso Ruiz 1-40 y Avenida El Rey frente al parque central."),Zo(),Zo(),Zo(),Go(128,"div",28),Go(129,"div",39),Ho(130,"i",41),Zo(),Go(131,"div",31),Go(132,"h3"),ks(133,"Telefono"),Zo(),Go(134,"span"),ks(135," (03) 277-9217"),Zo(),Zo(),Zo(),Go(136,"div",28),Go(137,"div",39),Ho(138,"i",42),Zo(),Go(139,"div",31),Go(140,"h3"),ks(141,"Correo Electr\xf3nico"),Zo(),Go(142,"span"),ks(143,"gadmMocha@email.com"),Zo(),Zo(),Zo(),Go(144,"div",28),Go(145,"div",39),Ho(146,"i",43),Zo(),Go(147,"div",31),Go(148,"h3"),ks(149,"Horario"),Zo(),Go(150,"span"),ks(151,"Lunes a Viernes de 8:00 a 17:00"),Zo(),Zo(),Zo(),Zo(),Zo(),Zo(),Go(152,"footer",44),Go(153,"span",45),ks(154,"GAD Municipalidad de Mocha"),Zo(),Zo(),Zo()),2&t&&(ur(21),qo("routerLink",Xa(1,Ax)))},directives:[bp],styles:['@import url("https://fonts.googleapis.com/css2?family=Poppins:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap");*[_ngcontent-%COMP%]{margin:0;padding:0;box-sizing:border-box;font-family:Poppins,sans-serif;scroll-behavior:smooth}section[_ngcontent-%COMP%]{padding:100px 200px}.main[_ngcontent-%COMP%]{position:relative;width:100%;min-height:100vh;display:flex;align-items:center;background:url(portada2.bc45b225139733da11b9.jpg)no-repeat;background-size:cover;background-position:50%;background-attachment:fixed}.main[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]{max-width:800px}.main[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{color:#fff;font-size:2em;font-weight:500}.main[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:2.8em;font-weight:600}.animated-text[_ngcontent-%COMP%]{position:relative;height:70px;overflow:hidden}.animated-text[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{color:#fff;font-size:3em;font-weight:700;line-height:70px;letter-spacing:1px}.animated-text[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]:first-child{animation:text-move 10s infinite}@keyframes text-move{0%{margin-top:0}25%{margin-top:-70px}50%{margin-top:-140px}75%{margin-top:-70px}to{margin-top:0}}.btn[_ngcontent-%COMP%]{color:#fff;background:#3a6cf4;font-size:1em;font-weight:600;display:inline-block;padding:10px 20px;text-transform:uppercase;text-decoration:none;letter-spacing:1px;border-radius:2px;margin-top:30px;transition:.5s ease}.btn[_ngcontent-%COMP%]:hover{background:#235bf6}.media-icons[_ngcontent-%COMP%]{margin-top:50px}.media-icons[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{color:#fff;font-size:25px;margin-right:30px}header[_ngcontent-%COMP%]{z-index:999;position:fixed;background:hsla(0,0%,100%,.1);top:0;left:0;width:100%;padding:15px 200px;display:flex;justify-content:space-between;align-items:center;transition:.5s ease}header.sticky[_ngcontent-%COMP%]{background:#3a6cf4;padding:10px 200px}header[_ngcontent-%COMP%]   .brand[_ngcontent-%COMP%]{color:#fff;font-size:1.8em;font-weight:700;text-transform:uppercase;text-decoration:none}header[_ngcontent-%COMP%]   .navigation[_ngcontent-%COMP%]{position:relative}header[_ngcontent-%COMP%]   .navigation[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{color:#fff;font-size:1em;font-weight:500;text-decoration:none;margin-left:30px}header[_ngcontent-%COMP%]   .navigation[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{color:#3a6cf4}header.sticky[_ngcontent-%COMP%]   .navigation[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{color:#000}body[_ngcontent-%COMP%]{min-height:110vh}.title[_ngcontent-%COMP%]{width:100%;display:flex;justify-content:center;align-items:center;flex-direction:column}.section-title[_ngcontent-%COMP%]{position:relative;color:#3a6cf4;font-size:2.2em;font-weight:800;margin-bottom:60px}.section-title[_ngcontent-%COMP%]:before{content:"";position:absolute;top:56px;left:50%;width:140px;height:4px;background:#3a6cf4;transform:translateX(-50%)}.section-title[_ngcontent-%COMP%]:after{content:"";position:absolute;top:50px;left:50%;width:15px;height:15px;border-radius:50%;background:#3a6cf4;transform:translateX(-50%)}.about[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]{position:relative;width:100%;display:flex;justify-content:space-between;margin-top:20px}.about[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .col-left[_ngcontent-%COMP%]{position:relative;width:45%}.about[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .col-right[_ngcontent-%COMP%]{position:relative;width:50%}.about[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .col-left[_ngcontent-%COMP%]   .img-card[_ngcontent-%COMP%]{position:relative;width:100%;min-height:450px}.about[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .col-left[_ngcontent-%COMP%]   .img-card[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{position:absolute;top:0;left:0;width:100%;height:100%;object-fit:cover;border-radius:10px}.about[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .col-right[_ngcontent-%COMP%]   .content-title[_ngcontent-%COMP%]{font-size:2em;font-weight:800;margin-bottom:20px}.about[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .col-right[_ngcontent-%COMP%]   .paragraph-text[_ngcontent-%COMP%]{font-size:1em}.skills[_ngcontent-%COMP%]{background:#000016}.skills[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]{position:relative;width:100%;display:flex;justify-content:space-between;color:#fff;margin-top:20px}.skills[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .col-left[_ngcontent-%COMP%]{position:relative;width:46%}.skills[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .col-left[_ngcontent-%COMP%]   .content-title[_ngcontent-%COMP%]{margin-bottom:20px}.skills[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .col-right[_ngcontent-%COMP%]{position:relative;width:46%}.skills[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .col-right[_ngcontent-%COMP%]   .bar[_ngcontent-%COMP%]{margin-bottom:15px;padding:10px}.skills[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .col-right[_ngcontent-%COMP%]   .bar[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;margin-bottom:5px}.skills[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .col-right[_ngcontent-%COMP%]   .bar[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:18px;font-weight:500}.skills[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .col-right[_ngcontent-%COMP%]   .bar[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]{position:relative;width:100%;height:15px;background:#ccc;border-radius:2px}.skills[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .col-right[_ngcontent-%COMP%]   .bar[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]:before{content:"";position:absolute;height:100%;top:0;left:0;border-radius:2px}.skills[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .col-right[_ngcontent-%COMP%]   .bar[_ngcontent-%COMP%]   .html[_ngcontent-%COMP%]:before{width:95%;background:#e45126}.skills[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .col-right[_ngcontent-%COMP%]   .bar[_ngcontent-%COMP%]   .css[_ngcontent-%COMP%]:before{width:90%;background:#0c73b8}.skills[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .col-right[_ngcontent-%COMP%]   .bar[_ngcontent-%COMP%]   .javascript[_ngcontent-%COMP%]:before{width:80%;background:#e3a324}.skills[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .col-right[_ngcontent-%COMP%]   .bar[_ngcontent-%COMP%]   .jquery[_ngcontent-%COMP%]:before{width:80%;background:#30dd6d}.skills[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .col-right[_ngcontent-%COMP%]   .bar[_ngcontent-%COMP%]   .php[_ngcontent-%COMP%]:before{width:75%;background:#6d7eb8}.services[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]{display:flex;justify-content:center;flex-wrap:wrap;flex-direction:row;margin-top:20px}.title[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:1em;width:80%}.services[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]{background:#fff;width:340px;margin:10px;padding:25px;justify-content:center;align-items:center;flex-direction:column;box-shadow:0 5px 25px rgba(1 1 1/15%);border-radius:10px}.services[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]   .service-icon[_ngcontent-%COMP%]{color:#3a6cf4;font-size:8em;text-align:center;transition:transform .5s ease}.services[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]:hover   .service-icon[_ngcontent-%COMP%]{transform:translateY(-10px)}.services[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]{text-align:center}.services[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{color:#3a6cf4;font-size:1.2em;font-weight:700;margin:10px}.work[_ngcontent-%COMP%]{background:#666}.work[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]{display:flex;justify-content:center;flex-direction:row;flex-wrap:wrap;margin-top:20px}.work[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]{width:340px;margin:15px}.work[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]   .card-img[_ngcontent-%COMP%]{position:relative;width:100%;height:260px;overflow:hidden;border-radius:10px}.work[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]   .card-img[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{position:absolute;top:0;left:0;width:100%;height:100%;object-fit:cover;border-radius:10px;transition:.5s ease}.work[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]   .card-img[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]:hover{transform:scale(1.2)}.contact[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]{flex-direction:column;margin-top:20px}.contact[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%], .contact[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]{display:flex;justify-content:center;flex-wrap:wrap}.contact[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]{flex-direction:row}.contact[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]{background:#fff;width:240px;margin:20px;padding:25px;display:flex;justify-content:center;align-items:center;flex-direction:column;box-shadow:0 5px 25px rgba(1 1 1/15%);border-radius:10px}.contact[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]   .contact-icon[_ngcontent-%COMP%]{color:#3a6cf4;font-size:4em;text-align:center;transition:transform .5s ease}.contact[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]:hover   .contact-icon[_ngcontent-%COMP%]{transform:translateY(-10px)}.contact[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]{text-align:center}.contact[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{color:#111;font-size:1.2em;font-weight:700;margin:10px}.contact[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{color:#666;font-weight:500}.contact-form[_ngcontent-%COMP%]{background:#fff;max-width:600px;margin-top:50px;padding:50px;border-radius:10px;box-shadow:0 5px 25px rgba(1 1 1/15%)}.contact-form[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{color:#111;font-size:1.6em;font-weight:600;text-align:center;margin-bottom:40px}.contact-form[_ngcontent-%COMP%]   .input-box[_ngcontent-%COMP%]{position:relative;width:100%;margin-bottom:20px}.contact-form[_ngcontent-%COMP%]   .input-box[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .contact-form[_ngcontent-%COMP%]   .input-box[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%]{color:#111;width:100%;padding:10px;font-size:1em;font-weight:400;outline:none;border:1px solid #111;border-radius:5px;resize:none}.contact-form[_ngcontent-%COMP%]   .input-box[_ngcontent-%COMP%]   .send-btn[_ngcontent-%COMP%]{color:#fff;background:#3a6cf4;display:inline-block;font-size:1.1em;font-weight:500;text-transform:uppercase;letter-spacing:2px;width:100%;border:none;cursor:pointer;transition:.5s ease}.contact-form[_ngcontent-%COMP%]   .input-box[_ngcontent-%COMP%]   .send-btn[_ngcontent-%COMP%]:hover{background:#235bf6}.footer[_ngcontent-%COMP%]{background:#000016;color:#fff;text-align:center;padding:2em}.footer[_ngcontent-%COMP%]   .footer-title[_ngcontent-%COMP%]{font-size:20px;font-weight:600}.footer[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:16px;margin-top:10px}.footer[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{color:#3a6cf4;font-weight:600;text-decoration:none}@media (max-width:1040px){header[_ngcontent-%COMP%]{padding:12px 20px}header.sticky[_ngcontent-%COMP%]{padding:10px 20px}header[_ngcontent-%COMP%]   .navigation[_ngcontent-%COMP%]{display:none}header[_ngcontent-%COMP%]   .navigation.active[_ngcontent-%COMP%]{z-index:888;position:fixed;background:#fff;top:0;right:0;width:380px;height:100%;display:flex;justify-content:center;align-items:center;flex-direction:column;box-shadow:0 5px 25px rgba(1 1 1/15%);transition:.3s ease}header[_ngcontent-%COMP%]   .navigation[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{color:#000;font-size:1.2em;margin:10px;padding:0 20px;border-radius:20px}header[_ngcontent-%COMP%]   .navigation[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{background:#3a6cf4;color:#fff;transition:.3s ease}.menu-btn[_ngcontent-%COMP%]{position:absolute;background:url(menu.32a31f8f0092d1152589.png)no-repeat;background-size:30px;background-position:50%;width:40px;height:40px;right:0;margin:0 20px;cursor:pointer;transition:.3s ease}.menu-btn.active[_ngcontent-%COMP%]{z-index:999;background:url(close.8d5c0be67537a4fdaac0.png)no-repeat;background-size:25px;background-position:50%;transition:.3s ease;filter:invert(1)}section[_ngcontent-%COMP%]{padding:80px 20px}.main[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:1em}.animated-text[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:2.2em}.section-title[_ngcontent-%COMP%]{font-size:1.8em}.about[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]{flex-direction:column}.about[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .column[_ngcontent-%COMP%]{position:relative;width:100%}.about[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .col-right[_ngcontent-%COMP%]{margin-top:40px}.skills[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]{flex-direction:column}.skills[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .column[_ngcontent-%COMP%]{position:relative;width:100%}.skills[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .col-right[_ngcontent-%COMP%]{margin-top:40px}.contact-form[_ngcontent-%COMP%]{padding:35px 40px}}.scrollToTop-btn[_ngcontent-%COMP%]{z-index:999;position:fixed;background:#3a6cf4;color:#fff;width:45px;height:45px;right:0;bottom:10px;font-size:22px;text-align:center;line-height:45px;border-radius:3px;cursor:pointer;pointer-events:none;opacity:0;transition:all .3s ease}.scrollToTop-btn.active[_ngcontent-%COMP%]{right:20px;opacity:1;pointer-events:auto}.reveal[_ngcontent-%COMP%]{position:relative;transform:translateY(50px);opacity:0;transition:all 1.5s ease}.reveal.active[_ngcontent-%COMP%]{transform:translateY(0);opacity:1}']}),t;var e})();const Px=function(t){return["/menu/editarUsuario/",t]},Mx=function(){return["active"]};function Ox(t,e){if(1&t){const t=Yo();Go(0,"tr",15),Go(1,"td"),Go(2,"strong"),ks(3),Zo(),Zo(),Go(4,"td"),ks(5),Zo(),Go(6,"td"),ks(7),Zo(),Go(8,"td"),ks(9),Zo(),Go(10,"td"),ks(11),Zo(),Go(12,"td"),ks(13),Zo(),Go(14,"td"),ks(15),Zo(),Go(16,"td",3),Go(17,"div",18),Go(18,"button",19),ks(19," Opciones "),Zo(),Go(20,"ul",20),Go(21,"li"),Go(22,"a",21),ks(23,"Editar"),Zo(),Zo(),Go(24,"li"),Go(25,"a",22),ts("click",function(){Ie(t);const n=e.$implicit;return is(2).eliminar(n.idUsuarios)}),ks(26,"Eliminar"),Zo(),Zo(),Zo(),Zo(),Zo(),Zo()}if(2&t){const t=e.$implicit,n=e.index;ur(3),As(n+1),ur(2),As(t.cedula),ur(2),As(t.nombres),ur(2),As(t.apellidos),ur(2),As(t.direccion),ur(2),As(t.telefono),ur(2),As(t.correo),ur(7),qo("routerLink",Ka(9,Px,t.idUsuarios))("routerLinkActive",Xa(11,Mx))}}function zx(t,e){1&t&&(Go(0,"td",23),ks(1,"No existen Registros "),Zo())}function Dx(t,e){if(1&t&&(Go(0,"div",12),Go(1,"table",13),Go(2,"thead",14),Go(3,"tr"),Go(4,"td"),ks(5,"#"),Zo(),Go(6,"td"),ks(7,"Cedula"),Zo(),Go(8,"td"),ks(9,"Nombres"),Zo(),Go(10,"td"),ks(11,"Apellidos"),Zo(),Go(12,"td"),ks(13,"Direccion "),Zo(),Go(14,"td"),ks(15,"Telefono "),Zo(),Go(16,"td"),ks(17,"Correo"),Zo(),Go(18,"td"),ks(19,"Opciones"),Zo(),Zo(),Zo(),Go(20,"tbody"),Ho(21,"tr",15),Uo(22,Ox,27,12,"tr",16),Go(23,"tr"),Uo(24,zx,2,0,"td",17),Zo(),Zo(),Zo(),Zo()),2&t){const t=is();ur(22),qo("ngForOf",t.clienteObj),ur(2),qo("ngIf",0==t.clienteObj.length)}}function Lx(t,e){1&t&&(Go(0,"div",24),Ho(1,"div",25),Zo())}const Rx=function(){return["/menu/nuevoUsuario"]};let Fx=(()=>{class t{constructor(t){this.usuarios=t,this.clienteObj=[],this.spinner=0}ngOnInit(){this.listar()}buscar(t){this.usuarios.buscar(t).subscribe(t=>{this.clienteObj=t},t=>alert("Error al conectar con el servidor"))}listar(){this.spinner=1,this.usuarios.listar().subscribe(t=>{this.clienteObj=t,this.spinner=0},t=>alert("Error al listar"))}eliminar(t){Zm.a.fire({title:"\xbfEsta seguro que desea eliminar?",text:" este registro se eliminar\xe1 permanentemente",icon:"warning",confirmButtonColor:"#29A05B",showCancelButton:!0,cancelButtonColor:"#d33",cancelButtonText:"Cancelar",confirmButtonText:"Aceptar"}).then(e=>{e.isConfirmed&&this.usuarios.eliminar(t).subscribe(t=>{this.listar(),Zm.a.fire("Usuarios","Registro Eliminado exitosamente ","success")},t=>alert("error al eliminar el registro"))})}}return t.\u0275fac=function(e){return new(e||t)(jo(Bv))},t.\u0275cmp=Bt({type:t,selectors:[["app-listar-usuario"]],decls:19,vars:5,consts:[[1,"container"],[1,"text-uppercase","text-center","pb-2"],[2,"font-weight","bold"],[1,"text-center"],[1,"btn","btn-primary","col-5","col-sm-3",3,"routerLink"],[1,"form-group","ms-auto","me-auto","col-8","col-sm-4","col-xl-4"],[1,"mt-4"],[1,"fa","fa-search"],["min","0","on","","type","text","aria-describedby","helpId","placeholder","",1,"form-control",3,"keyup"],[1,"text-center","mt-3",2,"color","green","font-size","1.2rem"],["class","table-responsive mt-4  container","style","height: 400px;",4,"ngIf"],["class","text-center  ","style","margin-top: 10em;",4,"ngIf"],[1,"table-responsive","mt-4","container",2,"height","400px"],[1,"table","table-bordered","table-sm","text-center"],[1,"bg-dark","text-white"],[1,"text-dark"],["class","text-dark webkit-scrollbar,","class","text-dark",4,"ngFor","ngForOf"],["class","text-center","colspan","10",4,"ngIf"],[1,"btn-group"],["type","button","data-bs-toggle","dropdown","aria-expanded","false",1,"btn","btn-primary","dropdown-toggle"],[1,"dropdown-menu"],[1,"dropdown-item",3,"routerLink","routerLinkActive"],[1,"dropdown-item",3,"click"],["colspan","10",1,"text-center"],[1,"text-center",2,"margin-top","10em"],["role","status",1,"spinner-border","text-primary"]],template:function(t,e){1&t&&(Go(0,"div",0),Go(1,"div",1),Go(2,"h3",2),ks(3,"Usuarios"),Zo(),Zo(),Zo(),Go(4,"div",3),Go(5,"a",4),ks(6,"Nuevo"),Zo(),Zo(),Go(7,"div",5),Go(8,"div",6),Go(9,"span"),Ho(10,"i",7),Zo(),Go(11,"input",8),ts("keyup",function(t){return e.buscar(t.target.value)}),Zo(),Zo(),Zo(),Go(12,"div",9),Go(13,"label"),ks(14,"Total "),Zo(),Go(15,"strong"),ks(16),Zo(),Zo(),Uo(17,Dx,25,2,"div",10),Uo(18,Lx,2,0,"div",11)),2&t&&(ur(5),qo("routerLink",Xa(4,Rx)),ur(11),Is(" ",e.clienteObj.length," "),ur(1),qo("ngIf",0==e.spinner),ur(1),qo("ngIf",1==e.spinner))},directives:[bp,Wc,Zc,Cp],styles:["span[_ngcontent-%COMP%]{position:absolute;margin-left:5px;height:25px;display:flex;align-items:center;margin-top:5px}input[_ngcontent-%COMP%]{padding-left:25px}"]}),t})(),Bx=(()=>{class t{constructor(t,e,n){this.clientes=t,this.router=e,this.ra=n,this.empleados=new Am({cedula:new km("",[Mf.required]),nombres:new km("",Mf.required),apellidos:new km("",Mf.required),direccion:new km("",Mf.required),telefono:new km("",Mf.required),correo:new km("",[Mf.required,Mf.email]),usuario:new km("",Mf.required),clave:new km("",Mf.required)}),this.idCliente=this.ra.snapshot.params.id}ngOnInit(){null!=this.idCliente&&this.cargar(this.idCliente)}guardar(t){var e;if(null==this.idCliente){if(this.empleados.invalid)return void Zm.a.fire("Usuarios","Todos los campos son requeridos","warning");this.clientes.cedula(this.empleados.get("cedula").value).subscribe(e=>{null!=e?1!=e?0==e&&this.clientes.nuevo(t).subscribe(t=>{this.router.navigate(["/menu/listarUsuario"]),Zm.a.fire("Usuarios","Registro guardado con exito","success")},t=>alert("Error al insertar el registro")):Zm.a.fire("Usuarios","Esta cedula ya se encuentra registrada","warning"):Zm.a.fire("Usuarios","Cedula Incorrecta","warning")},t=>{alert("error..."+t)})}else t.IdUsuarios=this.idCliente,t.Cedula=null===(e=this.empleados.get("cedula"))||void 0===e?void 0:e.value,this.clientes.editar(this.idCliente,t).subscribe(t=>{Zm.a.fire({position:"center",icon:"success",title:"Editado con exito",showConfirmButton:!1,timer:1500}),this.router.navigate(["/menu/listarUsuario"])},t=>console.log(t))}cargar(t){this.clientes.cargar(t).subscribe(t=>{var e;this.empleados.patchValue(Object.assign({},t)),this.igual=null===(e=this.empleados.get("usuario"))||void 0===e?void 0:e.value,this.empleados.controls.cedula.disable()})}}return t.\u0275fac=function(e){return new(e||t)(jo(Bv),jo(vp),jo(td))},t.\u0275cmp=Bt({type:t,selectors:[["app-nuevo-usuario"]],decls:55,vars:34,consts:[["lang","en"],["charset","UTF-8"],["http-equiv","X-UA-Compatible","content","IE=edge"],["name","viewport","content","width=device-width, initial-scale=1.0"],[1,"card","ms-auto","shadow-lg","me-auto","col","col-sm",2,"width","30rem","height","25rem"],[1,"card-header",2,"background-color","#4c4a4a !important"],[1,"text-center"],[2,"color","#fff"],[1,"card-body"],[3,"formGroup","ngSubmit"],[1,"row"],[1,"col"],["for","exampleInputEmail1",1,"text-black-50","fw-bold","fst-italic"],["formControlName","cedula","maxlength","10","onkeypress","return (event.charCode >= 48 && event.charCode <= 57)","type","text",1,"form-control","mb-2"],["formControlName","nombres","type","text",1,"form-control","mb-2"],["formControlName","apellidos","type","text",1,"form-control","mb-2"],["formControlName","correo","type","text",1,"form-control","mb-2"],["formControlName","direccion","direccion","","type","text",1,"form-control"],["maxlength","15","formControlName","telefono","type","number",1,"form-control"],["formControlName","usuario","type","text",1,"form-control"],["maxlength","15","formControlName","clave","type","password",1,"form-control"],[1,"text-center","mt-3"],[1,"btn","btn-primary","mt-3","col-12","col-sm-3","me-3"],[1,"btn","btn-secondary","mt-3","col-12","col-sm-3",3,"routerLink"]],template:function(t,e){if(1&t&&(Go(0,"html",0),Go(1,"head"),Ho(2,"meta",1),Ho(3,"meta",2),Ho(4,"meta",3),Go(5,"title"),ks(6,"Document"),Zo(),Zo(),Go(7,"div",4),Go(8,"div",5),Go(9,"div",6),Go(10,"h3",7),ks(11,"Nuevo Usuario"),Zo(),Zo(),Zo(),Go(12,"div",8),Go(13,"form",9),ts("ngSubmit",function(){return e.guardar(e.empleados.value)}),Go(14,"div",10),Go(15,"div",11),Go(16,"label",12),ks(17,"Cedula"),Zo(),Ho(18,"input",13),Zo(),Go(19,"div",11),Go(20,"label",12),ks(21,"Nombre"),Zo(),Ho(22,"input",14),Zo(),Zo(),Go(23,"div",10),Go(24,"div",11),Go(25,"label",12),ks(26,"Apellidos"),Zo(),Ho(27,"input",15),Zo(),Go(28,"div",11),Go(29,"label",12),ks(30,"Correo"),Zo(),Ho(31,"input",16),Zo(),Zo(),Go(32,"div",10),Go(33,"div",11),Go(34,"label",12),ks(35,"Direccion"),Zo(),Ho(36,"input",17),Zo(),Go(37,"div",11),Go(38,"label",12),ks(39,"Telefono"),Zo(),Ho(40,"input",18),Zo(),Zo(),Go(41,"div",10),Go(42,"div",11),Go(43,"label",12),ks(44,"Usuario"),Zo(),Ho(45,"input",19),Zo(),Go(46,"div",11),Go(47,"label",12),ks(48,"Clave"),Zo(),Ho(49,"input",20),Zo(),Zo(),Go(50,"div",21),Go(51,"button",22),ks(52,"Guardar"),Zo(),Go(53,"button",23),ks(54,"Atras"),Zo(),Zo(),Zo(),Zo(),Zo(),Zo()),2&t){let t=null,n=null,i=null,r=null,o=null,s=null,a=null,l=null,c=null,u=null,h=null,d=null,p=null,f=null,m=null,g=null;ur(13),qo("formGroup",e.empleados),ur(5),gs("is-valid",e.empleados.get("cedula").touched&&(null==(t=e.empleados.get("cedula"))?null:t.invalid))("border-success",e.empleados.get("cedula").touched&&(null==(n=e.empleados.get("cedula"))?null:n.valid)),ur(4),gs("border-danger",e.empleados.get("nombres").touched&&(null==(i=e.empleados.get("nombres"))?null:i.invalid))("border-success",e.empleados.get("nombres").touched&&(null==(r=e.empleados.get("nombres"))?null:r.valid)),ur(5),gs("border-danger",e.empleados.get("apellidos").touched&&(null==(o=e.empleados.get("apellidos"))?null:o.invalid))("border-success",e.empleados.get("apellidos").touched&&(null==(s=e.empleados.get("apellidos"))?null:s.valid)),ur(4),gs("border-danger",e.empleados.get("correo").touched&&(null==(a=e.empleados.get("correo"))?null:a.invalid))("border-success",e.empleados.get("correo").touched&&(null==(l=e.empleados.get("correo"))?null:l.valid)),ur(5),gs("border-danger",e.empleados.get("direccion").touched&&(null==(c=e.empleados.get("direccion"))?null:c.invalid))("border-success",e.empleados.get("direccion").touched&&(null==(u=e.empleados.get("direccion"))?null:u.valid)),ur(4),gs("border-danger",e.empleados.get("telefono").touched&&(null==(h=e.empleados.get("telefono"))?null:h.invalid))("border-success",e.empleados.get("telefono").touched&&(null==(d=e.empleados.get("telefono"))?null:d.valid)),ur(5),gs("border-danger",e.empleados.get("usuario").touched&&(null==(p=e.empleados.get("usuario"))?null:p.invalid))("border-success",e.empleados.get("usuario").touched&&(null==(f=e.empleados.get("usuario"))?null:f.valid)),ur(4),gs("border-danger",e.empleados.get("clave").touched&&(null==(m=e.empleados.get("clave"))?null:m.invalid))("border-success",e.empleados.get("clave").touched&&(null==(g=e.empleados.get("clave"))?null:g.valid)),ur(4),qo("routerLink","/menu/listarUsuario")}},directives:[zm,Wf,Rm,Sf,Hf,Bm,Um,Kf,xp],styles:[""]}),t})(),Vx=(()=>{class t{constructor(t){this.http=t,this.api="http://raphaelrod-001-site1.itempurl.com/api/productores/"}nuevo(t){return this.http.post(this.api,t)}listar(){return this.http.get(this.api)}eliminar(t){return this.http.delete(this.api+t)}cargar(t){return this.http.get(this.api+t)}editar(t,e){return this.http.put(this.api+t,e)}cedula(t){const e=(new $_).set("cedula",t);return this.http.get(this.api+"cedulaCliente",{params:e})}buscar(t){var e=(new $_).append("busqueda",t);return this.http.get(this.api+"buscador",{params:e})}}return t.\u0275fac=function(e){return new(e||t)(ui(ey))},t.\u0275prov=at({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();const Ux=function(t){return["/menu/editarProveedor/",t]};function Nx(t,e){if(1&t){const t=Yo();Go(0,"tr",18),Go(1,"td"),Go(2,"strong"),ks(3),Zo(),Zo(),Go(4,"td"),ks(5),Zo(),Go(6,"td"),ks(7),Zo(),Go(8,"td"),ks(9),Zo(),Go(10,"td"),ks(11),Zo(),Go(12,"td"),ks(13),Zo(),Go(14,"td",21),Go(15,"div",22),Go(16,"button",23),ks(17," Opciones "),Zo(),Go(18,"ul",24),Go(19,"li"),Go(20,"a",25),ks(21,"Editar"),Zo(),Zo(),Go(22,"li"),Go(23,"a",26),ts("click",function(){Ie(t);const n=e.$implicit;return is(2).eliminar(n.idProductores)}),ks(24,"Eliminar"),Zo(),Zo(),Zo(),Zo(),Zo(),Zo()}if(2&t){const t=e.$implicit,n=e.index;ur(3),As(n+1),ur(2),As(t.cedula),ur(2),Ps("",t.nombres," ",t.apellidos," "),ur(2),As(t.direccion),ur(2),As(t.telefono),ur(2),As(t.correo),ur(7),qo("routerLink",Ka(8,Ux,t.idProductores))}}function jx(t,e){1&t&&(Go(0,"td",27),ks(1,"No existen Registros "),Zo())}function qx(t,e){if(1&t&&(Go(0,"div",15),Go(1,"table",16),Go(2,"thead",17),Go(3,"tr"),Go(4,"td"),ks(5,"#"),Zo(),Go(6,"td"),ks(7,"Cedula"),Zo(),Go(8,"td"),ks(9,"Nombre"),Zo(),Go(10,"td"),ks(11,"Direccion "),Zo(),Go(12,"td"),ks(13,"Telefono "),Zo(),Go(14,"td"),ks(15,"Correo"),Zo(),Go(16,"td"),ks(17,"Opciones"),Zo(),Zo(),Zo(),Go(18,"tbody"),Ho(19,"tr",18),Uo(20,Nx,25,10,"tr",19),Go(21,"tr"),Uo(22,jx,2,0,"td",20),Zo(),Zo(),Zo(),Zo()),2&t){const t=is();ur(20),qo("ngForOf",t.proveeObj),ur(2),qo("ngIf",0==t.proveeObj.length)}}function $x(t,e){1&t&&(Go(0,"div",28),Ho(1,"div",29),Zo())}const Gx=function(){return["/menu/nuevoProveedor"]};let Zx=(()=>{class t{constructor(t){this.productor=t,this.proveeObj=[],this.spinner=0}ngOnInit(){this.listar()}listar(){this.spinner=1,this.productor.listar().subscribe(t=>{this.proveeObj=t,this.spinner=0},t=>{alert("Error al conectarse"),this.spinner=1})}eliminar(t){Zm.a.fire({title:"\xbfEsta seguro que desea eliminar?",text:" este registro se eliminar\xe1 permanentemente",icon:"warning",showCancelButton:!0,confirmButtonColor:"#29A05B",cancelButtonColor:"#d33",cancelButtonText:"Cancelar",confirmButtonText:"Aceptar"}).then(e=>{e.isConfirmed&&this.productor.eliminar(t).subscribe(t=>{this.listar(),Zm.a.fire("Proveedores","Registro Eliminado exitosamente ","success")},t=>alert("error al eliminar el registro"))})}buscar(t){this.productor.buscar(t).subscribe(t=>{this.proveeObj=t},t=>alert("Error al conectar con el servidor"))}}return t.\u0275fac=function(e){return new(e||t)(jo(Vx))},t.\u0275cmp=Bt({type:t,selectors:[["app-listar-productores"]],decls:25,vars:5,consts:[["lang","en"],["charset","UTF-8"],["name","viewport","content","width=device-width, initial-scale=1.0"],[1,"container"],[1,"text-uppercase","text-center"],[2,"font-weight","bold"],[1,"text-center","mt-3"],[1,"btn","btn-primary","col-5","col-sm-3",3,"routerLink"],[1,"form-group","ms-auto","me-auto","col-4"],[1,"col","mt-4"],[1,"fa","fa-search"],["on","","type","text","aria-describedby","helpId","placeholder","",1,"form-control",3,"keyup"],[1,"text-center","mt-3",2,"color","green","font-size","1.2rem"],["class","table-responsive mt-4    container","style","height: 400px;",4,"ngIf"],["class","text-center  ","style","margin-top: 10em;",4,"ngIf"],[1,"table-responsive","mt-4","container",2,"height","400px"],[1,"table","table-bordered","table-sm","text-center"],[1,"bg-dark","text-white"],[1,"text-dark"],["class","text-dark webkit-scrollbar,","class","text-dark",4,"ngFor","ngForOf"],["class","text-center","colspan","7",4,"ngIf"],[1,"text-center"],[1,"btn-group"],["type","button","data-bs-toggle","dropdown","aria-expanded","false",1,"btn","btn-primary","dropdown-toggle"],[1,"dropdown-menu"],[1,"dropdown-item",3,"routerLink"],[1,"dropdown-item",3,"click"],["colspan","7",1,"text-center"],[1,"text-center",2,"margin-top","10em"],["role","status",1,"spinner-border","text-primary"]],template:function(t,e){1&t&&(Go(0,"html",0),Go(1,"head"),Ho(2,"meta",1),Ho(3,"meta",2),Go(4,"title"),ks(5,"Listar Proveedores"),Zo(),Zo(),Go(6,"div",3),Go(7,"div",4),Go(8,"h3",5),ks(9,"Productores"),Zo(),Zo(),Zo(),Go(10,"div",6),Go(11,"a",7),ks(12,"Nuevo"),Zo(),Zo(),Go(13,"div",8),Go(14,"div",9),Go(15,"span"),Ho(16,"i",10),Zo(),Go(17,"input",11),ts("keyup",function(t){return e.buscar(t.target.value)}),Zo(),Zo(),Zo(),Go(18,"div",12),Go(19,"label"),ks(20,"Total "),Zo(),Go(21,"strong"),ks(22),Zo(),Zo(),Uo(23,qx,23,2,"div",13),Uo(24,$x,2,0,"div",14),Zo()),2&t&&(ur(11),qo("routerLink",Xa(4,Gx)),ur(11),Is(" ",e.proveeObj.length," "),ur(1),qo("ngIf",0==e.spinner),ur(1),qo("ngIf",1==e.spinner))},directives:[bp,Wc,Zc],styles:["span[_ngcontent-%COMP%]{position:absolute;margin-left:5px;height:25px;display:flex;align-items:center;margin-top:5px}input[_ngcontent-%COMP%]{padding-left:25px}"]}),t})();var Hx=n("4ZJM");let Wx=(()=>{class t{constructor(){}carga(t){for(let e of t){let t=document.createElement("script");t.src="../assets/js/"+e+".js",document.getElementsByTagName("body")[0].appendChild(t)}}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=at({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();function Xx(t,e){if(1&t&&(Go(0,"option",45),ks(1),Zo()),2&t){const t=e.$implicit;as("value",t.idTipoProductores),ur(1),Is("",t.nombre," ")}}let Kx=(()=>{class t{constructor(t,e,n,i,r,o){this.proveedores=t,this.router=e,this.ra=n,this._cargarScripts=i,this.element=r,this.tipoProductoresService=o,this.chb=!1,this.listaTipo=[],this.tipoProductoresObj=[],this.proved=new Am({cedula:new km("",Mf.required),nombres:new km("",Mf.required),apellidos:new km("",Mf.required),direccion:new km("",Mf.required),telefono:new km("",Mf.required),correo:new km("",[Mf.required,Mf.email]),edad:new km("",Mf.required),sexo:new km("",Mf.required),longitud:new km("",Mf.required),latitud:new km("",Mf.required),paginaWeb:new km(""),organizacion:new km(""),detalleOrganizacion:new km(""),discapacidad:new km(""),detalleDiscapacidad:new km(""),porcentajeDiscapacidad:new km(""),idTipoProductores:new km("",Mf.required)}),this.idProveedores=this.ra.snapshot.params.id,i.carga(["mapa"])}ngOnInit(){Hx.accessToken="pk.eyJ1IjoiYXJpZWx0aWIzNjkiLCJhIjoiY2txMng0ZHZqMHRlYTJ2cWJjbXNkNGpyOCJ9.fRwi9MaD4rgGR1-o_fhlUQ",this.mapa=new Hx.Map({container:"mapa-mapbox",style:"mapbox://styles/mapbox/streets-v11",center:[-78.6613343,-1.4190227],zoom:15}),this.crearMarcador(-78.6613343,-1.4190227),null!=this.idProveedores&&this.cargar(this.idProveedores),this.llenarTProductores()}crearMarcador(t,e){const n=new Hx.Marker({draggable:!0}).setLngLat([t,e]).addTo(this.mapa);n.on("dragend",()=>{this.element.nativeElement.querySelector("#latitud").value=n.getLngLat().lat,this.element.nativeElement.querySelector("#longitud").value=n.getLngLat().lng,this.lat=n.getLngLat().lat.toString(),this.lng=n.getLngLat().lng.toString()})}guardar(t){var e;""==t.organizacion&&(t.organizacion=!1,t.detalleOrganizacion=""),""==t.discapacidad&&(t.discapacidad=!1,t.porcentajeDiscapacidad=0),0!=this.validarCedula(this.proved.get("cedula").value)?null==this.idProveedores?this.proveedores.nuevo(t).subscribe(t=>{this.router.navigate(["/menu/listarProveedor"]),Zm.a.fire("Proveedores","Registro guardado con exito","success")},t=>{Zm.a.fire("Productores","Ha ocurrido un error","warning")}):(t.idProductores=this.idProveedores,t.Cedula=null===(e=this.proved.get("cedula"))||void 0===e?void 0:e.value,this.proveedores.editar(this.idProveedores,t).subscribe(t=>{Zm.a.fire({position:"center",icon:"success",title:"Editado con exito",showConfirmButton:!1,timer:1500}),this.router.navigate(["/menu/listarProveedor"])},t=>{Zm.a.fire({position:"center",icon:"error",title:"Ha ocurrido un error",showConfirmButton:!1,timer:1500}),this.router.navigate(["/menu/listarProveedor"])})):Zm.a.fire({position:"center",icon:"error",title:"Cedula no valida",showConfirmButton:!1,timer:1500})}validarCedula(t){var e=0,n=t.length,i=n-1;if(""!==t&&10==n){for(let n=0;n<i;n++)if(n%2==0){var r=2*t.charAt(n);r>9&&(r-=9),e+=r}else e+=parseInt(t.charAt(n));return e=e%10?10-e%10:0,t.charAt(n-1)==e}return!1}cargar(t){this.proveedores.cargar(t).subscribe(t=>{console.log(t),this.proved.patchValue(Object.assign({},t))})}llenarTProductores(){this.tipoProductoresService.listar().subscribe(t=>{this.listaTipo=t})}abrir(){alert("hola")}}return t.\u0275fac=function(e){return new(e||t)(jo(Vx),jo(vp),jo(td),jo(Wx),jo(Qs),jo(Kv))},t.\u0275cmp=Bt({type:t,selectors:[["app-nuevo-productores"]],decls:122,vars:58,consts:[["charset","UTF-8"],["http-equiv","X-UA-Compatible","content","IE=edge"],["name","viewport","content","width=device-width, initial-scale=1.0"],["name","viewport","content","width=device-width"],[1,"table-responsive","mt-4","container",2,"height","40rem","overflow-x","hidden","overflow-y","unset"],[3,"formGroup","ngSubmit"],[1,"card","me-auto","ms-auto","col","col-sm",2,"width","30rem","margin-top","2em","margin-bottom","2em","margin-left","em"],[1,"card-header"],[1,"text-center"],[1,"card-body"],[1,"row"],[1,"col"],["for","exampleInputEmail1",1,"text-black-50","fw-bold","fst-italic"],["maxlength","10","formControlName","cedula","type","text",1,"form-control","mb-2"],["formControlName","nombres","type","text",1,"form-control","mb-2"],["formControlName","apellidos","type","text",1,"form-control"],["maxlength","200","formControlName","direccion","type","text",1,"form-control"],["formControlName","telefono","type","number",1,"form-control"],["maxlength","100","formControlName","correo","type","text",1,"form-control"],["formControlName","edad","type","number",1,"form-control"],["aria-label","Default select example","formControlName","sexo",1,"form-select"],["value","Masculino"],["value","Femenino"],["aria-label","Default select example","formControlName","idTipoProductores",1,"form-control"],[3,"value",4,"ngFor","ngForOf"],["maxlength","250","formControlName","paginaWeb","type","text",1,"form-control"],["id","latitud","name","latitud","formControlName","latitud","type","text","readonly","",1,"form-control","mb-2",3,"ngModel"],["id","longitud","name","longitud","formControlName","longitud","type","text","readonly","",1,"form-control","mb-2",3,"ngModel"],["id","mapa-mapbox",2,"width","auto","height","500px"],[1,"form-check",2,"margin-left","27%"],["type","checkbox","data-bs-toggle","collapse","href","#multiCollapseExample1","role","button","aria-expanded","false","aria-controls","multiCollapseExample1","formControlName","organizacion",1,"form-check-input"],["for","exampleCheck1",1,"form-check-label"],["data-bs-toggle","collapse","href","#multiCollapseExample1",1,"align-middle",2,"cursor","pointer","font-size","20px"],["id","multiCollapseExample1",1,"collapse","multi-collapse",2,"margin-top","10px !important"],["maxlength","500","formControlName","detalleOrganizacion","type","text",1,"form-control","mb-2"],[1,"form-check",2,"margin-left","8%"],["type","checkbox","data-bs-toggle","collapse","href","#multiCollapseExample2","role","button","aria-expanded","false","aria-controls","multiCollapseExample1","formControlName","discapacidad",1,"form-check-input",3,"defaultValue"],["data-bs-toggle","collapse","href","#multiCollapseExample2",1,"align-middle",2,"cursor","pointer","font-size","20px"],["id","multiCollapseExample2",1,"collapse","multi-collapse",2,"margin-top","10px !important"],["maxlength","500","formControlName","detalleDiscapacidad","type","text",1,"form-control","mb-2"],["id","multiCollapseExample2",1,"collapse","multi-collapse"],["maxlength","500","formControlName","porcentajeDiscapacidad","type","number",1,"form-control","mb-2"],[1,"text-center","mt-3"],["type","submit",1,"btn","btn-primary","mt-3","me-5","col-4"],[1,"btn","btn-secondary","mt-3","col-4",3,"routerLink"],[3,"value"]],template:function(t,e){if(1&t&&(Go(0,"html"),Go(1,"head"),Ho(2,"meta",0),Ho(3,"meta",1),Ho(4,"meta",2),Go(5,"title"),ks(6,"Document"),Zo(),Ho(7,"meta",3),Zo(),Go(8,"div",4),Go(9,"form",5),ts("ngSubmit",function(){return e.guardar(e.proved.value)}),Go(10,"div",6),Go(11,"div",7),Go(12,"div",8),Go(13,"h3"),ks(14,"Datos Generales"),Zo(),Zo(),Zo(),Go(15,"div",9),Go(16,"div",10),Go(17,"div",11),Go(18,"label",12),ks(19,"Cedula"),Zo(),Ho(20,"input",13),Zo(),Go(21,"div",11),Go(22,"label",12),ks(23,"Nombres"),Zo(),Ho(24,"input",14),Zo(),Zo(),Go(25,"div",10),Go(26,"div",11),Go(27,"label",12),ks(28,"Apellidos"),Zo(),Ho(29,"input",15),Zo(),Go(30,"div",11),Go(31,"label",12),ks(32,"Direccion"),Zo(),Ho(33,"input",16),Zo(),Zo(),Go(34,"div",10),Go(35,"div",11),Go(36,"label",12),ks(37,"Telefono"),Zo(),Ho(38,"input",17),Zo(),Go(39,"div",11),Go(40,"label",12),ks(41,"Correo"),Zo(),Ho(42,"input",18),Zo(),Zo(),Go(43,"div",10),Go(44,"div",11),Go(45,"label",12),ks(46,"Edad"),Zo(),Ho(47,"input",19),Zo(),Go(48,"div",11),Go(49,"label",12),ks(50,"Sexo"),Zo(),Go(51,"select",20),Go(52,"option",21),ks(53,"Masculino"),Zo(),Go(54,"option",22),ks(55,"Femenino"),Zo(),Zo(),Zo(),Zo(),Go(56,"div",10),Go(57,"div",11),Go(58,"label",12),ks(59,"Cargo"),Zo(),Go(60,"select",23),Uo(61,Xx,2,2,"option",24),Zo(),Zo(),Go(62,"div",11),Go(63,"label",12),ks(64,"Web"),Zo(),Ho(65,"input",25),Zo(),Zo(),Zo(),Zo(),Go(66,"div",6),Go(67,"div",7),Go(68,"div",8),Go(69,"h3"),ks(70,"Geolocalizaci\xf3n"),Zo(),Zo(),Zo(),Go(71,"div",9),Go(72,"div",10),Go(73,"div",11),Go(74,"label",12),ks(75,"Latitud"),Zo(),Ho(76,"input",26),Zo(),Zo(),Go(77,"div",10),Go(78,"div",11),Go(79,"label",12),ks(80,"Longitud"),Zo(),Ho(81,"input",27),Zo(),Zo(),Ho(82,"div",28),Zo(),Zo(),Go(83,"div",6),Go(84,"div",7),Go(85,"div",8),Go(86,"h3"),ks(87,"Especificaciones"),Zo(),Zo(),Zo(),Go(88,"div",9),Go(89,"div",10),Go(90,"div",11),Go(91,"div",29),Ho(92,"input",30),Go(93,"label",31),ks(94,"Organizacion"),Zo(),Go(95,"strong",32),ks(96," +"),Zo(),Go(97,"div",33),Go(98,"label",12),ks(99,"Detalle"),Zo(),Ho(100,"input",34),Zo(),Zo(),Zo(),Go(101,"div",11),Go(102,"div",35),Ho(103,"input",36),Go(104,"label",31),ks(105,"Discapacidad"),Zo(),Go(106,"strong",37),ks(107," +"),Zo(),Go(108,"div",11),Go(109,"div",38),Go(110,"label",12),ks(111,"Detalle"),Zo(),Ho(112,"input",39),Zo(),Go(113,"div",40),Go(114,"label",12),ks(115,"Porcentaje"),Zo(),Ho(116,"input",41),Zo(),Zo(),Zo(),Zo(),Zo(),Go(117,"div",42),Go(118,"button",43),ks(119,"Guardar"),Zo(),Go(120,"button",44),ks(121,"Atras"),Zo(),Zo(),Zo(),Zo(),Zo(),Zo(),Zo()),2&t){let t=null,n=null,i=null,r=null,o=null,s=null,a=null,l=null,c=null,u=null,h=null,d=null,p=null,f=null,m=null,g=null,_=null,y=null,v=null,x=null,b=null,w=null,C=null,T=null,S=null,E=null;ur(9),qo("formGroup",e.proved),ur(11),gs("border-danger",e.proved.get("cedula").touched&&(null==(t=e.proved.get("cedula"))?null:t.invalid))("border-success",e.proved.get("cedula").touched&&(null==(n=e.proved.get("cedula"))?null:n.valid)),ur(4),gs("border-danger",e.proved.get("nombres").touched&&(null==(i=e.proved.get("nombres"))?null:i.invalid))("border-success",e.proved.get("nombres").touched&&(null==(r=e.proved.get("nombres"))?null:r.valid)),ur(5),gs("border-danger",e.proved.get("apellidos").touched&&(null==(o=e.proved.get("apellidos"))?null:o.invalid))("border-success",e.proved.get("apellidos").touched&&(null==(s=e.proved.get("apellidos"))?null:s.valid)),ur(4),gs("border-danger",e.proved.get("direccion").touched&&(null==(a=e.proved.get("direccion"))?null:a.invalid))("border-success",e.proved.get("direccion").touched&&(null==(l=e.proved.get("direccion"))?null:l.valid)),ur(5),gs("border-danger",e.proved.get("telefono").touched&&(null==(c=e.proved.get("telefono"))?null:c.invalid))("border-success",e.proved.get("telefono").touched&&(null==(u=e.proved.get("telefono"))?null:u.valid)),ur(4),gs("border-info",e.proved.get("correo").touched&&(null==(h=e.proved.get("correo"))?null:h.invalid))("border-info",e.proved.get("correo").touched&&(null==(d=e.proved.get("correo"))?null:d.valid)),ur(5),gs("border-danger",e.proved.get("edad").touched&&(null==(p=e.proved.get("edad"))?null:p.invalid))("border-success",e.proved.get("edad").touched&&(null==(f=e.proved.get("edad"))?null:f.valid)),ur(4),gs("border-danger",e.proved.get("sexo").touched&&(null==(m=e.proved.get("sexo"))?null:m.invalid))("border-success",e.proved.get("sexo").touched&&(null==(g=e.proved.get("sexo"))?null:g.valid)),ur(9),gs("border-danger",e.proved.get("idTipoProductores").touched&&(null==(_=e.proved.get("idTipoProductores"))?null:_.invalid))("border-success",e.proved.get("idTipoProductores").touched&&(null==(y=e.proved.get("idTipoProductores"))?null:y.valid)),ur(1),qo("ngForOf",e.listaTipo),ur(4),gs("border-danger",e.proved.get("paginaWeb").touched&&(null==(v=e.proved.get("paginaWeb"))?null:v.invalid))("border-success",e.proved.get("paginaWeb").touched&&(null==(x=e.proved.get("paginaWeb"))?null:x.valid)),ur(11),qo("ngModel",e.lat),ur(5),qo("ngModel",e.lng),ur(19),gs("border-info",e.proved.get("detalleOrganizacion").touched&&(null==(b=e.proved.get("detalleOrganizacion"))?null:b.invalid))("border-info",e.proved.get("detalleOrganizacion").touched&&(null==(w=e.proved.get("detalleOrganizacion"))?null:w.valid)),ur(3),qo("defaultValue",!1),ur(9),gs("border-danger",e.proved.get("detalleDiscapacidad").touched&&(null==(C=e.proved.get("detalleDiscapacidad"))?null:C.invalid))("border-success",e.proved.get("detalleDiscapacidad").touched&&(null==(T=e.proved.get("detalleDiscapacidad"))?null:T.valid)),ur(4),gs("border-danger",e.proved.get("detalleDiscapacidad").touched&&(null==(S=e.proved.get("detalleDiscapacidad"))?null:S.invalid))("border-success",e.proved.get("detalleDiscapacidad").touched&&(null==(E=e.proved.get("detalleDiscapacidad"))?null:E.valid)),ur(4),qo("routerLink","/menu/listarProveedor")}},directives:[zm,Wf,Rm,Sf,Um,Hf,Bm,Kf,rm,om,cm,Zc,wf,xp],styles:["#mapa-mapbox[_ngcontent-%COMP%]{width:100%;height:500px;background-color:green}"]}),t})();const Yx=[{path:"login",component:Nv},{path:"nosotros",component:Ix},{path:"menu",component:Rv,canActivate:[Ay],children:[{path:"listarUsuario",component:Fx},{path:"nuevoUsuario",component:Bx},{path:"editarUsuario/:id",component:Bx},{path:"listarCategoria",component:Wv},{path:"listarProveedor",component:Zx},{path:"nuevoProveedor",component:Kx},{path:"editarProveedor/:id",component:Kx},{path:"productos",component:kx},{path:"listarDetalle",component:ky},{path:"nuevoDetalle",component:xy},{path:"editarDetalle/:id",component:xy}]},{path:"**",pathMatch:"full",redirectTo:"nosotros"},{path:"",pathMatch:"full",redirectTo:"nosotros"}];let Jx=(()=>{class t{}return t.\u0275mod=jt({type:t}),t.\u0275inj=lt({factory:function(e){return new(e||t)},imports:[[Dp.forRoot(Yx)],Dp]}),t})(),Qx=(()=>{class t{constructor(){this.title="vinculacion"}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=Bt({type:t,selectors:[["app-root"]],decls:1,vars:0,template:function(t,e){1&t&&Ho(0,"router-outlet")},directives:[Tp],styles:[""]}),t})(),tb=(()=>{class t{}return t.\u0275mod=jt({type:t,bootstrap:[Qx]}),t.\u0275inj=lt({factory:function(e){return new(e||t)},providers:[Wx],imports:[[_f,Jx,$m,gy,Iv,qm,Jv,B_,Dp]]}),t})();(function(){if(nc)throw new Error("Cannot enable prod mode after platform setup.");ec=!1})(),mf().bootstrapModule(tb).catch(t=>console.error(t))},zn8P:function(t,e){function n(t){return Promise.resolve().then(function(){var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e})}n.keys=function(){return[]},n.resolve=n,t.exports=n,n.id="zn8P"}},[[0,0]]]);